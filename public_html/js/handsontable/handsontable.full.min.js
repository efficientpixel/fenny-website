/*!
Copyright (c) Handsoncode sp. z o.o. <hello@handsoncode.net>

This Handsontable Pro is a commercial software distributed by Handsoncode Sp. z o.o. with
its registered seat in Gdynia, Aleja Zwyciestwa 96/98 (81-451 Gdynia) Poland, entered into the Entrepreneurs
Register of the National Court Register under number 0000538651, hereinafter referred to as "HANDSONCODE".

By installing, copying, or otherwise using this software, you agree to be bound by the terms
of its EULA (End-User License Agreement). This software is copyrighted and protected by copyright laws
and international treaties.

YOU EXPRESSLY ACKNOWLEDGE AND AGREE THAT USE OF THE SOFTWARE IS AT YOUR OWN RISK AND THAT THE SOFTWARE
IS PROVIDED "AS IS" WITHOUT ANY WARRANTIES OR CONDITIONS WHATSOEVER. HANDSONCODE EXPRESSLY DISCLAIMS ANY WARRANTY,
EXPRESS OR IMPLIED, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF MERCHANTABILITY,
FITNESS FORA PARTICULAR PURPOSE, OR NONINFRINGMENT. HANDSONCODE DOES NOT WARRANT THAT THE SOFTWARE AND ITS FUNCTIONALITY,
RELIABILITY AND PERFORMANCE WILL MEET YOUR REQUIREMENTS OR THAT THE OPERATION OF THE SOFTWARE WILL BE
UNINTERRUPTED OR ERROR FREE.

YOU SHALL OBTAIN A COMMERCIAL LICENSE FOR THIS SOFTWARE AT HANDSONTABLE.COM.

*/
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.Handsontable=e()}}(function(){var define,module,exports;return function e(t,n,r){function o(a,l){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!l&&u)return u(a,!0);if(i)return i(a,!0);if(s[a]&&"undefined"!=typeof window[s[a]])return window[s[a]];var d=new Error("Cannot find module '"+a+"'");throw d.code="MODULE_NOT_FOUND",d}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return o(n?n:e)},c,c.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,s=JSON.parse('{"zeroclipboard":"ZeroClipboard","moment":"moment","numbro":"numbro","pikaday":"Pikaday","hot-formula-parser":"formulaParser"}')||{},a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t,n){},{}],2:[function(e,t,n){window.jQuery&&!function(e){e.fn.handsontable=function(e){var t,n,r,o,i,s=this.first(),a=s.data("handsontable");if("string"!=typeof e)return i=e||{},a?a.updateSettings(i):(a=new Handsontable.Core(s[0],i),s.data("handsontable",a),a.init()),s;if(r=[],arguments.length>1)for(t=1,n=arguments.length;t<n;t++)r.push(arguments[t]);if(a){if("undefined"==typeof a[e])throw new Error("Handsontable do not provide action: "+e);o=a[e].apply(a,r),"destroy"===e&&s.removeData()}return o}}(window.jQuery)},{}],3:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableBorder:{get:function(){return _}},__esModule:{value:!0}});var r,o,i,s,a,l,u=(r=e("helpers/dom/element"),r&&r.__esModule&&r||{default:r}),d=u.getComputedStyle,c=u.getTrimmingContainer,h=u.innerWidth,f=u.innerHeight,p=u.offset,m=u.outerHeight,g=u.outerWidth,v=(o=e("helpers/dom/event"),o&&o.__esModule&&o||{default:o}).stopImmediatePropagation,w=(i=e("helpers/browser"),i&&i.__esModule&&i||{default:i}).isMobileBrowser,b=(s=e("eventManager"),s&&s.__esModule&&s||{default:s}).EventManager,y=(a=e("cell/coords"),a&&a.__esModule&&a||{default:a}).WalkontableCellCoords,_=((l=e("overlay/_base.js"),l&&l.__esModule&&l||{default:l}).WalkontableOverlay,function(e,t){t&&(this.eventManager=new b(e),this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.left=null,this.bottom=null,this.right=null,this.topStyle=null,this.leftStyle=null,this.bottomStyle=null,this.rightStyle=null,this.cornerDefaultStyle={width:"5px",height:"5px",borderWidth:"2px",borderStyle:"solid",borderColor:"#FFF"},this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())});$traceurRuntime.createClass(_,{registerListeners:function(){var e=this;this.eventManager.addEventListener(document.body,"mousedown",function(){return e.onMouseDown()}),this.eventManager.addEventListener(document.body,"mouseup",function(){return e.onMouseUp()});for(var t=this,n=function(n,r){t.eventManager.addEventListener(t.main.childNodes[n],"mouseenter",function(t){return e.onMouseEnter(t,e.main.childNodes[n])})},r=0,o=this.main.childNodes.length;r<o;r++)n(r,o)},onMouseDown:function(){this.mouseDown=!0},onMouseUp:function(){this.mouseDown=!1},onMouseEnter:function(e,t){function n(e){return e.clientY<Math.floor(i.top)||(e.clientY>Math.ceil(i.top+i.height)||(e.clientX<Math.floor(i.left)||(e.clientX>Math.ceil(i.left+i.width)||void 0)))}function r(e){n(e)&&(o.eventManager.removeEventListener(document.body,"mousemove",r),t.style.display="block")}if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){e.preventDefault(),v(e);var o=this,i=t.getBoundingClientRect();t.style.display="none",this.eventManager.addEventListener(document.body,"mousemove",r)}},createBorders:function(e){this.main=document.createElement("div");var t=["top","left","bottom","right","corner"],n=this.main.style;n.position="absolute",n.top=0,n.left=0;for(var r=0;r<5;r++){var o=t[r],i=document.createElement("div");i.className="wtBorder "+(this.settings.className||""),this.settings[o]&&this.settings[o].hide&&(i.className+=" hidden"),n=i.style,n.backgroundColor=this.settings[o]&&this.settings[o].color?this.settings[o].color:e.border.color,n.height=this.settings[o]&&this.settings[o].width?this.settings[o].width+"px":e.border.width+"px",n.width=this.settings[o]&&this.settings[o].width?this.settings[o].width+"px":e.border.width+"px",this.main.appendChild(i)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),w()&&this.createMultipleSelectorHandles(),this.disappear(),this.wot.wtTable.bordersHolder||(this.wot.wtTable.bordersHolder=document.createElement("div"),this.wot.wtTable.bordersHolder.className="htBorders",this.wot.wtTable.spreader.appendChild(this.wot.wtTable.bordersHolder)),this.wot.wtTable.bordersHolder.insertBefore(this.main,this.wot.wtTable.bordersHolder.firstChild)},createMultipleSelectorHandles:function(){this.selectionHandles={topLeft:document.createElement("DIV"),topLeftHitArea:document.createElement("DIV"),bottomRight:document.createElement("DIV"),bottomRightHitArea:document.createElement("DIV")};var e=10,t=40;this.selectionHandles.topLeft.className="topLeftSelectionHandle",this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea",this.selectionHandles.bottomRight.className="bottomRightSelectionHandle",this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};var n={position:"absolute",height:t+"px",width:t+"px","border-radius":parseInt(t/1.5,10)+"px"};for(var r in n)n.hasOwnProperty(r)&&(this.selectionHandles.styles.bottomRightHitArea[r]=n[r],this.selectionHandles.styles.topLeftHitArea[r]=n[r]);var o={position:"absolute",height:e+"px",width:e+"px","border-radius":parseInt(e/1.5,10)+"px",background:"#F5F5FF",border:"1px solid #4285c8"};for(var i in o)o.hasOwnProperty(i)&&(this.selectionHandles.styles.bottomRight[i]=o[i],this.selectionHandles.styles.topLeft[i]=o[i]);this.main.appendChild(this.selectionHandles.topLeft),this.main.appendChild(this.selectionHandles.bottomRight),this.main.appendChild(this.selectionHandles.topLeftHitArea),this.main.appendChild(this.selectionHandles.bottomRightHitArea)},isPartRange:function(e,t){return!(!this.wot.selections.area.cellRange||e==this.wot.selections.area.cellRange.to.row&&t==this.wot.selections.area.cellRange.to.col)},updateMultipleSelectionHandlesPosition:function(e,t,n,r,o,i){var s=parseInt(this.selectionHandles.styles.topLeft.width,10),a=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top=parseInt(n-s,10)+"px",this.selectionHandles.styles.topLeft.left=parseInt(r-s,10)+"px",this.selectionHandles.styles.topLeftHitArea.top=parseInt(n-a/4*3,10)+"px",this.selectionHandles.styles.topLeftHitArea.left=parseInt(r-a/4*3,10)+"px",this.selectionHandles.styles.bottomRight.top=parseInt(n+i,10)+"px",this.selectionHandles.styles.bottomRight.left=parseInt(r+o,10)+"px",this.selectionHandles.styles.bottomRightHitArea.top=parseInt(n+i-a/4,10)+"px",this.selectionHandles.styles.bottomRightHitArea.left=parseInt(r+o-a/4,10)+"px",this.settings.border.multipleSelectionHandlesVisible&&this.settings.border.multipleSelectionHandlesVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",this.isPartRange(e,t)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"),e==this.wot.wtSettings.getSetting("fixedRowsTop")||t==this.wot.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")},appear:function(e){if(!this.disabled){var t,n,r,o,i,s,a,l,u,v,b,_,C,R,M,E,S,O,T;T=this.wot.wtTable.getRenderedRowsCount();for(var A=0;A<T;A++){var N=this.wot.wtTable.rowFilter.renderedToSource(A);if(N>=e[0]&&N<=e[2]){C=N;break}}for(var x=T-1;x>=0;x--){var k=this.wot.wtTable.rowFilter.renderedToSource(x);if(k>=e[0]&&k<=e[2]){M=k;break}}T=this.wot.wtTable.getRenderedColumnsCount();for(var I=0;I<T;I++){var D=this.wot.wtTable.columnFilter.renderedToSource(I);if(D>=e[1]&&D<=e[3]){R=D;break}}for(var P=T-1;P>=0;P--){var H=this.wot.wtTable.columnFilter.renderedToSource(P);if(H>=e[1]&&H<=e[3]){E=H;break}}if(void 0===C||void 0===R)return void this.disappear();t=C!==M||R!==E,n=this.wot.wtTable.getCell(new y(C,R)),r=t?this.wot.wtTable.getCell(new y(M,E)):n,o=p(n),i=t?p(r):o,s=p(this.wot.wtTable.TABLE),l=o.top,b=i.top+m(r)-l,v=o.left,_=i.left+g(r)-v,a=l-s.top-1,u=v-s.left-1;var L=d(n);parseInt(L.borderTopWidth,10)>0&&(a+=1,b=b>0?b-1:0),parseInt(L.borderLeftWidth,10)>0&&(u+=1,_=_>0?_-1:0),this.topStyle.top=a+"px",this.topStyle.left=u+"px",this.topStyle.width=_+"px",this.topStyle.display="block",this.leftStyle.top=a+"px",this.leftStyle.left=u+"px",this.leftStyle.height=b+"px",this.leftStyle.display="block";var V=Math.floor(this.settings.border.width/2);this.bottomStyle.top=a+b-V+"px",this.bottomStyle.left=u+"px",this.bottomStyle.width=_+"px",this.bottomStyle.display="block",this.rightStyle.top=a+"px",this.rightStyle.left=u+_-V+"px",this.rightStyle.height=b+1+"px",this.rightStyle.display="block",w()||!this.hasSetting(this.settings.border.cornerVisible)||this.isPartRange(M,E)?this.cornerStyle.display="none":(this.cornerStyle.top=a+b-4+"px",this.cornerStyle.left=u+_-4+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none",S=c(this.wot.wtTable.TABLE),E===this.wot.getSetting("totalColumns")-1&&(O=r.offsetLeft+g(r)+parseInt(this.cornerDefaultStyle.width)/2>=h(S),O&&(this.cornerStyle.left=Math.floor(u+_-3-parseInt(this.cornerDefaultStyle.width)/2)+"px",this.cornerStyle.borderRightWidth=0)),M===this.wot.getSetting("totalRows")-1&&(O=r.offsetTop+m(r)+parseInt(this.cornerDefaultStyle.height)/2>=f(S),O&&(this.cornerStyle.top=Math.floor(a+b-3-parseInt(this.cornerDefaultStyle.height)/2)+"px",this.cornerStyle.borderBottomWidth=0)),this.cornerStyle.display="block"),w()&&this.updateMultipleSelectionHandlesPosition(C,R,a,u,_,b)}},disappear:function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none",w()&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")},hasSetting:function(e){return"function"==typeof e?e():!!e}},{}),window.WalkontableBorder=_},{"cell/coords":6,eventManager:42,"helpers/browser":44,"helpers/dom/element":47,"helpers/dom/event":48,"overlay/_base.js":12}],4:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableViewportColumnsCalculator:{get:function(){return o}},__esModule:{value:!0}});var r=new WeakMap,o=function(e,t,n,o,i,s,a){var l=void 0!==arguments[7]?arguments[7]:function(e){return e};r.set(this,{viewportWidth:e,scrollOffset:t,totalColumns:n,columnWidthFn:o,overrideFn:i,onlyFullyVisible:s,stretchingColumnWidthFn:l}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=a,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()},i=o;$traceurRuntime.createClass(o,{calculate:function(){for(var e,t=0,n=!0,o=[],i=r.get(this),s=i.onlyFullyVisible,a=i.overrideFn,l=i.scrollOffset,u=i.totalColumns,d=i.viewportWidth,c=0;c<u;c++){e=this._getColumnWidth(c),t<=l&&!s&&(this.startColumn=c);var h=l>0?d+1:d;if(t>=l&&t+e<=l+h&&(null==this.startColumn&&(this.startColumn=c),this.endColumn=c),o.push(t),t+=e,s||(this.endColumn=c),t>=l+d){n=!1;break}}if(this.endColumn===u-1&&n)for(this.startColumn=this.endColumn;this.startColumn>0;){var f=o[this.endColumn]+e-o[this.startColumn-1];if((f<=d||!s)&&this.startColumn--,f>d)break}null!==this.startColumn&&a&&a(this),this.startPosition=o[this.startColumn],void 0==this.startPosition&&(this.startPosition=null),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)},refreshStretching:function(e){if("none"!==this.stretch){this.totalTargetWidth=e;for(var t=r.get(this),n=t.totalColumns,o=0,i=0;i<n;i++){var s=this._getColumnWidth(i),a=t.stretchingColumnWidthFn(void 0,i);"number"==typeof a?e-=a:o+=s}var l=e-o;if("all"===this.stretch&&l>0)this.stretchAllRatio=e/o,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===this.stretch&&e!==1/0){var u=this._getColumnWidth(n-1),d=l+u;this.stretchLastWidth=d>=0?d:u}}},getStretchedColumnWidth:function(e,t){var n=null;return"all"===this.stretch&&0!==this.stretchAllRatio?n=this._getStretchedAllColumnWidth(e,t):"last"===this.stretch&&0!==this.stretchLastWidth&&(n=this._getStretchedLastColumnWidth(e)),n},_getStretchedAllColumnWidth:function(e,t){var n=0,o=r.get(this),i=o.totalColumns;if(!this.stretchAllColumnsWidth[e]){var s=Math.round(t*this.stretchAllRatio),a=o.stretchingColumnWidthFn(s,e);void 0===a?this.stretchAllColumnsWidth[e]=s:this.stretchAllColumnsWidth[e]=isNaN(a)?this._getColumnWidth(e):a}if(this.stretchAllColumnsWidth.length===i&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var l=0;l<this.stretchAllColumnsWidth.length;l++)n+=this.stretchAllColumnsWidth[l];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[e]},_getStretchedLastColumnWidth:function(e){var t=r.get(this),n=t.totalColumns;return e===n-1?this.stretchLastWidth:null},_getColumnWidth:function(e){var t=r.get(this).columnWidthFn(e);return void 0===t&&(t=i.DEFAULT_WIDTH),t}},{get DEFAULT_WIDTH(){return 50}}),window.WalkontableViewportColumnsCalculator=o},{}],5:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableViewportRowsCalculator:{get:function(){return o}},__esModule:{value:!0}});var r=new WeakMap,o=function(e,t,n,o,i,s,a){r.set(this,{viewportHeight:e,scrollOffset:t,totalRows:n,rowHeightFn:o,overrideFn:i,onlyFullyVisible:s,horizontalScrollbarHeight:a}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()},i=o;$traceurRuntime.createClass(o,{calculate:function(){for(var e=0,t=!0,n=[],o=r.get(this),s=o.onlyFullyVisible,a=o.overrideFn,l=o.rowHeightFn,u=o.scrollOffset,d=o.totalRows,c=o.viewportHeight,h=o.horizontalScrollbarHeight||0,f=0;f<d;f++){var p=l(f);if(void 0===p&&(p=i.DEFAULT_HEIGHT),e<=u&&!s&&(this.startRow=f),e>=u&&e+p<=u+c-h&&(null===this.startRow&&(this.startRow=f),this.endRow=f),n.push(e),e+=p,s||(this.endRow=f),e>=u+c-h){t=!1;break}}if(this.endRow===d-1&&t)for(this.startRow=this.endRow;this.startRow>0;){var m=n[this.endRow]+p-n[this.startRow-1];if((m<=c-h||!s)&&this.startRow--,m>=c-h)break}null!==this.startRow&&a&&a(this),this.startPosition=n[this.startRow],void 0==this.startPosition&&(this.startPosition=null),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}},{get DEFAULT_HEIGHT(){return 23}}),window.WalkontableViewportRowsCalculator=o},{}],6:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableCellCoords:{get:function(){return r}},__esModule:{value:!0}});var r=function(e,t){"undefined"!=typeof e&&"undefined"!=typeof t?(this.row=e,this.col=t):(this.row=null,this.col=null)};$traceurRuntime.createClass(r,{isValid:function(e){return!(this.row<0||this.col<0)&&!(this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns"))},isEqual:function(e){return e===this||this.row===e.row&&this.col===e.col},isSouthEastOf:function(e){return this.row>=e.row&&this.col>=e.col},isNorthWestOf:function(e){return this.row<=e.row&&this.col<=e.col},isSouthWestOf:function(e){return this.row>=e.row&&this.col<=e.col},isNorthEastOf:function(e){return this.row<=e.row&&this.col>=e.col}},{}),window.WalkontableCellCoords=r},{}],7:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableCellRange:{get:function(){return i}},__esModule:{value:!0}});var r,o=(r=e("cell/coords"),r&&r.__esModule&&r||{default:r}).WalkontableCellCoords,i=function(e,t,n){this.highlight=e,this.from=t,this.to=n},s=i;$traceurRuntime.createClass(i,{isValid:function(e){return this.from.isValid(e)&&this.to.isValid(e)},isSingle:function(){return this.from.row===this.to.row&&this.from.col===this.to.col},getHeight:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1},getWidth:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1},includes:function(e){var t=e,n=t.row,r=t.col,o=this.getTopLeftCorner(),i=this.getBottomRightCorner();return o.row<=n&&i.row>=n&&o.col<=r&&i.col>=r},includesRange:function(e){return this.includes(e.getTopLeftCorner())&&this.includes(e.getBottomRightCorner())},isEqual:function(e){return Math.min(this.from.row,this.to.row)==Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)==Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)==Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)==Math.max(e.from.col,e.to.col)},overlaps:function(e){return e.isSouthEastOf(this.getTopLeftCorner())&&e.isNorthWestOf(this.getBottomRightCorner())},isSouthEastOf:function(e){return this.getTopLeftCorner().isSouthEastOf(e)||this.getBottomRightCorner().isSouthEastOf(e)},isNorthWestOf:function(e){return this.getTopLeftCorner().isNorthWestOf(e)||this.getBottomRightCorner().isNorthWestOf(e)},expand:function(e){var t=this.getTopLeftCorner(),n=this.getBottomRightCorner();return(e.row<t.row||e.col<t.col||e.row>n.row||e.col>n.col)&&(this.from=new o(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=new o(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0)},expandByRange:function(e){if(this.includesRange(e)||!this.overlaps(e))return!1;var t=this.getTopLeftCorner(),n=this.getBottomRightCorner(),r=(this.getTopRightCorner(),this.getBottomLeftCorner(),e.getTopLeftCorner()),i=e.getBottomRightCorner(),a=Math.min(t.row,r.row),l=Math.min(t.col,r.col),u=Math.max(n.row,i.row),d=Math.max(n.col,i.col),c=new o(a,l),h=new o(u,d),f=new s(c,c,h).isCorner(this.from,e),p=e.isEqual(new s(c,c,h));return f&&!p&&(this.from.col>c.col&&(c.col=d,h.col=l),this.from.row>c.row&&(c.row=u,h.row=a)),this.from=c,this.to=h,!0},getDirection:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0},setDirection:function(e){var t,n,r,o;switch(e){case"NW-SE":t=[this.getTopLeftCorner(),this.getBottomRightCorner()],this.from=t[0],this.to=t[1],t;break;case"NE-SW":n=[this.getTopRightCorner(),this.getBottomLeftCorner()],this.from=n[0],this.to=n[1],n;break;case"SE-NW":r=[this.getBottomRightCorner(),this.getTopLeftCorner()],this.from=r[0],this.to=r[1],r;break;case"SW-NE":o=[this.getBottomLeftCorner(),this.getTopRightCorner()],this.from=o[0],this.to=o[1],o}},getTopLeftCorner:function(){return new o(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},getBottomRightCorner:function(){return new o(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},getTopRightCorner:function(){return new o(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},getBottomLeftCorner:function(){return new o(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},isCorner:function(e,t){return!!(t&&t.includes(e)&&(this.getTopLeftCorner().isEqual(new o(t.from.row,t.from.col))||this.getTopRightCorner().isEqual(new o(t.from.row,t.to.col))||this.getBottomLeftCorner().isEqual(new o(t.to.row,t.from.col))||this.getBottomRightCorner().isEqual(new o(t.to.row,t.to.col))))||(e.isEqual(this.getTopLeftCorner())||e.isEqual(this.getTopRightCorner())||e.isEqual(this.getBottomLeftCorner())||e.isEqual(this.getBottomRightCorner()))},getOppositeCorner:function(e,t){if(!(e instanceof o))return!1;if(t&&t.includes(e)){if(this.getTopLeftCorner().isEqual(new o(t.from.row,t.from.col)))return this.getBottomRightCorner();if(this.getTopRightCorner().isEqual(new o(t.from.row,t.to.col)))return this.getBottomLeftCorner();if(this.getBottomLeftCorner().isEqual(new o(t.to.row,t.from.col)))return this.getTopRightCorner();if(this.getBottomRightCorner().isEqual(new o(t.to.row,t.to.col)))return this.getTopLeftCorner()}return e.isEqual(this.getBottomRightCorner())?this.getTopLeftCorner():e.isEqual(this.getTopLeftCorner())?this.getBottomRightCorner():e.isEqual(this.getTopRightCorner())?this.getBottomLeftCorner():e.isEqual(this.getBottomLeftCorner())?this.getTopRightCorner():void 0},getBordersSharedWith:function(e){if(!this.includesRange(e))return[];var t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},r=[];return t.top==n.top&&r.push("top"),t.right==n.right&&r.push("right"),t.bottom==n.bottom&&r.push("bottom"),t.left==n.left&&r.push("left"),r},getInner:function(){for(var e=this.getTopLeftCorner(),t=this.getBottomRightCorner(),n=[],r=e.row;r<=t.row;r++)for(var i=e.col;i<=t.col;i++)this.from.row===r&&this.from.col===i||this.to.row===r&&this.to.col===i||n.push(new o(r,i));return n},getAll:function(){for(var e=this.getTopLeftCorner(),t=this.getBottomRightCorner(),n=[],r=e.row;r<=t.row;r++)for(var i=e.col;i<=t.col;i++)e.row===r&&e.col===i?n.push(e):t.row===r&&t.col===i?n.push(t):n.push(new o(r,i));return n},forAll:function(e){for(var t=this.getTopLeftCorner(),n=this.getBottomRightCorner(),r=t.row;r<=n.row;r++)for(var o=t.col;o<=n.col;o++){var i=e(r,o);if(i===!1)return}}},{}),window.WalkontableCellRange=i},{"cell/coords":6}],8:[function(e,t,n){"use strict";Object.defineProperties(n,{Walkontable:{get:function(){return k}},__esModule:{value:!0}});var r,o,i,s,a,l,u,d,c,h,f,p,m,g,v=(r=e("helpers/dom/element"),r&&r.__esModule&&r||{default:r}),w=v.addClass,b=v.fastInnerText,y=v.isVisible,_=v.removeClass,C=(o=e("helpers/object"),o&&o.__esModule&&o||{default:o}).objectEach,R=(i=e("helpers/string"),i&&i.__esModule&&i||{default:i}),M=R.toUpperCaseFirst,E=R.randomString,S=(s=e("event"),s&&s.__esModule&&s||{default:s}).WalkontableEvent,O=(a=e("overlays"),a&&a.__esModule&&a||{default:a}).WalkontableOverlays,T=(l=e("scroll"),l&&l.__esModule&&l||{default:l}).WalkontableScroll,A=(u=e("settings"),u&&u.__esModule&&u||{default:u}).WalkontableSettings,N=(d=e("table"),d&&d.__esModule&&d||{default:d}).WalkontableTable,x=(c=e("viewport"),c&&c.__esModule&&c||{default:c}).WalkontableViewport,k=((h=e("overlay/_base.js"),h&&h.__esModule&&h||{default:h}).WalkontableOverlay,(f=e("overlay/top.js"),f&&f.__esModule&&f||{default:f}).WalkontableTopOverlay,(p=e("overlay/left.js"),p&&p.__esModule&&p||{default:p}).WalkontableLeftOverlay,(m=e("overlay/debug.js"),m&&m.__esModule&&m||{default:m}).WalkontableDebugOverlay,(g=e("overlay/topLeftCorner.js"),g&&g.__esModule&&g||{default:g}).WalkontableTopLeftCornerOverlay,function(e){var t=[];if(this.guid="wt_"+E(),e.cloneSource?(this.cloneSource=e.cloneSource,this.cloneOverlay=e.cloneOverlay,this.wtSettings=e.cloneSource.wtSettings,this.wtTable=new N(this,e.table,e.wtRootElement),this.wtScroll=new T(this),this.wtViewport=e.cloneSource.wtViewport,this.wtEvent=new S(this),this.selections=this.cloneSource.selections):(this.wtSettings=new A(this,e),this.wtTable=new N(this,e.table),this.wtScroll=new T(this),this.wtViewport=new x(this),this.wtEvent=new S(this),this.selections=this.getSetting("selections"),this.wtOverlays=new O(this),this.exportSettingsAsClassNames()),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var n=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;n<r;n++)t.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(e,n){b(n,t[e])}])}this.drawn=!1,this.drawInterrupted=!1});$traceurRuntime.createClass(k,{draw:function(){var e=void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,e||y(this.wtTable.TABLE)?this.wtTable.draw(e):this.drawInterrupted=!0,this},getCell:function(e){var t=void 0!==arguments[1]&&arguments[1];if(!t)return this.wtTable.getCell(e);var n=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),i=this.wtSettings.getSetting("fixedColumnsLeft");if(e.row<r&&e.col<i)return this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(e);if(e.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<i&&e.row>=n-o){if(this.wtOverlays.bottomLeftCornerOverlay.clone)return this.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<i)return this.wtOverlays.leftOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>n-o&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)},update:function(e,t){return this.wtSettings.update(e,t)},scrollVertical:function(e){return this.wtOverlays.topOverlay.scrollTo(e),this.getSetting("onScrollVertically"),this},scrollHorizontal:function(e){return this.wtOverlays.leftOverlay.scrollTo(e),this.getSetting("onScrollHorizontally"),this},scrollViewport:function(e){return this.wtScroll.scrollViewport(e),this},getViewport:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]},getOverlayName:function(){return this.cloneOverlay?this.cloneOverlay.type:"master"},isOverlayName:function(e){return!!this.cloneOverlay&&this.cloneOverlay.type===e},exportSettingsAsClassNames:function(){var e=this,t={rowHeaders:["array"],columnHeaders:["array"]},n=[],r=[];C(t,function(t,o){t.indexOf("array")>-1&&e.getSetting(o).length&&r.push("ht"+M(o)),n.push("ht"+M(o))}),_(this.wtTable.wtRootElement.parentNode,n),w(this.wtTable.wtRootElement.parentNode,r)},getSetting:function(e,t,n,r,o){return this.wtSettings.getSetting(e,t,n,r,o)},hasSetting:function(e){return this.wtSettings.has(e)},destroy:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}},{}),window.Walkontable=k},{event:9,"helpers/dom/element":47,"helpers/object":53,"helpers/string":55,"overlay/_base.js":12,"overlay/debug.js":13,"overlay/left.js":14,"overlay/top.js":15,"overlay/topLeftCorner.js":16,overlays:17,scroll:18,settings:20,table:21,viewport:23}],9:[function(e,t,n){"use strict";function r(e){var t=this,n=m(e);this.instance=e;var r=[null,null];this.dblClickTimeout=[null,null];var o,i=function(e){var n=document.activeElement,o=f(h,e.realTarget),i=e.realTarget;if(i!==n&&o(0)!==n&&o(1)!==n){var s=t.parentCell(i);d(i,"corner")?t.instance.getSetting("onCellCornerMouseDown",e,i):s.TD&&t.instance.hasSetting("onCellMouseDown")&&t.instance.getSetting("onCellMouseDown",e,s.coords,s.TD,t.instance),2!==e.button&&s.TD&&(r[0]=s.TD,clearTimeout(t.dblClickTimeout[0]),t.dblClickTimeout[0]=setTimeout(function(){r[0]=null},1e3))}},s=function(e){t.instance.touchMoving=!0},a=function(e){n.addEventListener(this,"touchmove",s),t.checkIfTouchMove=setTimeout(function(){return t.instance.touchMoving===!0?(t.instance.touchMoving=void 0,void n.removeEventListener("touchmove",s,!1)):void i(e)},30)},l=function(e){var n,r,o;t.instance.hasSetting("onCellMouseOver")&&(n=t.instance.wtTable.TABLE,r=u(e.realTarget,["TD","TH"],n),o=t.instance.cloneSource||t.instance,r&&r!==o.lastMouseOver&&c(r,n)&&(o.lastMouseOver=r,t.instance.getSetting("onCellMouseOver",e,t.instance.wtTable.getCoords(r),r,t.instance)))},g=function(e){if(2!==e.button){var n=t.parentCell(e.realTarget);n.TD===r[0]&&n.TD===r[1]?(d(e.realTarget,"corner")?t.instance.getSetting("onCellCornerDblClick",e,n.coords,n.TD,t.instance):t.instance.getSetting("onCellDblClick",e,n.coords,n.TD,t.instance),r[0]=null,r[1]=null):n.TD===r[0]?(t.instance.getSetting("onCellMouseUp",e,n.coords,n.TD,t.instance),r[1]=n.TD,clearTimeout(t.dblClickTimeout[1]),t.dblClickTimeout[1]=setTimeout(function(){r[1]=null},500)):n.TD&&t.instance.hasSetting("onCellMouseUp")&&t.instance.getSetting("onCellMouseUp",e,n.coords,n.TD,t.instance)}},v=function(e){clearTimeout(o),e.preventDefault(),g(e)};if(n.addEventListener(this.instance.wtTable.holder,"mousedown",i),n.addEventListener(this.instance.wtTable.TABLE,"mouseover",l),n.addEventListener(this.instance.wtTable.holder,"mouseup",g),this.instance.wtTable.holder.parentNode.parentNode&&p()&&!t.instance.wtTable.isWorkingOnClone()){var w="."+this.instance.wtTable.holder.parentNode.className.split(" ").join(".");n.addEventListener(this.instance.wtTable.holder,"touchstart",function(e){t.instance.touchApplied=!0,c(e.target,w)&&a.call(e.target,e)}),n.addEventListener(this.instance.wtTable.holder,"touchend",function(e){t.instance.touchApplied=!1,c(e.target,w)&&v.call(e.target,e)}),t.instance.momentumScrolling||(t.instance.momentumScrolling={}),n.addEventListener(this.instance.wtTable.holder,"scroll",function(e){clearTimeout(t.instance.momentumScrolling._timeout),t.instance.momentumScrolling.ongoing||t.instance.getSetting("onBeforeTouchScroll"),t.instance.momentumScrolling.ongoing=!0,t.instance.momentumScrolling._timeout=setTimeout(function(){t.instance.touchApplied||(t.instance.momentumScrolling.ongoing=!1,t.instance.getSetting("onAfterMomentumScroll"))},200)})}n.addEventListener(window,"resize",function(){"none"!==t.instance.getSetting("stretchH")&&t.instance.draw()}),this.destroy=function(){clearTimeout(this.dblClickTimeout[0]),clearTimeout(this.dblClickTimeout[1]),n.destroy()}}Object.defineProperties(n,{WalkontableEvent:{get:function(){return r}},__esModule:{value:!0}});var o,i,s,a,l=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{default:o}),u=l.closestDown,d=l.hasClass,c=l.isChildOf,h=l.getParent,f=(i=e("helpers/function"),i&&i.__esModule&&i||{default:i}).partial,p=(s=e("helpers/browser"),s&&s.__esModule&&s||{default:s}).isMobileBrowser,m=(a=e("eventManager"),a&&a.__esModule&&a||{default:a}).eventManager;r.prototype.parentCell=function(e){var t={},n=this.instance.wtTable.TABLE,r=u(e,["TD","TH"],n);return r?(t.coords=this.instance.wtTable.getCoords(r),t.TD=r):d(e,"wtBorder")&&d(e,"current")?(t.coords=this.instance.selections.current.cellRange.highlight,t.TD=this.instance.wtTable.getCell(t.coords)):d(e,"wtBorder")&&d(e,"area")&&this.instance.selections.area.cellRange&&(t.coords=this.instance.selections.area.cellRange.to,t.TD=this.instance.wtTable.getCell(t.coords)),t},window.WalkontableEvent=r},{eventManager:42,"helpers/browser":44,"helpers/dom/element":47,"helpers/function":50}],10:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableColumnFilter:{
get:function(){return r}},__esModule:{value:!0}});var r=function(e,t,n){this.offset=e,this.total=t,this.countTH=n};$traceurRuntime.createClass(r,{offsetted:function(e){return e+this.offset},unOffsetted:function(e){return e-this.offset},renderedToSource:function(e){return this.offsetted(e)},sourceToRendered:function(e){return this.unOffsetted(e)},offsettedTH:function(e){return e-this.countTH},unOffsettedTH:function(e){return e+this.countTH},visibleRowHeadedColumnToSourceColumn:function(e){return this.renderedToSource(this.offsettedTH(e))},sourceColumnToVisibleRowHeadedColumn:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}},{}),window.WalkontableColumnFilter=r},{}],11:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableRowFilter:{get:function(){return r}},__esModule:{value:!0}});var r=function(e,t,n){this.offset=e,this.total=t,this.countTH=n};$traceurRuntime.createClass(r,{offsetted:function(e){return e+this.offset},unOffsetted:function(e){return e-this.offset},renderedToSource:function(e){return this.offsetted(e)},sourceToRendered:function(e){return this.unOffsetted(e)},offsettedTH:function(e){return e-this.countTH},unOffsettedTH:function(e){return e+this.countTH},visibleColHeadedRowToSourceRow:function(e){return this.renderedToSource(this.offsettedTH(e))},sourceRowToVisibleColHeadedRow:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}},{}),window.WalkontableRowFilter=r},{}],12:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableOverlay:{get:function(){return p}},__esModule:{value:!0}});var r,o,i,s,a=(r=e("helpers/dom/element"),r&&r.__esModule&&r||{default:r}),l=a.getScrollableElement,u=a.getTrimmingContainer,d=(o=e("helpers/object"),o&&o.__esModule&&o||{default:o}).defineGetter,c=(i=e("helpers/array"),i&&i.__esModule&&i||{default:i}).arrayEach,h=(s=e("eventManager"),s&&s.__esModule&&s||{default:s}).eventManager,f={},p=function(e){d(this,"wot",e,{writable:!1}),this.instance=this.wot,this.type="",this.mainTableScrollableElement=null,this.TABLE=this.wot.wtTable.TABLE,this.hider=this.wot.wtTable.hider,this.spreader=this.wot.wtTable.spreader,this.holder=this.wot.wtTable.holder,this.wtRootElement=this.wot.wtTable.wtRootElement,this.trimmingContainer=u(this.hider.parentNode.parentNode),this.areElementSizesAdjusted=!1,this.updateStateOfRendering()},m=p;$traceurRuntime.createClass(p,{updateStateOfRendering:function(){var e=this.needFullRender;this.needFullRender=this.shouldBeRendered();var t=e!==this.needFullRender;return t&&!this.needFullRender&&this.reset(),t},shouldBeRendered:function(){return!0},updateTrimmingContainer:function(){this.trimmingContainer=u(this.hider.parentNode.parentNode)},updateMainScrollableElement:function(){this.mainTableScrollableElement=l(this.wot.wtTable.TABLE)},makeClone:function(e){if(m.CLONE_TYPES.indexOf(e)===-1)throw new Error('Clone type "'+e+'" is not supported.');var t=document.createElement("DIV"),n=document.createElement("TABLE");t.className="ht_clone_"+e+" handsontable",t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.overflow="hidden",n.className=this.wot.wtTable.TABLE.className,t.appendChild(n),this.type=e,this.wot.wtTable.wtRootElement.parentNode.appendChild(t);var r=this.wot.getSetting("preventOverflow");return r===!0||"horizontal"===r&&this.type===m.CLONE_TOP||"vertical"===r&&this.type===m.CLONE_LEFT?this.mainTableScrollableElement=window:this.mainTableScrollableElement=l(this.wot.wtTable.TABLE),new Walkontable({cloneSource:this.wot,cloneOverlay:this,table:n})},refresh:function(){var e=void 0!==arguments[0]&&arguments[0],t=this.shouldBeRendered();this.clone&&(this.needFullRender||t)&&this.clone.draw(e),this.needFullRender=t},reset:function(){if(this.clone){var e=this.clone.wtTable.holder,t=this.clone.wtTable.hider,n=e.style,r=t.style,o=e.parentNode.style;c([n,r,o],function(e){e.width="",e.height=""})}},destroy:function(){h(this.clone).destroy()}},{get CLONE_TOP(){return"top"},get CLONE_BOTTOM(){return"bottom"},get CLONE_LEFT(){return"left"},get CLONE_TOP_LEFT_CORNER(){return"top_left_corner"},get CLONE_BOTTOM_LEFT_CORNER(){return"bottom_left_corner"},get CLONE_DEBUG(){return"debug"},get CLONE_TYPES(){return[m.CLONE_TOP,m.CLONE_BOTTOM,m.CLONE_LEFT,m.CLONE_TOP_LEFT_CORNER,m.CLONE_BOTTOM_LEFT_CORNER,m.CLONE_DEBUG]},registerOverlay:function(e,t){if(m.CLONE_TYPES.indexOf(e)===-1)throw new Error("Unsupported overlay ("+e+").");f[e]=t},createOverlay:function(e,t){return new f[e](t)},isOverlayTypeOf:function(e,t){return!(!e||!f[t])&&e instanceof f[t]}}),window.WalkontableOverlay=p},{eventManager:42,"helpers/array":43,"helpers/dom/element":47,"helpers/object":53}],13:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableDebugOverlay:{get:function(){return a}},__esModule:{value:!0}});var r,o,i=(r=e("helpers/dom/element"),r&&r.__esModule&&r||{default:r}).addClass,s=(o=e("_base"),o&&o.__esModule&&o||{default:o}).WalkontableOverlay,a=function(e){$traceurRuntime.superConstructor(l).call(this,e),this.clone=this.makeClone(s.CLONE_DEBUG),this.clone.wtTable.holder.style.opacity=.4,this.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000",i(this.clone.wtTable.holder.parentNode,"wtDebugVisible")},l=a;$traceurRuntime.createClass(a,{},{},s),window.WalkontableDebugOverlay=a,s.registerOverlay(s.CLONE_DEBUG,a)},{_base:12,"helpers/dom/element":47}],14:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableLeftOverlay:{get:function(){return v}},__esModule:{value:!0}});var r,o,i=(r=e("helpers/dom/element"),r&&r.__esModule&&r||{default:r}),s=i.addClass,a=i.getScrollbarWidth,l=i.getScrollLeft,u=i.getWindowScrollTop,d=i.hasClass,c=i.outerWidth,h=i.innerHeight,f=i.removeClass,p=i.setOverlayPosition,m=i.resetCssTransform,g=(o=e("_base"),o&&o.__esModule&&o||{default:o}).WalkontableOverlay,v=function(e){$traceurRuntime.superConstructor(w).call(this,e),this.clone=this.makeClone(g.CLONE_LEFT)},w=v;$traceurRuntime.createClass(v,{shouldBeRendered:function(){return!(!this.wot.getSetting("fixedColumnsLeft")&&!this.wot.getSetting("rowHeaders").length)},resetFixedPosition:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,t=0,n=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||n&&"horizontal"===n)t=this.getScrollPosition(),m(e);else{var r,o,i=this.wot.wtTable.hider.getBoundingClientRect(),s=Math.ceil(i.left),a=Math.ceil(i.right);o=this.wot.wtTable.hider.style.top,o=""===o?0:o,r=s<0&&a-e.offsetWidth>0?-s:0,t=r,r+="px",p(e,r,o)}this.adjustHeaderBordersPosition(t),this.adjustElementsSize()}},setScrollPosition:function(e){this.mainTableScrollableElement===window?window.scrollTo(e,u()):this.mainTableScrollableElement.scrollLeft=e},onScroll:function(){this.wot.getSetting("onScrollVertically")},sumCellSizes:function(e,t){for(var n=0,r=this.wot.wtSettings.defaultColumnWidth;e<t;)n+=this.wot.wtTable.getStretchedColumnWidth(e)||r,e++;return n},adjustElementsSize:function(){var e=void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),e||(this.areElementSizesAdjusted=!0))},adjustRootElementSize:function(){var e,t=this.wot.wtTable.holder,n=t.clientHeight===t.offsetHeight?0:a(),r=this.clone.wtTable.holder.parentNode,o=r.style,i=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||"vertical"===i){var s=this.wot.wtViewport.getWorkspaceHeight()-n;s=Math.min(s,h(this.wot.wtTable.wtRootElement)),o.height=s+"px"}else o.height="";this.clone.wtTable.holder.style.height=o.height,e=c(this.clone.wtTable.TABLE),o.width=(0===e?e:e+4)+"px"},adjustRootChildrenSize:function(){var e=a();this.clone.wtTable.hider.style.height=this.hider.style.height,this.clone.wtTable.holder.style.height=this.clone.wtTable.holder.parentNode.style.height,0===e&&(e=30),this.clone.wtTable.holder.style.width=parseInt(this.clone.wtTable.holder.parentNode.style.width,10)+e+"px"},applyToDOM:function(){var e=this.wot.getSetting("totalColumns");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px";else{if(0!==e)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style.left="0"}this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()},syncOverlayOffset:function(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px":this.clone.wtTable.spreader.style.top=""},scrollTo:function(e,t){var n=this.getTableParentOffset(),r=this.wot.cloneSource?this.wot.cloneSource:this.wot,o=r.wtTable.holder,i=0;t&&o.offsetWidth!==o.clientWidth&&(i=a()),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportWidth()):n+=this.sumCellSizes(this.wot.getSetting("fixedColumnsLeft"),e),n+=i,this.setScrollPosition(n)},getTableParentOffset:function(){var e=this.wot.getSetting("preventOverflow"),t=0;return e||this.trimmingContainer!==window||(t=this.wot.wtTable.holderOffset.left),t},getScrollPosition:function(){return l(this.mainTableScrollableElement)},adjustHeaderBordersPosition:function(e){var t=this.wot.wtTable.holder.parentNode,n=this.wot.getSetting("rowHeaders"),r=this.wot.getSetting("fixedColumnsLeft"),o=this.wot.getSetting("totalRows");if(o?f(t,"emptyRows"):s(t,"emptyRows"),r&&!n.length)s(t,"innerBorderLeft");else if(!r&&n.length){var i=d(t,"innerBorderLeft");e?s(t,"innerBorderLeft"):f(t,"innerBorderLeft"),(!i&&e||i&&!e)&&this.wot.wtOverlays.adjustElementsSize()}}},{},g),window.WalkontableLeftOverlay=v,g.registerOverlay(g.CLONE_LEFT,v)},{_base:12,"helpers/dom/element":47}],15:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableTopOverlay:{get:function(){return v}},__esModule:{value:!0}});var r,o,i=(r=e("helpers/dom/element"),r&&r.__esModule&&r||{default:r}),s=i.addClass,a=i.getScrollbarWidth,l=i.getScrollTop,u=i.getWindowScrollLeft,d=i.hasClass,c=i.outerHeight,h=i.innerWidth,f=i.removeClass,p=i.setOverlayPosition,m=i.resetCssTransform,g=(o=e("_base"),o&&o.__esModule&&o||{default:o}).WalkontableOverlay,v=function(e){$traceurRuntime.superConstructor(w).call(this,e),this.clone=this.makeClone(g.CLONE_TOP)},w=v;$traceurRuntime.createClass(v,{shouldBeRendered:function(){return!(!this.wot.getSetting("fixedRowsTop")&&!this.wot.getSetting("columnHeaders").length)},resetFixedPosition:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,t=0,n=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||n&&"vertical"===n)t=this.getScrollPosition(),m(e);else{var r,o,i=this.wot.wtTable.hider.getBoundingClientRect(),s=Math.ceil(i.top),a=Math.ceil(i.bottom);r=this.wot.wtTable.hider.style.left,r=""===r?0:r,o=s<0&&a-e.offsetHeight>0?-s:0,t=o,o+="px",p(e,r,o)}this.adjustHeaderBordersPosition(t),this.adjustElementsSize()}},setScrollPosition:function(e){this.mainTableScrollableElement===window?window.scrollTo(u(),e):this.mainTableScrollableElement.scrollTop=e},onScroll:function(){this.wot.getSetting("onScrollHorizontally")},sumCellSizes:function(e,t){for(var n=0,r=this.wot.wtSettings.settings.defaultRowHeight;e<t;){var o=this.wot.wtTable.getRowHeight(e);n+=void 0===o?r:o,e++}return n},adjustElementsSize:function(){var e=void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),e||(this.areElementSizesAdjusted=!0))},adjustRootElementSize:function(){var e,t=this.wot.wtTable.holder,n=t.clientWidth===t.offsetWidth?0:a(),r=this.clone.wtTable.holder.parentNode,o=r.style,i=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||"horizontal"===i){var s=this.wot.wtViewport.getWorkspaceWidth()-n;s=Math.min(s,h(this.wot.wtTable.wtRootElement)),o.width=s+"px"}else o.width="";this.clone.wtTable.holder.style.width=o.width,e=c(this.clone.wtTable.TABLE),o.height=(0===e?e:e+4)+"px"},adjustRootChildrenSize:function(){var e=a();this.clone.wtTable.hider.style.width=this.hider.style.width,this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width,0===e&&(e=30),this.clone.wtTable.holder.style.height=parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+e+"px"},applyToDOM:function(){var e=this.wot.getSetting("totalRows");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()},syncOverlayOffset:function(){"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":this.clone.wtTable.spreader.style.left=""},scrollTo:function(e,t){var n=this.getTableParentOffset(),r=this.wot.cloneSource?this.wot.cloneSource:this.wot,o=r.wtTable.holder,i=0;if(t&&o.offsetHeight!==o.clientHeight&&(i=a()),t){var s=this.wot.getSetting("fixedRowsBottom"),l=(this.wot.getSetting("fixedRowsTop"),this.wot.getSetting("totalRows"));n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight()-this.sumCellSizes(l-s,l),n+=1}else n+=this.sumCellSizes(this.wot.getSetting("fixedRowsTop"),e);n+=i,this.setScrollPosition(n)},getTableParentOffset:function(){return this.mainTableScrollableElement===window?this.wot.wtTable.holderOffset.top:0},getScrollPosition:function(){return l(this.mainTableScrollableElement)},adjustHeaderBordersPosition:function(e){var t=this.wot.wtTable.holder.parentNode,n=this.wot.getSetting("totalColumns");if(n?f(t,"emptyColumns"):s(t,"emptyColumns"),0===this.wot.getSetting("fixedRowsTop")&&this.wot.getSetting("columnHeaders").length>0){var r=d(t,"innerBorderTop");e||0===this.wot.getSetting("totalRows")?s(t,"innerBorderTop"):f(t,"innerBorderTop"),(!r&&e||r&&!e)&&this.wot.wtOverlays.adjustElementsSize()}if(0===this.wot.getSetting("rowHeaders").length){var o=this.clone.wtTable.THEAD.querySelectorAll("th:nth-of-type(2)");if(o)for(var i=0;i<o.length;i++)o[i].style["border-left-width"]=0}}},{},g),window.WalkontableTopOverlay=v,g.registerOverlay(g.CLONE_TOP,v)},{_base:12,"helpers/dom/element":47}],16:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableTopLeftCornerOverlay:{get:function(){return c}},__esModule:{value:!0}});var r,o,i=(r=e("helpers/dom/element"),r&&r.__esModule&&r||{default:r}),s=i.outerHeight,a=i.outerWidth,l=i.setOverlayPosition,u=i.resetCssTransform,d=(o=e("_base"),o&&o.__esModule&&o||{default:o}).WalkontableOverlay,c=function(e){$traceurRuntime.superConstructor(h).call(this,e),this.clone=this.makeClone(d.CLONE_TOP_LEFT_CORNER)},h=c;$traceurRuntime.createClass(c,{shouldBeRendered:function(){return!(!this.wot.getSetting("fixedRowsTop")&&!this.wot.getSetting("columnHeaders").length||!this.wot.getSetting("fixedColumnsLeft")&&!this.wot.getSetting("rowHeaders").length)},resetFixedPosition:function(){if(this.updateTrimmingContainer(),this.wot.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,t=s(this.clone.wtTable.TABLE),n=a(this.clone.wtTable.TABLE),r=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===window){var o=this.wot.wtTable.hider.getBoundingClientRect(),i=Math.ceil(o.top),d=Math.ceil(o.left),c=Math.ceil(o.bottom),h=Math.ceil(o.right),f="0",p="0";r&&"vertical"!==r||d<0&&h-e.offsetWidth>0&&(f=-d+"px"),r&&"horizontal"!==r||i<0&&c-e.offsetHeight>0&&(p=-i+"px"),l(e,f,p)}else u(e);e.style.height=(0===t?t:t+4)+"px",e.style.width=(0===n?n:n+4)+"px"}}},{},d),window.WalkontableTopLeftCornerOverlay=c,d.registerOverlay(d.CLONE_TOP_LEFT_CORNER,c)},{_base:12,"helpers/dom/element":47}],17:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableOverlays:{get:function(){return v}},__esModule:{value:!0}});var r,o,i,s,a,l=(r=e("helpers/dom/element"),r&&r.__esModule&&r||{default:r}),u=l.getScrollableElement,d=l.getScrollbarWidth,c=l.getScrollLeft,h=l.getScrollTop,f=(o=e("helpers/array"),o&&o.__esModule&&o||{default:o}).arrayEach,p=(i=e("helpers/unicode"),i&&i.__esModule&&i||{default:i}).isKey,m=(s=e("helpers/browser"),s&&s.__esModule&&s||{default:s}).isMobileBrowser,g=(a=e("eventManager"),a&&a.__esModule&&a||{default:a}).EventManager,v=function(e){this.wot=e,this.instance=this.wot,this.eventManager=new g(this.wot),this.wot.update("scrollbarWidth",d()),this.wot.update("scrollbarHeight",d()),this.scrollableElement=u(this.wot.wtTable.TABLE),this.prepareOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.overlayScrollPositions={master:{top:0,left:0},top:{top:null,left:0},bottom:{top:null,left:0},left:{top:0,left:null}},this.pendingScrollCallbacks={master:{top:0,left:0},top:{left:0},bottom:{left:0},left:{top:0}},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.delegatedScrollCallback=!1,this.registeredListeners=[],this.registerListeners()};$traceurRuntime.createClass(v,{prepareOverlays:function(){var e=!1;return this.topOverlay?e=this.topOverlay.updateStateOfRendering()||e:this.topOverlay=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_TOP,this.wot),"undefined"==typeof WalkontableBottomOverlay&&(this.bottomOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),"undefined"==typeof WalkontableBottomLeftCornerOverlay&&(this.bottomLeftCornerOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),this.bottomOverlay?e=this.bottomOverlay.updateStateOfRendering()||e:this.bottomOverlay=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_BOTTOM,this.wot),this.leftOverlay?e=this.leftOverlay.updateStateOfRendering()||e:this.leftOverlay=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_LEFT,this.wot),this.topOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.topLeftCornerOverlay?e=this.topLeftCornerOverlay.updateStateOfRendering()||e:this.topLeftCornerOverlay=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_TOP_LEFT_CORNER,this.wot)),this.bottomOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.bottomLeftCornerOverlay?e=this.bottomLeftCornerOverlay.updateStateOfRendering()||e:this.bottomLeftCornerOverlay=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER,this.wot)),this.wot.getSetting("debug")&&!this.debug&&(this.debug=WalkontableOverlay.createOverlay(WalkontableOverlay.CLONE_DEBUG,this.wot)),e},refreshAll:function(){if(this.wot.drawn){if(!this.wot.wtTable.holder.parentNode)return void this.destroy();this.wot.draw(!0),this.verticalScrolling&&this.leftOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}},registerListeners:function(){var e=this,t=this.topOverlay.mainTableScrollableElement,n=this.leftOverlay.mainTableScrollableElement,r=[];for(r.push([document.documentElement,"keydown",function(t){return e.onKeyDown(t)}]),r.push([document.documentElement,"keyup",function(){return e.onKeyUp()}]),r.push([document,"visibilitychange",function(){return e.onKeyUp()}]),r.push([t,"scroll",function(t){return e.onTableScroll(t)}]),t!==n&&r.push([n,"scroll",function(t){return e.onTableScroll(t)}]),this.topOverlay.needFullRender&&(r.push([this.topOverlay.clone.wtTable.holder,"scroll",function(t){return e.onTableScroll(t)}]),r.push([this.topOverlay.clone.wtTable.holder,"wheel",function(t){return e.onTableScroll(t)}])),this.bottomOverlay.needFullRender&&(r.push([this.bottomOverlay.clone.wtTable.holder,"scroll",function(t){return e.onTableScroll(t)}]),r.push([this.bottomOverlay.clone.wtTable.holder,"wheel",function(t){return e.onTableScroll(t)}])),this.leftOverlay.needFullRender&&(r.push([this.leftOverlay.clone.wtTable.holder,"scroll",function(t){return e.onTableScroll(t)}]),r.push([this.leftOverlay.clone.wtTable.holder,"wheel",function(t){return e.onTableScroll(t)}])),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.needFullRender&&r.push([this.topLeftCornerOverlay.clone.wtTable.holder,"wheel",function(t){return e.onTableScroll(t)}]),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.needFullRender&&r.push([this.bottomLeftCornerOverlay.clone.wtTable.holder,"wheel",function(t){return e.onTableScroll(t)}]),this.topOverlay.trimmingContainer!==window&&this.leftOverlay.trimmingContainer!==window&&r.push([window,"wheel",function(t){var n,r=t.wheelDeltaY||t.deltaY,o=t.wheelDeltaX||t.deltaX;e.topOverlay.clone.wtTable.holder.contains(t.realTarget)?n="top":e.bottomOverlay.clone&&e.bottomOverlay.clone.wtTable.holder.contains(t.realTarget)?n="bottom":e.leftOverlay.clone.wtTable.holder.contains(t.realTarget)?n="left":e.topLeftCornerOverlay&&e.topLeftCornerOverlay.clone&&e.topLeftCornerOverlay.clone.wtTable.holder.contains(t.realTarget)?n="topLeft":e.bottomLeftCornerOverlay&&e.bottomLeftCornerOverlay.clone&&e.bottomLeftCornerOverlay.clone.wtTable.holder.contains(t.realTarget)&&(n="bottomLeft"),("top"==n&&0!==r||"left"==n&&0!==o||"bottom"==n&&0!==r||("topLeft"===n||"bottomLeft"===n)&&(0!==r||0!==o))&&t.preventDefault()}]);r.length;){var o=r.pop();this.eventManager.addEventListener(o[0],o[1],o[2]),this.registeredListeners.push(o)}},deregisterListeners:function(){for(;this.registeredListeners.length;){var e=this.registeredListeners.pop();this.eventManager.removeEventListener(e[0],e[1],e[2])}},onTableScroll:function(e){if(!m()){var t=this.leftOverlay.mainTableScrollableElement,n=this.topOverlay.mainTableScrollableElement,r=e.target;this.keyPressed&&(n!==window&&r!==window&&!e.target.contains(n)||t!==window&&r!==window&&!e.target.contains(t))||("scroll"===e.type?this.syncScrollPositions(e):this.translateMouseWheelToScroll(e))}},onKeyDown:function(e){this.keyPressed=p(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")},onKeyUp:function(){this.keyPressed=!1},translateMouseWheelToScroll:function(e){var t=this.topOverlay.clone.wtTable.holder,n=this.bottomOverlay.clone?this.bottomOverlay.clone.wtTable.holder:null,r=this.leftOverlay.clone.wtTable.holder,o=this.topLeftCornerOverlay&&this.topLeftCornerOverlay.clone?this.topLeftCornerOverlay.clone.wtTable.holder:null,i=this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone?this.bottomLeftCornerOverlay.clone.wtTable.holder:null,s=-.2,a=e.wheelDeltaY||-1*e.deltaY,l=e.wheelDeltaX||-1*e.deltaX,u=null,d={type:"wheel"},c=e.target,h=null;for(1===e.deltaMode&&(a*=120,l*=120);c!=document&&null!=c;){if(c.className.indexOf("wtHolder")>-1){u=c;break}c=c.parentNode}return d.target=u,u===o||u===i?(this.syncScrollPositions(d,s*l,"x"),this.syncScrollPositions(d,s*a,"y")):(u===t||u===n?h=a:u===r&&(h=l),this.syncScrollPositions(d,s*h)),!1},syncScrollPositions:function(e){var t=void 0!==arguments[1]?arguments[1]:null,n=void 0!==arguments[2]?arguments[2]:null;if(!this.destroyed){if(0===arguments.length)return void this.syncScrollWithMaster();var r,o,i,s,a,l=this.leftOverlay.mainTableScrollableElement,u=this.topOverlay.mainTableScrollableElement,d=e.target,f=0,p=!1,m=!1,g=this.wot.getSetting("preventOverflow");this.topOverlay.needFullRender&&(r=this.topOverlay.clone.wtTable.holder),this.bottomOverlay.needFullRender&&(a=this.bottomOverlay.clone.wtTable.holder),this.leftOverlay.needFullRender&&(o=this.leftOverlay.clone.wtTable.holder),this.leftOverlay.needFullRender&&this.topOverlay.needFullRender&&(i=this.topLeftCornerOverlay.clone.wtTable.holder),this.leftOverlay.needFullRender&&this.bottomOverlay.needFullRender&&(s=this.bottomLeftCornerOverlay.clone.wtTable.holder),d===document&&(d=window),d===l||d===u?(f=c(g?this.scrollableElement:d),this.horizontalScrolling=!0,this.overlayScrollPositions.master.left=f,p=!0,this.pendingScrollCallbacks.master.left>0?this.pendingScrollCallbacks.master.left--:(r&&r.scrollLeft!==f&&(null==t&&this.pendingScrollCallbacks.top.left++,r.scrollLeft=f,m=l!==window),a&&a.scrollLeft!==f&&(null==t&&this.pendingScrollCallbacks.bottom.left++,a.scrollLeft=f,m=l!==window)),f=h(d),this.verticalScrolling=!0,this.overlayScrollPositions.master.top=f,p=!0,this.pendingScrollCallbacks.master.top>0?this.pendingScrollCallbacks.master.top--:o&&o.scrollTop!==f&&(null==t&&this.pendingScrollCallbacks.left.top++,o.scrollTop=f,m=u!==window)):d===a?(f=c(d),this.horizontalScrolling=!0,this.overlayScrollPositions.bottom.left=f,p=!0,this.pendingScrollCallbacks.bottom.left>0?this.pendingScrollCallbacks.bottom.left--:(null==t&&this.pendingScrollCallbacks.master.left++,l.scrollLeft=f,r&&r.scrollLeft!==f&&(null==t&&this.pendingScrollCallbacks.top.left++,r.scrollLeft=f,m=u!==window)),null!==t&&(p=!0,u.scrollTop+=t)):d===r?(f=c(d),this.horizontalScrolling=!0,this.overlayScrollPositions.top.left=f,p=!0,this.pendingScrollCallbacks.top.left>0?this.pendingScrollCallbacks.top.left--:(null==t&&this.pendingScrollCallbacks.master.left++,l.scrollLeft=f),null!==t&&(p=!0,u.scrollTop+=t),a&&a.scrollLeft!==f&&(null==t&&this.pendingScrollCallbacks.bottom.left++,a.scrollLeft=f,m=u!==window)):d===o?(f=h(d),this.overlayScrollPositions.left.top!==f&&(this.verticalScrolling=!0,this.overlayScrollPositions.left.top=f,p=!0,this.pendingScrollCallbacks.left.top>0?this.pendingScrollCallbacks.left.top--:(null==t&&this.pendingScrollCallbacks.master.top++,u.scrollTop=f)),null!==t&&(p=!0,u.scrollLeft+=t)):d!==i&&d!==s||null!==t&&(p=!0,"x"===n?u.scrollLeft+=t:"y"===n&&(u.scrollTop+=t)),!this.keyPressed&&p&&"scroll"===e.type&&(this.delegatedScrollCallback?this.delegatedScrollCallback=!1:this.refreshAll(),m&&(this.delegatedScrollCallback=!0))}},syncScrollWithMaster:function(){var e=this.topOverlay.mainTableScrollableElement,t=e,n=t.scrollLeft,r=t.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.leftOverlay.needFullRender&&(this.leftOverlay.clone.wtTable.holder.scrollTop=r)},updateMainScrollableElements:function(){this.deregisterListeners(),this.leftOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement(),this.scrollableElement=u(this.wot.wtTable.TABLE),this.registerListeners()},destroy:function(){this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.leftOverlay.destroy(),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.destroy(),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.destroy(),this.debug&&this.debug.destroy(),this.destroyed=!0},refresh:function(){var e=void 0!==arguments[0]&&arguments[0];if(this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted){var t=this.wot.wtTable.wtRootElement.parentNode||this.wot.wtTable.wtRootElement,n=t.clientWidth,r=t.clientHeight;n===this.spreaderLastSize.width&&r===this.spreaderLastSize.height||(this.spreaderLastSize.width=n,this.spreaderLastSize.height=r,this.adjustElementsSize())}this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.leftOverlay.refresh(e),this.topOverlay.refresh(e),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.refresh(e),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.refresh(e),this.debug&&this.debug.refresh(e)},adjustElementsSize:function(){var e=void 0!==arguments[0]&&arguments[0],t=this.wot.getSetting("totalColumns"),n=this.wot.getSetting("totalRows"),r=this.wot.wtViewport.getRowHeaderWidth(),o=this.wot.wtViewport.getColumnHeaderHeight(),i=this.wot.wtTable.hider.style;i.width=r+this.leftOverlay.sumCellSizes(0,t)+"px",i.height=o+this.topOverlay.sumCellSizes(0,n)+1+"px",this.topOverlay.adjustElementsSize(e),this.leftOverlay.adjustElementsSize(e),this.bottomOverlay.clone&&this.bottomOverlay.adjustElementsSize(e)},applyToDOM:function(){this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted||this.adjustElementsSize(),this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.leftOverlay.applyToDOM()},getParentOverlay:function(e){if(!e)return null;var t=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay],n=null;return f(t,function(t,r){t&&t.clone&&t.clone.wtTable.TABLE.contains(e)&&(n=t.clone)}),n}},{}),window.WalkontableOverlays=v},{eventManager:42,"helpers/array":43,"helpers/browser":44,"helpers/dom/element":47,"helpers/unicode":56}],18:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableScroll:{get:function(){return p}},__esModule:{value:!0}});var r,o,i=(r=e("helpers/dom/element"),r&&r.__esModule&&r||{default:r}),s=i.innerHeight,a=i.innerWidth,l=i.getScrollLeft,u=i.getScrollTop,d=i.offset,c=(o=e("helpers/number"),o&&o.__esModule&&o||{default:o}),h=c.rangeEach,f=c.rangeEachReverse,p=function(e){this.wot=e,this.instance=e};$traceurRuntime.createClass(p,{scrollViewport:function(e){if(this.wot.drawn){var t=this._getVariables(),n=t.topOverlay,r=t.leftOverlay,o=t.totalRows,i=t.totalColumns,s=t.fixedRowsTop,a=t.fixedRowsBottom,l=t.fixedColumnsLeft;if(e.row<0||e.row>Math.max(o-1,0))throw new Error("row "+e.row+" does not exist");if(e.col<0||e.col>Math.max(i-1,0))throw new Error("column "+e.col+" does not exist");e.row>=s&&e.row<this.getFirstVisibleRow()?n.scrollTo(e.row):e.row>this.getLastVisibleRow()&&e.row<o-a&&n.scrollTo(e.row,!0),e.col>=l&&e.col<this.getFirstVisibleColumn()?r.scrollTo(e.col):e.col>this.getLastVisibleColumn()&&r.scrollTo(e.col,!0)}},getFirstVisibleRow:function(){var e=this._getVariables(),t=e.topOverlay,n=e.wtTable,r=e.wtViewport,o=e.totalRows,i=e.fixedRowsTop,a=n.getFirstVisibleRow();if(t.mainTableScrollableElement===window){var l=d(n.wtRootElement),c=s(n.hider),h=s(window),p=u(window);if(l.top+c-h<=p){var m=r.getColumnHeaderHeight();m+=t.sumCellSizes(0,i),f(o,1,function(e){if(m+=t.sumCellSizes(e-1,e),l.top+c-m<=p)return a=e,!1})}}return a},getLastVisibleRow:function(){var e=this._getVariables(),t=e.topOverlay,n=e.wtTable,r=e.wtViewport,o=e.totalRows,i=n.getLastVisibleRow();if(t.mainTableScrollableElement===window){var a=d(n.wtRootElement),l=s(window),c=u(window);if(a.top>c){var f=r.getColumnHeaderHeight();h(1,o,function(e){if(f+=t.sumCellSizes(e-1,e),a.top+f-c>=l)return i=e-2,!1})}}return i},getFirstVisibleColumn:function(){var e=this._getVariables(),t=e.leftOverlay,n=e.wtTable,r=e.wtViewport,o=e.totalColumns,i=(e.fixedColumnsLeft,n.getFirstVisibleColumn());if(t.mainTableScrollableElement===window){var s=d(n.wtRootElement),u=a(n.hider),c=a(window),h=l(window);if(s.left+u-c<=h){var p=r.getRowHeaderWidth();f(o,1,function(e){if(p+=t.sumCellSizes(e-1,e),s.left+u-p<=h)return i=e,!1})}}return i},getLastVisibleColumn:function(){var e=this._getVariables(),t=e.leftOverlay,n=e.wtTable,r=e.wtViewport,o=e.totalColumns,i=n.getLastVisibleColumn();if(t.mainTableScrollableElement===window){var s=d(n.wtRootElement),u=a(window),c=l(window);if(s.left>c){var f=r.getRowHeaderWidth();h(1,o,function(e){if(f+=t.sumCellSizes(e-1,e),s.left+f-c>=u)return i=e-2,!1})}}return i},_getVariables:function(){var e=this.wot,t=e.wtOverlays.topOverlay,n=e.wtOverlays.leftOverlay,r=e.wtTable,o=e.wtViewport,i=e.getSetting("totalRows"),s=e.getSetting("totalColumns"),a=e.getSetting("fixedRowsTop"),l=e.getSetting("fixedRowsBottom"),u=e.getSetting("fixedColumnsLeft");return{topOverlay:t,leftOverlay:n,wtTable:r,wtViewport:o,totalRows:i,totalColumns:s,fixedRowsTop:a,fixedRowsBottom:l,fixedColumnsLeft:u}}},{}),window.WalkontableScroll=p},{"helpers/dom/element":47,"helpers/number":52}],19:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableSelection:{get:function(){return c}},__esModule:{value:!0}});var r,o,i,s,a=(r=e("helpers/dom/element"),
r&&r.__esModule&&r||{default:r}).addClass,l=(o=e("border"),o&&o.__esModule&&o||{default:o}).WalkontableBorder,u=(i=e("cell/coords"),i&&i.__esModule&&i||{default:i}).WalkontableCellCoords,d=(s=e("cell/range"),s&&s.__esModule&&s||{default:s}).WalkontableCellRange,c=function(e,t){this.settings=e,this.cellRange=t||null,this.instanceBorders={}};$traceurRuntime.createClass(c,{getBorder:function(e){return this.instanceBorders[e.guid]?this.instanceBorders[e.guid]:void(this.instanceBorders[e.guid]=new l(e,this.settings))},isEmpty:function(){return null===this.cellRange},add:function(e){this.isEmpty()?this.cellRange=new d(e,e,e):this.cellRange.expand(e)},replace:function(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1},clear:function(){this.cellRange=null},getCorners:function(){var e=this.cellRange.getTopLeftCorner(),t=this.cellRange.getBottomRightCorner();return[e.row,e.col,t.row,t.col]},addClassAtCoords:function(e,t,n,r){var o=e.wtTable.getCell(new u(t,n));"object"==typeof o&&a(o,r)},draw:function(e){if(this.isEmpty()){if(this.settings.border){var t=this.getBorder(e);t&&t.disappear()}}else{for(var n,r,o,i=e.wtTable.getRenderedRowsCount(),s=e.wtTable.getRenderedColumnsCount(),l=this.getCorners(),u=0;u<s;u++)if(r=e.wtTable.columnFilter.renderedToSource(u),r>=l[1]&&r<=l[3]&&(o=e.wtTable.getColumnHeader(r))){var d=[];this.settings.highlightHeaderClassName&&d.push(this.settings.highlightHeaderClassName),this.settings.highlightColumnClassName&&d.push(this.settings.highlightColumnClassName),a(o,d)}for(var c=0;c<i;c++){if(n=e.wtTable.rowFilter.renderedToSource(c),n>=l[0]&&n<=l[2]&&(o=e.wtTable.getRowHeader(n))){var h=[];this.settings.highlightHeaderClassName&&h.push(this.settings.highlightHeaderClassName),this.settings.highlightRowClassName&&h.push(this.settings.highlightRowClassName),a(o,h)}for(var f=0;f<s;f++)r=e.wtTable.columnFilter.renderedToSource(f),n>=l[0]&&n<=l[2]&&r>=l[1]&&r<=l[3]?this.settings.className&&this.addClassAtCoords(e,n,r,this.settings.className):n>=l[0]&&n<=l[2]?this.settings.highlightRowClassName&&this.addClassAtCoords(e,n,r,this.settings.highlightRowClassName):r>=l[1]&&r<=l[3]&&this.settings.highlightColumnClassName&&this.addClassAtCoords(e,n,r,this.settings.highlightColumnClassName)}if(e.getSetting("onBeforeDrawBorders",l,this.settings.className),this.settings.border){var p=this.getBorder(e);p&&p.appear(l)}}}},{}),window.WalkontableSelection=c},{border:3,"cell/coords":6,"cell/range":7,"helpers/dom/element":47}],20:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableSettings:{get:function(){return i}},__esModule:{value:!0}});var r,o=(r=e("helpers/dom/element"),r&&r.__esModule&&r||{default:r}).fastInnerText,i=function(e,t){var n=this;this.wot=e,this.instance=e,this.defaults={table:void 0,debug:!1,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},data:void 0,fixedColumnsLeft:0,fixedRowsTop:0,fixedRowsBottom:0,minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(e,t,r){var i=n.getSetting("data",e,t);o(r,void 0===i||null===i?"":i)},columnWidth:function(e){},rowHeight:function(e){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellMouseOver:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(e){return e},onModifyRowHeaderWidth:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null},this.settings={};for(var r in this.defaults)if(this.defaults.hasOwnProperty(r))if(void 0!==t[r])this.settings[r]=t[r];else{if(void 0===this.defaults[r])throw new Error('A required setting "'+r+'" was not provided');this.settings[r]=this.defaults[r]}};$traceurRuntime.createClass(i,{update:function(e,t){if(void 0===t)for(var n in e)e.hasOwnProperty(n)&&(this.settings[n]=e[n]);else this.settings[e]=t;return this.wot},getSetting:function(e,t,n,r,o){return"function"==typeof this.settings[e]?this.settings[e](t,n,r,o):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]},has:function(e){return!!this.settings[e]}},{}),window.WalkontableSettings=i},{"helpers/dom/element":47}],21:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableTable:{get:function(){return E}},__esModule:{value:!0}});var r,o,i,s,a,l,u,d=(r=e("helpers/dom/element"),r&&r.__esModule&&r||{default:r}),c=d.getStyle,h=d.getTrimmingContainer,f=d.hasClass,p=d.index,m=d.offset,g=d.removeClass,v=d.removeTextNodes,w=d.overlayContainsElement,b=d.closest,y=(o=e("helpers/function"),o&&o.__esModule&&o||{default:o}).isFunction,_=(i=e("cell/coords"),i&&i.__esModule&&i||{default:i}).WalkontableCellCoords,C=((s=e("cell/range"),s&&s.__esModule&&s||{default:s}).WalkontableCellRange,(a=e("filter/column"),a&&a.__esModule&&a||{default:a}).WalkontableColumnFilter),R=(l=e("filter/row"),l&&l.__esModule&&l||{default:l}).WalkontableRowFilter,M=(u=e("tableRenderer"),u&&u.__esModule&&u||{default:u}).WalkontableTableRenderer,E=function(e,t){var n=this;this.wot=e,this.instance=this.wot,this.TABLE=t,this.TBODY=null,this.THEAD=null,this.COLGROUP=null,this.tableOffset=0,this.holderOffset=0,v(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.colgroupChildrenLength=this.COLGROUP.childNodes.length,this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0,this.tbodyChildrenLength=this.TBODY.childNodes.length,this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var r=this.wot.wtSettings.settings.rowHeaderWidth;this.wot.wtSettings.settings.rowHeaderWidth=function(){return n._modifyRowHeaderWidth(r)}};$traceurRuntime.createClass(E,{fixTableDomTree:function(){this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=document.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=document.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=document.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.wot.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length&&this.THEAD.appendChild(document.createElement("TR"))},createSpreader:function(e){var t,n=e.parentNode;return n&&1===n.nodeType&&f(n,"wtHolder")||(t=document.createElement("div"),t.className="wtSpreader",n&&n.insertBefore(t,e),t.appendChild(e)),t.style.position="relative",t},createHider:function(e){var t,n=e.parentNode;return n&&1===n.nodeType&&f(n,"wtHolder")||(t=document.createElement("div"),t.className="wtHider",n&&n.insertBefore(t,e),t.appendChild(e)),t},createHolder:function(e){var t,n=e.parentNode;return n&&1===n.nodeType&&f(n,"wtHolder")||(t=document.createElement("div"),t.style.position="relative",t.className="wtHolder",n&&n.insertBefore(t,e),this.isWorkingOnClone()||(t.parentNode.className+="ht_master handsontable"),t.appendChild(e)),t},alignOverlaysWithTrimmingContainer:function(){var e=h(this.wtRootElement);if(!this.isWorkingOnClone())if(this.holder.parentNode.style.position="relative",e===window){var t=this.wot.getSetting("preventOverflow");t||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else this.holder.style.width=c(e,"width"),this.holder.style.height=c(e,"height"),this.holder.style.overflow=""},isWorkingOnClone:function(){return!!this.wot.cloneSource},draw:function(e){var t=this.wot,n=t.wtOverlays,r=t.wtViewport,o=this.instance.getSetting("totalRows"),i=this.wot.getSetting("rowHeaders").length,s=this.wot.getSetting("columnHeaders").length,a=!1;if(!this.isWorkingOnClone()&&(this.holderOffset=m(this.holder),e=r.createRenderCalculators(e),i&&!this.wot.getSetting("fixedColumnsLeft"))){var l=n.leftOverlay.getScrollPosition(),u=this.correctHeaderWidth;this.correctHeaderWidth=l>0,u!==this.correctHeaderWidth&&(e=!1)}if(this.isWorkingOnClone()||(a=n.prepareOverlays()),e)this.isWorkingOnClone()||r.createVisibleCalculators(),n&&n.refresh(!0);else{this.isWorkingOnClone()?this.tableOffset=this.wot.cloneSource.wtTable.tableOffset:this.tableOffset=m(this.TABLE);var d;d=WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_DEBUG)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_TOP)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_TOP_LEFT_CORNER)?0:WalkontableOverlay.isOverlayTypeOf(this.instance.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM)||WalkontableOverlay.isOverlayTypeOf(this.instance.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER)?Math.max(o-this.wot.getSetting("fixedRowsBottom"),0):r.rowsRenderCalculator.startRow;var c;c=WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_DEBUG)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_LEFT)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_TOP_LEFT_CORNER)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER)?0:r.columnsRenderCalculator.startColumn,this.rowFilter=new R(d,o,s),this.columnFilter=new C(c,this.wot.getSetting("totalColumns"),i),this.alignOverlaysWithTrimmingContainer(),this._doDraw()}return this.refreshSelections(e),this.isWorkingOnClone()||(n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&n.bottomOverlay.resetFixedPosition(),n.leftOverlay.resetFixedPosition(),n.topLeftCornerOverlay&&n.topLeftCornerOverlay.resetFixedPosition(),n.bottomLeftCornerOverlay&&n.bottomLeftCornerOverlay.clone&&n.bottomLeftCornerOverlay.resetFixedPosition()),a&&n.syncScrollWithMaster(),this.wot.drawn=!0,this},_doDraw:function(){var e=new M(this);e.render()},removeClassFromCells:function(e){for(var t=this.TABLE.querySelectorAll("."+e),n=0,r=t.length;n<r;n++)g(t[n],e)},refreshSelections:function(e){if(this.wot.selections){var t=this.wot.selections.length;if(e)for(var n=0;n<t;n++)this.wot.selections[n].settings.className&&this.removeClassFromCells(this.wot.selections[n].settings.className),this.wot.selections[n].settings.highlightHeaderClassName&&this.removeClassFromCells(this.wot.selections[n].settings.highlightHeaderClassName),this.wot.selections[n].settings.highlightRowClassName&&this.removeClassFromCells(this.wot.selections[n].settings.highlightRowClassName),this.wot.selections[n].settings.highlightColumnClassName&&this.removeClassFromCells(this.wot.selections[n].settings.highlightColumnClassName);for(var r=0;r<t;r++)this.wot.selections[r].draw(this.wot,e)}},getCell:function(e){if(this.isRowBeforeRenderedRows(e.row))return-1;if(this.isRowAfterRenderedRows(e.row))return-2;var t=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e.row)];return t?t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e.col)]:void 0},getColumnHeader:function(e){var t=void 0!==arguments[1]?arguments[1]:0,n=this.THEAD.childNodes[t];if(n)return n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]},getRowHeader:function(e){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return null;var t=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return t?t.childNodes[0]:void 0},getCoords:function(e){"TD"!==e.nodeName&&"TH"!==e.nodeName&&(e=b(e,["TD","TH"]));var t=e.parentNode,n=t.parentNode,r=p(t),o=e.cellIndex;return w(WalkontableOverlay.CLONE_TOP_LEFT_CORNER,e)||w(WalkontableOverlay.CLONE_TOP,e)?"THEAD"===n.nodeName&&(r-=n.childNodes.length):r=n===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(r):this.rowFilter.renderedToSource(r),o=w(WalkontableOverlay.CLONE_TOP_LEFT_CORNER,e)||w(WalkontableOverlay.CLONE_LEFT,e)?this.columnFilter.offsettedTH(o):this.columnFilter.visibleRowHeadedColumnToSourceColumn(o),new _(r,o)},getTrForRow:function(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]},getFirstRenderedRow:function(){return this.wot.wtViewport.rowsRenderCalculator.startRow},getFirstVisibleRow:function(){return this.wot.wtViewport.rowsVisibleCalculator.startRow},getFirstRenderedColumn:function(){return this.wot.wtViewport.columnsRenderCalculator.startColumn},getFirstVisibleColumn:function(){return this.wot.wtViewport.columnsVisibleCalculator.startColumn},getLastRenderedRow:function(){return this.wot.wtViewport.rowsRenderCalculator.endRow},getLastVisibleRow:function(){return this.wot.wtViewport.rowsVisibleCalculator.endRow},getLastRenderedColumn:function(){return this.wot.wtViewport.columnsRenderCalculator.endColumn},getLastVisibleColumn:function(){return this.wot.wtViewport.columnsVisibleCalculator.endColumn},isRowBeforeRenderedRows:function(e){return this.rowFilter&&this.rowFilter.sourceToRendered(e)<0&&e>=0},isRowAfterViewport:function(e){return this.rowFilter&&this.rowFilter.sourceToRendered(e)>this.getLastVisibleRow()},isRowAfterRenderedRows:function(e){return this.rowFilter&&this.rowFilter.sourceToRendered(e)>this.getLastRenderedRow()},isColumnBeforeViewport:function(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0},isColumnAfterViewport:function(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)>this.getLastVisibleColumn()},isLastRowFullyVisible:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()},isLastColumnFullyVisible:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()},getRenderedColumnsCount:function(){var e=this.wot.wtViewport.columnsRenderCalculator.count,t=this.wot.getSetting("totalColumns");if(this.wot.isOverlayName(WalkontableOverlay.CLONE_DEBUG))e=t;else if(this.wot.isOverlayName(WalkontableOverlay.CLONE_LEFT)||this.wot.isOverlayName(WalkontableOverlay.CLONE_TOP_LEFT_CORNER)||this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER))return Math.min(this.wot.getSetting("fixedColumnsLeft"),t);return e},getRenderedRowsCount:function(){var e=this.wot.wtViewport.rowsRenderCalculator.count,t=this.wot.getSetting("totalRows");return this.wot.isOverlayName(WalkontableOverlay.CLONE_DEBUG)?e=t:this.wot.isOverlayName(WalkontableOverlay.CLONE_TOP)||this.wot.isOverlayName(WalkontableOverlay.CLONE_TOP_LEFT_CORNER)?e=Math.min(this.wot.getSetting("fixedRowsTop"),t):(this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM)||this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER))&&(e=Math.min(this.wot.getSetting("fixedRowsBottom"),t)),e},getVisibleRowsCount:function(){return this.wot.wtViewport.rowsVisibleCalculator.count},allRowsInViewport:function(){return this.wot.getSetting("totalRows")==this.getVisibleRowsCount()},getRowHeight:function(e){var t=this.wot.wtSettings.settings.rowHeight(e),n=this.wot.wtViewport.oversizedRows[e];return void 0!==n&&(t=void 0===t?n:Math.max(t,n)),t},getColumnHeaderHeight:function(e){var t=this.wot.wtSettings.settings.defaultRowHeight,n=this.wot.wtViewport.oversizedColumnHeaders[e];return void 0!==n&&(t=t?Math.max(t,n):n),t},getVisibleColumnsCount:function(){return this.wot.wtViewport.columnsVisibleCalculator.count},allColumnsInViewport:function(){return this.wot.getSetting("totalColumns")==this.getVisibleColumnsCount()},getColumnWidth:function(e){var t=this.wot.wtSettings.settings.columnWidth;return"function"==typeof t?t=t(e):"object"==typeof t&&(t=t[e]),t||this.wot.wtSettings.settings.defaultColumnWidth},getStretchedColumnWidth:function(e){var t=this.getColumnWidth(e),n=null==t?this.instance.wtSettings.settings.defaultColumnWidth:t,r=this.wot.wtViewport.columnsRenderCalculator;if(r){var o=r.getStretchedColumnWidth(e,n);o&&(n=o)}return n},_modifyRowHeaderWidth:function(e){var t=y(e)?e():null;return Array.isArray(t)?(t=$traceurRuntime.spread(t),t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t},_correctRowHeaderWidth:function(e){return"number"!=typeof e&&(e=this.wot.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&e++,e}},{}),window.WalkontableTable=E},{"cell/coords":6,"cell/range":7,"filter/column":10,"filter/row":11,"helpers/dom/element":47,"helpers/function":50,tableRenderer:22}],22:[function(e,t,n){"use strict";function r(e,t){var n=document.createElement("TH");return t.insertBefore(n,e),t.removeChild(e),n}function o(e,t){var n=document.createElement("TD");return t.insertBefore(n,e),t.removeChild(e),n}Object.defineProperties(n,{WalkontableTableRenderer:{get:function(){return p}},__esModule:{value:!0}});var i,s=(i=e("helpers/dom/element"),i&&i.__esModule&&i||{default:i}),a=s.addClass,l=s.empty,u=s.getScrollbarWidth,d=s.hasClass,c=s.innerHeight,h=s.outerWidth,f=!1,p=function(e){this.wtTable=e,this.wot=e.instance,this.instance=e.instance,this.rowFilter=e.rowFilter,this.columnFilter=e.columnFilter,this.TABLE=e.TABLE,this.THEAD=e.THEAD,this.TBODY=e.TBODY,this.COLGROUP=e.COLGROUP,this.rowHeaders=[],this.rowHeaderCount=0,this.columnHeaders=[],this.columnHeaderCount=0,this.fixedRowsTop=0,this.fixedRowsBottom=0};$traceurRuntime.createClass(p,{render:function(){if(!this.wtTable.isWorkingOnClone()){var e={};if(this.wot.getSetting("beforeDraw",!0,e),e.skipRender===!0)return}this.rowHeaders=this.wot.getSetting("rowHeaders"),this.rowHeaderCount=this.rowHeaders.length,this.fixedRowsTop=this.wot.getSetting("fixedRowsTop"),this.fixedRowsBottom=this.wot.getSetting("fixedRowsBottom"),this.columnHeaders=this.wot.getSetting("columnHeaders"),this.columnHeaderCount=this.columnHeaders.length;var t,n=this.wtTable.getRenderedColumnsCount(),r=this.wtTable.getRenderedRowsCount(),o=this.wot.getSetting("totalColumns"),i=this.wot.getSetting("totalRows"),s=!1;if((WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM)||WalkontableOverlay.isOverlayTypeOf(this.wot.cloneOverlay,WalkontableOverlay.CLONE_BOTTOM_LEFT_CORNER))&&(this.columnHeaders=[],this.columnHeaderCount=0),o>=0&&(this.adjustAvailableNodes(),s=!0,this.renderColumnHeaders(),this.renderRows(i,r,n),this.wtTable.isWorkingOnClone()||(t=this.wot.wtViewport.getWorkspaceWidth(),this.wot.wtViewport.containerWidth=null),this.adjustColumnWidths(n),this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights()),s||this.adjustAvailableNodes(),this.removeRedundantRows(r),this.wtTable.isWorkingOnClone()&&!this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM)||this.markOversizedRows(),this.wtTable.isWorkingOnClone())this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM)&&this.wot.cloneSource.wtOverlays.adjustElementsSize();else{this.wot.wtViewport.createVisibleCalculators(),this.wot.wtOverlays.refresh(!1),this.wot.wtOverlays.applyToDOM();var a=h(this.wtTable.hider),l=h(this.wtTable.TABLE);if(0!==a&&l!==a&&this.adjustColumnWidths(n),t!==this.wot.wtViewport.getWorkspaceWidth()){this.wot.wtViewport.containerWidth=null;var u=this.wtTable.getFirstRenderedColumn(),d=this.wtTable.getLastRenderedColumn(),c=this.wot.getSetting("defaultColumnWidth"),f=this.wot.getSetting("rowHeaderWidth");if(f=this.instance.getSetting("onModifyRowHeaderWidth",f),null!=f)for(var p=0;p<this.rowHeaderCount;p++){var m=Array.isArray(f)?f[p]:f;m=null==m?c:m,this.COLGROUP.childNodes[p].style.width=m+"px"}for(var g=u;g<d;g++){var v=this.wtTable.getStretchedColumnWidth(g),w=this.columnFilter.sourceToRendered(g);this.COLGROUP.childNodes[w+this.rowHeaderCount].style.width=v+"px"}}this.wot.getSetting("onDraw",!0)}},removeRedundantRows:function(e){for(;this.wtTable.tbodyChildrenLength>e;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--},renderRows:function(e,t,n){for(var r,o,i=0,s=this.rowFilter.renderedToSource(i),a=this.wtTable.isWorkingOnClone();s<e&&s>=0&&(!f&&i>1e3&&(f=!0,console.warn('Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.')),void 0===t||i!==t);){if(o=this.getOrCreateTrForRow(i,o),this.renderRowHeaders(s,o),this.adjustColumns(o,n+this.rowHeaderCount),r=this.renderCells(s,o,n),a&&!this.wot.isOverlayName(WalkontableOverlay.CLONE_BOTTOM)||this.resetOversizedRow(s),o.firstChild){var l=this.wot.wtTable.getRowHeight(s);l?(l--,o.firstChild.style.height=l+"px"):o.firstChild.style.height=""}i++,s=this.rowFilter.renderedToSource(i)}},resetOversizedRow:function(e){this.wot.getSetting("externalRowCalculator")||this.wot.wtViewport.oversizedRows&&this.wot.wtViewport.oversizedRows[e]&&(this.wot.wtViewport.oversizedRows[e]=void 0)},markOversizedRows:function(){if(!this.wot.getSetting("externalRowCalculator")){var e,t,n,r,o,i=this.instance.wtTable.TBODY.childNodes.length,s=i*this.instance.wtSettings.settings.defaultRowHeight,a=c(this.instance.wtTable.TBODY)-1;this.instance.getSetting("totalRows");if(s!==a||this.instance.getSetting("fixedRowsBottom"))for(;i;)i--,n=this.instance.wtTable.rowFilter.renderedToSource(i),e=this.instance.wtTable.getRowHeight(n),r=this.instance.wtTable.getTrForRow(n),o=r.querySelector("th"),t=o?c(o):c(r)-1,(!e&&this.instance.wtSettings.settings.defaultRowHeight<t||e<t)&&(this.instance.wtViewport.oversizedRows[n]=++t)}},markOversizedColumnHeaders:function(){var e=this.wot.getOverlayName();if(this.columnHeaderCount&&!this.wot.wtViewport.hasOversizedColumnHeadersMarked[e]&&!this.wtTable.isWorkingOnClone()){for(var t=this.wtTable.getRenderedColumnsCount(),n=0;n<this.columnHeaderCount;n++)for(var r=-1*this.rowHeaderCount;r<t;r++)this.markIfOversizedColumnHeader(r);this.wot.wtViewport.hasOversizedColumnHeadersMarked[e]=!0}},adjustColumnHeaderHeights:function(){for(var e=this.wot.getSetting("columnHeaders"),t=this.wot.wtTable.THEAD.childNodes,n=this.wot.wtViewport.oversizedColumnHeaders,r=0,o=e.length;r<o;r++)if(n[r]){if(!t[r]||0===t[r].childNodes.length)return;t[r].childNodes[0].style.height=n[r]+"px"}},markIfOversizedColumnHeader:function(e){for(var t,n,r,o=this.wot.wtTable.columnFilter.renderedToSource(e),i=this.columnHeaderCount,s=this.wot.wtSettings.settings.defaultRowHeight,a=this.wot.getSetting("columnHeaderHeight")||[];i;)i--,t=this.wot.wtTable.getColumnHeaderHeight(i),n=this.wot.wtTable.getColumnHeader(o,i),n&&(r=c(n),(!t&&s<r||t<r)&&(this.wot.wtViewport.oversizedColumnHeaders[i]=r),Array.isArray(a)?null!=a[i]&&(this.wot.wtViewport.oversizedColumnHeaders[i]=a[i]):isNaN(a)||(this.wot.wtViewport.oversizedColumnHeaders[i]=a),this.wot.wtViewport.oversizedColumnHeaders[i]<(a[i]||a)&&(this.wot.wtViewport.oversizedColumnHeaders[i]=a[i]||a))},renderCells:function(e,t,n){for(var r,i,s=0;s<n;s++)i=this.columnFilter.renderedToSource(s),r=0===s?t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)]:r.nextSibling,"TH"==r.nodeName&&(r=o(r,t)),d(r,"hide")||(r.className=""),r.removeAttribute("style"),this.wot.wtSettings.settings.cellRenderer(e,i,r);return r},adjustColumnWidths:function(e){var t=0,n=this.wot.cloneSource?this.wot.cloneSource:this.wot,r=n.wtTable.holder,o=this.wot.getSetting("defaultColumnWidth"),i=this.wot.getSetting("rowHeaderWidth");if(r.offsetHeight<r.scrollHeight&&(t=u()),this.wot.wtViewport.columnsRenderCalculator.refreshStretching(this.wot.wtViewport.getViewportWidth()-t),i=this.instance.getSetting("onModifyRowHeaderWidth",i),null!=i)for(var s=0;s<this.rowHeaderCount;s++){var a=Array.isArray(i)?i[s]:i;a=null==a?o:a,this.COLGROUP.childNodes[s].style.width=a+"px"}for(var l=0;l<e;l++){var d=this.wtTable.getStretchedColumnWidth(this.columnFilter.renderedToSource(l));this.COLGROUP.childNodes[l+this.rowHeaderCount].style.width=d+"px"}},appendToTbody:function(e){this.TBODY.appendChild(e),this.wtTable.tbodyChildrenLength++},getOrCreateTrForRow:function(e,t){var n;return e>=this.wtTable.tbodyChildrenLength?(n=this.createRow(),this.appendToTbody(n)):n=0===e?this.TBODY.firstChild:t.nextSibling,n.className&&n.removeAttribute("class"),n},createRow:function(){for(var e=document.createElement("TR"),t=0;t<this.rowHeaderCount;t++)e.appendChild(document.createElement("TH"));return e},renderRowHeader:function(e,t,n){n.className="",n.removeAttribute("style"),this.rowHeaders[t](e,n,t)},renderRowHeaders:function(e,t){for(var n=t.firstChild,o=0;o<this.rowHeaderCount;o++)n?"TD"==n.nodeName&&(n=r(n,t)):(n=document.createElement("TH"),t.appendChild(n)),this.renderRowHeader(e,o,n),n=n.nextSibling},adjustAvailableNodes:function(){this.adjustColGroups(),this.adjustThead()},renderColumnHeaders:function(){if(this.columnHeaderCount)for(var e=this.wtTable.getRenderedColumnsCount(),t=0;t<this.columnHeaderCount;t++)for(var n=this.getTrForColumnHeaders(t),r=-1*this.rowHeaderCount;r<e;r++){var o=this.columnFilter.renderedToSource(r);this.renderColumnHeader(t,o,n.childNodes[r+this.rowHeaderCount])}},adjustColGroups:function(){for(var e=this.wtTable.getRenderedColumnsCount();this.wtTable.colgroupChildrenLength<e+this.rowHeaderCount;)this.COLGROUP.appendChild(document.createElement("COL")),this.wtTable.colgroupChildrenLength++;for(;this.wtTable.colgroupChildrenLength>e+this.rowHeaderCount;)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.wtTable.colgroupChildrenLength--;this.rowHeaderCount&&a(this.COLGROUP.childNodes[0],"rowHeader")},adjustThead:function(){var e=this.wtTable.getRenderedColumnsCount(),t=this.THEAD.firstChild;if(this.columnHeaders.length){for(var n=0,r=this.columnHeaders.length;n<r;n++){for(t=this.THEAD.childNodes[n],t||(t=document.createElement("TR"),this.THEAD.appendChild(t)),this.theadChildrenLength=t.childNodes.length;this.theadChildrenLength<e+this.rowHeaderCount;)t.appendChild(document.createElement("TH")),this.theadChildrenLength++;for(;this.theadChildrenLength>e+this.rowHeaderCount;)t.removeChild(t.lastChild),this.theadChildrenLength--}var o=this.THEAD.childNodes.length;if(o>this.columnHeaders.length)for(var i=this.columnHeaders.length;i<o;i++)this.THEAD.removeChild(this.THEAD.lastChild)}else t&&l(t)},getTrForColumnHeaders:function(e){return this.THEAD.childNodes[e]},renderColumnHeader:function(e,t,n){return n.className="",n.removeAttribute("style"),this.columnHeaders[e](t,n,e)},adjustColumns:function(e,t){for(var n=e.childNodes.length;n<t;){var r=document.createElement("TD");e.appendChild(r),n++}for(;n>t;)e.removeChild(e.lastChild),n--},removeRedundantColumns:function(e){for(;this.wtTable.tbodyChildrenLength>e;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--}},{}),window.WalkontableTableRenderer=p},{"helpers/dom/element":47}],23:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableViewport:{get:function(){return w}},__esModule:{value:!0}});var r,o,i,s,a,l=(r=e("browser"),r&&r.__esModule&&r||{default:r}).default,u=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{default:o}),d=u.getScrollbarWidth,c=(u.getScrollTop,u.getStyle),h=u.offset,f=u.outerHeight,p=u.outerWidth,m=(i=e("eventManager"),i&&i.__esModule&&i||{default:i}).EventManager,g=(s=e("calculator/viewportColumns"),s&&s.__esModule&&s||{default:s}).WalkontableViewportColumnsCalculator,v=(a=e("calculator/viewportRows"),a&&a.__esModule&&a||{default:a}).WalkontableViewportRowsCalculator,w=function(e){var t=this;this.wot=e,this.instance=this.wot,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=new m(this.wot),this.eventManager.addEventListener(window,"resize",function(){t.clientHeight=t.getWorkspaceHeight()})};$traceurRuntime.createClass(w,{getWorkspaceHeight:function(){var e,t=this.instance.wtOverlays.topOverlay.trimmingContainer,n=0;return t===window?n=document.documentElement.clientHeight:(e=f(t),n=e>0&&t.clientHeight>0?t.clientHeight:1/0),n},getWorkspaceWidth:function(){var e,t,n=this.wot.getSetting("totalColumns"),r=this.instance.wtOverlays.leftOverlay.trimmingContainer,o=this.wot.getSetting("stretchH"),i=document.documentElement.offsetWidth,s=this.wot.getSetting("preventOverflow");return s?p(this.instance.wtTable.wtRootElement):(e=l.freezeOverlays?Math.min(i-this.getWorkspaceOffset().left,i):Math.min(this.getContainerFillWidth(),i-this.getWorkspaceOffset().left,i),r===window&&n>0&&this.sumColumnWidths(0,n-1)>e?document.documentElement.clientWidth:r!==window&&(t=c(this.instance.wtOverlays.leftOverlay.trimmingContainer,"overflow"),"scroll"==t||"hidden"==t||"auto"==t)?Math.max(e,r.clientWidth):"none"!==o&&o?e:Math.max(e,p(this.instance.wtTable.TABLE)))},hasVerticalScroll:function(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()},hasHorizontalScroll:function(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()},sumColumnWidths:function(e,t){for(var n=0;e<t;)n+=this.wot.wtTable.getColumnWidth(e),e++;return n},getContainerFillWidth:function(){if(this.containerWidth)return this.containerWidth;var e,t,n=this.instance.wtTable.holder;return t=document.createElement("div"),t.style.width="100%",t.style.height="1px",n.appendChild(t),e=t.offsetWidth,this.containerWidth=e,n.removeChild(t),e},getWorkspaceOffset:function(){return h(this.wot.wtTable.TABLE)},getWorkspaceActualHeight:function(){return f(this.wot.wtTable.TABLE)},getWorkspaceActualWidth:function(){return p(this.wot.wtTable.TABLE)||p(this.wot.wtTable.TBODY)||p(this.wot.wtTable.THEAD)},getColumnHeaderHeight:function(){return isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=f(this.wot.wtTable.THEAD)),this.columnHeaderHeight},getViewportHeight:function(){var e,t=this.getWorkspaceHeight();return t===1/0?t:(e=this.getColumnHeaderHeight(),e>0&&(t-=e),t)},getRowHeaderWidth:function(){var e=this.instance.getSetting("rowHeaderWidth"),t=this.instance.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(var n=0,r=t.length;n<r;n++)this.rowHeaderWidth+=e[n]||e}if(this.wot.cloneSource)return this.wot.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth))if(t.length){var o=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var i=0,s=t.length;i<s;i++)o?(this.rowHeaderWidth+=p(o),o=o.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.instance.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth},getViewportWidth:function(){var e,t=this.getWorkspaceWidth();return t===1/0?t:(e=this.getRowHeaderWidth(),e>0?t-e:t)},createRowsCalculator:function(){var e,t,n,r,o,i,s,a=void 0!==arguments[0]&&arguments[0],l=this;return this.rowHeaderWidth=NaN,e=this.wot.wtSettings.settings.renderAllRows?1/0:this.getViewportHeight(),t=this.wot.wtOverlays.topOverlay.getScrollPosition()-this.wot.wtOverlays.topOverlay.getTableParentOffset(),t<0&&(t=0),n=this.wot.getSetting("fixedRowsTop"),o=this.wot.getSetting("fixedRowsBottom"),s=this.wot.getSetting("totalRows"),n&&(i=this.wot.wtOverlays.topOverlay.sumCellSizes(0,n),t+=i,e-=i),o&&this.wot.wtOverlays.bottomOverlay.clone&&(i=this.wot.wtOverlays.bottomOverlay.sumCellSizes(s-o,s),e-=i),r=this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight?0:d(),new v(e,t,this.wot.getSetting("totalRows"),function(e){return l.wot.wtTable.getRowHeight(e)},a?null:this.wot.wtSettings.settings.viewportRowCalculatorOverride,a,r)},createColumnsCalculator:function(){var e,t,n=void 0!==arguments[0]&&arguments[0],r=this,o=this.getViewportWidth();if(this.columnHeaderHeight=NaN,e=this.wot.wtOverlays.leftOverlay.getScrollPosition()-this.wot.wtOverlays.leftOverlay.getTableParentOffset(),
e<0&&(e=0),t=this.wot.getSetting("fixedColumnsLeft")){var i=this.wot.wtOverlays.leftOverlay.sumCellSizes(0,t);e+=i,o-=i}return this.wot.wtTable.holder.clientWidth!==this.wot.wtTable.holder.offsetWidth&&(o-=d()),new g(o,e,this.wot.getSetting("totalColumns"),function(e){return r.wot.wtTable.getColumnWidth(e)},n?null:this.wot.wtSettings.settings.viewportColumnCalculatorOverride,n,this.wot.getSetting("stretchH"),function(e,t){return r.wot.getSetting("onBeforeStretchingColumnWidth",e,t)})},createRenderCalculators:function(){var e=void 0!==arguments[0]&&arguments[0];if(e){var t=this.createRowsCalculator(!0),n=this.createColumnsCalculator(!0);this.areAllProposedVisibleRowsAlreadyRendered(t)&&this.areAllProposedVisibleColumnsAlreadyRendered(n)||(e=!1)}return e||(this.rowsRenderCalculator=this.createRowsCalculator(),this.columnsRenderCalculator=this.createColumnsCalculator()),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,e},createVisibleCalculators:function(){this.rowsVisibleCalculator=this.createRowsCalculator(!0),this.columnsVisibleCalculator=this.createColumnsCalculator(!0)},areAllProposedVisibleRowsAlreadyRendered:function(e){return!!this.rowsVisibleCalculator&&(!(e.startRow<this.rowsRenderCalculator.startRow||e.startRow===this.rowsRenderCalculator.startRow&&e.startRow>0)&&!(e.endRow>this.rowsRenderCalculator.endRow||e.endRow===this.rowsRenderCalculator.endRow&&e.endRow<this.wot.getSetting("totalRows")-1))},areAllProposedVisibleColumnsAlreadyRendered:function(e){return!!this.columnsVisibleCalculator&&(!(e.startColumn<this.columnsRenderCalculator.startColumn||e.startColumn===this.columnsRenderCalculator.startColumn&&e.startColumn>0)&&!(e.endColumn>this.columnsRenderCalculator.endColumn||e.endColumn===this.columnsRenderCalculator.endColumn&&e.endColumn<this.wot.getSetting("totalColumns")-1))}},{}),window.WalkontableViewport=w},{browser:24,"calculator/viewportColumns":4,"calculator/viewportRows":5,eventManager:42,"helpers/dom/element":47}],24:[function(e,t,n){"use strict";function r(e,t){var n=new r.Core(e,t||{});return n.init(),n}var o,i,s,a,l,u,d,c,h,f,p,m,g,v,w,b,y,_,C,R,M,E,S,O;t.exports=r,r.utils={},o=e("shims/runtime"),o&&o.__esModule&&o||{default:o},i=e("es6collections"),i&&i.__esModule&&i||{default:i};var T=(s=e("pluginHooks"),s&&s.__esModule&&s||{default:s}).Hooks,A=(a=e("numbro"),a&&a.__esModule&&a||{default:a}).default,N=(l=e("moment"),l&&l.__esModule&&l||{default:l}).default;"object"==typeof window&&("undefined"==typeof window.numbro&&(window.numbro=A),"undefined"==typeof window.moment&&(window.moment=N)),r.hooks||(r.hooks=new T),r.utils.Hooks=T,u=e("core"),u&&u.__esModule&&u||{default:u},d=e("renderers/_cellDecorator"),d&&d.__esModule&&d||{default:d},c=e("cellTypes"),c&&c.__esModule&&c||{default:c},h=e("plugins/jqueryHandsontable"),h&&h.__esModule&&h||{default:h};var x=(f=e("helpers/array"),f&&f.__esModule&&f||{default:f}),k=(p=e("helpers/browser"),p&&p.__esModule&&p||{default:p}),I=(m=e("helpers/data"),m&&m.__esModule&&m||{default:m}),D=(g=e("helpers/date"),g&&g.__esModule&&g||{default:g}),P=(v=e("helpers/feature"),v&&v.__esModule&&v||{default:v}),H=(w=e("helpers/function"),w&&w.__esModule&&w||{default:w}),L=(b=e("helpers/mixed"),b&&b.__esModule&&b||{default:b}),V=(y=e("helpers/number"),y&&y.__esModule&&y||{default:y}),j=(_=e("helpers/object"),_&&_.__esModule&&_||{default:_}),F=(C=e("helpers/setting"),C&&C.__esModule&&C||{default:C}),$=(R=e("helpers/string"),R&&R.__esModule&&R||{default:R}),B=(M=e("helpers/unicode"),M&&M.__esModule&&M||{default:M}),W=(E=e("helpers/dom/element"),E&&E.__esModule&&E||{default:E}),U=(S=e("helpers/dom/event"),S&&S.__esModule&&S||{default:S}),Y=[x,k,I,D,P,H,L,V,j,F,$,B],G=[W,U];r.buildDate="Wed Dec 21 2016 14:03:43 GMT+0100 (CET)",r.packageName="handsontable-pro",r.version="1.8.2";var z="0.29.2";/^@@/.test(z)||(r.baseVersion=z),r.plugins={};var X=(O=e("plugins"),O&&O.__esModule&&O||{default:O}).registerPlugin;r.plugins.registerPlugin=X,r.helper={},r.dom={},r.Dom=r.dom,x.arrayEach(Y,function(e){x.arrayEach(Object.getOwnPropertyNames(e),function(t){"_"!==t.charAt(0)&&(r.helper[t]=e[t])})}),x.arrayEach(G,function(e){x.arrayEach(Object.getOwnPropertyNames(e),function(t){"_"!==t.charAt(0)&&(r.dom[t]=e[t])})})},{cellTypes:25,core:26,es6collections:"es6collections","helpers/array":43,"helpers/browser":44,"helpers/data":45,"helpers/date":46,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/feature":49,"helpers/function":50,"helpers/mixed":51,"helpers/number":52,"helpers/object":53,"helpers/setting":54,"helpers/string":55,"helpers/unicode":56,moment:"moment",numbro:"numbro",pluginHooks:61,plugins:62,"plugins/jqueryHandsontable":2,"renderers/_cellDecorator":118,"shims/runtime":125}],25:[function(e,t,n){"use strict";var r,o,i,s,a,l,u,d,c,h,f,p,m,g,v,w,b,y,_,C,R,M,E,S,O=(r=e("helpers/browser"),r&&r.__esModule&&r||{default:r}).isMobileBrowser,T=(o=e("editors"),o&&o.__esModule&&o||{default:o}).getEditorConstructor,A=(i=e("renderers"),i&&i.__esModule&&i||{default:i}).getRenderer,N=((s=e("editors/autocompleteEditor"),s&&s.__esModule&&s||{default:s}).AutocompleteEditor,(a=e("editors/checkboxEditor"),a&&a.__esModule&&a||{default:a}).CheckboxEditor,(l=e("editors/dateEditor"),l&&l.__esModule&&l||{default:l}).DateEditor,(u=e("editors/dropdownEditor"),u&&u.__esModule&&u||{default:u}).DropdownEditor,(d=e("editors/handsontableEditor"),d&&d.__esModule&&d||{default:d}).HandsontableEditor,(c=e("editors/mobileTextEditor"),c&&c.__esModule&&c||{default:c}).MobileTextEditor,(h=e("editors/numericEditor"),h&&h.__esModule&&h||{default:h}).NumericEditor,(f=e("editors/passwordEditor"),f&&f.__esModule&&f||{default:f}).PasswordEditor,(p=e("editors/selectEditor"),p&&p.__esModule&&p||{default:p}).SelectEditor,(m=e("editors/textEditor"),m&&m.__esModule&&m||{default:m}).TextEditor,(g=e("renderers/autocompleteRenderer"),g&&g.__esModule&&g||{default:g}).AutocompleteRenderer,(v=e("renderers/checkboxRenderer"),v&&v.__esModule&&v||{default:v}).CheckboxRenderer,(w=e("renderers/htmlRenderer"),w&&w.__esModule&&w||{default:w}).HtmlRenderer,(b=e("renderers/numericRenderer"),b&&b.__esModule&&b||{default:b}).NumericRenderer,(y=e("renderers/passwordRenderer"),y&&y.__esModule&&y||{default:y}).PasswordRenderer,(_=e("renderers/textRenderer"),_&&_.__esModule&&_||{default:_}).TextRenderer,(C=e("validators/autocompleteValidator"),C&&C.__esModule&&C||{default:C}).AutocompleteValidator,(R=e("validators/dateValidator"),R&&R.__esModule&&R||{default:R}).DateValidator,(M=e("validators/timeValidator"),M&&M.__esModule&&M||{default:M}).TimeValidator,(E=e("validators/numericValidator"),E&&E.__esModule&&E||{default:E}).NumericValidator,(S=e("browser"),S&&S.__esModule&&S||{default:S}).default);N.AutocompleteCell={editor:T("autocomplete"),renderer:A("autocomplete"),validator:N.AutocompleteValidator},N.CheckboxCell={editor:T("checkbox"),renderer:A("checkbox")},N.TextCell={editor:T(O()?"mobile":"text"),renderer:A("text")},N.NumericCell={editor:T("numeric"),renderer:A("numeric"),validator:N.NumericValidator,dataType:"number"},N.DateCell={editor:T("date"),validator:N.DateValidator,renderer:A("autocomplete")},N.TimeCell={editor:T("text"),validator:N.TimeValidator,renderer:A("text")},N.HandsontableCell={editor:T("handsontable"),renderer:A("autocomplete")},N.PasswordCell={editor:T("password"),renderer:A("password"),copyable:!1},N.DropdownCell={editor:T("dropdown"),renderer:A("autocomplete"),validator:N.AutocompleteValidator},N.cellTypes={text:N.TextCell,date:N.DateCell,time:N.TimeCell,numeric:N.NumericCell,checkbox:N.CheckboxCell,autocomplete:N.AutocompleteCell,handsontable:N.HandsontableCell,password:N.PasswordCell,dropdown:N.DropdownCell},N.cellLookup={validator:{numeric:N.NumericValidator,autocomplete:N.AutocompleteValidator}}},{browser:24,editors:30,"editors/autocompleteEditor":32,"editors/checkboxEditor":33,"editors/dateEditor":34,"editors/dropdownEditor":35,"editors/handsontableEditor":36,"editors/mobileTextEditor":37,"editors/numericEditor":38,"editors/passwordEditor":39,"editors/selectEditor":40,"editors/textEditor":41,"helpers/browser":44,renderers:117,"renderers/autocompleteRenderer":119,"renderers/checkboxRenderer":120,"renderers/htmlRenderer":121,"renderers/numericRenderer":122,"renderers/passwordRenderer":123,"renderers/textRenderer":124,"validators/autocompleteValidator":132,"validators/dateValidator":133,"validators/numericValidator":134,"validators/timeValidator":135}],26:[function(e,t,n){"use strict";var r,o,i,s,a,l,u,d,c,h,f,p,m,g,v,w,b,y,_,C,R,M,E,S=(r=e("browser"),r&&r.__esModule&&r||{default:r}).default,O=(o=e("numbro"),o&&o.__esModule&&o||{default:o}).default,T=(i=e("helpers/dom/element"),i&&i.__esModule&&i||{default:i}),A=T.addClass,N=T.empty,x=T.isChildOfWebComponentTable,k=T.removeClass,I=(s=e("helpers/setting"),s&&s.__esModule&&s||{default:s}).columnFactory,D=(a=e("helpers/function"),a&&a.__esModule&&a||{default:a}).isFunction,P=(l=e("helpers/mixed"),l&&l.__esModule&&l||{default:l}),H=P.isDefined,L=P.isUndefined,V=(u=e("helpers/browser"),u&&u.__esModule&&u||{default:u}).isMobileBrowser,j=(d=e("dataMap"),d&&d.__esModule&&d||{default:d}).DataMap,F=(c=e("editorManager"),c&&c.__esModule&&c||{default:c}).EditorManager,$=(h=e("eventManager"),h&&h.__esModule&&h||{default:h}).eventManager,B=(f=e("helpers/object"),f&&f.__esModule&&f||{default:f}),W=B.deepClone,U=B.duckSchema,Y=B.extend,G=B.isObject,z=B.isObjectEquals,X=B.deepObjectSize,q=(p=e("helpers/array"),p&&p.__esModule&&p||{default:p}),K=q.arrayFlatten,Q=q.arrayMap,Z=(m=e("plugins"),m&&m.__esModule&&m||{default:m}).getPlugin,J=(g=e("renderers"),g&&g.__esModule&&g||{default:g}).getRenderer,ee=(v=e("helpers/string"),v&&v.__esModule&&v||{default:v}).randomString,te=(w=e("helpers/number"),w&&w.__esModule&&w||{default:w}).rangeEach,ne=(b=e("tableView"),b&&b.__esModule&&b||{default:b}).TableView,re=(y=e("dataSource"),y&&y.__esModule&&y||{default:y}).DataSource,oe=(_=e("helpers/data"),_&&_.__esModule&&_||{default:_}),ie=oe.translateRowsToColumns,se=oe.cellMethodLookupFactory,ae=oe.spreadsheetColumnLabel,le=(C=e("utils/recordTranslator"),C&&C.__esModule&&C||{default:C}).getTranslator,ue=(R=e("3rdparty/walkontable/src/cell/coords"),R&&R.__esModule&&R||{default:R}).WalkontableCellCoords,de=(M=e("3rdparty/walkontable/src/cell/range"),M&&M.__esModule&&M||{default:M}).WalkontableCellRange,ce=(E=e("3rdparty/walkontable/src/calculator/viewportColumns"),E&&E.__esModule&&E||{default:E}).WalkontableViewportColumnsCalculator;S.activeGuid=null,S.Core=function(e,t){function n(){var e=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue++,e=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(e){},checkIfQueueIsEmpty:function(){0==this.validatorsInQueue&&0==e&&(e=!0,this.onQueueEmpty(this.valid))}}}function r(e,t,r){function o(){var n;e.length&&(n=S.hooks.run(p,"beforeChange",e,t),D(n)?console.warn("Your beforeChange callback returns a function. It's not supported since Handsontable 0.12.1 (and the returned function will not be executed)."):n===!1&&e.splice(0,e.length)),r()}var i=new n;i.onQueueEmpty=o;for(var s=e.length-1;s>=0;s--)if(null===e[s])e.splice(s,1);else{var a=e[s][0],l=u.propToCol(e[s][1]),d=p.getCellMeta(a,l);if("numeric"===d.type&&"string"==typeof e[s][3]&&e[s][3].length>0&&(/^-?[\d\s]*(\.|\,)?\d*$/.test(e[s][3])||d.format)){var c=e[s][3].length;L(d.language)?O.culture("en-US"):e[s][3].indexOf(".")===c-3&&e[s][3].indexOf(",")===-1?O.culture("en-US"):O.culture(d.language);O.cultureData(O.culture()).delimiters;O.validate(e[s][3])&&!isNaN(e[s][3])?e[s][3]=parseFloat(e[s][3]):e[s][3]=O().unformat(e[s][3])}p.getCellValidator(d)&&(i.addValidatorToQueue(),p.validateCell(e[s][3],d,function(t,n){return function(r){if("boolean"!=typeof r)throw new Error("Validation error: result is not boolean");r===!1&&n.allowInvalid===!1&&(e.splice(t,1),n.valid=!0,--t),i.removeValidatorFormQueue()}}(s,d),t))}i.checkIfQueueIsEmpty()}function o(e,t){var n=e.length-1;if(!(n<0)){for(;0<=n;n--){var r=!1;if(null!==e[n]){if(null!=e[n][2]||null!=e[n][3]){if(l.settings.allowInsertRow)for(;e[n][0]>p.countRows()-1;){var o=u.createRow();if(0===o){r=!0;break}}if(!r){if("array"===p.dataType&&(!l.settings.columns||0===l.settings.columns.length)&&l.settings.allowInsertColumn)for(;u.propToCol(e[n][1])>p.countCols()-1;)u.createCol();u.set(e[n][0],e[n][1],e[n][3])}}}else e.splice(n,1)}p.forceFullRender=!0,c.adjustRowsAndCols(),S.hooks.run(p,"beforeChangeRender",e,t),h.refreshBorders(null,!0),p.view.wt.wtOverlays.adjustElementsSize(),S.hooks.run(p,"afterChange",e,t||"edit")}}function i(e,t,n){return"object"==typeof e?e:[[e,t,n]]}function s(e){if(e.hasOwnProperty("type")){var t,n={};if("object"==typeof e.type)t=e.type;else if("string"==typeof e.type&&(t=S.cellTypes[e.type],void 0===t))throw new Error('You declared cell type "'+e.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');for(var r in t)t.hasOwnProperty(r)&&!e.hasOwnProperty(r)&&(n[r]=t[r]);return n}}function a(){throw new Error("This method cannot be called because this Handsontable instance has been destroyed")}var l,u,d,c,h,f,p=this,m=function(){},g=$(p),v=le(p);Y(m.prototype,he.prototype),Y(m.prototype,t),Y(m.prototype,s(t)),this.rootElement=e,this.isHotTableEnv=x(this.rootElement),S.eventManager.isHotTableEnv=this.isHotTableEnv,this.container=document.createElement("DIV"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),this.guid="ht_"+ee(),d=new re(p),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid),l={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new m,selRange:null,isPopulated:null,scrollable:null,firstRun:!0},c={alter:function(e,t,n,r,o){function i(e,t,n,r){var o=function(){var e;return"array"===r?e=[]:"object"===r&&(e={}),e},i=Q(new Array(n),function(){return o()});i.unshift(t,0),e.splice.apply(e,i)}var s;switch(n=n||1,e){case"insert_row":if(p.getSettings().maxRows===p.countSourceRows())return;s=u.createRow(t,n,r),i(l.cellSettings,t,n,"array"),s&&(h.isSelected()&&l.selRange.from.row>=t?(l.selRange.from.row=l.selRange.from.row+s,h.transformEnd(s,0)):h.refreshBorders());break;case"insert_col":s=u.createCol(t,n,r);for(var a=0,d=p.countSourceRows();a<d;a++)l.cellSettings[a]&&i(l.cellSettings[a],t,n);if(s){if(Array.isArray(p.getSettings().colHeaders)){var f=[t,0];f.length+=s,Array.prototype.splice.apply(p.getSettings().colHeaders,f)}h.isSelected()&&l.selRange.from.col>=t?(l.selRange.from.col=l.selRange.from.col+s,h.transformEnd(0,s)):h.refreshBorders()}break;case"remove_row":u.removeRow(t,n,r),l.cellSettings.splice(t,n);var m=p.countRows(),g=p.getSettings().fixedRowsTop;g>=t+1&&(p.getSettings().fixedRowsTop-=Math.min(n,g-t));var w=p.getSettings().fixedRowsBottom;w&&t>=m-w&&(p.getSettings().fixedRowsBottom-=Math.min(n,w)),c.adjustRowsAndCols(),h.refreshBorders();break;case"remove_col":var b=v.toPhysicalColumn(t);u.removeCol(t,n,r);for(var y=0,_=p.countSourceRows();y<_;y++)l.cellSettings[y]&&l.cellSettings[y].splice(b,n);var C=p.getSettings().fixedColumnsLeft;C>=t+1&&(p.getSettings().fixedColumnsLeft-=Math.min(n,C-t)),Array.isArray(p.getSettings().colHeaders)&&("undefined"==typeof b&&(b=-1),p.getSettings().colHeaders.splice(b,n)),c.adjustRowsAndCols(),h.refreshBorders();break;default:throw new Error('There is no such action "'+e+'"')}o||c.adjustRowsAndCols()},adjustRowsAndCols:function(){if(l.settings.minRows){var e=p.countRows();if(e<l.settings.minRows)for(var t=0,n=l.settings.minRows;t<n-e;t++)u.createRow(p.countRows(),1,"auto")}if(l.settings.minSpareRows){var r=p.countEmptyRows(!0);if(r<l.settings.minSpareRows)for(;r<l.settings.minSpareRows&&p.countSourceRows()<l.settings.maxRows;r++)u.createRow(p.countRows(),1,"auto")}var o;if((l.settings.minCols||l.settings.minSpareCols)&&(o=p.countEmptyCols(!0)),l.settings.minCols&&!l.settings.columns&&p.countCols()<l.settings.minCols)for(;p.countCols()<l.settings.minCols;o++)u.createCol(p.countCols(),1,"auto");if(l.settings.minSpareCols&&!l.settings.columns&&"array"===p.dataType&&o<l.settings.minSpareCols)for(;o<l.settings.minSpareCols&&p.countCols()<l.settings.maxCols;o++)u.createCol(p.countCols(),1,"auto");var i=p.countRows(),s=p.countCols();if(0!==i&&0!==s||h.deselect(),h.isSelected()){var a=!1,d=l.selRange.from.row,c=l.selRange.from.col,f=l.selRange.to.row,m=l.selRange.to.col;d>i-1?(d=i-1,a=!0,f>d&&(f=d)):f>i-1&&(f=i-1,a=!0,d>f&&(d=f)),c>s-1?(c=s-1,a=!0,m>c&&(m=c)):m>s-1&&(m=s-1,a=!0,c>m&&(c=m)),a&&p.selectCell(d,c,f,m)}p.view&&p.view.wt.wtOverlays.adjustElementsSize()},populateFromArray:function(e,t,n,r,o,i,s){var a,u,d,c,h=[],f={};if(u=t.length,0===u)return!1;var m,g,v,w;({row:null===n?null:n.row,col:null===n?null:n.col});switch(o){case"shift_down":for(m=n?n.col-e.col+1:0,g=n?n.row-e.row+1:0,t=ie(t),d=0,c=t.length,v=Math.max(c,m);d<v;d++)if(d<c){for(a=0,u=t[d].length;a<g-u;a++)t[d].push(t[d][a%u]);t[d].unshift(e.col+d,e.row,0),p.spliceCol.apply(p,t[d])}else t[d%c][0]=e.col+d,p.spliceCol.apply(p,t[d%c]);break;case"shift_right":for(m=n?n.col-e.col+1:0,g=n?n.row-e.row+1:0,a=0,u=t.length,w=Math.max(u,g);a<w;a++)if(a<u){for(d=0,c=t[a].length;d<m-c;d++)t[a].push(t[a][d%c]);t[a].unshift(e.row+a,e.col,0),p.spliceRow.apply(p,t[a])}else t[a%u][0]=e.row+a,p.spliceRow.apply(p,t[a%u]);break;case"overwrite":default:f.row=e.row,f.col=e.col;var b,y={row:n&&e?n.row-e.row+1:1,col:n&&e?n.col-e.col+1:1},_=0,C=0,R=!0,M=function(e){var n=void 0!==arguments[1]?arguments[1]:null,r=t[e%t.length];return null!==n?r[n%r.length]:r},E=t.length,S=n?n.row-e.row+1:0;for(u=n?S:Math.max(E,S),a=0;a<u&&!(n&&f.row>n.row&&S>E||!l.settings.allowInsertRow&&f.row>p.countRows()-1||f.row>=l.settings.maxRows);a++){var O=a-_,T=M(O).length,A=n?n.col-e.col+1:0;if(c=n?A:Math.max(T,A),f.col=e.col,b=p.getCellMeta(f.row,f.col),"paste"!==r&&"autofill"!==r||!b.skipRowOnPaste){for(C=0,d=0;d<c&&!(n&&f.col>n.col&&A>T||!l.settings.allowInsertColumn&&f.col>p.countCols()-1||f.col>=l.settings.maxCols);d++)if(b=p.getCellMeta(f.row,f.col),"paste"!==r&&"autofill"!==r||!b.skipColumnOnPaste)if(b.readOnly)f.col++;else{var N=d-C,x=M(O,N),k=p.getDataAtCell(f.row,f.col),I={row:O,col:N};if("autofill"===r){var D=p.runHooks("beforeAutofillInsidePopulate",I,i,t,s,{},y);D&&(x=L(D.value)?x:D.value)}if(null!==x&&"object"==typeof x)if(null===k||"object"!=typeof k)R=!1;else{var P=U(k[0]||k),H=U(x[0]||x);z(P,H)?x=W(x):R=!1}else null!==k&&"object"==typeof k&&(R=!1);R&&h.push([f.row,f.col,x]),R=!0,f.col++}else C++,f.col++,c++;f.row++}else _++,f.row++,u++}p.setDataAtCell(h,null,null,r||"populateFromArray")}}},this.selection=h={inProgress:!1,selectedHeader:{cols:!1,rows:!1},setSelectedHeaders:function(){var e=void 0!==arguments[0]&&arguments[0],t=void 0!==arguments[1]&&arguments[1],n=void 0!==arguments[2]&&arguments[2];p.selection.selectedHeader.rows=e,p.selection.selectedHeader.cols=t,p.selection.selectedHeader.corner=n},begin:function(){p.selection.inProgress=!0},finish:function(){var e=p.getSelected();S.hooks.run(p,"afterSelectionEnd",e[0],e[1],e[2],e[3]),S.hooks.run(p,"afterSelectionEndByProp",e[0],p.colToProp(e[1]),e[2],p.colToProp(e[3])),p.selection.inProgress=!1},isInProgress:function(){return p.selection.inProgress},setRangeStart:function(e,t){S.hooks.run(p,"beforeSetRangeStart",e),l.selRange=new de(e,e,e),h.setRangeEnd(e,null,t)},setRangeStartOnly:function(e){S.hooks.run(p,"beforeSetRangeStartOnly",e),l.selRange=new de(e,e,e)},setRangeEnd:function(e,t,n){if(null!==l.selRange){var r,o=!1,i=!0,s=p.view.wt.wtTable.getFirstVisibleRow(),a=p.view.wt.wtTable.getFirstVisibleColumn(),d={row:null,col:null};S.hooks.run(p,"beforeSetRangeEnd",e),p.selection.begin(),d.row=e.row<0?s:e.row,d.col=e.col<0?a:e.col,l.selRange.to=new ue(d.row,d.col),l.settings.multiSelect||(l.selRange.from=e),p.view.wt.selections.current.clear(),r=p.getCellMeta(l.selRange.highlight.row,l.selRange.highlight.col).disableVisualSelection,"string"==typeof r&&(r=[r]),(r===!1||Array.isArray(r)&&r.indexOf("current")===-1)&&p.view.wt.selections.current.add(l.selRange.highlight),p.view.wt.selections.area.clear(),(r===!1||Array.isArray(r)&&r.indexOf("area")===-1)&&h.isMultiple()&&(p.view.wt.selections.area.add(l.selRange.from),p.view.wt.selections.area.add(l.selRange.to)),(l.settings.currentHeaderClassName||l.settings.currentRowClassName||l.settings.currentColClassName)&&(p.view.wt.selections.highlight.clear(),p.view.wt.selections.highlight.add(l.selRange.from),p.view.wt.selections.highlight.add(l.selRange.to)),S.hooks.run(p,"afterSelection",l.selRange.from.row,l.selRange.from.col,l.selRange.to.row,l.selRange.to.col),S.hooks.run(p,"afterSelectionByProp",l.selRange.from.row,u.colToProp(l.selRange.from.col),l.selRange.to.row,u.colToProp(l.selRange.to.col)),(0===l.selRange.from.row&&l.selRange.to.row===p.countRows()-1&&p.countRows()>1||0===l.selRange.from.col&&l.selRange.to.col===p.countCols()-1&&p.countCols()>1)&&(o=!0),(e.row<0||e.col<0)&&(i=!1),t!==!1&&!o&&i&&(l.selRange.from&&!h.isMultiple()?p.view.scrollViewport(l.selRange.from):p.view.scrollViewport(e)),h.refreshBorders(null,n)}},refreshBorders:function(e,t){t||f.destroyEditor(e),p.view.render(),h.isSelected()&&!t&&f.prepareEditor()},isMultiple:function(){var e=!(l.selRange.to.col===l.selRange.from.col&&l.selRange.to.row===l.selRange.from.row),t=S.hooks.run(p,"afterIsMultipleSelection",e);if(e)return t},transformStart:function(e,t,n,r){var o,i,s,a,u=new ue(e,t),d=0,c=0;p.runHooks("modifyTransformStart",u),o=p.countRows(),i=p.countCols(),a=p.getSettings().fixedRowsBottom,l.selRange.highlight.row+e>o-1?n&&l.settings.minSpareRows>0&&!(a&&l.selRange.highlight.row>=o-a-1)?(p.alter("insert_row",o),o=p.countRows()):l.settings.autoWrapCol&&(u.row=1-o,u.col=l.selRange.highlight.col+u.col==i-1?1-i:1):l.settings.autoWrapCol&&l.selRange.highlight.row+u.row<0&&l.selRange.highlight.col+u.col>=0&&(u.row=o-1,u.col=l.selRange.highlight.col+u.col==0?i-1:-1),l.selRange.highlight.col+u.col>i-1?n&&l.settings.minSpareCols>0?(p.alter("insert_col",i),i=p.countCols()):l.settings.autoWrapRow&&(u.row=l.selRange.highlight.row+u.row==o-1?1-o:1,u.col=1-i):l.settings.autoWrapRow&&l.selRange.highlight.col+u.col<0&&l.selRange.highlight.row+u.row>=0&&(u.row=l.selRange.highlight.row+u.row==0?o-1:-1,u.col=i-1),s=new ue(l.selRange.highlight.row+u.row,l.selRange.highlight.col+u.col),s.row<0?(d=-1,s.row=0):s.row>0&&s.row>=o&&(d=1,s.row=o-1),s.col<0?(c=-1,s.col=0):s.col>0&&s.col>=i&&(c=1,s.col=i-1),p.runHooks("afterModifyTransformStart",s,d,c),h.setRangeStart(s,r)},transformEnd:function(e,t){var n,r,o,i=new ue(e,t),s=0,a=0;p.runHooks("modifyTransformEnd",i),n=p.countRows(),r=p.countCols(),o=new ue(l.selRange.to.row+i.row,l.selRange.to.col+i.col),o.row<0?(s=-1,o.row=0):o.row>0&&o.row>=n&&(s=1,o.row=n-1),o.col<0?(a=-1,o.col=0):o.col>0&&o.col>=r&&(a=1,o.col=r-1),p.runHooks("afterModifyTransformEnd",o,s,a),h.setRangeEnd(o,!0)},isSelected:function(){return null!==l.selRange},inInSelection:function(e){return!!h.isSelected()&&l.selRange.includes(e)},deselect:function(){h.isSelected()&&(p.selection.inProgress=!1,l.selRange=null,p.view.wt.selections.current.clear(),p.view.wt.selections.area.clear(),(l.settings.currentHeaderClassName||l.settings.currentRowClassName||l.settings.currentColClassName)&&p.view.wt.selections.highlight.clear(),f.destroyEditor(),h.refreshBorders(),k(p.rootElement,["ht__selection--rows","ht__selection--columns"]),S.hooks.run(p,"afterDeselect"))},selectAll:function(){l.settings.multiSelect&&(h.setRangeStart(new ue(0,0)),h.setRangeEnd(new ue(p.countRows()-1,p.countCols()-1),!1))},empty:function(){if(h.isSelected()){var e,t,n=l.selRange.getTopLeftCorner(),r=l.selRange.getBottomRightCorner(),o=[];for(e=n.row;e<=r.row;e++)for(t=n.col;t<=r.col;t++)p.getCellMeta(e,t).readOnly||o.push([e,t,""]);p.setDataAtCell(o)}}},this.init=function(){d.setData(l.settings.data),S.hooks.run(p,"beforeInit"),V()&&A(p.rootElement,"mobile"),this.updateSettings(l.settings,!0),this.view=new ne(this),f=new F(p,l,h,u),this.forceFullRender=!0,S.hooks.run(p,"init"),this.view.render(),"object"==typeof l.firstRun&&(S.hooks.run(p,"afterChange",l.firstRun[0],l.firstRun[1]),l.firstRun=!1),S.hooks.run(p,"afterInit")},this.validateCell=function(e,t,n,r){function o(e){var r=t.visualCol,o=t.visualRow,i=p.getCell(o,r,!0);i&&"TH"!=i.nodeName&&p.view.wt.wtSettings.settings.cellRenderer(o,r,i),n(e)}var i=p.getCellValidator(t);"[object RegExp]"===Object.prototype.toString.call(i)&&(i=function(e){return function(t,n){n(e.test(t))}}(i)),D(i)?(e=S.hooks.run(p,"beforeValidate",e,t.visualRow,t.prop,r),p._registerTimeout(setTimeout(function(){i.call(t,e,function(n){n=S.hooks.run(p,"afterValidate",n,e,t.visualRow,t.prop,r),t.valid=n,o(n),S.hooks.run(p,"postAfterValidate",n,e,t.visualRow,t.prop,r)})},0))):p._registerTimeout(setTimeout(function(){t.valid=!0,o(t.valid)},0))},this.setDataAtCell=function(e,t,n,s){var a,l,c,h=i(e,t,n),f=[];for(a=0,l=h.length;a<l;a++){if("object"!=typeof h[a])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof h[a][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");c=u.colToProp(h[a][1]),f.push([h[a][0],c,d.getAtCell(v.toPhysicalRow(h[a][0]),h[a][1]),h[a][2]])}s||"object"!=typeof e||(s=t),p.runHooks("afterSetDataAtCell",f,s),r(f,s,function(){o(f,s)})},this.setDataAtRowProp=function(e,t,n,s){var a,l,u=i(e,t,n),c=[];for(a=0,l=u.length;a<l;a++)c.push([u[a][0],u[a][1],d.getAtCell(v.toPhysicalRow(u[a][0]),u[a][1]),u[a][2]]);s||"object"!=typeof e||(s=t),p.runHooks("afterSetDataAtRowProp",c,s),r(c,s,function(){o(c,s)})},this.listen=function(){S.activeGuid=p.guid},this.unlisten=function(){S.activeGuid=null},this.isListening=function(){return S.activeGuid===p.guid},this.destroyEditor=function(e){h.refreshBorders(e)},this.populateFromArray=function(e,t,n,r,o,i,s,a,l){var u;if("object"!=typeof n||"object"!=typeof n[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");return u="number"==typeof r?new ue(r,o):null,c.populateFromArray(new ue(e,t),n,u,i,s,a,l)},this.spliceCol=function(e,t,n){return u.spliceCol.apply(u,arguments)},this.spliceRow=function(e,t,n){return u.spliceRow.apply(u,arguments)},this.getSelected=function(){if(h.isSelected())return[l.selRange.from.row,l.selRange.from.col,l.selRange.to.row,l.selRange.to.col]},this.getSelectedRange=function(){if(h.isSelected())return l.selRange},this.render=function(){p.view&&(p.renderCall=!0,p.forceFullRender=!0,h.refreshBorders(null,!0))},this.loadData=function(e){function t(){l.cellSettings.length=0}if(Array.isArray(l.settings.dataSchema)?p.dataType="array":D(l.settings.dataSchema)?p.dataType="function":p.dataType="object",u&&u.destroy(),u=new j(p,l,m),"object"==typeof e&&null!==e)e.push&&e.splice||(e=[e]);else{if(null!==e)throw new Error("loadData only accepts array of objects or array of arrays ("+typeof e+" given)");e=[];var n,r=0,o=0,i=u.getSchema();for(r=0,o=l.settings.startRows;r<o;r++)if("object"!==p.dataType&&"function"!==p.dataType||!l.settings.dataSchema)if("array"===p.dataType)n=W(i[0]),e.push(n);else{n=[];for(var s=0,a=l.settings.startCols;s<a;s++)n.push(null);e.push(n)}else n=W(i),e.push(n)}l.isPopulated=!1,m.prototype.data=e,Array.isArray(e[0])&&(p.dataType="array"),u.dataSource=e,d.data=e,d.dataType=p.dataType,d.colToProp=u.colToProp.bind(u),d.propToCol=u.propToCol.bind(u),t(),c.adjustRowsAndCols(),S.hooks.run(p,"afterLoadData",l.firstRun),l.firstRun?l.firstRun=[null,"loadData"]:(S.hooks.run(p,"afterChange",null,"loadData"),p.render()),l.isPopulated=!0},this.getData=function(e,t,n,r){return L(e)?u.getAll():u.getRange(new ue(e,t),new ue(n,r),u.DESTINATION_RENDERER)},this.getCopyableText=function(e,t,n,r){return u.getCopyableText(new ue(e,t),new ue(n,r))},this.getCopyableData=function(e,t){return u.getCopyable(e,u.colToProp(t))},this.getSchema=function(){return u.getSchema()},this.updateSettings=function(e,t){var n,r,o,i=!1;if(H(e.rows))throw new Error('"rows" setting is no longer supported. do you mean startRows, minRows or maxRows?');if(H(e.cols))throw new Error('"cols" setting is no longer supported. do you mean startCols, minCols or maxCols?');for(n in e)"data"!==n&&(S.hooks.getRegistered().indexOf(n)>-1?(D(e[n])||Array.isArray(e[n]))&&p.addHook(n,e[n]):!t&&e.hasOwnProperty(n)&&(m.prototype[n]=e[n]));if(void 0===e.data&&void 0===l.settings.data?p.loadData(null):void 0!==e.data?p.loadData(e.data):void 0!==e.columns&&u.createMap(),o=p.countCols(),e.columns&&D(e.columns)&&(o=p.countSourceCols(),i=!0),void 0===e.cell&&void 0===e.cells&&void 0===e.columns||(l.cellSettings.length=0),o>0){var a,d;for(n=0,r=0;n<o;n++)i&&!e.columns(n)||(l.columnSettings[r]=I(m,l.columnsSettingConflicts),a=l.columnSettings[r].prototype,m.prototype.columns&&(d=i?m.prototype.columns(n):m.prototype.columns[r],d&&(Y(a,d),Y(a,s(d)))),r++)}if(H(e.cell))for(var f in e.cell)if(e.cell.hasOwnProperty(f)){var g=e.cell[f];p.setCellMetaObject(g.row,g.col,g)}S.hooks.run(p,"afterCellMetaReset"),H(e.className)&&(m.prototype.className&&k(p.rootElement,m.prototype.className),e.className&&A(p.rootElement,e.className));var v=p.rootElement.style.height;""!==v&&(v=parseInt(p.rootElement.style.height,10));var w=e.height;if(D(w)&&(w=w()),t){var b=p.rootElement.getAttribute("style");b&&p.rootElement.setAttribute("data-initialstyle",p.rootElement.getAttribute("style"))}if(null===w){var y=p.rootElement.getAttribute("data-initialstyle");y&&(y.indexOf("height")>-1||y.indexOf("overflow")>-1)?p.rootElement.setAttribute("style",y):(p.rootElement.style.height="",p.rootElement.style.overflow="")}else void 0!==w&&(p.rootElement.style.height=w+"px",p.rootElement.style.overflow="hidden");if("undefined"!=typeof e.width){var _=e.width;D(_)&&(_=_()),p.rootElement.style.width=_+"px"}t||(u.clearLengthCache(),S.hooks.run(p,"afterUpdateSettings")),c.adjustRowsAndCols(),p.view&&!l.firstRun&&(p.forceFullRender=!0,h.refreshBorders(null,!0)),t||!p.view||""!==v&&""!==w&&void 0!==w||v===w||p.view.wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var e=p.getSelected();if(m.prototype.getValue){if(D(m.prototype.getValue))return m.prototype.getValue.call(p);if(e)return p.getData()[e[0]][m.prototype.getValue]}else if(e)return p.getDataAtCell(e[0],e[1])},this.getSettings=function(){return l.settings},this.clear=function(){h.selectAll(),h.empty()},this.alter=function(e,t,n,r,o){c.alter(e,t,n,r,o)},this.getCell=function(e,t,n){return p.view.getCellAtCoords(new ue(e,t),n)},this.getCoords=function(e){return this.view.wt.wtTable.getCoords.call(this.view.wt.wtTable,e)},this.colToProp=function(e){return u.colToProp(e)},this.propToCol=function(e){return u.propToCol(e)},this.toVisualRow=function(e){return v.toVisualRow(e)},this.toVisualColumn=function(e){return v.toVisualColumn(e)},this.toPhysicalRow=function(e){return v.toPhysicalRow(e)},this.toPhysicalColumn=function(e){return v.toPhysicalColumn(e)},this.getDataAtCell=function(e,t){return u.get(e,u.colToProp(t))},this.getDataAtRowProp=function(e,t){return u.get(e,t)},this.getDataAtCol=function(e){var t=[];return t.concat.apply(t,u.getRange(new ue(0,e),new ue(l.settings.data.length-1,e),u.DESTINATION_RENDERER))},this.getDataAtProp=function(e){var t,n=[];return t=u.getRange(new ue(0,u.propToCol(e)),new ue(l.settings.data.length-1,u.propToCol(e)),u.DESTINATION_RENDERER),n.concat.apply(n,t)},this.getSourceData=function(e,t,n,r){var o;return o=void 0===e?d.getData():d.getByRange(new ue(e,t),new ue(n,r))},this.getSourceDataArray=function(e,t,n,r){var o;return o=void 0===e?d.getData(!0):d.getByRange(new ue(e,t),new ue(n,r),!0)},this.getSourceDataAtCol=function(e){return d.getAtColumn(e)},this.getSourceDataAtRow=function(e){return d.getAtRow(e)},this.getSourceDataAtCell=function(e,t){return d.getAtCell(e,t);
},this.getDataAtRow=function(e){var t=u.getRange(new ue(e,0),new ue(e,this.countCols()-1),u.DESTINATION_RENDERER);return t[0]},this.getDataType=function(e,t,n,r){var o=this,i=null,s=null;void 0===e&&(e=0,n=this.countRows(),t=0,r=this.countCols()),void 0===n&&(n=e),void 0===r&&(r=t);var a="mixed";return te(Math.min(e,n),Math.max(e,n),function(e){var n=!0;return te(Math.min(t,r),Math.max(t,r),function(t){var r=o.getCellMeta(e,t);return s=r.type,i?n=i===s:i=s,n}),a=n?s:"mixed",n}),a},this.removeCellMeta=function(e,t,n){var r=p.getCellMeta(e,t);void 0!=r[n]&&delete l.cellSettings[e][t][n]},this.setCellMetaObject=function(e,t,n){if("object"==typeof n)for(var r in n)if(n.hasOwnProperty(r)){var o=n[r];this.setCellMeta(e,t,r,o)}},this.setCellMeta=function(e,t,n,r){l.cellSettings[e]||(l.cellSettings[e]=[]),l.cellSettings[e][t]||(l.cellSettings[e][t]=new l.columnSettings[t]),l.cellSettings[e][t][n]=r,S.hooks.run(p,"afterSetCellMeta",e,t,n,r)},this.getCellsMeta=function(){return K(l.cellSettings)},this.getCellMeta=function(e,t){var n,r,o=u.colToProp(t),i=e,a=t;if(n=v.toPhysical(e,t),e=n[0],t=n[1],n,l.columnSettings[t]||(l.columnSettings[t]=I(m,l.columnsSettingConflicts)),l.cellSettings[e]||(l.cellSettings[e]=[]),l.cellSettings[e][t]||(l.cellSettings[e][t]=new l.columnSettings[t]),r=l.cellSettings[e][t],r.row=e,r.col=t,r.visualRow=i,r.visualCol=a,r.prop=o,r.instance=p,S.hooks.run(p,"beforeGetCellMeta",e,t,r),Y(r,s(r)),r.cells){var d=r.cells.call(r,e,t,o);d&&(Y(r,d),Y(r,s(d)))}return S.hooks.run(p,"afterGetCellMeta",e,t,r),r},this.isColumnModificationAllowed=function(){return!("object"===p.dataType||p.getSettings().columns)};var w=se("renderer");this.getCellRenderer=function(e,t){var n=w.call(this,e,t);return J(n)},this.getCellEditor=se("editor"),this.getCellValidator=se("validator"),this.validateCells=function(e){var t=new n;e&&(t.onQueueEmpty=e);for(var r=p.countRows()-1;r>=0;){for(var o=p.countCols()-1;o>=0;)t.addValidatorToQueue(),p.validateCell(p.getDataAtCell(r,o),p.getCellMeta(r,o),function(e){if("boolean"!=typeof e)throw new Error("Validation error: result is not boolean");e===!1&&(t.valid=!1),t.removeValidatorFormQueue()},"validateCells"),o--;r--}t.checkIfQueueIsEmpty()},this.getRowHeader=function(e){var t=l.settings.rowHeaders;return void 0!==e&&(e=S.hooks.run(p,"modifyRowHeader",e)),void 0===e?(t=[],te(p.countRows()-1,function(e){t.push(p.getRowHeader(e))})):Array.isArray(t)&&void 0!==t[e]?t=t[e]:D(t)?t=t(e):t&&"string"!=typeof t&&"number"!=typeof t&&(t=e+1),t},this.hasRowHeaders=function(){return!!l.settings.rowHeaders},this.hasColHeaders=function(){if(void 0!==l.settings.colHeaders&&null!==l.settings.colHeaders)return!!l.settings.colHeaders;for(var e=0,t=p.countCols();e<t;e++)if(p.getColHeader(e))return!0;return!1},this.getColHeader=function(e){var t=l.settings.columns&&D(l.settings.columns),n=l.settings.colHeaders;if(e=S.hooks.run(p,"modifyColHeader",e),void 0===e){for(var r=[],o=t?p.countSourceCols():p.countCols(),i=0;i<o;i++)r.push(p.getColHeader(i));n=r}else{var s=function(e){for(var t=[],n=p.countSourceCols(),r=0;r<n;r++)D(p.getSettings().columns)&&p.getSettings().columns(r)&&t.push(r);return t[e]},a=e;e=S.hooks.run(p,"modifyCol",e);var u=s(e);l.settings.columns&&D(l.settings.columns)&&l.settings.columns(u)&&l.settings.columns(u).title?n=l.settings.columns(u).title:l.settings.columns&&l.settings.columns[e]&&l.settings.columns[e].title?n=l.settings.columns[e].title:Array.isArray(l.settings.colHeaders)&&void 0!==l.settings.colHeaders[e]?n=l.settings.colHeaders[e]:D(l.settings.colHeaders)?n=l.settings.colHeaders(e):l.settings.colHeaders&&"string"!=typeof l.settings.colHeaders&&"number"!=typeof l.settings.colHeaders&&(n=ae(a))}return n},this._getColWidthFromSettings=function(e){var t=p.getCellMeta(0,e),n=t.width;if(void 0!==n&&n!==l.settings.width||(n=t.colWidths),void 0!==n&&null!==n){switch(typeof n){case"object":n=n[e];break;case"function":n=n(e)}"string"==typeof n&&(n=parseInt(n,10))}return n},this.getColWidth=function(e){var t=p._getColWidthFromSettings(e);return t=S.hooks.run(p,"modifyColWidth",t,e),void 0===t&&(t=ce.DEFAULT_WIDTH),t},this._getRowHeightFromSettings=function(e){var t=l.settings.rowHeights;if(void 0!==t&&null!==t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){var t=p._getRowHeightFromSettings(e);return t=S.hooks.run(p,"modifyRowHeight",t,e)},this.countSourceRows=function(){var e=S.hooks.run(p,"modifySourceLength");return e||(p.getSourceData()?p.getSourceData().length:0)},this.countSourceCols=function(){var e=0,t=p.getSourceData()&&p.getSourceData()[0]?p.getSourceData()[0]:[];return e=G(t)?X(t):t.length||0},this.countRows=function(){return u.getLength()},this.countCols=function(){var e=!1,t=0;if("array"===p.dataType&&(e=l.settings.data&&l.settings.data[0]&&l.settings.data[0].length),e&&(t=l.settings.data[0].length),l.settings.columns){var n=D(l.settings.columns);if(n)if("array"===p.dataType){for(var r=0,o=0;o<t;o++)l.settings.columns(o)&&r++;t=r}else"object"!==p.dataType&&"function"!==p.dataType||(t=u.colToPropCache.length);else t=l.settings.columns.length}else"object"!==p.dataType&&"function"!==p.dataType||(t=u.colToPropCache.length);return t},this.rowOffset=function(){return p.view.wt.wtTable.getFirstRenderedRow()},this.colOffset=function(){return p.view.wt.wtTable.getFirstRenderedColumn()},this.countRenderedRows=function(){return p.view.wt.drawn?p.view.wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return p.view.wt.drawn?p.view.wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return p.view.wt.drawn?p.view.wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return p.view.wt.drawn?p.view.wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(e){for(var t,n=p.countRows()-1,r=0;n>=0;){if(t=S.hooks.run(this,"modifyRow",n),p.isEmptyRow(t))r++;else if(e)break;n--}return r},this.countEmptyCols=function(e){if(p.countRows()<1)return 0;for(var t=p.countCols()-1,n=0;t>=0;){if(p.isEmptyCol(t))n++;else if(e)break;t--}return n},this.isEmptyRow=function(e){return l.settings.isEmptyRow.call(p,e)},this.isEmptyCol=function(e){return l.settings.isEmptyCol.call(p,e)},this.selectCell=function(e,t,n,r,o,i){var s;if(i=L(i)||i===!0,"number"!=typeof e||e<0||e>=p.countRows())return!1;if("number"!=typeof t||t<0||t>=p.countCols())return!1;if(H(n)){if("number"!=typeof n||n<0||n>=p.countRows())return!1;if("number"!=typeof r||r<0||r>=p.countCols())return!1}return s=new ue(e,t),l.selRange=new de(s,s,s),i&&p.listen(),L(n)?h.setRangeEnd(l.selRange.from,o):h.setRangeEnd(new ue(n,r),o),p.selection.finish(),!0},this.selectCellByProp=function(e,t,n,r,o){return arguments[1]=u.propToCol(arguments[1]),H(arguments[3])&&(arguments[3]=u.propToCol(arguments[3])),p.selectCell.apply(p,arguments)},this.deselectCell=function(){h.deselect()},this.scrollViewportTo=function(e,t){var n=void 0!==arguments[2]&&arguments[2],r=void 0!==arguments[3]&&arguments[3];if(void 0!==e&&(e<0||e>=p.countRows()))return!1;if(void 0!==t&&(t<0||t>=p.countCols()))return!1;var o=!1;return void 0!==e&&void 0!==t&&(p.view.wt.wtOverlays.topOverlay.scrollTo(e,n),p.view.wt.wtOverlays.leftOverlay.scrollTo(t,r),o=!0),"number"==typeof e&&"number"!=typeof t&&(p.view.wt.wtOverlays.topOverlay.scrollTo(e,n),o=!0),"number"==typeof t&&"number"!=typeof e&&(p.view.wt.wtOverlays.leftOverlay.scrollTo(t,r),o=!0),o},this.destroy=function(){p._clearTimeouts(),p.view&&p.view.destroy(),d&&d.destroy(),d=null,N(p.rootElement),g.destroy(),S.hooks.run(p,"afterDestroy"),S.hooks.destroy(p);for(var e in p)p.hasOwnProperty(e)&&(D(p[e])?p[e]=a:"guid"!==e&&(p[e]=null));u&&u.destroy(),u=null,l=null,c=null,h=null,f=null,p=null,m=null},this.getActiveEditor=function(){return f.getActiveEditor()},this.getPlugin=function(e){return Z(this,e)},this.getInstance=function(){return p},this.addHook=function(e,t){S.hooks.add(e,t,p)},this.hasHook=function(e){return S.hooks.has(e,p)},this.addHookOnce=function(e,t){S.hooks.once(e,t,p)},this.removeHook=function(e,t){S.hooks.remove(e,t,p)},this.runHooks=function(e,t,n,r,o,i,s){return S.hooks.run(p,e,t,n,r,o,i,s)},this.timeouts=[],this._registerTimeout=function(e){this.timeouts.push(e)},this._clearTimeouts=function(){for(var e=0,t=this.timeouts.length;e<t;e++)clearTimeout(this.timeouts[e])},this.version=S.version,S.hooks.run(p,"construct")};var he=function(){};he.prototype={data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:void 0,colHeaders:null,colWidths:void 0,rowHeights:void 0,columns:void 0,cells:void 0,cell:[],comments:!1,customBorders:!1,minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,multiSelect:!0,fillHandle:!0,fixedRowsTop:0,fixedRowsBottom:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,copyRowsLimit:1e3,copyColsLimit:1e3,pasteMode:"overwrite",persistentState:void 0,currentRowClassName:void 0,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",className:void 0,tableClassName:void 0,stretchH:"none",isEmptyRow:function(e){var t,n,r,o;for(t=0,n=this.countCols();t<n;t++)if(r=this.getDataAtCell(e,t),""!==r&&null!==r&&H(r))return"object"==typeof r&&(o=this.getCellMeta(e,t),z(this.getSchema()[o.prop],r));return!0},isEmptyCol:function(e){var t,n,r;for(t=0,n=this.countRows();t<n;t++)if(r=this.getDataAtCell(t,e),""!==r&&null!==r&&H(r))return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,allowEmpty:!0,invalidCellClassName:"htInvalid",placeholder:!1,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,skipColumnOnPaste:!1,search:!1,type:"text",copyable:!0,editor:void 0,autoComplete:void 0,visibleRows:10,trimDropdown:!0,debug:!1,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,contextMenuCopyPaste:void 0,copyPaste:void 0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:!1,viewportRowRenderingOffset:"auto",viewportColumnRenderingOffset:"auto",validator:void 0,disableVisualSelection:!1,sortIndicator:void 0,manualColumnFreeze:void 0,trimWhitespace:!0,settings:void 0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,label:void 0,format:void 0,language:void 0,selectOptions:void 0,autoColumnSize:void 0,autoRowSize:void 0,dateFormat:void 0,correctFormat:!1,defaultDate:void 0,strict:void 0,allowHtml:!1,renderAllRows:void 0,preventOverflow:!1,bindRowsWithHeaders:void 0,collapsibleColumns:void 0,columnSummary:void 0,dropdownMenu:void 0,filters:void 0,formulas:void 0,ganttChart:void 0,headerTooltips:void 0,hiddenColumns:void 0,hiddenRows:void 0,nestedHeaders:void 0,trimRows:void 0,rowHeaderWidth:void 0,columnHeaderHeight:void 0,observeChanges:void 0,sortFunction:void 0,sortByRelevance:!0,filter:!0,filteringCaseSensitive:!1},S.DefaultSettings=he},{"3rdparty/walkontable/src/calculator/viewportColumns":4,"3rdparty/walkontable/src/cell/coords":6,"3rdparty/walkontable/src/cell/range":7,browser:24,dataMap:27,dataSource:28,editorManager:29,eventManager:42,"helpers/array":43,"helpers/browser":44,"helpers/data":45,"helpers/dom/element":47,"helpers/function":50,"helpers/mixed":51,"helpers/number":52,"helpers/object":53,"helpers/setting":54,"helpers/string":55,numbro:"numbro",plugins:62,renderers:117,tableView:126,"utils/recordTranslator":130}],27:[function(e,t,n){"use strict";function r(e,t,n){var r=this;this.instance=e,this.priv=t,this.GridSettings=n,this.dataSource=this.instance.getSettings().data,this.cachedLength=null,this.skipCache=!1,this.latestSourceRowsCount=0,this.dataSource&&this.dataSource[0]?this.duckSchema=this.recursiveDuckSchema(this.dataSource[0]):this.duckSchema={},this.createMap(),this.interval=O.create(function(){return r.clearLengthCache()},"15fps"),this.instance.addHook("skipLengthCache",function(e){return r.onSkipLengthCache(e)})}Object.defineProperties(n,{DataMap:{get:function(){return r}},__esModule:{value:!0}});var o,i,s,a,l,u,d,c,h,f=(o=e("browser"),o&&o.__esModule&&o||{default:o}).default,p=(i=e("SheetClip"),i&&i.__esModule&&i||{default:i}).default,m=(s=e("helpers/data"),s&&s.__esModule&&s||{default:s}).cellMethodLookupFactory,g=(a=e("helpers/setting"),a&&a.__esModule&&a||{default:a}).columnFactory,v=(l=e("helpers/object"),l&&l.__esModule&&l||{default:l}),w=v.createObjectPropListener,b=v.duckSchema,y=v.deepExtend,_=v.deepClone,C=v.isObject,R=v.deepObjectSize,M=(u=e("helpers/array"),u&&u.__esModule&&u||{default:u}),E=M.extendArray,S=M.to2dArray,O=(d=e("utils/interval"),d&&d.__esModule&&d||{default:d}).Interval,T=(c=e("helpers/number"),c&&c.__esModule&&c||{default:c}).rangeEach,A=(h=e("multiMap"),h&&h.__esModule&&h||{default:h}).MultiMap;r.prototype.DESTINATION_RENDERER=1,r.prototype.DESTINATION_CLIPBOARD_GENERATOR=2,r.prototype.recursiveDuckSchema=function(e){return b(e)},r.prototype.recursiveDuckColumns=function(e,t,n){var r,o;if("undefined"==typeof t&&(t=0,n=""),"object"==typeof e&&!Array.isArray(e))for(o in e)e.hasOwnProperty(o)&&(null===e[o]?(r=n+o,this.colToPropCache.push(r),this.propToColCache.set(r,t),t++):t=this.recursiveDuckColumns(e[o],t,o+"."));return t},r.prototype.createMap=function(){var e,t=this.getSchema();if("undefined"==typeof t)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");this.colToPropCache=[],this.propToColCache=new A;var n=this.instance.getSettings().columns;if(n){var r=n.length,o=0,i=!1,s=R(t);for("function"==typeof n&&(r=s>0?s:this.instance.countSourceCols(),i=!0),e=0;e<r;e++){var a=i?n(e):n[e];if(C(a)){if("undefined"!=typeof a.data){var l=i?o:e;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}o++}}}else this.recursiveDuckColumns(t)},r.prototype.colToProp=function(e){return e=f.hooks.run(this.instance,"modifyCol",e),this.colToPropCache&&"undefined"!=typeof this.colToPropCache[e]?this.colToPropCache[e]:e},r.prototype.propToCol=function(e){var t;return t="undefined"==typeof this.propToColCache.get(e)?e:this.propToColCache.get(e),t=f.hooks.run(this.instance,"unmodifyCol",t)},r.prototype.getSchema=function(){var e=this.instance.getSettings().dataSchema;return e?"function"==typeof e?e():e:this.duckSchema},r.prototype.createRow=function(e,t,n){var r,o,i=this.instance.countCols(),s=0;t||(t=1),("number"!=typeof e||e>=this.instance.countSourceRows())&&(e=this.instance.countSourceRows()),f.hooks.run(this.instance,"beforeCreateRow",e,t,n),o=e;for(var a=this.instance.getSettings().maxRows;s<t&&this.instance.countSourceRows()<a;)"array"===this.instance.dataType?this.instance.getSettings().dataSchema?r=_(this.getSchema()):(r=[],T(i-1,function(){return r.push(null)})):"function"===this.instance.dataType?r=this.instance.getSettings().dataSchema(e):(r={},y(r,this.getSchema())),e===this.instance.countSourceRows()?this.dataSource.push(r):this.spliceData(e,0,r),s++,o++;return f.hooks.run(this.instance,"afterCreateRow",e,s,n),this.instance.forceFullRender=!0,s},r.prototype.createCol=function(e,t,n){if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var r,o,i=this.instance.countSourceRows(),s=this.dataSource,a=0;t||(t=1),("number"!=typeof e||e>=this.instance.countCols())&&(e=this.instance.countCols()),f.hooks.run(this.instance,"beforeCreateCol",e,t,n),o=e;for(var l=this.instance.getSettings().maxCols;a<t&&this.instance.countCols()<l;){if(r=g(this.GridSettings,this.priv.columnsSettingConflicts),"number"!=typeof e||e>=this.instance.countCols()){if(i>0)for(var u=0;u<i;u++)"undefined"==typeof s[u]&&(s[u]=[]),s[u].push(null);else s.push([null]);this.priv.columnSettings.push(r)}else{for(var u=0;u<i;u++)s[u].splice(o,0,null);this.priv.columnSettings.splice(o,0,r)}a++,o++}return f.hooks.run(this.instance,"afterCreateCol",e,a,n),this.instance.forceFullRender=!0,a},r.prototype.removeRow=function(e,t,n){t||(t=1),"number"!=typeof e&&(e=-t),t=f.hooks.run(this.instance,"modifyRemovedAmount",t,e),e=(this.instance.countSourceRows()+e)%this.instance.countSourceRows();var r=this.physicalRowsToLogical(e,t),o=f.hooks.run(this.instance,"beforeRemoveRow",e,t,r,n);if(o!==!1){var i,s=this.dataSource;i=this.filterData(e,t),i&&(s.length=0,Array.prototype.push.apply(s,i)),f.hooks.run(this.instance,"afterRemoveRow",e,t,r,n),this.instance.forceFullRender=!0}},r.prototype.removeCol=function(e,t,n){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("cannot remove column with object data source or columns option specified");t||(t=1),"number"!=typeof e&&(e=-t),e=(this.instance.countCols()+e)%this.instance.countCols();var r=this.physicalColumnsToLogical(e,t),o=r.slice(0).sort(function(e,t){return t-e}),i=f.hooks.run(this.instance,"beforeRemoveCol",e,t,r,n);if(i!==!1){for(var s=!0,a=o.length,l=this.dataSource,u=0;u<a;u++)s&&r[0]!==r[u]-u&&(s=!1);if(s)for(var d=0,c=this.instance.countSourceRows();d<c;d++)l[d].splice(r[0],t);else{for(var h=0,p=this.instance.countSourceRows();h<p;h++)for(var m=0;m<a;m++)l[h].splice(o[m],1);for(var g=0;g<a;g++)this.priv.columnSettings.splice(r[g],1)}f.hooks.run(this.instance,"afterRemoveCol",e,t,r,n),this.instance.forceFullRender=!0}},r.prototype.spliceCol=function(e,t,n){var r=4<=arguments.length?[].slice.call(arguments,3):[],o=this.instance.getDataAtCol(e),i=o.slice(t,t+n),s=o.slice(t+n);E(r,s);for(var a=0;a<n;)r.push(null),a++;return S(r),this.instance.populateFromArray(t,e,r,null,null,"spliceCol"),i},r.prototype.spliceRow=function(e,t,n){var r=4<=arguments.length?[].slice.call(arguments,3):[],o=this.instance.getSourceDataAtRow(e),i=o.slice(t,t+n),s=o.slice(t+n);E(r,s);for(var a=0;a<n;)r.push(null),a++;return this.instance.populateFromArray(e,t,[r],null,null,"spliceRow"),i},r.prototype.spliceData=function(e,t,n){var r=f.hooks.run(this.instance,"beforeDataSplice",e,t,n);r!==!1&&this.dataSource.splice(e,t,n)},r.prototype.filterData=function(e,t){var n=this.physicalRowsToLogical(e,t),r=f.hooks.run(this.instance,"beforeDataFilter",e,t,n);if(r!==!1){var o=this.dataSource.filter(function(e,t){return n.indexOf(t)==-1});return o}},r.prototype.get=function(e,t){e=f.hooks.run(this.instance,"modifyRow",e);var n=this.dataSource[e],r=f.hooks.run(this.instance,"modifyRowData",e);n=isNaN(r)?r:n;var o=null;if(n&&n.hasOwnProperty&&n.hasOwnProperty(t))o=n[t];else if("string"==typeof t&&t.indexOf(".")>-1){var i=t.split("."),s=n;if(!s)return null;for(var a=0,l=i.length;a<l;a++)if(s=s[i[a]],"undefined"==typeof s)return null;o=s}else"function"==typeof t&&(o=t(this.dataSource.slice(e,e+1)[0]));if(f.hooks.has("modifyData",this.instance)){var u=w(o);f.hooks.run(this.instance,"modifyData",e,this.propToCol(t),u,"get"),u.isTouched()&&(o=u.value)}return o};var N=m("copyable",!1);r.prototype.getCopyable=function(e,t){return N.call(this.instance,e,this.propToCol(t))?this.get(e,t):""},r.prototype.set=function(e,t,n,r){e=f.hooks.run(this.instance,"modifyRow",e,r||"datamapGet");var o=this.dataSource[e],i=f.hooks.run(this.instance,"modifyRowData",e);if(o=isNaN(i)?i:o,f.hooks.has("modifyData",this.instance)){var s=w(n);f.hooks.run(this.instance,"modifyData",e,this.propToCol(t),s,"set"),s.isTouched()&&(n=s.value)}if(o&&o.hasOwnProperty&&o.hasOwnProperty(t))o[t]=n;else if("string"==typeof t&&t.indexOf(".")>-1){for(var a=t.split("."),l=o,u=0,d=a.length-1;u<d;u++)"undefined"==typeof l[a[u]]&&(l[a[u]]={}),l=l[a[u]];l[a[u]]=n}else"function"==typeof t?t(this.dataSource.slice(e,e+1)[0],n):o[t]=n},r.prototype.physicalRowsToLogical=function(e,t){for(var n,r=this.instance.countSourceRows(),o=(r+e)%r,i=[],s=t;o<r&&s;)n=f.hooks.run(this.instance,"modifyRow",o),i.push(n),s--,o++;return i},r.prototype.physicalColumnsToLogical=function(e,t){for(var n=this.instance.countCols(),r=(n+e)%n,o=[],i=t;r<n&&i;){var s=f.hooks.run(this.instance,"modifyCol",r);o.push(s),i--,r++}return o},r.prototype.clear=function(){for(var e=0;e<this.instance.countSourceRows();e++)for(var t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")},r.prototype.clearLengthCache=function(){this.cachedLength=null},r.prototype.getLength=function(){var e,t=this,n=this.instance.getSettings().maxRows;e=n<0||0===n?0:n||1/0;var r=this.instance.countSourceRows();if(f.hooks.has("modifyRow",this.instance)){var o=this.skipCache;this.interval.start(),r!==this.latestSourceRowsCount&&(o=!0),this.latestSourceRowsCount=r,null===this.cachedLength||o?(T(r-1,function(e){e=f.hooks.run(t.instance,"modifyRow",e),null===e&&--r}),this.cachedLength=r):r=this.cachedLength}else this.interval.stop();return Math.min(r,e)},r.prototype.getAll=function(){var e={row:0,col:0},t=this.instance.getSettings().maxRows;if(0===t)return[];var n={row:Math.min(Math.max(t-1,0),Math.max(this.instance.countSourceRows()-1,0)),col:Math.max(this.instance.countCols()-1,0)};return e.row-n.row!==0||this.instance.countSourceRows()?this.getRange(e,n,r.prototype.DESTINATION_RENDERER):[]},r.prototype.getRange=function(e,t,n){var r,o,i,s,a,l=[],u=n===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;for(o=Math.max(e.row,t.row),s=Math.max(e.col,t.col),r=Math.min(e.row,t.row);r<=o;r++){a=[];var d=f.hooks.run(this.instance,"modifyRow",r);for(i=Math.min(e.col,t.col);i<=s&&null!==d;i++)a.push(u.call(this,r,this.colToProp(i)));null!==d&&l.push(a)}return l},r.prototype.getText=function(e,t){return p.stringify(this.getRange(e,t,this.DESTINATION_RENDERER))},r.prototype.getCopyableText=function(e,t){return p.stringify(this.getRange(e,t,this.DESTINATION_CLIPBOARD_GENERATOR))},r.prototype.onSkipLengthCache=function(e){var t=this;this.skipCache=!0,setTimeout(function(){t.skipCache=!1},e)},r.prototype.destroy=function(){this.interval.stop(),this.interval=null,this.instance=null,this.priv=null,this.GridSettings=null,this.dataSource=null,this.cachedLength=null,this.duckSchema=null}},{SheetClip:"SheetClip",browser:24,"helpers/array":43,"helpers/data":45,"helpers/number":52,"helpers/object":53,"helpers/setting":54,multiMap:60,"utils/interval":129}],28:[function(e,t,n){"use strict";Object.defineProperties(n,{DataSource:{get:function(){return u}},__esModule:{value:!0}});var r,o,i,s=(r=e("helpers/object"),r&&r.__esModule&&r||{default:r}).getProperty,a=(o=e("helpers/array"),o&&o.__esModule&&o||{default:o}).arrayEach,l=(i=e("helpers/number"),i&&i.__esModule&&i||{default:i}).rangeEach,u=function(e){var t=void 0!==arguments[1]?arguments[1]:[];this.hot=e,this.data=t,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}};$traceurRuntime.createClass(u,{getData:function(){var e=void 0!==arguments[0]&&arguments[0],t=this.data;return e&&(t=this.getByRange({row:0,col:0},{row:Math.max(this.countRows()-1,0),col:Math.max(this.countColumns()-1,0)},!0)),t},setData:function(e){this.data=e},getAtColumn:function(e){var t=this,n=[];return a(this.data,function(r){var o=t.colToProp(e);r="string"==typeof o?s(r,o):r[o],n.push(r)}),n},getAtRow:function(e){return this.data[e]},getAtCell:function(e,t){var n=null,r=this.hot.runHooks("modifyRowData",e),o=isNaN(r)?r:this.data[e];if(o){var i=this.colToProp(t);n="string"==typeof i?s(o,i):"function"==typeof i?i(this.data.slice(e,e+1)[0]):o[i]}return n},getByRange:function(e,t){var n=void 0!==arguments[2]&&arguments[2],r=this,o=Math.min(e.row,t.row),i=Math.min(e.col,t.col),s=Math.max(e.row,t.row),a=Math.max(e.col,t.col),u=[];return l(o,s,function(e){var t,o=r.getAtRow(e);"array"===r.dataType?t=o.slice(i,a+1):"object"===r.dataType&&(t=n?[]:{},l(i,a,function(e){var i=r.colToProp(e);n?t.push(o[i]):t[i]=o[i]})),u.push(t)}),u},countRows:function(){return Array.isArray(this.data)?this.data.length:0},countColumns:function(){var e=0;return Array.isArray(this.data)&&("array"===this.dataType?e=this.data[0].length:"object"===this.dataType&&(e=Object.keys(this.data[0]).length)),e},destroy:function(){this.data=null,this.hot=null}},{})},{"helpers/array":43,"helpers/number":52,"helpers/object":53}],29:[function(e,t,n){"use strict";function r(e,t,n){function r(e){var r="function"==typeof t.settings.enterMoves?t.settings.enterMoves(event):t.settings.enterMoves;e?n.transformStart(-r.row,-r.col):n.transformStart(r.row,r.col,!0)}function o(e){e?n.transformEnd(-1,0):n.transformStart(-1,0)}function i(e){e?n.transformEnd(1,0):n.transformStart(1,0)}function s(e){e?n.transformEnd(0,1):n.transformStart(0,1)}function a(e){e?n.transformEnd(0,-1):n.transformStart(0,-1)}function l(l){var u,h;if(e.isListening()&&(d.hooks.run(e,"beforeKeyDown",l),!C&&!b(l)&&(t.lastKeyCode=l.keyCode,n.isSelected()))){if(u=(l.ctrlKey||l.metaKey)&&!l.altKey,g&&!g.isWaiting()&&!(p(l.keyCode)||m(l.keyCode)||u||_.isEditorOpened()))return void _.openEditor("",l);switch(h=l.shiftKey?n.setRangeEnd:n.setRangeStart,l.keyCode){case f.A:!_.isEditorOpened()&&u&&(n.selectAll(),l.preventDefault(),v(l));break;case f.ARROW_UP:_.isEditorOpened()&&!g.isWaiting()&&_.closeEditorAndSaveChanges(u),o(l.shiftKey),l.preventDefault(),v(l);break;case f.ARROW_DOWN:_.isEditorOpened()&&!g.isWaiting()&&_.closeEditorAndSaveChanges(u),i(l.shiftKey),l.preventDefault(),v(l);break;case f.ARROW_RIGHT:_.isEditorOpened()&&!g.isWaiting()&&_.closeEditorAndSaveChanges(u),s(l.shiftKey),l.preventDefault(),v(l);break;case f.ARROW_LEFT:_.isEditorOpened()&&!g.isWaiting()&&_.closeEditorAndSaveChanges(u),a(l.shiftKey),l.preventDefault(),v(l);break;case f.TAB:var y="function"==typeof t.settings.tabMoves?t.settings.tabMoves(l):t.settings.tabMoves;l.shiftKey?n.transformStart(-y.row,-y.col):n.transformStart(y.row,y.col,!0),l.preventDefault(),v(l);break;case f.BACKSPACE:case f.DELETE:n.empty(l),_.prepareEditor(),l.preventDefault();break;case f.F2:_.openEditor(null,l),g&&g.enableFullEditMode(),l.preventDefault();break;case f.ENTER:_.isEditorOpened()?(g&&g.state!==d.EditorState.WAITING&&_.closeEditorAndSaveChanges(u),r(l.shiftKey)):e.getSettings().enterBeginsEditing?(_.openEditor(null,l),g&&g.enableFullEditMode()):r(l.shiftKey),l.preventDefault(),w(l);break;case f.ESCAPE:_.isEditorOpened()&&_.closeEditorAndRestoreOriginalValue(u),l.preventDefault();break;case f.HOME:h(l.ctrlKey||l.metaKey?new c(0,t.selRange.from.col):new c(t.selRange.from.row,0)),l.preventDefault(),v(l);break;case f.END:h(l.ctrlKey||l.metaKey?new c(e.countRows()-1,t.selRange.from.col):new c(t.selRange.from.row,e.countCols()-1)),l.preventDefault(),v(l);break;case f.PAGE_UP:n.transformStart(-e.countVisibleRows(),0),l.preventDefault(),v(l);break;case f.PAGE_DOWN:n.transformStart(e.countVisibleRows(),0),l.preventDefault(),v(l)}}}function u(){function t(e,t,n){"TD"==n.nodeName&&(_.openEditor(),g&&g.enableFullEditMode())}e.addHook("afterDocumentKeyDown",l),h.addEventListener(document.documentElement,"keydown",function(t){C||e.runHooks("afterDocumentKeyDown",t)}),e.view.wt.update("onCellDblClick",t),e.addHook("afterDestroy",function(){C=!0})}var h,g,_=this,C=!1;h=y(e),this.destroyEditor=function(e){this.closeEditor(e)},this.getActiveEditor=function(){return g},this.prepareEditor=function(){var n,r,o,i,s,a,l;return g&&g.isWaiting()?void this.closeEditor(!1,!1,function(e){e&&_.prepareEditor()}):(n=t.selRange.highlight.row,r=t.selRange.highlight.col,o=e.colToProp(r),i=e.getCell(n,r),s=e.getSourceDataAtCell(e.runHooks("modifyRow",n),r),a=e.getCellMeta(n,r),l=e.getCellEditor(a),void(l?(g=d.editors.getEditor(l,e),g.prepare(n,r,o,i,s,a)):g=void 0))},this.isEditorOpened=function(){return g&&g.isOpened()},this.openEditor=function(e,t){g&&!g.cellProperties.readOnly?g.beginEditing(e,t):g&&g.cellProperties.readOnly&&t&&t.keyCode===f.ENTER&&r()},this.closeEditor=function(e,t,n){g?g.finishEditing(e,t,n):n&&n(!1)},this.closeEditorAndSaveChanges=function(e){return this.closeEditor(!1,e)},this.closeEditorAndRestoreOriginalValue=function(e){return this.closeEditor(!0,e)},u()}Object.defineProperties(n,{EditorManager:{get:function(){return r}},__esModule:{value:!0}});var o,i,s,a,l,u,d=(o=e("browser"),o&&o.__esModule&&o||{default:o}).default,c=(i=e("3rdparty/walkontable/src/cell/coords"),i&&i.__esModule&&i||{default:i}).WalkontableCellCoords,h=(s=e("helpers/unicode"),s&&s.__esModule&&s||{default:s}),f=h.KEY_CODES,p=h.isMetaKey,m=h.isCtrlKey,g=(a=e("helpers/dom/event"),a&&a.__esModule&&a||{default:a}),v=g.stopPropagation,w=g.stopImmediatePropagation,b=g.isImmediatePropagationStopped,y=((l=e("editors"),l&&l.__esModule&&l||{default:l}).getEditor,(u=e("eventManager"),u&&u.__esModule&&u||{default:u}).eventManager);d.EditorManager=r},{"3rdparty/walkontable/src/cell/coords":6,browser:24,editors:30,eventManager:42,"helpers/dom/event":48,"helpers/unicode":56}],30:[function(e,t,n){"use strict";function r(e){var t,n;n={},t=e,this.getConstructor=function(){return e},this.getInstance=function(e){return e.guid in n||(n[e.guid]=new t(e)),n[e.guid]}}function o(e,t){var n=new r(t);"string"==typeof e&&(h[e]=n,d.editors[c(e)+"Editor"]=t),f.set(t,n)}function i(e,t){var n;if("function"==typeof e)f.get(e)||o(null,e),n=f.get(e);else{if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter ');n=h[e]}if(!n)throw Error('No editor registered under name "'+e+'"');return n.getInstance(t)}function s(e){var t;if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter ');if(t=h[e],!t)throw Error('No editor registered under name "'+e+'"');return t.getConstructor()}function a(e){return!!h[e]}Object.defineProperties(n,{registerEditor:{get:function(){return o}},getEditor:{get:function(){return i}},hasEditor:{get:function(){return a}},getEditorConstructor:{get:function(){return s}},__esModule:{value:!0}});var l,u,d=(l=e("browser"),l&&l.__esModule&&l||{default:l}).default,c=(u=e("helpers/string"),u&&u.__esModule&&u||{default:u}).toUpperCaseFirst,h={},f=new WeakMap;d.editors=d.editors||{},d.editors.registerEditor=o,d.editors.getEditor=i},{browser:24,"helpers/string":55}],31:[function(e,t,n){"use strict";function r(e){this.instance=e,this.state=a.EditorState.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.init()}Object.defineProperties(n,{BaseEditor:{get:function(){return r}},__esModule:{value:!0}});var o,i,s,a=(o=e("browser"),o&&o.__esModule&&o||{default:o}).default,l=(i=e("helpers/mixed"),i&&i.__esModule&&i||{default:i}).stringify,u=(s=e("3rdparty/walkontable/src/cell/coords"),s&&s.__esModule&&s||{default:s}).WalkontableCellCoords;a.editors=a.editors||{},a.editors.BaseEditor=r,a.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"},r.prototype._fireCallbacks=function(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)},r.prototype.init=function(){},r.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented")},r.prototype.setValue=function(e){throw Error("Editor setValue() method unimplemented")},r.prototype.open=function(){throw Error("Editor open() method unimplemented")},r.prototype.close=function(){throw Error("Editor close() method unimplemented")},r.prototype.prepare=function(e,t,n,r,o,i){this.TD=r,this.row=e,this.col=t,this.prop=n,this.originalValue=o,this.cellProperties=i;var s=!document.activeElement||document.activeElement&&void 0===document.activeElement.nodeName;this.instance.view.isMouseDown()&&document.activeElement&&document.activeElement!==document.body&&!s?document.activeElement.blur():s&&document.body.focus(),this.state=a.EditorState.VIRGIN},r.prototype.extend=function(){function e(){n.apply(this,arguments)}function t(e,t){function n(){}return n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e,e}var n=this.constructor;return t(e,n)},r.prototype.saveValue=function(e,t){
var n,r;t?(n=this.instance.getSelected(),n[0]>n[2]&&(r=n[0],n[0]=n[2],n[2]=r),n[1]>n[3]&&(r=n[1],n[1]=n[3],n[3]=r)):n=[this.row,this.col,null,null],this.instance.populateFromArray(n[0],n[1],e,n[2],n[3],"edit")},r.prototype.beginEditing=function(e,t){this.state==a.EditorState.VIRGIN&&(this.instance.view.scrollViewport(new u(this.row,this.col)),this.instance.view.render(),this.state=a.EditorState.EDITING,e="string"==typeof e?e:this.originalValue,this.setValue(l(e)),this.open(t),this._opened=!0,this.focus(),this.instance.view.render(),this.instance.runHooks("afterBeginEditing",this.row,this.col))},r.prototype.finishEditing=function(e,t,n){var r,o=this;if(n){var i=this._closeCallback;this._closeCallback=function(e){i&&i(e),n(e)}}if(!this.isWaiting()){if(this.state==a.EditorState.VIRGIN)return void this.instance._registerTimeout(setTimeout(function(){o._fireCallbacks(!0)},0));if(this.state==a.EditorState.EDITING){if(e)return this.cancelChanges(),void this.instance.view.render();var s=this.getValue();r=this.instance.getSettings().trimWhitespace?[["string"==typeof s?String.prototype.trim.call(s||""):s]]:[[s]],this.state=a.EditorState.WAITING,this.saveValue(r,t),this.instance.getCellValidator(this.cellProperties)?this.instance.addHookOnce("postAfterValidate",function(e){o.state=a.EditorState.FINISHED,o.discardEditor(e)}):(this.state=a.EditorState.FINISHED,this.discardEditor(!0))}}},r.prototype.cancelChanges=function(){this.state=a.EditorState.FINISHED,this.discardEditor()},r.prototype.discardEditor=function(e){this.state===a.EditorState.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=a.EditorState.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=a.EditorState.VIRGIN,this._fireCallbacks(!0)))},r.prototype.enableFullEditMode=function(){this._fullEditMode=!0},r.prototype.isInFullEditMode=function(){return this._fullEditMode},r.prototype.isOpened=function(){return this._opened},r.prototype.isWaiting=function(){return this.state===a.EditorState.WAITING},r.prototype.checkEditorSection=function(){var e=this.instance.countRows(),t="";return this.row<this.instance.getSettings().fixedRowsTop?t=this.col<this.instance.getSettings().fixedColumnsLeft?"top-left-corner":"top":this.instance.getSettings().fixedRowsBottom&&this.row>=e-this.instance.getSettings().fixedRowsBottom?t=this.col<this.instance.getSettings().fixedColumnsLeft?"bottom-left-corner":"bottom":this.col<this.instance.getSettings().fixedColumnsLeft&&(t="left"),t}},{"3rdparty/walkontable/src/cell/coords":6,browser:24,"helpers/mixed":51}],32:[function(e,t,n){"use strict";function r(e){k=!1;var t=this.getActiveEditor();if(f(e.keyCode)||e.keyCode===h.BACKSPACE||e.keyCode===h.DELETE||e.keyCode===h.INSERT){var n=0;if(e.keyCode===h.C&&(e.ctrlKey||e.metaKey))return;t.isOpened()||(n+=10),t.htEditor&&t.instance._registerTimeout(setTimeout(function(){t.queryChoices(t.TEXTAREA.value),k=!0},n))}}Object.defineProperties(n,{AutocompleteEditor:{get:function(){return x}},__esModule:{value:!0}});var o,i,s,a,l,u,d,c=(o=e("helpers/unicode"),o&&o.__esModule&&o||{default:o}),h=c.KEY_CODES,f=c.isPrintableChar,p=(i=e("helpers/mixed"),i&&i.__esModule&&i||{default:i}).stringify,m=(s=e("helpers/string"),s&&s.__esModule&&s||{default:s}).stripTags,g=(a=e("helpers/array"),a&&a.__esModule&&a||{default:a}),v=g.pivot,w=(g.arrayFilter,g.arrayMap),b=(l=e("helpers/dom/element"),l&&l.__esModule&&l||{default:l}),y=b.addClass,_=b.getCaretPosition,C=b.getScrollbarWidth,R=b.getSelectionEndPosition,M=b.outerWidth,E=b.outerHeight,S=b.offset,O=b.getTrimmingContainer,T=b.setCaretPosition,A=(u=e("editors"),u&&u.__esModule&&u||{default:u}).registerEditor,N=(d=e("handsontableEditor"),d&&d.__esModule&&d||{default:d}).HandsontableEditor,x=N.prototype.extend();x.prototype.init=function(){N.prototype.init.apply(this,arguments),this.query=null,this.choices=[]},x.prototype.createElements=function(){N.prototype.createElements.apply(this,arguments),y(this.htContainer,"autocompleteEditor"),y(this.htContainer,window.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll")};var k=!1;x.prototype.prepare=function(){this.instance.addHook("beforeKeyDown",r),N.prototype.prepare.apply(this,arguments)},x.prototype.open=function(){this.TEXTAREA_PARENT.style.overflow="auto",N.prototype.open.apply(this,arguments),this.TEXTAREA_PARENT.style.overflow="";var e=this.htEditor.getInstance(),t=this,n=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown;this.TEXTAREA.style.visibility="visible",this.focus(),e.updateSettings({colWidths:n?[M(this.TEXTAREA)-2]:void 0,width:n?M(this.TEXTAREA)+C()+2:void 0,afterRenderer:function(e,n,r,o,i,s){var a,l,u=t.cellProperties,d=u.filteringCaseSensitive,c=u.allowHtml;i=p(i),i&&!c&&(a=d===!0?i.indexOf(this.query):i.toLowerCase().indexOf(t.query.toLowerCase()),a!==-1&&(l=i.substr(a,t.query.length),i=i.replace(l,"<strong>"+l+"</strong>"))),e.innerHTML=i},autoColumnSize:!0,modifyColWidth:function(e,t){var r=this.getPlugin("autoColumnSize").widths;return r[t]&&(e=r[t]),n?e:e+15}}),this.htEditor.view.wt.wtTable.holder.parentNode.style["padding-right"]=C()+2+"px",k&&(k=!1),t.instance._registerTimeout(setTimeout(function(){t.queryChoices(t.TEXTAREA.value)},0))},x.prototype.close=function(){N.prototype.close.apply(this,arguments)},x.prototype.queryChoices=function(e){var t=this;this.query=e;var n=this.cellProperties,r=n.source,o=(n.filter,n.filteringCaseSensitive,n.allowHtml),i=function(e){return w(e,function(e){return m(e)})};"function"==typeof r?r.call(this.cellProperties,e,function(e){t.updateChoicesList(o?e:i(e))}):Array.isArray(r)?this.updateChoicesList(o?r:i(r)):this.updateChoicesList([])},x.prototype.updateChoicesList=function(e){var t=_(this.TEXTAREA),n=R(this.TEXTAREA),r=this.cellProperties.sortByRelevance,o=this.cellProperties.filter,i=null,s=null;r&&(i=x.sortByRelevance(this.getValue(),e,this.cellProperties.filteringCaseSensitive));var a=Array.isArray(i)?i.length:0;if(o===!1)a&&(s=i[0]);else{for(var l=[],u=0,d=e.length;u<d&&!(r&&a<=u);u++)a?l.push(e[i[u]]):l.push(e[u]);s=0,e=l}this.choices=e,this.htEditor.loadData(v([e])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(s),this.instance.listen(),this.TEXTAREA.focus(),T(this.TEXTAREA,t,t===n?void 0:n)},x.prototype.flipDropdownIfNeeded=function(){var e=S(this.TEXTAREA),t=E(this.TEXTAREA),n=this.getDropdownHeight(),r=O(this.instance.view.wt.wtTable.TABLE),o=r.scrollTop,i=E(this.instance.view.wt.wtTable.THEAD),s={row:0,col:0};r!==window&&(s=S(r));var a=e.top-s.top-i+o,l=r.scrollHeight-a-i-t,u=n>l&&a>l;return u?this.flipDropdown(n):this.unflipDropdown(),this.limitDropdownIfNeeded(u?a:l,n),u},x.prototype.limitDropdownIfNeeded=function(e,t){if(t>e){var n=0,r=0,o=0,i=null;do o=this.htEditor.getRowHeight(r)||this.htEditor.view.wt.wtSettings.settings.defaultRowHeight,n+=o,r++;while(n<e);i=n-o,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+t-i+"px"),this.setDropdownHeight(n-o)}},x.prototype.flipDropdown=function(e){var t=this.htEditor.rootElement.style;t.position="absolute",t.top=-e+"px",this.htEditor.flipped=!0},x.prototype.unflipDropdown=function(){var e=this.htEditor.rootElement.style;"absolute"===e.position&&(e.position="",e.top=""),this.htEditor.flipped=void 0},x.prototype.updateDropdownHeight=function(){var e=this.htEditor.getColWidth(0)+C()+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer()},x.prototype.setDropdownHeight=function(e){this.htEditor.updateSettings({height:e})},x.prototype.finishEditing=function(e){e||this.instance.removeHook("beforeKeyDown",r),N.prototype.finishEditing.apply(this,arguments)},x.prototype.highlightBestMatchingChoice=function(e){"number"==typeof e?this.htEditor.selectCell(e,0):this.htEditor.deselectCell()},x.sortByRelevance=function(e,t,n){var r,o,i,s,a=[],l=e.length,u=[],d=t.length;if(0===l){for(s=0;s<d;s++)u.push(s);return u}for(s=0;s<d;s++)r=m(p(t[s])),o=n?r.indexOf(e):r.toLowerCase().indexOf(e.toLowerCase()),o!=-1&&(i=r.length-o-l,a.push({baseIndex:s,index:o,charsLeft:i,value:r}));for(a.sort(function(e,t){return t.index===-1?-1:e.index===-1?1:e.index<t.index?-1:t.index<e.index?1:e.index===t.index?e.charsLeft<t.charsLeft?-1:e.charsLeft>t.charsLeft?1:0:void 0}),s=0,d=a.length;s<d;s++)u.push(a[s].baseIndex);return u},x.prototype.getDropdownHeight=function(){var e=this.htEditor.getInstance().getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.choices.length>=t?t*e:this.choices.length*e+8},x.prototype.allowKeyEventPropagation=function(e){var t={row:this.htEditor.getSelectedRange()?this.htEditor.getSelectedRange().from.row:-1},n=!1;return e===h.ARROW_DOWN&&t.row>0&&t.row<this.htEditor.countRows()-1&&(n=!0),e===h.ARROW_UP&&t.row>-1&&(n=!0),n},x.prototype.discardEditor=function(e){N.prototype.discardEditor.apply(this,arguments),this.instance.view.render()},A("autocomplete",x)},{editors:30,handsontableEditor:36,"helpers/array":43,"helpers/dom/element":47,"helpers/mixed":51,"helpers/string":55,"helpers/unicode":56}],33:[function(e,t,n){"use strict";Object.defineProperties(n,{CheckboxEditor:{get:function(){return u}},__esModule:{value:!0}});var r,o,i,s=(r=e("editors"),r&&r.__esModule&&r||{default:r}).registerEditor,a=(o=e("_baseEditor"),o&&o.__esModule&&o||{default:o}).BaseEditor,l=(i=e("helpers/dom/element"),i&&i.__esModule&&i||{default:i}).hasClass,u=function(){$traceurRuntime.superConstructor(d).apply(this,arguments)},d=u;$traceurRuntime.createClass(u,{beginEditing:function(e,t){if(void 0===t){var n=this.TD.querySelector('input[type="checkbox"]');l(n,"htBadValue")||n.click()}},finishEditing:function(){},init:function(){},open:function(){},close:function(){},getValue:function(){},setValue:function(){},focus:function(){}},{},a),s("checkbox",u)},{_baseEditor:31,editors:30,"helpers/dom/element":47}],34:[function(e,t,n){"use strict";Object.defineProperties(n,{DateEditor:{get:function(){return S}},__esModule:{value:!0}});var r,o,i,s,a,l,u,d,c,h,f=(r=e("browser"),r&&r.__esModule&&r||{default:r}).default,p=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{default:o}),m=p.addClass,g=p.outerHeight,v=(i=e("helpers/object"),i&&i.__esModule&&i||{default:i}).deepExtend,w=(s=e("eventManager"),s&&s.__esModule&&s||{default:s}).EventManager,b=(a=e("editors"),a&&a.__esModule&&a||{default:a}),y=(b.getEditor,b.registerEditor),_=(l=e("helpers/unicode"),l&&l.__esModule&&l||{default:l}).isMetaKey,C=(u=e("helpers/dom/event"),u&&u.__esModule&&u||{default:u}).stopPropagation,R=(d=e("textEditor"),d&&d.__esModule&&d||{default:d}).TextEditor,M=(c=e("moment"),c&&c.__esModule&&c||{default:c}).default,E=(h=e("pikaday"),h&&h.__esModule&&h||{default:h}).default,S=function(e){this.$datePicker=null,this.datePicker=null,this.datePickerStyle=null,this.defaultDateFormat="DD/MM/YYYY",this.isCellEdited=!1,this.parentDestroyed=!1,$traceurRuntime.superConstructor(O).call(this,e)},O=S;$traceurRuntime.createClass(S,{init:function(){var e=this;if("function"!=typeof M)throw new Error("You need to include moment.js to your project.");if("function"!=typeof E)throw new Error("You need to include Pikaday to your project.");$traceurRuntime.superGet(this,O.prototype,"init").call(this),this.instance.addHook("afterDestroy",function(){e.parentDestroyed=!0,e.destroyElements()})},createElements:function(){$traceurRuntime.superGet(this,O.prototype,"createElements").call(this),this.datePicker=document.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,m(this.datePicker,"htDatepickerHolder"),document.body.appendChild(this.datePicker),this.$datePicker=new E(this.getDatePickerConfig());var e=new w(this);e.addEventListener(this.datePicker,"mousedown",function(e){return C(e)}),this.hideDatepicker()},destroyElements:function(){this.$datePicker.destroy()},prepare:function(e,t,n,r,o,i){this._opened=!1,$traceurRuntime.superGet(this,O.prototype,"prepare").call(this,e,t,n,r,o,i)},open:function(){var e=void 0!==arguments[0]?arguments[0]:null;$traceurRuntime.superGet(this,O.prototype,"open").call(this),this.showDatepicker(e)},close:function(){var e=this;this._opened=!1,this.instance._registerTimeout(setTimeout(function(){e.instance.selection.refreshBorders()},0)),$traceurRuntime.superGet(this,O.prototype,"close").call(this)},finishEditing:function(){var e=void 0!==arguments[0]&&arguments[0],t=void 0!==arguments[1]&&arguments[1];if(e){var n=this.originalValue;void 0!==n&&this.setValue(n)}this.hideDatepicker(),$traceurRuntime.superGet(this,O.prototype,"finishEditing").call(this,e,t)},showDatepicker:function(e){this.$datePicker.config(this.getDatePickerConfig());var t,n=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,o=this.$datePicker.config(),i=this.instance.view.isMouseDown(),s=!!e&&_(e.keyCode);this.datePickerStyle.top=window.pageYOffset+n.top+g(this.TD)+"px",this.datePickerStyle.left=window.pageXOffset+n.left+"px",this.$datePicker._onInputFocus=function(){},o.format=r,this.originalValue?(t=this.originalValue,M(t,r,!0).isValid()&&this.$datePicker.setMoment(M(t,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),s||i||this.setValue("")):this.cellProperties.defaultDate?(t=this.cellProperties.defaultDate,o.defaultDate=t,M(t,r,!0).isValid()&&this.$datePicker.setMoment(M(t,r),!0),s||i||this.setValue("")):this.$datePicker.gotoToday(),this.datePickerStyle.display="block",this.$datePicker.show()},hideDatepicker:function(){this.datePickerStyle.display="none",this.$datePicker.hide()},getDatePickerConfig:function(){var e=this,t=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&v(n,this.cellProperties.datePickerConfig);var r=n.onSelect,o=n.onClose;return n.field=t,n.trigger=t,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.onSelect=function(t){isNaN(t.getTime())||(t=M(t).format(e.cellProperties.dateFormat||e.defaultDateFormat)),e.setValue(t),e.hideDatepicker(),r&&r()},n.onClose=function(){e.parentDestroyed||e.finishEditing(!1),o&&o()},n}},{},R),f.editors=f.editors||{},f.editors.DateEditor=S,y("date",S)},{browser:24,editors:30,eventManager:42,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/object":53,"helpers/unicode":56,moment:"moment",pikaday:"pikaday",textEditor:41}],35:[function(e,t,n){"use strict";Object.defineProperties(n,{DropdownEditor:{get:function(){return d}},__esModule:{value:!0}});var r,o,i,s=(r=e("browser"),r&&r.__esModule&&r||{default:r}).default,a=(o=e("editors"),o&&o.__esModule&&o||{default:o}),l=(a.getEditor,a.registerEditor),u=(a.getEditorConstructor,(i=e("autocompleteEditor"),i&&i.__esModule&&i||{default:i}).AutocompleteEditor),d=function(){$traceurRuntime.superConstructor(c).apply(this,arguments)},c=d;$traceurRuntime.createClass(d,{prepare:function(e,t,n,r,o,i){$traceurRuntime.superGet(this,c.prototype,"prepare").call(this,e,t,n,r,o,i),this.cellProperties.filter=!1,this.cellProperties.strict=!0}},{},u),s.hooks.add("beforeValidate",function(e,t,n,r){var o=this.getCellMeta(t,this.propToCol(n));o.editor===s.editors.DropdownEditor&&void 0===o.strict&&(o.filter=!1,o.strict=!0)}),l("dropdown",d)},{autocompleteEditor:32,browser:24,editors:30}],36:[function(e,t,n){"use strict";Object.defineProperties(n,{HandsontableEditor:{get:function(){return y}},__esModule:{value:!0}});var r,o,i,s,a,l,u,d=(r=e("browser"),r&&r.__esModule&&r||{default:r}).default,c=(o=e("helpers/unicode"),o&&o.__esModule&&o||{default:o}).KEY_CODES,h=(i=e("helpers/object"),i&&i.__esModule&&i||{default:i}).extend,f=(s=e("helpers/dom/element"),s&&s.__esModule&&s||{default:s}).setCaretPosition,p=(a=e("helpers/dom/event"),a&&a.__esModule&&a||{default:a}),m=p.stopImmediatePropagation,g=p.isImmediatePropagationStopped,v=(l=e("editors"),l&&l.__esModule&&l||{default:l}),w=(v.getEditor,v.registerEditor),b=(u=e("textEditor"),u&&u.__esModule&&u||{default:u}).TextEditor,y=b.prototype.extend();y.prototype.createElements=function(){b.prototype.createElements.apply(this,arguments);var e=document.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()},y.prototype.prepare=function(e,t,n,r,o,i){b.prototype.prepare.apply(this,arguments);var s=this,a={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,afterOnCellMouseDown:function(){var e=this.getValue();void 0!==e&&s.setValue(e),s.instance.destroyEditor()}};this.cellProperties.handsontable&&h(a,i.handsontable),this.htOptions=a};var _=function(e){if(!g(e)){var t,n=this.getActiveEditor(),r=n.htEditor.getInstance();if(e.keyCode==c.ARROW_DOWN)if(r.getSelected()||r.flipped){if(r.getSelected())if(r.flipped)t=r.getSelected()[0]+1;else if(!r.flipped){var o=r.getSelected()[0],i=r.countRows()-1;t=Math.min(i,o+1)}}else t=0;else if(e.keyCode==c.ARROW_UP)if(!r.getSelected()&&r.flipped)t=r.countRows()-1;else if(r.getSelected())if(r.flipped){var o=r.getSelected()[0];t=Math.max(0,o-1)}else{var o=r.getSelected()[0];t=o-1}void 0!==t&&(t<0||r.flipped&&t>r.countRows()-1?r.deselectCell():r.selectCell(t,0),r.getData().length&&(e.preventDefault(),m(e),n.instance.listen(),n.TEXTAREA.focus()))}};y.prototype.open=function(){this.instance.addHook("beforeKeyDown",_),b.prototype.open.apply(this,arguments),this.htEditor&&this.htEditor.destroy(),this.htEditor=new d(this.htContainer,this.htOptions),this.cellProperties.strict?(this.htEditor.selectCell(0,0),this.TEXTAREA.style.visibility="hidden"):(this.htEditor.deselectCell(),this.TEXTAREA.style.visibility="visible"),f(this.TEXTAREA,0,this.TEXTAREA.value.length)},y.prototype.close=function(){this.instance.removeHook("beforeKeyDown",_),this.instance.listen(),b.prototype.close.apply(this,arguments)},y.prototype.focus=function(){this.instance.listen(),b.prototype.focus.apply(this,arguments)},y.prototype.beginEditing=function(e){var t=this.instance.getSettings().onBeginEditing;t&&t()===!1||b.prototype.beginEditing.apply(this,arguments)},y.prototype.finishEditing=function(e,t){if(this.htEditor&&this.htEditor.isListening()&&this.instance.listen(),this.htEditor&&this.htEditor.getSelected()){var n=this.htEditor.getInstance().getValue();void 0!==n&&this.setValue(n)}return b.prototype.finishEditing.apply(this,arguments)},y.prototype.assignHooks=function(){var e=this;this.instance.addHook("afterDestroy",function(){e.htEditor&&e.htEditor.destroy()})},w("handsontable",y)},{browser:24,editors:30,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/object":53,"helpers/unicode":56,textEditor:41}],37:[function(e,t,n){"use strict";Object.defineProperties(n,{MobileTextEditor:{get:function(){return A}},__esModule:{value:!0}});var r,o,i,s,a,l,u,d=((r=e("browser"),r&&r.__esModule&&r||{default:r}).default,(o=e("helpers/unicode"),o&&o.__esModule&&o||{default:o}).KEY_CODES),c=(i=e("helpers/dom/event"),i&&i.__esModule&&i||{default:i}),h=c.stopImmediatePropagation,f=c.isImmediatePropagationStopped,p=(s=e("helpers/dom/element"),s&&s.__esModule&&s||{default:s}),m=p.addClass,g=p.getScrollLeft,v=p.getScrollTop,w=p.hasClass,b=p.isChildOf,y=p.offset,_=p.outerHeight,C=p.outerWidth,R=p.removeClass,M=p.setCaretPosition,E=(a=e("editors"),a&&a.__esModule&&a||{default:a}),S=(E.getEditor,E.registerEditor),O=(l=e("_baseEditor"),l&&l.__esModule&&l||{default:l}).BaseEditor,T=(u=e("eventManager"),u&&u.__esModule&&u||{default:u}).eventManager,A=O.prototype.extend(),N={},x=function(){this.controls={},this.controls.leftButton=document.createElement("DIV"),this.controls.leftButton.className="leftButton",this.controls.rightButton=document.createElement("DIV"),this.controls.rightButton.className="rightButton",this.controls.upButton=document.createElement("DIV"),this.controls.upButton.className="upButton",this.controls.downButton=document.createElement("DIV"),this.controls.downButton.className="downButton";for(var e in this.controls)this.controls.hasOwnProperty(e)&&this.positionControls.appendChild(this.controls[e])};A.prototype.valueChanged=function(){return this.initValue!=this.getValue()},A.prototype.init=function(){var e=this;this.eventManager=T(this.instance),this.createElements(),this.bindEvents(),this.instance.addHook("afterDestroy",function(){e.destroy()})},A.prototype.getValue=function(){return this.TEXTAREA.value},A.prototype.setValue=function(e){this.initValue=e,this.TEXTAREA.value=e},A.prototype.createElements=function(){this.editorContainer=document.createElement("DIV"),this.editorContainer.className="htMobileEditorContainer",this.cellPointer=document.createElement("DIV"),this.cellPointer.className="cellPointer",this.moveHandle=document.createElement("DIV"),this.moveHandle.className="moveHandle",this.inputPane=document.createElement("DIV"),this.inputPane.className="inputs",this.positionControls=document.createElement("DIV"),this.positionControls.className="positionControls",this.TEXTAREA=document.createElement("TEXTAREA"),m(this.TEXTAREA,"handsontableInput"),this.inputPane.appendChild(this.TEXTAREA),this.editorContainer.appendChild(this.cellPointer),this.editorContainer.appendChild(this.moveHandle),this.editorContainer.appendChild(this.inputPane),this.editorContainer.appendChild(this.positionControls),x.call(this),document.body.appendChild(this.editorContainer)},A.prototype.onBeforeKeyDown=function(e){var t=this,n=t.getActiveEditor();if(e.target===n.TEXTAREA&&!f(e))switch(e.keyCode){case d.ENTER:n.close(),e.preventDefault();break;case d.BACKSPACE:h(e)}},A.prototype.open=function(){this.instance.addHook("beforeKeyDown",this.onBeforeKeyDown),m(this.editorContainer,"active"),R(this.cellPointer,"hidden"),this.updateEditorPosition()},A.prototype.focus=function(){this.TEXTAREA.focus(),M(this.TEXTAREA,this.TEXTAREA.value.length)},A.prototype.close=function(){this.TEXTAREA.blur(),this.instance.removeHook("beforeKeyDown",this.onBeforeKeyDown),R(this.editorContainer,"active")},A.prototype.scrollToView=function(){var e=this.instance.getSelectedRange().highlight;this.instance.view.scrollViewport(e)},A.prototype.hideCellPointer=function(){w(this.cellPointer,"hidden")||m(this.cellPointer,"hidden")},A.prototype.updateEditorPosition=function(e,t){if(e&&t)e=parseInt(e,10),t=parseInt(t,10),this.editorContainer.style.top=t+"px",this.editorContainer.style.left=e+"px";else{var n=this.instance.getSelected(),r=this.instance.getCell(n[0],n[1]);if(N.cellPointer||(N.cellPointer={height:_(this.cellPointer),width:C(this.cellPointer)}),N.editorContainer||(N.editorContainer={width:C(this.editorContainer)}),void 0!==r){var o=this.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer==window?0:g(this.instance.view.wt.wtOverlays.leftOverlay.holder),i=this.instance.view.wt.wtOverlays.topOverlay.trimmingContainer==window?0:v(this.instance.view.wt.wtOverlays.topOverlay.holder),s=y(r),a=C(r),l={x:o,y:i};this.editorContainer.style.top=parseInt(s.top+_(r)-l.y+N.cellPointer.height,10)+"px",this.editorContainer.style.left=parseInt(window.innerWidth/2-N.editorContainer.width/2,10)+"px",s.left+a/2>parseInt(this.editorContainer.style.left,10)+N.editorContainer.width?this.editorContainer.style.left=window.innerWidth-N.editorContainer.width+"px":s.left+a/2<parseInt(this.editorContainer.style.left,10)+20&&(this.editorContainer.style.left="0px"),this.cellPointer.style.left=parseInt(s.left-N.cellPointer.width/2-y(this.editorContainer).left+a/2-l.x,10)+"px"}}},A.prototype.updateEditorData=function(){var e=this.instance.getSelected(),t=this.instance.getDataAtCell(e[0],e[1]);this.row=e[0],this.col=e[1],this.setValue(t),this.updateEditorPosition()},A.prototype.prepareAndSave=function(){var e;return!this.valueChanged()||(e=this.instance.getSettings().trimWhitespace?[[String.prototype.trim.call(this.getValue())]]:[[this.getValue()]],void this.saveValue(e))},A.prototype.bindEvents=function(){var e=this;this.eventManager.addEventListener(this.controls.leftButton,"touchend",function(t){e.prepareAndSave(),e.instance.selection.transformStart(0,-1,null,!0),e.updateEditorData(),t.preventDefault()}),this.eventManager.addEventListener(this.controls.rightButton,"touchend",function(t){e.prepareAndSave(),e.instance.selection.transformStart(0,1,null,!0),e.updateEditorData(),t.preventDefault()}),this.eventManager.addEventListener(this.controls.upButton,"touchend",function(t){e.prepareAndSave(),e.instance.selection.transformStart(-1,0,null,!0),e.updateEditorData(),t.preventDefault()}),this.eventManager.addEventListener(this.controls.downButton,"touchend",function(t){e.prepareAndSave(),e.instance.selection.transformStart(1,0,null,!0),e.updateEditorData(),t.preventDefault()}),this.eventManager.addEventListener(this.moveHandle,"touchstart",function(t){if(1==t.touches.length){var n=t.touches[0],r={x:e.editorContainer.offsetLeft,y:e.editorContainer.offsetTop},o={x:n.pageX-r.x,y:n.pageY-r.y};e.eventManager.addEventListener(this,"touchmove",function(t){var n=t.touches[0];e.updateEditorPosition(n.pageX-o.x,n.pageY-o.y),e.hideCellPointer(),t.preventDefault()})}}),this.eventManager.addEventListener(document.body,"touchend",function(t){b(t.target,e.editorContainer)||b(t.target,e.instance.rootElement)||e.close()}),this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.leftOverlay.holder,"scroll",function(t){e.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer!=window&&e.hideCellPointer()}),this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.topOverlay.holder,"scroll",function(t){e.instance.view.wt.wtOverlays.topOverlay.trimmingContainer!=window&&e.hideCellPointer()})},A.prototype.destroy=function(){this.eventManager.clear(),this.editorContainer.parentNode.removeChild(this.editorContainer)},S("mobile",A)},{_baseEditor:31,browser:24,editors:30,eventManager:42,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/unicode":56}],38:[function(e,t,n){"use strict";Object.defineProperties(n,{NumericEditor:{get:function(){return u}},__esModule:{value:!0}});var r,o,i,s=(r=e("numbro"),r&&r.__esModule&&r||{default:r}).default,a=(o=e("editors"),o&&o.__esModule&&o||{default:o}).registerEditor,l=(i=e("textEditor"),i&&i.__esModule&&i||{default:i}).TextEditor,u=function(){$traceurRuntime.superConstructor(d).apply(this,arguments)},d=u;$traceurRuntime.createClass(u,{beginEditing:function(e){if("undefined"==typeof e&&this.originalValue){"undefined"!=typeof this.cellProperties.language&&s.culture(this.cellProperties.language);var t=s.cultureData().delimiters.decimal;e=(""+this.originalValue).replace(".",t)}$traceurRuntime.superGet(this,d.prototype,"beginEditing").call(this,e)}},{},l),a("numeric",u)},{editors:30,numbro:"numbro",textEditor:41}],39:[function(e,t,n){"use strict";Object.defineProperties(n,{PasswordEditor:{get:function(){return c}},__esModule:{value:!0}});var r,o,i,s,a=((r=e("browser"),r&&r.__esModule&&r||{default:r}).default,(o=e("helpers/dom/element"),o&&o.__esModule&&o||{default:o}).empty),l=(i=e("editors"),i&&i.__esModule&&i||{default:i}),u=(l.getEditor,l.registerEditor),d=(s=e("textEditor"),s&&s.__esModule&&s||{default:s}).TextEditor,c=function(){$traceurRuntime.superConstructor(h).apply(this,arguments)},h=c;$traceurRuntime.createClass(c,{createElements:function(){$traceurRuntime.superGet(this,h.prototype,"createElements").call(this),this.TEXTAREA=document.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,a(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}},{},d),u("password",c)},{browser:24,editors:30,"helpers/dom/element":47,textEditor:41}],40:[function(e,t,n){"use strict";Object.defineProperties(n,{SelectEditor:{get:function(){return S}},__esModule:{value:!0}});var r,o,i,s,a,l,u=(r=e("browser"),r&&r.__esModule&&r||{default:r}).default,d=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{default:o}),c=d.addClass,h=d.empty,f=d.fastInnerHTML,p=d.getComputedStyle,m=d.getCssTransform,g=d.getScrollableElement,v=d.offset,w=d.outerHeight,b=d.outerWidth,y=d.resetCssTransform,_=(i=e("helpers/dom/event"),i&&i.__esModule&&i||{default:i}).stopImmediatePropagation,C=(s=e("helpers/unicode"),s&&s.__esModule&&s||{default:s}).KEY_CODES,R=(a=e("editors"),a&&a.__esModule&&a||{default:a}),M=(R.getEditor,R.registerEditor),E=(l=e("_baseEditor"),l&&l.__esModule&&l||{default:l}).BaseEditor,S=E.prototype.extend();S.prototype.init=function(){this.select=document.createElement("SELECT"),c(this.select,"htSelectEditor"),this.select.style.display="none",this.instance.rootElement.appendChild(this.select),this.registerHooks()},S.prototype.registerHooks=function(){var e=this;this.instance.addHook("afterScrollHorizontally",function(){return e.refreshDimensions()}),this.instance.addHook("afterScrollVertically",function(){return e.refreshDimensions()}),this.instance.addHook("afterColumnResize",function(){return e.refreshDimensions()}),this.instance.addHook("afterRowResize",function(){return e.refreshDimensions()})},S.prototype.prepare=function(){E.prototype.prepare.apply(this,arguments);var e,t=this.cellProperties.selectOptions;e="function"==typeof t?this.prepareOptions(t(this.row,this.col,this.prop)):this.prepareOptions(t),h(this.select);for(var n in e)if(e.hasOwnProperty(n)){var r=document.createElement("OPTION");r.value=n,f(r,e[n]),this.select.appendChild(r)}},S.prototype.prepareOptions=function(e){var t={};if(Array.isArray(e))for(var n=0,r=e.length;n<r;n++)t[e[n]]=e[n];else"object"==typeof e&&(t=e);return t},S.prototype.getValue=function(){return this.select.value},S.prototype.setValue=function(e){this.select.value=e};var O=function(e){var t=this,n=t.getActiveEditor();switch(e.keyCode){case C.ARROW_UP:var r=n.select.selectedIndex-1;r>=0&&(n.select[r].selected=!0),_(e),e.preventDefault();break;case C.ARROW_DOWN:var o=n.select.selectedIndex+1;o<=n.select.length-1&&(n.select[o].selected=!0),_(e),e.preventDefault()}};S.prototype.open=function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.instance.addHook("beforeKeyDown",O)},S.prototype.close=function(){this._opened=!1,this.select.style.display="none",this.instance.removeHook("beforeKeyDown",O)},S.prototype.focus=function(){this.select.focus()},S.prototype.refreshDimensions=function(){if(this.state===u.EditorState.EDITING){if(this.TD=this.getEditedCell(),!this.TD)return void this.close();var e,t=b(this.TD)+1,n=w(this.TD)+1,r=v(this.TD),o=v(this.instance.rootElement),i=g(this.TD),s=r.top-o.top-1-(i.scrollTop||0),a=r.left-o.left-1-(i.scrollLeft||0),l=this.checkEditorSection(),d=this.instance.getSettings();d.rowHeaders?1:0,d.colHeaders?1:0;switch(l){case"top":e=m(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":e=m(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":e=m(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":e=m(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":e=m(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode)}0===this.instance.getSelected()[0]&&(s+=1),0===this.instance.getSelected()[1]&&(a+=1);var c=this.select.style;e&&e!=-1?c[e[0]]=e[1]:y(this.select);var h=p(this.TD);parseInt(h.borderTopWidth,10)>0&&(n-=1),parseInt(h.borderLeftWidth,10)>0&&(t-=1),c.height=n+"px",c.minWidth=t+"px",c.top=s+"px",c.left=a+"px",c.margin="0px"}},S.prototype.getEditedCell=function(){var e,t=this.checkEditorSection();switch(t){case"top":e=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({
row:this.row,col:this.col}),this.select.style.zIndex=101;break;case"corner":e=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=103;break;case"left":e=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=102;break;default:e=this.instance.getCell(this.row,this.col),this.select.style.zIndex=""}return e!=-1&&e!=-2?e:void 0},M("select",S)},{_baseEditor:31,browser:24,editors:30,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/unicode":56}],41:[function(e,t,n){"use strict";Object.defineProperties(n,{TextEditor:{get:function(){return P}},__esModule:{value:!0}});var r,o,i,s,a,l,u,d,c=(r=e("browser"),r&&r.__esModule&&r||{default:r}).default,h=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{default:o}),f=h.addClass,p=h.getCaretPosition,m=h.getComputedStyle,g=h.getCssTransform,v=h.getScrollableElement,w=h.getScrollbarWidth,b=h.innerWidth,y=h.offset,_=h.resetCssTransform,C=h.setCaretPosition,R=h.hasVerticalScrollbar,M=h.hasHorizontalScrollbar,E=(i=e("autoResize"),i&&i.__esModule&&i||{default:i}).default,S=(s=e("_baseEditor"),s&&s.__esModule&&s||{default:s}).BaseEditor,O=(a=e("eventManager"),a&&a.__esModule&&a||{default:a}).eventManager,T=(l=e("editors"),l&&l.__esModule&&l||{default:l}),A=(T.getEditor,T.registerEditor),N=(u=e("helpers/unicode"),u&&u.__esModule&&u||{default:u}).KEY_CODES,x=(d=e("helpers/dom/event"),d&&d.__esModule&&d||{default:d}),k=x.stopPropagation,I=x.stopImmediatePropagation,D=x.isImmediatePropagationStopped,P=S.prototype.extend();P.prototype.init=function(){var e=this;this.createElements(),this.eventManager=O(this),this.bindEvents(),this.autoResize=E(),this.instance.addHook("afterDestroy",function(){e.destroy()})},P.prototype.getValue=function(){return this.TEXTAREA.value},P.prototype.setValue=function(e){this.TEXTAREA.value=e};var H=function(e){var t,n=this,r=n.getActiveEditor();if(t=(e.ctrlKey||e.metaKey)&&!e.altKey,e.target===r.TEXTAREA&&!D(e)){if(17===e.keyCode||224===e.keyCode||91===e.keyCode||93===e.keyCode)return void I(e);switch(e.keyCode){case N.ARROW_RIGHT:r.isInFullEditMode()&&(!r.isWaiting()&&!r.allowKeyEventPropagation||!r.isWaiting()&&r.allowKeyEventPropagation&&!r.allowKeyEventPropagation(e.keyCode))&&I(e);break;case N.ARROW_LEFT:r.isInFullEditMode()&&(!r.isWaiting()&&!r.allowKeyEventPropagation||!r.isWaiting()&&r.allowKeyEventPropagation&&!r.allowKeyEventPropagation(e.keyCode))&&I(e);break;case N.ARROW_UP:case N.ARROW_DOWN:r.isInFullEditMode()&&(!r.isWaiting()&&!r.allowKeyEventPropagation||!r.isWaiting()&&r.allowKeyEventPropagation&&!r.allowKeyEventPropagation(e.keyCode))&&I(e);break;case N.ENTER:var o=r.instance.getSelected(),i=!(o[0]===o[2]&&o[1]===o[3]);if(t&&!i||e.altKey){if(r.isOpened()){var s=p(r.TEXTAREA),a=r.getValue(),l=a.slice(0,s)+"\n"+a.slice(s);r.setValue(l),C(r.TEXTAREA,s+1)}else r.beginEditing(r.originalValue+"\n");I(e)}e.preventDefault();break;case N.A:case N.X:case N.C:case N.V:t&&I(e);break;case N.BACKSPACE:case N.DELETE:case N.HOME:case N.END:I(e)}[N.ARROW_UP,N.ARROW_RIGHT,N.ARROW_DOWN,N.ARROW_LEFT].indexOf(e.keyCode)===-1&&r.autoResize.resize(String.fromCharCode(e.keyCode))}};P.prototype.open=function(){this.refreshDimensions(),this.instance.addHook("beforeKeyDown",H)},P.prototype.close=function(e){this.textareaParentStyle.display="none",this.autoResize.unObserve(),document.activeElement===this.TEXTAREA&&this.instance.listen(),this.instance.removeHook("beforeKeyDown",H)},P.prototype.focus=function(){this.TEXTAREA.focus(),C(this.TEXTAREA,this.TEXTAREA.value.length)},P.prototype.createElements=function(){this.TEXTAREA=document.createElement("TEXTAREA"),f(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.TEXTAREA_PARENT=document.createElement("DIV"),f(this.TEXTAREA_PARENT,"handsontableInputHolder"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.textareaParentStyle.top=0,this.textareaParentStyle.left=0,this.textareaParentStyle.display="none",this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.instance.rootElement.appendChild(this.TEXTAREA_PARENT);var e=this;this.instance._registerTimeout(setTimeout(function(){e.refreshDimensions()},0))},P.prototype.getEditedCell=function(){var e,t=this.checkEditorSection();switch(t){case"top":e=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=101;break;case"top-left-corner":e=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=103;break;case"bottom-left-corner":e=this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=103;break;case"left":e=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=102;break;case"bottom":e=this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=102;break;default:e=this.instance.getCell(this.row,this.col),this.textareaParentStyle.zIndex=""}return e!=-1&&e!=-2?e:void 0},P.prototype.refreshDimensions=function(){if(this.state===c.EditorState.EDITING){if(this.TD=this.getEditedCell(),!this.TD)return void this.close(!0);var e,t=y(this.TD),n=y(this.instance.rootElement),r=v(this.TD),o=this.instance.countRows(),i=t.top===n.top?0:1,s=t.top-n.top-i-(r.scrollTop||0),a=t.left-n.left-1-(r.scrollLeft||0),l=this.instance.getSettings(),u=(this.instance.hasRowHeaders(),this.instance.hasColHeaders()),d=this.checkEditorSection(),h=this.TD.style.backgroundColor;switch(d){case"top":e=g(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":e=g(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":e=g(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":e=g(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":e=g(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode)}(u&&0===this.instance.getSelected()[0]||l.fixedRowsBottom&&this.instance.getSelected()[0]===o-l.fixedRowsBottom)&&(s+=1),0===this.instance.getSelected()[1]&&(a+=1),e&&e!=-1?this.textareaParentStyle[e[0]]=e[1]:_(this.TEXTAREA_PARENT),this.textareaParentStyle.top=s+"px",this.textareaParentStyle.left=a+"px";var f=this.instance.view.wt.wtViewport.rowsRenderCalculator.startPosition,p=this.instance.view.wt.wtViewport.columnsRenderCalculator.startPosition,C=this.instance.view.wt.wtOverlays.leftOverlay.getScrollPosition(),E=this.instance.view.wt.wtOverlays.topOverlay.getScrollPosition(),S=w(),O=this.TD.offsetTop+f-E,T=this.TD.offsetLeft+p-C,A=b(this.TD)-8,N=R(r)?S:0,x=M(r)?S:0,k=this.instance.view.maximumVisibleElementWidth(T)-9-N,I=this.TD.scrollHeight+1,D=Math.max(this.instance.view.maximumVisibleElementHeight(O)-x,23),P=m(this.TD);this.TEXTAREA.style.fontSize=P.fontSize,this.TEXTAREA.style.fontFamily=P.fontFamily,this.TEXTAREA.style.backgroundColor="",this.TEXTAREA.style.backgroundColor=h?h:m(this.TEXTAREA).backgroundColor,this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(I,D),maxHeight:D,minWidth:Math.min(A,k),maxWidth:k},!0),this.textareaParentStyle.display="block"}},P.prototype.bindEvents=function(){var e=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(e){k(e)}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(e){k(e)}),this.instance.addHook("afterScrollHorizontally",function(){e.refreshDimensions()}),this.instance.addHook("afterScrollVertically",function(){e.refreshDimensions()}),this.instance.addHook("afterColumnResize",function(){e.refreshDimensions(),e.focus()}),this.instance.addHook("afterRowResize",function(){e.refreshDimensions(),e.focus()}),this.instance.addHook("afterDestroy",function(){e.eventManager.destroy()})},P.prototype.destroy=function(){this.eventManager.destroy()},A("text",P)},{_baseEditor:31,autoResize:"autoResize",browser:24,editors:30,eventManager:42,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/unicode":56}],42:[function(e,t,n){"use strict";function r(e,t){var n,r,o,i,s,a,l="HOT-TABLE";if(t.isTargetWebComponent=!1,t.realTarget=t.target,a=t.stopImmediatePropagation,t.stopImmediatePropagation=function(){a.apply(this),p(this)},!u.eventManager.isHotTableEnv)return t;for(t=c(t),s=t.path?t.path.length:0;s--;){if(t.path[s].nodeName===l)n=!0;else if(n&&t.path[s].shadowRoot){i=t.path[s];break}0!==s||i||(i=t.path[s])}return i||(i=t.target),t.isTargetWebComponent=!0,f()?t.realTarget=t.srcElement||t.toElement:(e instanceof u.Core||e instanceof Walkontable)&&(e instanceof u.Core?r=e.view?e.view.wt.wtTable.TABLE:null:e instanceof Walkontable&&(r=e.wtTable.TABLE.parentNode.parentNode),o=h(t.target,[l],r),o?t.realTarget=r.querySelector(l)||t.target:t.realTarget=t.target),Object.defineProperty(t,"target",{get:function(){return c(i)},enumerable:!0,configurable:!0}),t}function o(e){return new m(e)}Object.defineProperties(n,{EventManager:{get:function(){return m}},eventManager:{get:function(){return o}},__esModule:{value:!0}});var i,s,a,l,u=(i=e("browser"),i&&i.__esModule&&i||{default:i}).default,d=(s=e("helpers/dom/element"),s&&s.__esModule&&s||{default:s}),c=d.polymerWrap,h=d.closest,f=(a=e("helpers/feature"),a&&a.__esModule&&a||{default:a}).isWebComponentSupportedNatively,p=(l=e("helpers/dom/event"),l&&l.__esModule&&l||{default:l}).stopImmediatePropagation,m=function(){var e=void 0!==arguments[0]?arguments[0]:null;this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])};$traceurRuntime.createClass(m,{addEventListener:function(e,t,n){function o(e){e=r(s,e),n.call(this,e)}var i=this,s=this.context;return this.context.eventListeners.push({element:e,event:t,callback:n,callbackProxy:o}),window.addEventListener?e.addEventListener(t,o,!1):e.attachEvent("on"+t,o),u.countEventManagerListeners++,function(){i.removeEventListener(e,t,n)}},removeEventListener:function(e,t,n){for(var r,o=this.context.eventListeners.length;o--;)if(r=this.context.eventListeners[o],r.event==t&&r.element==e){if(n&&n!=r.callback)continue;this.context.eventListeners.splice(o,1),r.element.removeEventListener?r.element.removeEventListener(r.event,r.callbackProxy,!1):r.element.detachEvent("on"+r.event,r.callbackProxy),u.countEventManagerListeners--}},clearEvents:function(){if(this.context)for(var e=this.context.eventListeners.length;e--;){var t=this.context.eventListeners[e];t&&this.removeEventListener(t.element,t.event,t.callback)}},clear:function(){this.clearEvents()},destroy:function(){this.clearEvents(),this.context=null},fireEvent:function(e,t){var n,r={bubbles:!0,cancelable:"mousemove"!==t,view:window,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};document.createEvent?(n=document.createEvent("MouseEvents"),n.initMouseEvent(t,r.bubbles,r.cancelable,r.view,r.detail,r.screenX,r.screenY,r.clientX,r.clientY,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.button,r.relatedTarget||document.body.parentNode)):n=document.createEventObject(),e.dispatchEvent?e.dispatchEvent(n):e.fireEvent("on"+t,n)}},{}),u.countEventManagerListeners=0,u.eventManager=o},{browser:24,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/feature":49}],43:[function(e,t,n){"use strict";function r(e){for(var t=0,n=e.length;t<n;)e[t]=[e[t]],t++}function o(e,t){for(var n=0,r=t.length;n<r;)e.push(t[n]),n++}function i(e){var t=[];if(!e||0===e.length||!e[0]||0===e[0].length)return t;for(var n=e.length,r=e[0].length,o=0;o<n;o++)for(var i=0;i<r;i++)t[i]||(t[i]=[]),t[i][o]=e[o][i];return t}function s(e,t,n,r){var o=-1,i=e.length;for(r&&i&&(n=e[++o]);++o<i;)n=t(n,e[o],o,e);return n}function a(e,t){for(var n=-1,r=e.length,o=-1,i=[];++n<r;){var s=e[n];t(s,n,e)&&(i[++o]=s)}return i}function l(e,t){for(var n=-1,r=e.length,o=-1,i=[];++n<r;){var s=e[n];i[++o]=t(s,n,e)}return i}function u(e,t){for(var n=-1,r=e.length;++n<r&&t(e[n],n,e)!==!1;);return e}function d(e){return s(e,function(e,t){return e+t},0)}function c(e){return s(e,function(e,t){return e>t?e:t},Array.isArray(e)?e[0]:void 0)}function h(e){return s(e,function(e,t){return e<t?e:t},Array.isArray(e)?e[0]:void 0)}function f(e){return e.length?d(e)/e.length:0}function p(e){return s(e,function(e,t){return e.concat(Array.isArray(t)?p(t):t)},[])}function m(e){var t=[];return u(e,function(e){t.indexOf(e)===-1&&t.push(e)}),t}Object.defineProperties(n,{to2dArray:{get:function(){return r}},extendArray:{get:function(){return o}},pivot:{get:function(){return i}},arrayReduce:{get:function(){return s}},arrayFilter:{get:function(){return a}},arrayMap:{get:function(){return l}},arrayEach:{get:function(){return u}},arraySum:{get:function(){return d}},arrayMax:{get:function(){return c}},arrayMin:{get:function(){return h}},arrayAvg:{get:function(){return f}},arrayFlatten:{get:function(){return p}},arrayUnique:{get:function(){return m}},__esModule:{value:!0}})},{}],44:[function(e,t,n){"use strict";function r(){return l}function o(){return u}function i(){return d}function s(){return c}function a(e){return e||(e=navigator.userAgent),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}Object.defineProperties(n,{isIE8:{get:function(){return r}},isIE9:{get:function(){return o}},isSafari:{get:function(){return i}},isChrome:{get:function(){return s}},isMobileBrowser:{get:function(){return a}},__esModule:{value:!0}});var l=!document.createTextNode("test").textContent,u=!!document.documentMode,d=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor),c=/Chrome/.test(navigator.userAgent)&&/Google/.test(navigator.vendor)},{}],45:[function(e,t,n){"use strict";function r(e){for(var t,n=e+1,r="";n>0;)t=(n-1)%m,r=String.fromCharCode(65+t)+r,n=parseInt((n-t)/m,10);return r}function o(e){var t=0;if(e)for(var n=0,r=e.length-1;n<e.length;n+=1,r-=1)t+=Math.pow(m,r)*(p.indexOf(e[n])+1);return--t,t}function i(){var e,t,n=void 0!==arguments[0]?arguments[0]:100,o=void 0!==arguments[1]?arguments[1]:4,i=[];for(e=0;e<n;e++){var s=[];for(t=0;t<o;t++)s.push(r(t)+(e+1));i.push(s)}return i}function s(){var e,t,n=void 0!==arguments[0]?arguments[0]:100,o=void 0!==arguments[1]?arguments[1]:4,i=[];for(e=0;e<n;e++){var s={};for(t=0;t<o;t++)s["prop"+t]=r(t)+(e+1);i.push(s)}return i}function a(e,t){for(var n,r=[],o=0;o<e;o++){n=[];for(var i=0;i<t;i++)n.push("");r.push(n)}return r}function l(e){var t,n,r,o,i=[],s=0;for(t=0,n=e.length;t<n;t++)for(r=0,o=e[t].length;r<o;r++)r==s&&(i.push([]),s++),i[r].push(e[t][r]);return i}function u(e,t){function n(e){var t=h.cellTypes[e];if("undefined"==typeof t)throw new Error('You declared cell type "'+e+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');return t}return t="undefined"==typeof t||t,function(r,o){return function r(o){if(o){if(o.hasOwnProperty(e)&&void 0!==o[e])return o[e];if(o.hasOwnProperty("type")&&o.type){var i;if("string"!=typeof o.type)throw new Error("Cell type must be a string ");if(i=n(o.type),i.hasOwnProperty(e))return i[e];if(t)return}return r(f(o))}}("number"==typeof r?this.getCellMeta(r,o):r)}}Object.defineProperties(n,{spreadsheetColumnLabel:{get:function(){return r}},spreadsheetColumnIndex:{get:function(){return o}},createSpreadsheetData:{get:function(){return i}},createSpreadsheetObjectData:{get:function(){return s}},createEmptySpreadsheetData:{get:function(){return a}},translateRowsToColumns:{get:function(){return l}},cellMethodLookupFactory:{get:function(){return u}},__esModule:{value:!0}});var d,c,h=(d=e("browser"),d&&d.__esModule&&d||{default:d}).default,f=(c=e("object"),c&&c.__esModule&&c||{default:c}).getPrototypeOf,p="ABCDEFGHIJKLMNOPQRSTUVWXYZ",m=p.length},{browser:24,object:53}],46:[function(e,t,n){"use strict";function r(e){var t=new Date(e);return isNaN(new Date(e+"T00:00").getDate())?t:new Date(t.getTime()+6e4*t.getTimezoneOffset())}Object.defineProperties(n,{getNormalizedDate:{get:function(){return r}},__esModule:{value:!0}})},{}],47:[function(e,t,n){"use strict";function r(e){for(var t=void 0!==arguments[1]?arguments[1]:0,n=-1,r=null;null!=e;){if(n===t){r=e;break}e.host&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e=e.host:(n++,e=e.parentNode)}return r}function o(e,t,n){for(;null!=e&&e!==n;){if(e.nodeType===Node.ELEMENT_NODE&&(t.indexOf(e.nodeName)>-1||t.indexOf(e)>-1))return e;e=e.host&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.host:e.parentNode}return null}function i(e,t,n){for(var r=[];e&&(e=o(e,t,n),e&&(!n||n.contains(e)));)r.push(e),e=e.host&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.host:e.parentNode;var i=r.length;return i?r[i-1]:null}function s(e,t){var n=e.parentNode,r=[];for("string"==typeof t?r=Array.prototype.slice.call(document.querySelectorAll(t),0):r.push(t);null!=n;){if(r.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function a(e){function t(e){return e.nodeType===Node.ELEMENT_NODE&&e.nodeName===r.toUpperCase()}var n,r="hot-table",o=!1;for(n=l(e);null!=n;){if(t(n)){o=!0;break}if(n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(o=t(n.host))break;n=n.host}n=n.parentNode}return o}function l(e){return"undefined"!=typeof Polymer&&"function"==typeof wrap?wrap(e):e}function u(e){return"undefined"!=typeof Polymer&&"function"==typeof unwrap?unwrap(e):e}function d(e){var t=0;if(e.previousSibling)for(;e=e.previousSibling;)++t;return t}function c(e,t){var n=document.querySelector(".ht_clone_"+e);return n?n.contains(t):null}function h(e){var t=0,n=[];if(!e||!e.length)return n;for(;e[t];)n.push(e[t]),t++;return n}function f(e,t){return Q(e,t)}function p(e,t){return Z(e,t)}function m(e,t){return J(e,t)}function g(e,t){if(3===e.nodeType)t.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var n=e.childNodes,r=n.length-1;r>=0;r--)g(n[r],e)}function v(e){for(var t;t=e.lastChild;)e.removeChild(t)}function w(e,t){ue.test(t)?e.innerHTML=t:b(e,t)}function b(e,t){var n=e.firstChild;n&&3===n.nodeType&&null===n.nextSibling?de?n.textContent=t:n.data=t:(v(e),e.appendChild(document.createTextNode(t)))}function y(e){for(var t=e;u(t)!==document.documentElement;){if(null===t)return!1;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(t.host){if(t.host.impl)return y(t.host.impl);if(t.host)return y(t.host);throw new Error("Lost in Web Components world")}return!1}if("none"===t.style.display)return!1;t=t.parentNode}return!0}function _(e){var t,n,r,o,i;if(o=document.documentElement,oe()&&e.firstChild&&"CAPTION"===e.firstChild.nodeName)return i=e.getBoundingClientRect(),{top:i.top+(window.pageYOffset||o.scrollTop)-(o.clientTop||0),left:i.left+(window.pageXOffset||o.scrollLeft)-(o.clientLeft||0)};for(t=e.offsetLeft,n=e.offsetTop,r=e;(e=e.offsetParent)&&e!==document.body;)t+=e.offsetLeft,n+=e.offsetTop,r=e;return r&&"fixed"===r.style.position&&(t+=window.pageXOffset||o.scrollLeft,n+=window.pageYOffset||o.scrollTop),{left:t,top:n}}function C(){var e=window.scrollY;return void 0===e&&(e=document.documentElement.scrollTop),e}function R(){var e=window.scrollX;return void 0===e&&(e=document.documentElement.scrollLeft),e}function M(e){return e===window?C():e.scrollTop}function E(e){return e===window?R():e.scrollLeft}function S(e){for(var t,n,r,o=e.parentNode,i=["auto","scroll"],s="",a="",l="",u="";o&&o.style&&document.body!==o;){if(t=o.style.overflow,n=o.style.overflowX,r=o.style.overflowY,"scroll"==t||"scroll"==n||"scroll"==r)return o;if(window.getComputedStyle&&(s=window.getComputedStyle(o),a=s.getPropertyValue("overflow"),l=s.getPropertyValue("overflow-y"),u=s.getPropertyValue("overflow-x"),"scroll"===a||"scroll"===u||"scroll"===l))return o;if(o.clientHeight<=o.scrollHeight&&(i.indexOf(r)!==-1||i.indexOf(t)!==-1||i.indexOf(a)!==-1||i.indexOf(l)!==-1))return o;if(o.clientWidth<=o.scrollWidth&&(i.indexOf(n)!==-1||i.indexOf(t)!==-1||i.indexOf(a)!==-1||i.indexOf(u)!==-1))return o;o=o.parentNode}return window}function O(e){for(var t=e.parentNode;t&&t.style&&document.body!==t;){if("visible"!==t.style.overflow&&""!==t.style.overflow)return t;if(window.getComputedStyle){var n=window.getComputedStyle(t);if("visible"!==n.getPropertyValue("overflow")&&""!==n.getPropertyValue("overflow"))return t}t=t.parentNode}return window}function T(e,t){if(e){if(e!==window){var n,r=e.style[t];return""!==r&&void 0!==r?r:(n=A(e),""!==n[t]&&void 0!==n[t]?n[t]:void 0)}if("width"===t)return window.innerWidth+"px";if("height"===t)return window.innerHeight+"px"}}function A(e){return e.currentStyle||document.defaultView.getComputedStyle(e)}function N(e){return e.offsetWidth}function x(e){return oe()&&e.firstChild&&"CAPTION"===e.firstChild.nodeName?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function k(e){return e.clientHeight||e.innerHeight}function I(e){return e.clientWidth||e.innerWidth}function D(e,t,n){window.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}function P(e,t,n){window.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,n)}function H(e){if(e.selectionStart)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange();if(null==t)return 0;var n=e.createTextRange(),r=n.duplicate();return n.moveToBookmark(t.getBookmark()),r.setEndPoint("EndToStart",n),r.text.length}return 0}function L(e){if(e.selectionEnd)return e.selectionEnd;if(document.selection){var t=document.selection.createRange();if(null==t)return 0;var n=e.createTextRange();return n.text.indexOf(t.text)+t.text.length}}function V(){var e="";return window.getSelection?e=window.getSelection().toString():document.selection&&"Control"!==document.selection.type&&(e=document.selection.createRange().text),e}function j(e,t,n){if(void 0===n&&(n=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,n)}catch(i){var r=e.parentNode,o=r.style.display;r.style.display="block",e.setSelectionRange(t,n),r.style.display=o}}else if(e.createTextRange){var i=e.createTextRange();i.collapse(!0),i.moveEnd("character",n),i.moveStart("character",t),i.select()}}function F(){var e=document.createElement("div");e.style.height="200px",e.style.width="100%";var t=document.createElement("div");t.style.boxSizing="content-box",t.style.height="150px",t.style.left="0px",t.style.overflow="hidden",t.style.position="absolute",t.style.top="0px",t.style.width="200px",t.style.visibility="hidden",t.appendChild(e),(document.body||document.documentElement).appendChild(t);var n=e.offsetWidth;t.style.overflow="scroll";var r=e.offsetWidth;return n==r&&(r=t.clientWidth),(document.body||document.documentElement).removeChild(t),n-r}function $(){return void 0===le&&(le=F()),le}function B(e){return e.offsetWidth!==e.clientWidth}function W(e){return e.offsetHeight!==e.clientHeight}function U(e,t,n){te()||ne()?(e.style.top=n,e.style.left=t):re()?e.style["-webkit-transform"]="translate3d("+t+","+n+",0)":e.style.transform="translate3d("+t+","+n+",0)"}function Y(e){var t;return e.style.transform&&""!==(t=e.style.transform)?["transform",t]:e.style["-webkit-transform"]&&""!==(t=e.style["-webkit-transform"])?["-webkit-transform",t]:-1}function G(e){e.style.transform&&""!==e.style.transform?e.style.transform="":e.style["-webkit-transform"]&&""!==e.style["-webkit-transform"]&&(e.style["-webkit-transform"]="")}function z(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||"true"===e.contentEditable)}function X(e){return z(e)&&e.className.indexOf("handsontableInput")==-1&&e.className.indexOf("copyPaste")==-1}Object.defineProperties(n,{getParent:{get:function(){return r}},closest:{get:function(){return o}},closestDown:{get:function(){return i}},isChildOf:{get:function(){return s}},isChildOfWebComponentTable:{get:function(){return a}},polymerWrap:{get:function(){return l}},polymerUnwrap:{get:function(){return u}},index:{get:function(){return d}},overlayContainsElement:{get:function(){return c}},hasClass:{get:function(){return f}},addClass:{get:function(){return p}},removeClass:{get:function(){return m}},removeTextNodes:{get:function(){return g}},empty:{get:function(){return v}},HTML_CHARACTERS:{get:function(){return ue}},fastInnerHTML:{get:function(){return w}},fastInnerText:{get:function(){return b}},isVisible:{get:function(){return y}},offset:{get:function(){return _}},getWindowScrollTop:{get:function(){return C}},getWindowScrollLeft:{get:function(){return R}},getScrollTop:{get:function(){return M}},getScrollLeft:{get:function(){return E}},getScrollableElement:{get:function(){return S}},getTrimmingContainer:{get:function(){return O}},getStyle:{get:function(){return T}},getComputedStyle:{get:function(){return A}},outerWidth:{get:function(){return N}},outerHeight:{get:function(){return x}},innerHeight:{get:function(){return k}},innerWidth:{get:function(){return I}},addEvent:{get:function(){return D}},removeEvent:{get:function(){return P}},getCaretPosition:{get:function(){return H}},getSelectionEndPosition:{get:function(){return L}},getSelectionText:{get:function(){return V}},setCaretPosition:{get:function(){return j}},getScrollbarWidth:{get:function(){return $}},hasVerticalScrollbar:{get:function(){return B}},hasHorizontalScrollbar:{get:function(){return W}},setOverlayPosition:{get:function(){return U}},getCssTransform:{get:function(){return Y}},resetCssTransform:{get:function(){return G}},isInput:{get:function(){return z}},isOutsideInput:{get:function(){return X}},__esModule:{value:!0}});var q,K,Q,Z,J,ee=(q=e("../browser"),q&&q.__esModule&&q||{default:q}),te=ee.isIE8,ne=ee.isIE9,re=ee.isSafari,oe=(K=e("../feature"),K&&K.__esModule&&K||{default:K}).hasCaptionProblem,ie=!!document.documentElement.classList;if(ie){var se=function(){var e=document.createElement("div");return e.classList.add("test","test2"),e.classList.contains("test2")}();Q=function(e,t){return""!==t&&e.classList.contains(t)},Z=function(e,t){var n=0;if("string"==typeof t&&(t=t.split(" ")),t=h(t),se)e.classList.add.apply(e.classList,t);else for(;t&&t[n];)e.classList.add(t[n]),n++},J=function(e,t){var n=0;if("string"==typeof t&&(t=t.split(" ")),t=h(t),se)e.classList.remove.apply(e.classList,t);else for(;t&&t[n];)e.classList.remove(t[n]),n++}}else{var ae=function(e){return new RegExp("(\\s|^)"+e+"(\\s|$)")};Q=function(e,t){return!!e.className.match(ae(t))},Z=function(e,t){var n=0,r=e.className;if("string"==typeof t&&(t=t.split(" ")),""===r)r=t.join(" ");else for(;t&&t[n];)ae(t[n]).test(r)||(r+=" "+t[n]),n++;e.className=r},J=function(e,t){var n=0,r=e.className;for("string"==typeof t&&(t=t.split(" "));t&&t[n];)r=r.replace(ae(t[n])," ").trim(),n++;e.className!==r&&(e.className=r)}}var le,ue=/(<(.*)>|&(.*);)/,de=!!document.createTextNode("test").textContent},{"../browser":44,"../feature":49}],48:[function(e,t,n){"use strict";function r(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function o(e){return e.isImmediatePropagationEnabled===!1}function i(e){"function"==typeof e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function s(e){return e.pageX?e.pageX:e.clientX+f()}function a(e){return e.pageY?e.pageY:e.clientY+h()}function l(e){return 2===e.button}function u(e){return 0===e.button}Object.defineProperties(n,{stopImmediatePropagation:{get:function(){return r}},isImmediatePropagationStopped:{get:function(){return o}},stopPropagation:{get:function(){return i}},pageX:{get:function(){return s}},pageY:{get:function(){return a}},isRightClick:{get:function(){return l}},isLeftClick:{get:function(){return u}},__esModule:{value:!0}});var d,c=(d=e("element"),d&&d.__esModule&&d||{default:d}),h=c.getWindowScrollTop,f=c.getWindowScrollLeft},{element:47}],49:[function(e,t,n){"use strict";function r(e){return h.call(window,e)}function o(e){f.call(window,e)}function i(){return"ontouchstart"in window}function s(){var e=document.createElement("div");return!(!e.createShadowRoot||!e.createShadowRoot.toString().match(/\[native code\]/))}function a(){var e=document.createElement("TABLE");e.style.borderSpacing=0,e.style.borderWidth=0,e.style.padding=0;var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var n=document.createElement("CAPTION");n.innerHTML="c<br>c<br>c<br>c",n.style.padding=0,n.style.margin=0,e.insertBefore(n,t),document.body.appendChild(e),m=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function l(){return void 0===m&&a(),m}function u(e){var t=void 0!==arguments[1]?arguments[1]:{};return g?g:g="object"==typeof Intl?new Intl.Collator(e,t).compare:"function"==typeof String.prototype.localeCompare?function(e,t){return(e+"").localeCompare(t)}:function(e,t){return e===t?0:e>t?-1:1}}Object.defineProperties(n,{requestAnimationFrame:{get:function(){return r}},cancelAnimationFrame:{get:function(){return o}},isTouchSupported:{get:function(){return i}},isWebComponentSupportedNatively:{get:function(){return s}},hasCaptionProblem:{get:function(){return l}},getComparisonFunction:{get:function(){return u}},__esModule:{value:!0}});for(var d=0,c=["ms","moz","webkit","o"],h=window.requestAnimationFrame,f=window.cancelAnimationFrame,p=0;p<c.length&&!h;++p)h=window[c[p]+"RequestAnimationFrame"],f=window[c[p]+"CancelAnimationFrame"]||window[c[p]+"CancelRequestAnimationFrame"];h||(h=function(e){var t=(new Date).getTime(),n=Math.max(0,16-(t-d)),r=window.setTimeout(function(){e(t+n)},n);return d=t+n,r}),f||(f=function(e){clearTimeout(e)});var m,g},{}],50:[function(e,t,n){"use strict";function r(e){return"function"==typeof e}function o(e,t){return function(){return e.apply(t,arguments)}}function i(e){function t(){var t=this,s=arguments,a=Date.now(),l=!1;o.lastCallThrottled=!0,r||(r=a,l=!0);var u=n-(a-r);return l?(o.lastCallThrottled=!1,e.apply(this,s)):(i&&clearTimeout(i),i=setTimeout(function(){o.lastCallThrottled=!1,e.apply(t,s),r=0,i=void 0},u)),o}var n=void 0!==arguments[1]?arguments[1]:200,r=0,o={lastCallThrottled:!0},i=null;return t}function s(e){function t(){a=o}function n(){return a?(a--,e.apply(this,arguments)):s.apply(this,arguments)}var r=void 0!==arguments[1]?arguments[1]:200,o=void 0!==arguments[2]?arguments[2]:10,s=i(e,r),a=o;return n.clearHits=t,n}function a(e){function t(){var t=this,i=arguments;return o&&clearTimeout(o),o=setTimeout(function(){n=e.apply(t,i)},r),n}var n,r=void 0!==arguments[1]?arguments[1]:200,o=null;return t}function l(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e,r=n[0],o=Array.prototype.slice.call(n,1);return function(){return f(o,function(e,t){return t(e)},r.apply(this,arguments))}}function u(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return e.apply(this,t.concat(n))}}function d(e){function t(r){return function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];var s,a=r.concat(o);return s=a.length>=n?e.apply(this,a):t(a)}}var n=e.length;return t([])}function c(e){function t(r){return function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];var s,a=r.concat(o.reverse());return s=a.length>=n?e.apply(this,a):t(a)}}var n=e.length;return t([])}Object.defineProperties(n,{isFunction:{get:function(){return r}},proxy:{get:function(){return o}},throttle:{get:function(){return i}},throttleAfterHits:{get:function(){return s}},debounce:{get:function(){return a}},pipe:{get:function(){return l}},partial:{get:function(){return u}},curry:{get:function(){return d}},curryRight:{get:function(){return c}},__esModule:{value:!0}});var h,f=(h=e("array"),h&&h.__esModule&&h||{default:h}).arrayReduce},{array:43}],51:[function(e,t,n){"use strict";function r(e){switch(typeof e){case"string":case"number":return e+"";case"object":
return null===e?"":e.toString();case"undefined":return"";default:return e.toString()}}function o(e){return"undefined"!=typeof e}function i(e){return"undefined"==typeof e}Object.defineProperties(n,{stringify:{get:function(){return r}},isDefined:{get:function(){return o}},isUndefined:{get:function(){return i}},__esModule:{value:!0}})},{}],52:[function(e,t,n){"use strict";function r(e){var t=typeof e;return"number"==t?!isNaN(e)&&isFinite(e):"string"==t?!!e.length&&(1==e.length?/\d/.test(e):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(e)):"object"==t&&!(!e||"number"!=typeof e.valueOf()||e instanceof Date)}function o(e,t,n){var r=-1;for("function"==typeof t?(n=t,t=e):r=e-1;++r<=t&&n(r)!==!1;);}function i(e,t,n){var r=e+1;for("function"==typeof t&&(n=t,t=0);--r>=t&&n(r)!==!1;);}function s(e,t){return t=parseInt(t.toString().replace("%",""),10),t=parseInt(e*t/100)}Object.defineProperties(n,{isNumeric:{get:function(){return r}},rangeEach:{get:function(){return o}},rangeEachReverse:{get:function(){return i}},valueAccordingPercent:{get:function(){return s}},__esModule:{value:!0}})},{}],53:[function(e,t,n){"use strict";function r(e){var t;return Array.isArray(e)?t=[]:(t={},p(e,function(e,n){"__children"!==n&&(e&&"object"==typeof e&&!Array.isArray(e)?t[n]=r(e):Array.isArray(e)?e.length&&"object"==typeof e[0]&&!Array.isArray(e[0])?t[n]=[r(e[0])]:t[n]=[]:t[n]=null)})),t}function o(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function i(e,t){return p(t,function(t,n){e[n]=t}),e}function s(e,t){p(t,function(n,r){t[r]&&"object"==typeof t[r]?(e[r]||(Array.isArray(t[r])?e[r]=[]:"[object Date]"===Object.prototype.toString.call(t[r])?e[r]=t[r]:e[r]={}),s(e[r],t[r])):e[r]=t[r]})}function a(e){return"object"==typeof e?JSON.parse(JSON.stringify(e)):e}function l(e){var t={};return p(e,function(e,n){t[n]=e}),t}function u(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.MIXINS||(e.MIXINS=[]),b(t,function(t){e.MIXINS.push(t.MIXIN_NAME),p(t,function(t,n){if(void 0!==e.prototype[n])throw new Error("Mixin conflict. Property '"+n+"' already exist and cannot be overwritten.");if("function"==typeof t)e.prototype[n]=t;else{var r=function(e,t){e="_"+e;var n=function(e){return(Array.isArray(e)||c(e))&&(e=a(e)),e};return function(){return void 0===this[e]&&(this[e]=n(t)),this[e]}},o=function(e){return e="_"+e,function(t){this[e]=t}};Object.defineProperty(e.prototype,n,{get:r(n,t),set:o(n),configurable:!0})}})}),e}function d(e,t){return JSON.stringify(e)===JSON.stringify(t)}function c(e){return"[object Object]"==Object.prototype.toString.call(e)}function h(e){var t;if("object"==typeof e.__proto__)t=e.__proto__;else{var n,r=e.constructor;"function"==typeof e.constructor&&(n=r,delete e.constructor&&(r=e.constructor,e.constructor=n)),t=r?r.prototype:null}return t}function f(e,t,n,r){r.value=n,r.writable=r.writable!==!1,r.enumerable=r.enumerable!==!1,r.configurable=r.configurable!==!1,Object.defineProperty(e,t,r)}function p(e,t){for(var n in e)if((!e.hasOwnProperty||e.hasOwnProperty&&e.hasOwnProperty(n))&&t(e[n],n,e)===!1)break;return e}function m(e,t){var n=t.split("."),r=e;return p(n,function(e){if(r=r[e],void 0===r)return r=void 0,!1}),r}function g(e){if(!c(e))return 0;var t=function(e){var n=0;return c(e)?p(e,function(e){n+=t(e)}):n++,n};return t(e)}function v(e){var t,n=void 0!==arguments[1]?arguments[1]:"value",r="_"+n,o=(t={},Object.defineProperty(t,"_touched",{value:!1,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(t,r,{value:e,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(t,"isTouched",{value:function(){return this._touched},configurable:!0,enumerable:!0,writable:!0}),t);return Object.defineProperty(o,n,{get:function(){return this[r]},set:function(e){this._touched=!0,this[r]=e},enumerable:!0,configurable:!0}),o}Object.defineProperties(n,{duckSchema:{get:function(){return r}},inherit:{get:function(){return o}},extend:{get:function(){return i}},deepExtend:{get:function(){return s}},deepClone:{get:function(){return a}},clone:{get:function(){return l}},mixin:{get:function(){return u}},isObjectEquals:{get:function(){return d}},isObject:{get:function(){return c}},getPrototypeOf:{get:function(){return h}},defineGetter:{get:function(){return f}},objectEach:{get:function(){return p}},getProperty:{get:function(){return m}},deepObjectSize:{get:function(){return g}},createObjectPropListener:{get:function(){return v}},__esModule:{value:!0}});var w,b=(w=e("array"),w&&w.__esModule&&w||{default:w}).arrayEach},{array:43}],54:[function(e,t,n){"use strict";function r(e,t){function n(){}i(n,e);for(var r=0,o=t.length;r<o;r++)n.prototype[t[r]]=void 0;return n}Object.defineProperties(n,{columnFactory:{get:function(){return r}},__esModule:{value:!0}});var o,i=(o=e("object"),o&&o.__esModule&&o||{default:o}).inherit},{object:53}],55:[function(e,t,n){"use strict";function r(e){return e[0].toUpperCase()+e.substr(1)}function o(e,t){var n=!0;return m(t.length-1,function(r){if(e.charAt(r)!==t.charAt(r))return n=!1,!1}),n}function i(e,t){var n=!0,r=t.length-1,o=e.length-1;return m(r,function(i){var s=o-i,a=r-i;if(e.charAt(s)!==t.charAt(a))return n=!1,!1}),n}function s(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],r=e.length;r--;){var o=p(e[r]).toLowerCase();n.indexOf(o)===-1&&n.push(o)}return 1===n.length}function a(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function l(e){return/^([0-9][0-9]?\%$)|(^100\%$)/.test(e)}function u(e){var t=void 0!==arguments[1]?arguments[1]:{};return(e+"").replace(/(?:\\)?\[([^\[\]]+)]/g,function(e,n){return"\\"===e.charAt(0)?e.substr(1,e.length-1):void 0===t[n]?"":t[n]})}function d(e,t){var n=void 0!==arguments[2]?arguments[2]:" ";if(e+="",e.length>=t)return e;n=String(n);var r=n.length;r||(n=" ");var o=t-e.length,i=Math.ceil(o/n.length),s="";return m(i,function(e){s+=n}),s=s.slice(0,o),s+e}function c(e){return e+="",e.replace(g,"")}Object.defineProperties(n,{toUpperCaseFirst:{get:function(){return r}},startsWith:{get:function(){return o}},endsWith:{get:function(){return i}},equalsIgnoreCase:{get:function(){return s}},randomString:{get:function(){return a}},isPercentValue:{get:function(){return l}},substitute:{get:function(){return u}},padStart:{get:function(){return d}},stripTags:{get:function(){return c}},__esModule:{value:!0}});var h,f,p=(h=e("mixed"),h&&h.__esModule&&h||{default:h}).stringify,m=(f=e("number"),f&&f.__esModule&&f||{default:f}).rangeEach,g=/<\/?\w+\/?>|<\w+[\s|\/][^>]*>/gi},{mixed:51,number:52}],56:[function(e,t,n){"use strict";function r(e){return 32==e||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function o(e){var t=[u.ARROW_DOWN,u.ARROW_UP,u.ARROW_LEFT,u.ARROW_RIGHT,u.HOME,u.END,u.DELETE,u.BACKSPACE,u.F1,u.F2,u.F3,u.F4,u.F5,u.F6,u.F7,u.F8,u.F9,u.F10,u.F11,u.F12,u.TAB,u.PAGE_DOWN,u.PAGE_UP,u.ENTER,u.ESCAPE,u.SHIFT,u.CAPS_LOCK,u.ALT];return t.indexOf(e)!==-1}function i(e){return[u.CONTROL_LEFT,224,u.COMMAND_LEFT,u.COMMAND_RIGHT].indexOf(e)!==-1}function s(e,t){var n=t.split("|"),r=!1;return l(n,function(t){if(e===u[t])return r=!0,!1}),r}Object.defineProperties(n,{KEY_CODES:{get:function(){return u}},isPrintableChar:{get:function(){return r}},isMetaKey:{get:function(){return o}},isCtrlKey:{get:function(){return i}},isKey:{get:function(){return s}},__esModule:{value:!0}});var a,l=(a=e("array"),a&&a.__esModule&&a||{default:a}).arrayEach,u={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86}},{array:43}],57:[function(e,t,n){"use strict";Object.defineProperties(n,{arrayMapper:{get:function(){return m}},__esModule:{value:!0}});var r,o,i,s,a=(r=e("browser"),r&&r.__esModule&&r||{default:r}).default,l=(o=e("helpers/array"),o&&o.__esModule&&o||{default:o}),u=(l.arrayEach,l.arrayReduce),d=l.arrayMap,c=l.arrayMax,h=(i=e("helpers/object"),i&&i.__esModule&&i||{default:i}).defineGetter,f=(s=e("helpers/number"),s&&s.__esModule&&s||{default:s}).rangeEach,p="arrayMapper",m={_arrayMap:[],getValueByIndex:function(e){var t;return void 0===(t=this._arrayMap[e])?null:t},getIndexByValue:function(e){var t;return(t=this._arrayMap.indexOf(e))===-1?null:t},insertItems:function(e){var t=void 0!==arguments[1]?arguments[1]:1,n=this,r=c(this._arrayMap)+1,o=[];return f(t-1,function(t){o.push(n._arrayMap.splice(e+t,0,r+t))}),o},removeItems:function(e){var t=void 0!==arguments[1]?arguments[1]:1,n=this,r=[];if(Array.isArray(e)){var o=[].concat(this._arrayMap);e.sort(function(e,t){return t-e}),r=u(e,function(e,t){return n._arrayMap.splice(t,1),e.concat(o.slice(t,t+1))},[])}else r=this._arrayMap.splice(e,t);return r},unshiftItems:function(e){function t(e){return u(r,function(t,n){return e>n&&t++,t},0)}var n=void 0!==arguments[1]?arguments[1]:1,r=this.removeItems(e,n);this._arrayMap=d(this._arrayMap,function(e,n){var r=t(e);return r&&(e-=r),e})},shiftItems:function(e){var t=void 0!==arguments[1]?arguments[1]:1,n=this;this._arrayMap=d(this._arrayMap,function(n){return n>=e&&(n+=t),n}),f(t-1,function(t){n._arrayMap.splice(e+t,0,e+t)})},clearMap:function(){this._arrayMap.length=0}};h(m,"MIXIN_NAME",p,{writable:!1,enumerable:!1}),a.utils.arrayMapper=m},{browser:24,"helpers/array":43,"helpers/number":52,"helpers/object":53}],58:[function(e,t,n){"use strict";Object.defineProperties(n,{localHooks:{get:function(){return d}},__esModule:{value:!0}});var r,o,i,s=(r=e("browser"),r&&r.__esModule&&r||{default:r}).default,a=(o=e("helpers/array"),o&&o.__esModule&&o||{default:o}).arrayEach,l=(i=e("helpers/object"),i&&i.__esModule&&i||{default:i}).defineGetter,u="localHooks",d={_localHooks:Object.create(null),addLocalHook:function(e,t){this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(t)},runLocalHooks:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this;this._localHooks[e]&&a(this._localHooks[e],function(e){return e.apply(r,t)})},clearLocalHooks:function(){this._localHooks={}}};l(d,"MIXIN_NAME",u,{writable:!1,enumerable:!1}),s.utils.localHooks=d},{browser:24,"helpers/array":43,"helpers/object":53}],59:[function(e,t,n){"use strict";var r;Object.defineProperties(n,{stateSaver:{get:function(){return p}},__esModule:{value:!0}});var o,i,s,a=(o=e("browser"),o&&o.__esModule&&o||{default:o}).default,l=((i=e("helpers/array"),i&&i.__esModule&&i||{default:i}).arrayEach,(s=e("helpers/object"),s&&s.__esModule&&s||{default:s}).defineGetter),u="stateSaver",d="state_",c="_states",h=function(e,t){return e[c][d+t]},f=function(e,t,n){e[c][d+t]=n},p=(r={},Object.defineProperty(r,c,{value:{},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"getCachedState",{value:function(e){return h(this,e)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"setCachedState",{value:function(e,t){f(this,e,t)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"saveState",{value:function(e){f(this,e,this.getState())},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"restoreState",{value:function(e){this.setState(h(this,e))},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"hasSavedState",{value:function(e){return void 0!==h(this,e)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"clearState",{value:function(e){f(this,e)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"clearStates",{value:function(){this[c]={}},configurable:!0,enumerable:!0,writable:!0}),r);l(p,"MIXIN_NAME",u,{writable:!1,enumerable:!1}),a.utils.stateSaver=p},{browser:24,"helpers/array":43,"helpers/object":53}],60:[function(e,t,n){"use strict";function r(){function e(e){return null!==e&&!n(e)&&("string"==typeof e||"number"==typeof e)}function t(e){return null!==e&&("object"==typeof e||"function"==typeof e)}function n(e){return e!==e}var r={arrayMap:[],weakMap:new WeakMap};return{get:function(n){return e(n)?r.arrayMap[n]:t(n)?r.weakMap.get(n):void 0},set:function(n,o){if(e(n))r.arrayMap[n]=o;else{if(!t(n))throw new Error("Invalid key type");r.weakMap.set(n,o)}},delete:function(n){e(n)?delete r.arrayMap[n]:t(n)&&r.weakMap.delete(n)}}}Object.defineProperties(n,{MultiMap:{get:function(){return r}},__esModule:{value:!0}}),window.MultiMap=r},{}],61:[function(e,t,n){"use strict";Object.defineProperties(n,{Hooks:{get:function(){return l}},__esModule:{value:!0}});var r,o,i=["afterCellMetaReset","afterChange","afterChangesObserved","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellMouseDown","afterOnCellMouseOver","afterRemoveCol","afterRemoveRow","afterRender","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterUpdateSettings","afterValidate","beforeAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeInit","beforeInitWalkontable","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseOver","beforeRemoveCol","beforeRemoveRow","beforeRender","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyCol","unmodifyCol","unmodifyRow","modifyColHeader","modifyColWidth","modifyRow","modifyRowHeader","modifyRowHeight","modifyData","modifyRowData","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","afterAutofillApplyValues","modifyCopyableRange","beforeColumnMove","afterColumnMove","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","modifyColumnHeaderHeight","beforeUndo","afterUndo","beforeRedo","afterRedo","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","beforeValueRender","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","manualRowHeights","skipLengthCache","afterTrimRow","afterUntrimRow","afterDropdownMenuShow","afterDropdownMenuHide","hiddenRow","hiddenColumn","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing"],s=(r=e("helpers/array"),r&&r.__esModule&&r||{default:r}).arrayEach,a=(o=e("helpers/object"),o&&o.__esModule&&o||{default:o}).objectEach,l=function(){this.globalBucket=this.createEmptyBucket()};$traceurRuntime.createClass(l,{createEmptyBucket:function(){var e=Object.create(null);return s(i,function(t){return e[t]=[]}),e},getBucket:function(){var e=void 0!==arguments[0]?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket},add:function(e,t){var n=void 0!==arguments[2]?arguments[2]:null,r=this;if(Array.isArray(t))s(t,function(t){return r.add(e,t,n)});else{var o=this.getBucket(n);"undefined"==typeof o[e]&&(this.register(e),o[e]=[]),t.skip=!1,o[e].indexOf(t)===-1&&o[e].push(t)}return this},once:function(e,t){var n=void 0!==arguments[2]?arguments[2]:null,r=this;Array.isArray(t)?s(t,function(t){return r.once(e,t,n)}):(t.runOnce=!0,this.add(e,t,n))},remove:function(e,t){var n=void 0!==arguments[2]?arguments[2]:null,r=this.getBucket(n);return"undefined"!=typeof r[e]&&r[e].indexOf(t)>=0&&(t.skip=!0,!0)},has:function(e){var t=void 0!==arguments[1]?arguments[1]:null,n=this.getBucket(t);return!(void 0===n[e]||!n[e].length)},run:function(e,t,n,r,o,i,s,a){var l=this.globalBucket[t],u=-1,d=l?l.length:0;if(d)for(;++u<d;)if(l[u]&&!l[u].skip){var c=l[u].call(e,n,r,o,i,s,a);void 0!==c&&(n=c),l[u]&&l[u].runOnce&&this.remove(t,l[u])}var h=this.getBucket(e)[t],f=-1,p=h?h.length:0;if(p)for(;++f<p;)if(h[f]&&!h[f].skip){var m=h[f].call(e,n,r,o,i,s,a);void 0!==m&&(n=m),h[f]&&h[f].runOnce&&this.remove(t,h[f],e)}return n},destroy:function(){var e=void 0!==arguments[0]?arguments[0]:null;a(this.getBucket(e),function(e,t,n){return n[t].length=0})},register:function(e){this.isRegistered(e)||i.push(e)},deregister:function(e){this.isRegistered(e)&&i.splice(i.indexOf(e),1)},isRegistered:function(e){return i.indexOf(e)>=0},getRegistered:function(){return i}},{})},{"helpers/array":43,"helpers/object":53}],62:[function(e,t,n){"use strict";function r(e,t){e=h(e),d.plugins[e]=t,d.hooks.add("construct",function(){var n;f.has(this)||f.set(this,{}),n=f.get(this),n[e]||(n[e]=new t(this))}),d.hooks.add("afterDestroy",function(){if(f.has(this)){var e=f.get(this);c(e,function(e){return e.destroy()}),f.delete(this)}})}function o(e,t){if("string"!=typeof t)throw Error('Only strings can be passed as "plugin" parameter');var n=h(t);if(f.has(e)&&f.get(e)[n])return f.get(e)[n]}function i(e){return f.has(e)?Object.keys(f.get(e)):[]}function s(e,t){var n=null;return f.has(e)&&c(f.get(e),function(e,r){e===t&&(n=r)}),n}Object.defineProperties(n,{registerPlugin:{get:function(){return r}},getPlugin:{get:function(){return o}},getRegistredPluginNames:{get:function(){return i}},getPluginName:{get:function(){return s}},__esModule:{value:!0}});var a,l,u,d=(a=e("browser"),a&&a.__esModule&&a||{default:a}).default,c=(l=e("helpers/object"),l&&l.__esModule&&l||{default:l}).objectEach,h=(u=e("helpers/string"),u&&u.__esModule&&u||{default:u}).toUpperCaseFirst,f=new WeakMap},{browser:24,"helpers/object":53,"helpers/string":55}],63:[function(e,t,n){"use strict";Object.defineProperties(n,{default:{get:function(){return _}},__esModule:{value:!0}});var r,o,i,s,a,l=(r=e("browser"),r&&r.__esModule&&r||{default:r}).default,u=(o=e("helpers/object"),o&&o.__esModule&&o||{default:o}),d=u.defineGetter,c=u.objectEach,h=(i=e("helpers/array"),i&&i.__esModule&&i||{default:i}).arrayEach,f=(s=e("utils/recordTranslator"),s&&s.__esModule&&s||{default:s}),p=(f.registerIdentity,f.getTranslator),m=(a=e("plugins"),a&&a.__esModule&&a||{default:a}),g=m.getRegistredPluginNames,v=m.getPluginName,w=new WeakMap,b=null,y=function(e){var t=this;d(this,"hot",e,{writable:!1}),d(this,"t",p(e),{writable:!1}),w.set(this,{hooks:{}}),b=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return t.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(){return t.onUpdateSettings()}),this.hot.addHook("beforeInit",function(){return t.init()})};$traceurRuntime.createClass(y,{init:function(){this.pluginName=v(this.hot,this),this.isEnabled&&this.isEnabled()&&this.enablePlugin(),b||(b=g(this.hot)),b.indexOf(this.pluginName)>=0&&b.splice(b.indexOf(this.pluginName),1),b.length||this.hot.runHooks("afterPluginsInitialized"),this.initialized=!0},enablePlugin:function(){this.enabled=!0},disablePlugin:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1},addHook:function(e,t){var n=w.get(this).hooks[e]=w.get(this).hooks[e]||[];this.hot.addHook(e,t),n.push(t),w.get(this).hooks[e]=n},removeHooks:function(e){var t=this;h(w.get(this).hooks[e]||[],function(n){t.hot.removeHook(e,n)})},clearHooks:function(){var e=this,t=w.get(this).hooks;c(t,function(t,n){return e.removeHooks(n)}),t.length=0},callOnPluginsReady:function(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)},onAfterPluginsInitialized:function(){h(this.pluginsInitializedCallbacks,function(e){return e()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0},onUpdateSettings:function(){this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&this.updatePlugin())},updatePlugin:function(){},destroy:function(){var e=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),c(this,function(t,n){"hot"!==n&&"t"!==n&&(e[n]=null)}),delete this.t,delete this.hot}},{});var _=y;l.plugins.BasePlugin=y},{browser:24,"helpers/array":43,"helpers/object":53,plugins:62,"utils/recordTranslator":130}],64:[function(e,t,n){"use strict";Object.defineProperties(n,{AutoColumnSize:{get:function(){return k}},__esModule:{value:!0}});var r,o,i,s,a,l,u,d,c,h,f,p=(r=e("_base"),r&&r.__esModule&&r||{default:r}).default,m=(o=e("helpers/array"),o&&o.__esModule&&o||{default:o}),g=m.arrayEach,v=m.arrayFilter,w=(i=e("helpers/feature"),i&&i.__esModule&&i||{default:i}),b=w.cancelAnimationFrame,y=w.requestAnimationFrame,_=(s=e("helpers/dom/element"),s&&s.__esModule&&s||{default:s}).isVisible,C=(a=e("utils/ghostTable"),a&&a.__esModule&&a||{default:a}).GhostTable,R=(l=e("helpers/object"),l&&l.__esModule&&l||{default:l}),M=R.isObject,E=(R.objectEach,u=e("helpers/number"),u&&u.__esModule&&u||{default:u}),S=E.valueAccordingPercent,O=E.rangeEach,T=(d=e("plugins"),d&&d.__esModule&&d||{default:d}).registerPlugin,A=(c=e("utils/samplesGenerator"),c&&c.__esModule&&c||{default:c}).SamplesGenerator,N=(h=e("helpers/string"),h&&h.__esModule&&h||{default:h}).isPercentValue,x=(f=e("3rdparty/walkontable/src/calculator/viewportColumns"),f&&f.__esModule&&f||{default:f}).WalkontableViewportColumnsCalculator,k=function(e){var t=this;$traceurRuntime.superConstructor(I).call(this,e),this.widths=[],this.ghostTable=new C(this.hot),this.samplesGenerator=new A(function(e,n){return t.hot.getDataAtCell(e,n)}),this.firstCalculation=!0,this.inProgress=!1,this.addHook("beforeColumnResize",function(e,n,r){return t.onBeforeColumnResize(e,n,r)})},I=k;$traceurRuntime.createClass(k,{isEnabled:function(){return this.hot.getSettings().autoColumnSize!==!1&&!this.hot.getSettings().colWidths},enablePlugin:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().autoColumnSize;t&&null!=t.useHeaders&&this.ghostTable.setSetting("useHeaders",t.useHeaders),this.addHook("afterLoadData",function(){return e.onAfterLoadData()}),this.addHook("beforeChange",function(t){return e.onBeforeChange(t)}),this.addHook("beforeRender",function(t){return e.onBeforeRender(t)}),this.addHook("modifyColWidth",function(t,n){return e.getColumnWidth(n,t)}),$traceurRuntime.superGet(this,I.prototype,"enablePlugin").call(this)}},disablePlugin:function(){$traceurRuntime.superGet(this,I.prototype,"disablePlugin").call(this)},calculateColumnsWidth:function(){var e=void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},t=void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},n=void 0!==arguments[2]&&arguments[2],r=this;"number"==typeof e&&(e={from:e,to:e}),"number"==typeof t&&(t={from:t,to:t}),O(e.from,e.to,function(e){if(n||void 0===r.widths[e]&&!r.hot._getColWidthFromSettings(e)){var o=r.samplesGenerator.generateColumnSamples(e,t);o.forEach(function(e,t){return r.ghostTable.addColumn(t,e)})}}),this.ghostTable.columns.length&&(this.ghostTable.getWidths(function(e,t){return r.widths[e]=t}),this.ghostTable.clean())},calculateAllColumnsWidth:function(){var e=void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},t=this,n=0,r=this.hot.countCols()-1,o=null;this.inProgress=!0;var i=function(){return t.hot?(t.calculateColumnsWidth({from:n,to:Math.min(n+I.CALCULATION_STEP,r)},e),n=n+I.CALCULATION_STEP+1,void(n<r?o=y(i):(b(o),t.inProgress=!1,t.hot.view.wt.wtOverlays.adjustElementsSize(!0),t.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&t.hot.view.wt.wtOverlays.leftOverlay.clone.draw()))):(b(o),void(t.inProgress=!1))};this.firstCalculation&&this.getSyncCalculationLimit()&&(this.calculateColumnsWidth({from:0,to:this.getSyncCalculationLimit()},e),this.firstCalculation=!1,n=this.getSyncCalculationLimit()+1),n<r?i():this.inProgress=!1},setSamplingOptions:function(){var e=this.hot.getSettings().autoColumnSize,t=e&&e.hasOwnProperty("samplingRatio")?this.hot.getSettings().autoColumnSize.samplingRatio:void 0,n=e&&e.hasOwnProperty("allowSampleDuplicates")?this.hot.getSettings().autoColumnSize.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),n&&this.samplesGenerator.setAllowDuplicates(n)},recalculateAllColumnsWidth:function(){this.hot.view&&_(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllColumnsWidth())},getSyncCalculationLimit:function(){var e=I.SYNC_CALCULATION_LIMIT,t=this.hot.countCols()-1;return M(this.hot.getSettings().autoColumnSize)&&(e=this.hot.getSettings().autoColumnSize.syncLimit,N(e)?e=S(t,e):e>>=0),Math.min(e,t)},getColumnWidth:function(e){var t=arguments[1],n=void 0===arguments[2]||arguments[2],r=t;return void 0===r&&(r=this.widths[e],n&&"number"==typeof r&&(r=Math.max(r,x.DEFAULT_WIDTH))),r},getFirstVisibleColumn:function(){var e=this.hot.view.wt;return e.wtViewport.columnsVisibleCalculator?e.wtTable.getFirstVisibleColumn():e.wtViewport.columnsRenderCalculator?e.wtTable.getFirstRenderedColumn():-1},getLastVisibleColumn:function(){var e=this.hot.view.wt;return e.wtViewport.columnsVisibleCalculator?e.wtTable.getLastVisibleColumn():e.wtViewport.columnsRenderCalculator?e.wtTable.getLastRenderedColumn():-1},clearCache:function(){this.widths.length=0},isNeedRecalculate:function(){return!!v(this.widths,function(e){return void 0===e}).length},onBeforeRender:function(){var e=this.hot.renderCall,t=this.hot.countRows();t&&(this.calculateColumnsWidth({from:this.getFirstVisibleColumn(),to:this.getLastVisibleColumn()},void 0,e),this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllColumnsWidth())},onAfterLoadData:function(){var e=this;this.hot.view?this.recalculateAllColumnsWidth():setTimeout(function(){e.hot&&e.recalculateAllColumnsWidth()},0)},onBeforeChange:function(e){var t=this;g(e,function(e){return t.widths[t.hot.propToCol(e[1])]=void 0})},onBeforeColumnResize:function(e,t,n){return n&&(this.calculateColumnsWidth(e,void 0,!0),t=this.getColumnWidth(e,void 0,!1)),t},destroy:function(){this.ghostTable.clean(),$traceurRuntime.superGet(this,I.prototype,"destroy").call(this)}},{get CALCULATION_STEP(){return 50},get SYNC_CALCULATION_LIMIT(){return 50}},p),T("autoColumnSize",k)},{"3rdparty/walkontable/src/calculator/viewportColumns":4,_base:63,"helpers/array":43,"helpers/dom/element":47,"helpers/feature":49,"helpers/number":52,"helpers/object":53,"helpers/string":55,plugins:62,"utils/ghostTable":128,"utils/samplesGenerator":131}],65:[function(e,t,n){"use strict";Object.defineProperties(n,{AutoRowSize:{get:function(){return A}},__esModule:{value:!0}});var r,o,i,s,a,l,u,d,c,h,f=(r=e("_base"),r&&r.__esModule&&r||{default:r}).default,p=(o=e("helpers/array"),o&&o.__esModule&&o||{default:o}),m=(p.arrayEach,p.arrayFilter),g=(i=e("helpers/feature"),i&&i.__esModule&&i||{default:i}),v=g.cancelAnimationFrame,w=g.requestAnimationFrame,b=(s=e("helpers/dom/element"),s&&s.__esModule&&s||{default:s}).isVisible,y=(a=e("utils/ghostTable"),a&&a.__esModule&&a||{default:a}).GhostTable,_=(l=e("helpers/object"),l&&l.__esModule&&l||{default:l}),C=_.isObject,R=(_.objectEach,u=e("helpers/number"),u&&u.__esModule&&u||{default:u}),M=R.valueAccordingPercent,E=R.rangeEach,S=(d=e("plugins"),d&&d.__esModule&&d||{default:d}).registerPlugin,O=(c=e("utils/samplesGenerator"),c&&c.__esModule&&c||{default:c}).SamplesGenerator,T=(h=e("helpers/string"),h&&h.__esModule&&h||{default:h}).isPercentValue,A=function(e){var t=this;$traceurRuntime.superConstructor(N).call(this,e),this.heights=[],this.ghostTable=new y(this.hot),this.samplesGenerator=new O(function(e,n){return e>=0?t.hot.getDataAtCell(e,n):e===-1?t.hot.getColHeader(n):null}),this.firstCalculation=!0,this.inProgress=!1,this.addHook("beforeRowResize",function(e,n,r){return t.onBeforeRowResize(e,n,r)})},N=A;$traceurRuntime.createClass(A,{isEnabled:function(){return this.hot.getSettings().autoRowSize===!0||C(this.hot.getSettings().autoRowSize)},enablePlugin:function(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){return e.onAfterLoadData()}),this.addHook("beforeChange",function(t){return e.onBeforeChange(t)}),this.addHook("beforeColumnMove",function(){return e.recalculateAllRowsHeight()}),this.addHook("beforeColumnResize",function(){return e.recalculateAllRowsHeight()}),this.addHook("beforeColumnSort",function(){return e.clearCache()}),this.addHook("beforeRender",function(t){return e.onBeforeRender(t)}),this.addHook("beforeRowMove",function(t,n){return e.onBeforeRowMove(t,n)}),this.addHook("modifyRowHeight",function(t,n){return e.getRowHeight(n,t)}),this.addHook("modifyColumnHeaderHeight",function(){return e.getColumnHeaderHeight()}),$traceurRuntime.superGet(this,N.prototype,"enablePlugin").call(this))},disablePlugin:function(){$traceurRuntime.superGet(this,N.prototype,"disablePlugin").call(this)},calculateRowsHeight:function(){var e=void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},t=void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},n=void 0!==arguments[2]&&arguments[2],r=this;if("number"==typeof e&&(e={from:e,to:e}),"number"==typeof t&&(t={from:t,to:t}),null!==this.hot.getColHeader(0)){var o=this.samplesGenerator.generateRowSamples(-1,t);this.ghostTable.addColumnHeadersRow(o.get(-1))}E(e.from,e.to,function(e){if(n||void 0===r.heights[e]){var o=r.samplesGenerator.generateRowSamples(e,t);o.forEach(function(e,t){return r.ghostTable.addRow(t,e)})}}),this.ghostTable.rows.length&&(this.ghostTable.getHeights(function(e,t){return r.heights[e]=t}),this.ghostTable.clean())},calculateAllRowsHeight:function(){var e=void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},t=this,n=0,r=this.hot.countRows()-1,o=null;this.inProgress=!0;var i=function(){return t.hot?(t.calculateRowsHeight({from:n,to:Math.min(n+N.CALCULATION_STEP,r)},e),n=n+N.CALCULATION_STEP+1,void(n<r?o=w(i):(v(o),t.inProgress=!1,t.hot.view.wt.wtOverlays.adjustElementsSize(!0),t.hot.view.wt.wtOverlays.leftOverlay.needFullRender&&t.hot.view.wt.wtOverlays.leftOverlay.clone.draw()))):(v(o),void(t.inProgress=!1))};this.firstCalculation&&this.getSyncCalculationLimit()&&(this.calculateRowsHeight({from:0,to:this.getSyncCalculationLimit()},e),this.firstCalculation=!1,n=this.getSyncCalculationLimit()+1),n<r?i():this.inProgress=!1},setSamplingOptions:function(){var e=this.hot.getSettings().autoRowSize,t=e&&e.hasOwnProperty("samplingRatio")?this.hot.getSettings().autoRowSize.samplingRatio:void 0,n=e&&e.hasOwnProperty("allowSampleDuplicates")?this.hot.getSettings().autoRowSize.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),n&&this.samplesGenerator.setAllowDuplicates(n)},recalculateAllRowsHeight:function(){b(this.hot.view.wt.wtTable.TABLE)&&(this.clearCache(),this.calculateAllRowsHeight())},getSyncCalculationLimit:function(){var e=N.SYNC_CALCULATION_LIMIT,t=this.hot.countRows()-1;return C(this.hot.getSettings().autoRowSize)&&(e=this.hot.getSettings().autoRowSize.syncLimit,T(e)?e=M(t,e):e>>=0),Math.min(e,t)},getRowHeight:function(e){var t=arguments[1],n=t;return void 0!==this.heights[e]&&this.heights[e]>(t||0)&&(n=this.heights[e]),n},getColumnHeaderHeight:function(){return this.heights[-1]},getFirstVisibleRow:function(){var e=this.hot.view.wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getFirstVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getFirstRenderedRow():-1},getLastVisibleRow:function(){
var e=this.hot.view.wt;return e.wtViewport.rowsVisibleCalculator?e.wtTable.getLastVisibleRow():e.wtViewport.rowsRenderCalculator?e.wtTable.getLastRenderedRow():-1},clearCache:function(){this.heights.length=0,this.heights[-1]=void 0},clearCacheByRange:function(e){var t=this;"number"==typeof e&&(e={from:e,to:e}),E(Math.min(e.from,e.to),Math.max(e.from,e.to),function(e){return t.heights[e]=void 0})},isNeedRecalculate:function(){return!!m(this.heights,function(e){return void 0===e}).length},onBeforeRender:function(){var e=this.hot.renderCall;this.calculateRowsHeight({from:this.getFirstVisibleRow(),to:this.getLastVisibleRow()},void 0,e);var t=this.hot.getSettings().fixedRowsBottom;if(t){var n=this.hot.countRows()-1;this.calculateRowsHeight({from:n-t,to:n})}this.isNeedRecalculate()&&!this.inProgress&&this.calculateAllRowsHeight()},onBeforeRowMove:function(e,t){this.clearCacheByRange({from:e,to:t}),this.calculateAllRowsHeight()},onBeforeRowResize:function(e,t,n){return n&&(this.calculateRowsHeight(e,void 0,!0),t=this.getRowHeight(e)),t},onAfterLoadData:function(){var e=this;this.hot.view?this.recalculateAllRowsHeight():setTimeout(function(){e.hot&&e.recalculateAllRowsHeight()},0)},onBeforeChange:function(e){var t=null;1===e.length?t=e[0][0]:e.length>1&&(t={from:e[0][0],to:e[e.length-1][0]}),null!==t&&this.clearCacheByRange(t)},destroy:function(){this.ghostTable.clean(),$traceurRuntime.superGet(this,N.prototype,"destroy").call(this)}},{get CALCULATION_STEP(){return 50},get SYNC_CALCULATION_LIMIT(){return 500}},f),S("autoRowSize",A)},{_base:63,"helpers/array":43,"helpers/dom/element":47,"helpers/feature":49,"helpers/number":52,"helpers/object":53,"helpers/string":55,plugins:62,"utils/ghostTable":128,"utils/samplesGenerator":131}],66:[function(e,t,n){"use strict";function r(e,t,n,r){var o,i,s,a,l,u=n.length,d=n?n[0].length:0,c=[],h=[];if(o=t.row-e.row,i=t.col-e.col,["down","up"].indexOf(r)!==-1){for(var f=0;f<=i;f++)s=parseInt(n[0][f],10),a=parseInt(n[u-1][f],10),l=("down"===r?a-s:s-a)/(u-1)||0,h.push(l);c.push(h)}if(["right","left"].indexOf(r)!==-1)for(var p=0;p<=o;p++)s=parseInt(n[p][0],10),a=parseInt(n[p][d-1],10),l=("right"===r?a-s:s-a)/(d-1)||0,h=[],h.push(l),c.push(h);return c}function o(e){function t(t){return!e.autofill||void(e.autofill.handle&&e.autofill.handle.isDragged&&(e.autofill.handle.isDragged>1&&e.autofill.apply(),e.autofill.handle.isDragged=0,a=!1))}function n(e){var t,n;return!!s.instance.autofill&&(t=f(s.instance.table).top-(window.pageYOffset||document.documentElement.scrollTop)+p(s.instance.table),n=f(s.instance.table).left-(window.pageXOffset||document.documentElement.scrollLeft)+m(s.instance.table),s.addingStarted===!1&&s.instance.autofill.handle.isDragged>0&&e.clientY>t&&e.clientX<=n?(s.instance.mouseDragOutside=!0,s.addingStarted=!0):s.instance.mouseDragOutside=!1,void(s.instance.mouseDragOutside&&w("autoInsertRow")&&setTimeout(function(){s.addingStarted=!1,s.instance.alter("insert_row")},200)))}var r,o,i,s=this,a=!1;this.instance=e,this.addingStarted=!1,i=g(e),i.addEventListener(document,"mouseup",t),i.addEventListener(document,"mousemove",n),r=this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown,this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown=function(t){e.autofill.handle.isDragged=1,a=!0,r(t)},o=this.instance.view.wt.wtSettings.settings.onCellMouseOver,this.instance.view.wt.wtSettings.settings.onCellMouseOver=function(t,n,r,i){e.autofill&&a&&!e.view.isMouseDown()&&e.autofill.handle&&e.autofill.handle.isDragged&&(e.autofill.handle.isDragged++,e.autofill.showBorder(n),e.autofill.checkIfNewRowNeeded()),o(t,n,r,i)},this.instance.view.wt.wtSettings.settings.onCellCornerDblClick=function(){e.autofill.selectAdjacent()}}function i(e){return function(t){var n;return"direction"===t?n="string"==typeof e?e:"object"!=typeof e||void 0===e[t]||e[t]:"autoInsertRow"===t?n="object"!=typeof e||void 0===e[t]||e[t]:"fillHandle"===t&&(n=!!e),n}}Object.defineProperties(n,{Autofill:{get:function(){return o}},__esModule:{value:!0}});var s,a,l,u,d,c=(s=e("browser"),s&&s.__esModule&&s||{default:s}).default,h=(a=e("helpers/dom/element"),a&&a.__esModule&&a||{default:a}),f=h.offset,p=h.outerHeight,m=h.outerWidth,g=(l=e("eventManager"),l&&l.__esModule&&l||{default:l}).eventManager,v=((u=e("plugins"),u&&u.__esModule&&u||{default:u}).registerPlugin,(d=e("3rdparty/walkontable/src/cell/coords"),d&&d.__esModule&&d||{default:d}).WalkontableCellCoords);o.prototype.init=function(){this.handle={}},o.prototype.disable=function(){this.handle.disabled=!0},o.prototype.selectAdjacent=function(){var e,t,n,r,o;e=this.instance.selection.isMultiple()?this.instance.view.wt.selections.area.getCorners():this.instance.view.wt.selections.current.getCorners(),t=this.instance.getData();e:for(n=e[2]+1;n<this.instance.countRows();n++){for(o=e[1];o<=e[3];o++)if(t[n][o])break e;(t[n][e[1]-1]||t[n][e[3]+1])&&(r=n)}r&&(this.instance.view.wt.selections.fill.clear(),this.instance.view.wt.selections.fill.add(new v(e[0],e[1])),this.instance.view.wt.selections.fill.add(new v(r,e[3])),this.apply())},o.prototype.apply=function(){var e,t,n,o,i,s,a,l;this.handle.isDragged=0,this.instance.view.wt.selections.fill.isEmpty()||(e=this.instance.view.wt.selections.fill.getCorners(),this.instance.view.wt.selections.fill.clear(),t=this.instance.selection.isMultiple()?this.instance.view.wt.selections.area.getCorners():this.instance.view.wt.selections.current.getCorners(),c.hooks.run(this.instance,"afterAutofillApplyValues",t,e),e[0]===t[0]&&e[1]<t[1]?(s="left",n=new v(e[0],e[1]),o=new v(e[2],t[1]-1)):e[0]===t[0]&&e[3]>t[3]?(s="right",n=new v(e[0],t[3]+1),o=new v(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(s="up",n=new v(e[0],e[1]),o=new v(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(s="down",n=new v(t[2]+1,e[1]),o=new v(e[2],e[3])),n&&n.row>-1&&n.col>-1?(l={from:this.instance.getSelectedRange().from,to:this.instance.getSelectedRange().to},i=this.instance.getData(l.from.row,l.from.col,l.to.row,l.to.col),a=r(n,o,i,s),c.hooks.run(this.instance,"beforeAutofill",n,o,i),this.instance.populateFromArray(n.row,n.col,i,o.row,o.col,"autofill",null,s,a),this.instance.selection.setRangeStart(new v(e[0],e[1])),this.instance.selection.setRangeEnd(new v(e[2],e[3]))):this.instance.selection.refreshBorders())},o.prototype.showBorder=function(e){var t=this.instance.getSelectedRange().getTopLeftCorner(),n=this.instance.getSelectedRange().getBottomRightCorner();if("horizontal"!==w("direction")&&(n.row<e.row||t.row>e.row))e=new v(e.row,n.col);else{if("vertical"===w("direction"))return;e=new v(n.row,e.col)}this.instance.view.wt.selections.fill.clear(),this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().from),this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().to),this.instance.view.wt.selections.fill.add(e),this.instance.view.render()},o.prototype.checkIfNewRowNeeded=function(){var e,t,n=this.instance.countRows(),r=this;this.instance.view.wt.selections.fill.cellRange&&this.addingStarted===!1&&w("autoInsertRow")&&(t=this.instance.getSelected(),e=this.instance.view.wt.selections.fill.getCorners(),t[2]<n-1&&e[2]===n-1&&(this.addingStarted=!0,this.instance._registerTimeout(setTimeout(function(){r.instance.alter("insert_row"),r.addingStarted=!1},200))))},c.hooks.add("afterInit",function(){var e=new o(this);w=i(this.getSettings().fillHandle),void 0!==w("fillHandle")&&(e.handle&&w("fillHandle")===!1?e.disable():e.handle||w("fillHandle")===!1||(this.autofill=e,this.autofill.init()))});var w;c.Autofill=o},{"3rdparty/walkontable/src/cell/coords":6,browser:24,eventManager:42,"helpers/dom/element":47,plugins:62}],67:[function(e,t,n){"use strict";Object.defineProperties(n,{ColumnSorting:{get:function(){return _}},__esModule:{value:!0}});var r,o,i,s,a,l,u,d=(r=e("browser"),r&&r.__esModule&&r||{default:r}).default,c=(o=e("moment"),o&&o.__esModule&&o||{default:o}).default,h=(i=e("helpers/dom/element"),i&&i.__esModule&&i||{default:i}),f=h.addClass,p=(h.closest,h.hasClass),m=(h.index,h.removeClass),g=(s=e("helpers/array"),s&&s.__esModule&&s||{default:s}),v=(g.arrayEach,g.arrayMap),w=g.arrayReduce,b=((a=e("eventManager"),a&&a.__esModule&&a||{default:a}).eventManager,(l=e("_base"),l&&l.__esModule&&l||{default:l}).default),y=(u=e("plugins"),u&&u.__esModule&&u||{default:u}).registerPlugin;d.hooks.register("beforeColumnSort"),d.hooks.register("afterColumnSort");var _=function(e){$traceurRuntime.superConstructor(C).call(this,e),this.sortIndicators=[],this.lastSortedColumn=null},C=_;$traceurRuntime.createClass(_,{isEnabled:function(){return!!this.hot.getSettings().columnSorting},enablePlugin:function(){var e=this;if(!this.enabled){var t=this;this.hot.sortIndex=[],this.hot.sort=function(){var e=Array.prototype.slice.call(arguments);return t.sortByColumn.apply(t,e)},"undefined"==typeof this.hot.getSettings().observeChanges&&this.enableObserveChangesPlugin(),this.addHook("afterTrimRow",function(t){return e.sort()}),this.addHook("afterUntrimRow",function(t){return e.sort()}),this.addHook("modifyRow",function(t){return e.translateRow(t)}),this.addHook("unmodifyRow",function(t){return e.untranslateRow(t)}),this.addHook("afterUpdateSettings",function(){return e.onAfterUpdateSettings()}),this.addHook("afterGetColHeader",function(t,n){return e.getColHeader(t,n)}),this.addHook("afterOnCellMouseDown",function(t,n){return e.onAfterOnCellMouseDown(t,n)}),this.addHook("afterCreateRow",function(){t.afterCreateRow.apply(t,arguments)}),this.addHook("afterRemoveRow",function(){t.afterRemoveRow.apply(t,arguments)}),this.addHook("afterInit",function(){return e.sortBySettings()}),this.addHook("afterLoadData",function(){e.hot.sortIndex=[],e.hot.view&&e.sortBySettings()}),this.hot.view&&this.sortBySettings(),$traceurRuntime.superGet(this,C.prototype,"enablePlugin").call(this)}},disablePlugin:function(){this.hot.sort=void 0,$traceurRuntime.superGet(this,C.prototype,"disablePlugin").call(this)},onAfterUpdateSettings:function(){this.sortBySettings()},sortBySettings:function(){var e,t,n=this.hot.getSettings().columnSorting,r=this.loadSortingState();"undefined"==typeof r?(e=n.column,t=n.sortOrder):(e=r.sortColumn,t=r.sortOrder),"number"==typeof e&&(this.lastSortedColumn=e,this.sortByColumn(e,t))},setSortingColumn:function(e,t){return"undefined"==typeof e?(this.hot.sortColumn=void 0,void(this.hot.sortOrder=void 0)):(this.hot.sortColumn===e&&"undefined"==typeof t?this.hot.sortOrder===!1?this.hot.sortOrder=void 0:this.hot.sortOrder=!this.hot.sortOrder:this.hot.sortOrder="undefined"==typeof t||t,void(this.hot.sortColumn=e))},sortByColumn:function(e,t){if(this.setSortingColumn(e,t),"undefined"!=typeof this.hot.sortColumn){var n=d.hooks.run(this.hot,"beforeColumnSort",this.hot.sortColumn,this.hot.sortOrder);n!==!1&&this.sort(),this.updateOrderClass(),this.updateSortIndicator(),d.hooks.run(this.hot,"afterColumnSort",this.hot.sortColumn,this.hot.sortOrder),this.hot.render(),this.saveSortingState()}},saveSortingState:function(){var e={};"undefined"!=typeof this.hot.sortColumn&&(e.sortColumn=this.hot.sortColumn),"undefined"!=typeof this.hot.sortOrder&&(e.sortOrder=this.hot.sortOrder),(e.hasOwnProperty("sortColumn")||e.hasOwnProperty("sortOrder"))&&d.hooks.run(this.hot,"persistentStateSave","columnSorting",e)},loadSortingState:function(){var e={};return d.hooks.run(this.hot,"persistentStateLoad","columnSorting",e),e.value},updateOrderClass:function(){var e;this.hot.sortOrder===!0?e="ascending":this.hot.sortOrder===!1&&(e="descending"),this.sortOrderClass=e},enableObserveChangesPlugin:function(){var e=this;this.hot._registerTimeout(setTimeout(function(){e.hot.updateSettings({observeChanges:!0})},0))},defaultSort:function(e,t){return function(t,n){return"string"==typeof t[1]&&(t[1]=t[1].toLowerCase()),"string"==typeof n[1]&&(n[1]=n[1].toLowerCase()),t[1]===n[1]?0:null===t[1]||""===t[1]?1:null===n[1]||""===n[1]?-1:isNaN(t[1])&&!isNaN(n[1])?e?1:-1:!isNaN(t[1])&&isNaN(n[1])?e?-1:1:(isNaN(t[1])||isNaN(n[1])||(t[1]=parseFloat(t[1]),n[1]=parseFloat(n[1])),t[1]<n[1]?e?-1:1:t[1]>n[1]?e?1:-1:0)}},dateSort:function(e,t){return function(n,r){if(n[1]===r[1])return 0;if(null===n[1]||""===n[1])return 1;if(null===r[1]||""===r[1])return-1;var o=c(n[1],t.dateFormat),i=c(r[1],t.dateFormat);return o.isValid()?i.isValid()?i.isAfter(o)?e?-1:1:i.isBefore(o)?e?1:-1:0:-1:1}},numericSort:function(e,t){return function(t,n){var r=parseFloat(t[1]),o=parseFloat(n[1]);return r===o||isNaN(r)&&isNaN(o)?0:isNaN(r)?1:isNaN(o)?-1:r<o?e?-1:1:r>o?e?1:-1:0}},sort:function(){if("undefined"==typeof this.hot.sortOrder)return void(this.hot.sortIndex.length=0);var e,t;this.hot.sortingEnabled=!1,this.hot.sortIndex.length=0;var n,r=this.hot.countEmptyRows();n=this.hot.getSettings().maxRows===Number.POSITIVE_INFINITY?this.hot.countRows()-this.hot.getSettings().minSpareRows:this.hot.countRows()-r;for(var o=0,i=n;o<i;o++)this.hot.sortIndex.push([o,this.hot.getDataAtCell(o,this.hot.sortColumn)]);if(e=this.hot.getCellMeta(0,this.hot.sortColumn),e.sortFunction)t=e.sortFunction;else switch(e.type){case"date":t=this.dateSort;break;case"numeric":t=this.numericSort;break;default:t=this.defaultSort}this.hot.sortIndex.sort(t(this.hot.sortOrder,e));for(var s=this.hot.sortIndex.length;s<this.hot.countRows();s++)this.hot.sortIndex.push([s,this.hot.getDataAtCell(s,this.hot.sortColumn)]);this.hot.sortingEnabled=!0},updateSortIndicator:function(){if("undefined"!=typeof this.hot.sortOrder){var e=this.hot.getCellMeta(0,this.hot.sortColumn);this.sortIndicators[this.hot.sortColumn]=e.sortIndicator}},translateRow:function(e){return this.hot.sortingEnabled&&"undefined"!=typeof this.hot.sortOrder&&this.hot.sortIndex&&this.hot.sortIndex.length&&this.hot.sortIndex[e]?this.hot.sortIndex[e][0]:e},untranslateRow:function(e){if(this.hot.sortingEnabled&&this.hot.sortIndex&&this.hot.sortIndex.length)for(var t=0;t<this.hot.sortIndex.length;t++)if(this.hot.sortIndex[t][0]==e)return t},getColHeader:function(e,t){if(e<0||!t.parentNode)return!1;var n=t.querySelector(".colHeader"),r=(t.getAttribute("colspan"),t.parentNode.parentNode.childNodes),o=Array.prototype.indexOf.call(r,t.parentNode);o-=r.length,n&&(this.hot.getSettings().columnSorting&&e>=0&&o===-1&&f(n,"columnSorting"),m(n,"descending"),m(n,"ascending"),this.sortIndicators[e]&&e===this.hot.sortColumn&&("ascending"===this.sortOrderClass?f(n,"ascending"):"descending"===this.sortOrderClass&&f(n,"descending")))},isSorted:function(){return"undefined"!=typeof this.hot.sortColumn},afterCreateRow:function(e,t){if(this.isSorted()){for(var n=0;n<this.hot.sortIndex.length;n++)this.hot.sortIndex[n][0]>=e&&(this.hot.sortIndex[n][0]+=t);for(var n=0;n<t;n++)this.hot.sortIndex.splice(e+n,0,[e+n,this.hot.getSourceData()[e+n][this.hot.sortColumn+this.hot.colOffset()]]);this.saveSortingState()}},afterRemoveRow:function(e,t){function n(e){return w(r,function(t,n){return e>n&&t++,t},0)}if(this.isSorted()){var r=this.hot.sortIndex.splice(e,t);r=v(r,function(e){return e[0]}),this.hot.sortIndex=v(this.hot.sortIndex,function(e,t){var r=n(e[0]);return r&&(e[0]-=r),e}),this.saveSortingState()}},onAfterOnCellMouseDown:function(e,t){t.row>-1||p(e.realTarget,"columnSorting")&&(t.col!==this.lastSortedColumn&&(this.hot.sortOrder=!0),this.lastSortedColumn=t.col,this.sortByColumn(t.col))}},{},b),y("columnSorting",_)},{_base:63,browser:24,eventManager:42,"helpers/array":43,"helpers/dom/element":47,moment:"moment",plugins:62}],68:[function(e,t,n){"use strict";Object.defineProperties(n,{CommentEditor:{get:function(){return i}},__esModule:{value:!0}});var r,o=(r=e("helpers/dom/element"),r&&r.__esModule&&r||{default:r}).addClass,i=function(){this.editor=this.createEditor(),this.editorStyle=this.editor.style,this.hidden=!0,this.hide()},s=i;$traceurRuntime.createClass(i,{setPosition:function(e,t){this.editorStyle.left=e+"px",this.editorStyle.top=t+"px"},setSize:function(e,t){if(e&&t){var n=this.getInputElement();n.style.width=e+"px",n.style.height=t+"px"}},resetSize:function(){var e=this.getInputElement();e.style.width="",e.style.height=""},setReadOnlyState:function(e){var t=this.getInputElement();t.readOnly=e},show:function(){this.editorStyle.display="block",this.hidden=!1},hide:function(){this.editorStyle.display="none",this.hidden=!0},isVisible:function(){return"block"===this.editorStyle.display},setValue:function(){var e=void 0!==arguments[0]?arguments[0]:"";e=e||"",this.getInputElement().value=e},getValue:function(){return this.getInputElement().value},isFocused:function(){return document.activeElement===this.getInputElement()},focus:function(){this.getInputElement().focus()},createEditor:function(){var e,t,n=document.querySelector("."+s.CLASS_EDITOR_CONTAINER);return n||(n=document.createElement("div"),o(n,s.CLASS_EDITOR_CONTAINER),document.body.appendChild(n)),e=document.createElement("div"),o(e,s.CLASS_EDITOR),t=document.createElement("textarea"),o(t,s.CLASS_INPUT),e.appendChild(t),n.appendChild(e),e},getInputElement:function(){return this.editor.querySelector("."+s.CLASS_INPUT)},destroy:function(){this.editor.parentNode.removeChild(this.editor),this.editor=null,this.editorStyle=null}},{get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"},get CLASS_EDITOR(){return"htComments"},get CLASS_INPUT(){return"htCommentTextArea"},get CLASS_CELL(){return"htCommentCell"}})},{"helpers/dom/element":47}],69:[function(e,t,n){"use strict";var r;Object.defineProperties(n,{Comments:{get:function(){return j}},__esModule:{value:!0}});var o,i,s,a,l,u,d,c,h,f,p=(o=e("browser"),o&&o.__esModule&&o||{default:o}).default,m=(i=e("helpers/dom/element"),i&&i.__esModule&&i||{default:i}),g=m.addClass,v=m.closest,w=m.isChildOf,b=m.hasClass,y=m.offset,_=m.outerWidth,C=m.outerHeight,R=m.getScrollableElement,M=(s=e("helpers/object"),s&&s.__esModule&&s||{default:s}).deepExtend,E=(a=e("helpers/function"),a&&a.__esModule&&a||{default:a}).debounce,S=(l=e("eventManager"),l&&l.__esModule&&l||{default:l}).EventManager,O=(u=e("3rdparty/walkontable/src/cell/coords"),u&&u.__esModule&&u||{default:u}).WalkontableCellCoords,T=(d=e("plugins"),d&&d.__esModule&&d||{default:d}).registerPlugin,A=(c=e("_base"),c&&c.__esModule&&c||{default:c}).default,N=(h=e("commentEditor"),h&&h.__esModule&&h||{default:h}).CommentEditor,x=(f=e("contextMenu/utils"),f&&f.__esModule&&f||{default:f}),k=x.checkSelectionConsistency,I=x.markLabelAsSelected,D=new WeakMap,P="comment",H="value",L="style",V="readOnly",j=function(e){$traceurRuntime.superConstructor(F).call(this,e),this.editor=null,this.eventManager=null,this.range={},this.mouseDown=!1,this.contextMenuEvent=!1,this.timer=null,this.displayDelay=250,D.set(this,{tempEditorDimensions:{},cellBelowCursor:null})},F=j;$traceurRuntime.createClass(j,(r={},Object.defineProperty(r,"isEnabled",{value:function(){return!!this.hot.getSettings().comments},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"enablePlugin",{value:function(){var e=this;this.enabled||(this.editor||(this.editor=new N),this.eventManager||(this.eventManager=new S(this)),this.addHook("afterContextMenuDefaultOptions",function(t){return e.addToContextMenu(t)}),this.addHook("afterRenderer",function(t,n,r,o,i,s){return e.onAfterRenderer(t,s)}),this.addHook("afterScrollHorizontally",function(){return e.hide()}),this.addHook("afterScrollVertically",function(){return e.hide()}),this.addHook("afterBeginEditing",function(t){return e.onAfterBeginEditing(t)}),this.registerListeners(),$traceurRuntime.superGet(this,F.prototype,"enablePlugin").call(this))},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"disablePlugin",{value:function(){$traceurRuntime.superGet(this,F.prototype,"disablePlugin").call(this)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"registerListeners",{value:function(){var e=this;this.eventManager.addEventListener(document,"mouseover",function(t){return e.onMouseOver(t)}),this.eventManager.addEventListener(document,"mousedown",function(t){return e.onMouseDown(t)}),this.eventManager.addEventListener(document,"mouseup",function(t){return e.onMouseUp(t)}),this.eventManager.addEventListener(this.editor.getInputElement(),"blur",function(t){return e.onEditorBlur(t)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mousedown",function(t){return e.onEditorMouseDown(t)}),this.eventManager.addEventListener(this.editor.getInputElement(),"mouseup",function(t){return e.onEditorMouseUp(t)})},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"setRange",{value:function(e){this.range=e},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"clearRange",{value:function(){this.range={}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"targetIsCellWithComment",{value:function(e){var t=v(e.target,"TD","TBODY");return!!(t&&b(t,"htCommentCell")&&v(t,[this.hot.rootElement]))},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"targetIsCommentTextArea",{value:function(e){return this.editor.getInputElement()===e.target},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"setComment",{value:function(e){var t;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var n=this.editor.getValue(),r="";null!=e?r=e:null!=n&&(r=n);var o=this.range.from.row,i=this.range.from.col;this.updateCommentMeta(o,i,(t={},Object.defineProperty(t,H,{value:r,configurable:!0,enumerable:!0,writable:!0}),t)),this.hot.render()},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"setCommentAtCell",{value:function(e,t,n){this.setRange({from:new O(e,t)}),this.setComment(n)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"removeComment",{value:function(){var e=void 0===arguments[0]||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.getCellMeta(this.range.from.row,this.range.from.col)[P]=void 0,e&&this.hot.render(),this.hide()},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"removeCommentAtCell",{value:function(e,t){var n=void 0===arguments[2]||arguments[2];this.setRange({from:new O(e,t)}),this.removeComment(n)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"getComment",{value:function(){},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"getCommentAtCell",{value:function(e,t){},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"show",{value:function(){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');var e=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return this.refreshEditor(!0),this.editor.setValue(e[P]?e[P][H]:""),this.editor.hidden&&this.editor.show(),!0},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"showAtCell",{value:function(e,t){return this.setRange({from:new O(e,t)}),this.show()},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"hide",{value:function(){this.editor.hidden||this.editor.hide()},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"refreshEditor",{value:function(){var e=void 0!==arguments[0]&&arguments[0];if(e||this.range.from&&this.editor.isVisible()){var t=R(this.hot.view.wt.wtTable.TABLE),n=this.hot.view.wt.wtTable.getCell(this.range.from),r=this.range.from.row,o=this.range.from.col,i=y(n),s=this.hot.view.wt.wtTable.getStretchedColumnWidth(o),a=i.top<0?0:i.top,l=i.left;this.hot.view.wt.wtViewport.hasVerticalScroll()&&t!==window&&(a-=this.hot.view.wt.wtOverlays.topOverlay.getScrollPosition()),this.hot.view.wt.wtViewport.hasHorizontalScroll()&&t!==window&&(l-=this.hot.view.wt.wtOverlays.leftOverlay.getScrollPosition());var u=l+s,d=a,c=this.getCommentMeta(r,o,L),h=this.getCommentMeta(r,o,V);c?this.editor.setSize(c.width,c.height):this.editor.resetSize(),this.editor.setReadOnlyState(h),this.editor.setPosition(u,d)}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"checkSelectionCommentsConsistency",{value:function(){var e=this.hot.getSelectedRange();if(!e)return!1;var t=!1,n=e.from;return this.getCommentMeta(n.row,n.col,H)&&(t=!0),t},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"updateCommentMeta",{value:function(e,t,n){var r,o=this.hot.getCellMeta(e,t),i=(r={},Object.defineProperty(r,P,{value:n,configurable:!0,enumerable:!0,writable:!0}),r);M(o,i)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"getCommentMeta",{value:function(e,t,n){var r=this.hot.getCellMeta(e,t);if(r[P])return r[P][n]},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"onMouseDown",{value:function(e){if(this.mouseDown=!0,this.hot.view&&this.hot.view.wt){if(!this.contextMenuEvent&&!this.targetIsCommentTextArea(e)){var t=v(e.target,"TD","TBODY"),n=null;t&&(n=this.hot.view.wt.wtTable.getCoords(t)),(!t||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}this.contextMenuEvent=!1}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"onMouseOver",{value:function(e){var t=this;if(!this.mouseDown&&!this.editor.isFocused()){var n=D.get(this);n.cellBelowCursor=document.elementFromPoint(e.clientX,e.clientY),E(function(){if(!b(e.target,"wtBorder")&&n.cellBelowCursor===e.target)if(t.targetIsCellWithComment(e)){var r=t.hot.view.wt.wtTable.getCoords(e.target),o={from:new O(r.row,r.col)};t.setRange(o),t.show()}else!w(e.target,document)||t.targetIsCommentTextArea(e)||t.editor.isFocused()||t.hide()},this.displayDelay)()}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"onMouseUp",{value:function(e){this.mouseDown=!1},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"onAfterRenderer",{value:function(e,t){t[P]&&t[P][H]&&g(e,t.commentedCellClassName)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"onEditorBlur",{value:function(e){this.setComment()},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"onEditorMouseDown",{value:function(e){var t=D.get(this);t.tempEditorDimensions={width:_(e.target),height:C(e.target)}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"onEditorMouseUp",{value:function(e){var t,n=D.get(this),r=_(e.target),o=C(e.target);r===n.tempEditorDimensions.width+1&&o===n.tempEditorDimensions.height+2||this.updateCommentMeta(this.range.from.row,this.range.from.col,(t={},Object.defineProperty(t,L,{value:{width:r,height:o},configurable:!0,enumerable:!0,writable:!0}),t))},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"onContextMenuAddComment",{value:function(){var e=this,t=this.hot.getSelectedRange();this.contextMenuEvent=!0,this.setRange({from:t.from}),this.show(),setTimeout(function(){e.hot&&(e.hot.deselectCell(),e.editor.focus())},10)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"onContextMenuRemoveComment",{value:function(e){this.contextMenuEvent=!0;for(var t=e.start.row;t<=e.end.row;t++)for(var n=e.start.col;n<=e.end.col;n++)this.removeCommentAtCell(t,n,!1);this.hot.render()},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"onContextMenuMakeReadOnly",{value:function(e){var t;this.contextMenuEvent=!0;for(var n=e.start.row;n<=e.end.row;n++)for(var r=e.start.col;r<=e.end.col;r++){var o=!!this.getCommentMeta(n,r,V);this.updateCommentMeta(n,r,(t={},Object.defineProperty(t,V,{value:!o,configurable:!0,enumerable:!0,writable:!0}),t))}},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"addToContextMenu",{value:function(e){var t=this;e.items.push(p.plugins.ContextMenu.SEPARATOR,{key:"commentsAddEdit",name:function(){return t.checkSelectionCommentsConsistency()?"Edit comment":"Add comment"},callback:function(){return t.onContextMenuAddComment()},disabled:function(){return!(this.getSelected()&&!this.selection.selectedHeader.corner)}},{key:"commentsRemove",name:function(){return"Delete comment"},callback:function(e,n){return t.onContextMenuRemoveComment(n)},disabled:function(){return t.hot.selection.selectedHeader.corner}},{key:"commentsReadOnly",name:function(){var e=this,t="Read only comment",n=k(this.getSelectedRange(),function(t,n){var r=e.getCellMeta(t,n)[P];if(r&&(r=r[V]),r)return!0});return n&&(t=I(t)),t},callback:function(e,n){return t.onContextMenuMakeReadOnly(n)},disabled:function(){return t.hot.selection.selectedHeader.corner||!t.checkSelectionCommentsConsistency()}})},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"onAfterBeginEditing",{value:function(e,t){this.hide()},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"destroy",{value:function(){this.editor&&this.editor.destroy(),$traceurRuntime.superGet(this,F.prototype,"destroy").call(this)},configurable:!0,enumerable:!0,writable:!0}),r),{},A),T("comments",j)},{"3rdparty/walkontable/src/cell/coords":6,_base:63,browser:24,commentEditor:68,"contextMenu/utils":88,eventManager:42,"helpers/dom/element":47,"helpers/function":50,"helpers/object":53,plugins:62}],70:[function(e,t,n){"use strict";function r(e,t){var n;return i(t,function(t){var r=t.key?t.key.split(":"):null;if(Array.isArray(r)&&r[1]===e)return n=t,!1}),n}Object.defineProperties(n,{CommandExecutor:{get:function(){return s}},__esModule:{value:!0}});var o,i=(o=e("helpers/array"),o&&o.__esModule&&o||{default:o}).arrayEach,s=function(e){this.hot=e,this.commands={},this.commonCallback=null};$traceurRuntime.createClass(s,{registerCommand:function(e,t){this.commands[e]=t},setCommonCallback:function(e){this.commonCallback=e},execute:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=this,s=e.split(":");e=s[0];var a=2===s.length?s[1]:null,l=this.commands[e];if(!l)throw new Error("Menu command '"+e+"' not exists.");if(a&&l.submenu&&(l=r(a,l.submenu.items)),l.disabled!==!0&&("function"!=typeof l.disabled||l.disabled.call(this.hot)!==!0)&&!l.hasOwnProperty("submenu")){var u=[];"function"==typeof l.callback&&u.push(l.callback),"function"==typeof this.commonCallback&&u.push(this.commonCallback),t.unshift(s.join(":")),i(u,function(e){return e.apply(o.hot,t)})}}},{})},{"helpers/array":43}],71:[function(e,t,n){"use strict";Object.defineProperties(n,{ContextMenu:{get:function(){return B}},__esModule:{value:!0}});var r,o,i,s,a,l,u,d,c,h,l,f,p=(r=e("browser"),r&&r.__esModule&&r||{default:r}).default,m=(o=e("_base"),o&&o.__esModule&&o||{default:o}).default,g=(i=e("helpers/array"),i&&i.__esModule&&i||{default:i}).arrayEach,v=(s=e("commandExecutor"),s&&s.__esModule&&s||{default:s}).CommandExecutor,w=(a=e("eventManager"),a&&a.__esModule&&a||{default:a}).EventManager,b=(l=e("helpers/dom/element"),l&&l.__esModule&&l||{default:l}).hasClass,y=(u=e("itemsFactory"),u&&u.__esModule&&u||{default:u}).ItemsFactory,_=(d=e("menu"),d&&d.__esModule&&d||{default:d}).Menu,C=(c=e("plugins"),c&&c.__esModule&&c||{default:c}).registerPlugin,R=(h=e("helpers/dom/event"),h&&h.__esModule&&h||{default:h}),M=R.stopPropagation,E=R.pageX,S=R.pageY,O=(l=e("helpers/dom/element"),l&&l.__esModule&&l||{default:l}),T=O.getWindowScrollLeft,A=O.getWindowScrollTop,N=(f=e("predefinedItems"),f&&f.__esModule&&f||{default:f}),x=N.ROW_ABOVE,k=N.ROW_BELOW,I=N.COLUMN_LEFT,D=N.COLUMN_RIGHT,P=N.REMOVE_ROW,H=N.REMOVE_COLUMN,L=N.UNDO,V=N.REDO,j=N.READ_ONLY,F=N.ALIGNMENT,$=N.SEPARATOR,B=function(e){$traceurRuntime.superConstructor(W).call(this,e),this.eventManager=new w(this),this.commandExecutor=new v(this.hot),this.itemsFactory=null,this.menu=null},W=B;$traceurRuntime.createClass(B,{isEnabled:function(){return this.hot.getSettings().contextMenu},enablePlugin:function(){var e=this;if(!this.enabled){this.itemsFactory=new y(this.hot,W.DEFAULT_ITEMS);var t=this.hot.getSettings().contextMenu,n={items:this.itemsFactory.getItems(t)};this.registerEvents(),"function"==typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),$traceurRuntime.superGet(this,W.prototype,"enablePlugin").call(this),this.callOnPluginsReady(function(){e.hot.runHooks("afterContextMenuDefaultOptions",n),
e.itemsFactory.setPredefinedItems(n.items);var r=e.itemsFactory.getItems(t);e.menu=new _(e.hot,{className:"htContextMenu",keepInViewport:!0}),e.hot.runHooks("beforeContextMenuSetItems",r),e.menu.setMenuItems(r),e.menu.addLocalHook("afterOpen",function(){return e.onMenuAfterOpen()}),e.menu.addLocalHook("afterClose",function(){return e.onMenuAfterClose()}),e.menu.addLocalHook("executeCommand",function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.executeCommand.apply(e,t)}),g(r,function(t){return e.commandExecutor.registerCommand(t.key,t)})})}},updatePlugin:function(){this.disablePlugin(),this.enablePlugin(),$traceurRuntime.superGet(this,W.prototype,"updatePlugin").call(this)},disablePlugin:function(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),$traceurRuntime.superGet(this,W.prototype,"disablePlugin").call(this)},registerEvents:function(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"contextmenu",function(t){return e.onContextMenu(t)})},open:function(e){this.menu&&(this.menu.open(),this.menu.setPosition({top:parseInt(S(e),10)-A(),left:parseInt(E(e),10)-T()}),this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv,p.eventManager.isHotTableEnv=this.hot.isHotTableEnv)},close:function(){this.menu&&this.menu.close()},executeCommand:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.commandExecutor.execute.apply(this.commandExecutor,e)},onContextMenu:function(e){function t(e){return"TD"===e.nodeName||"TD"===e.parentNode.nodeName}var n=this.hot.getSettings(),r=n.rowHeaders,o=n.colHeaders,i=e.realTarget;this.close(),b(i,"handsontableInput")||(e.preventDefault(),M(e),(r||o||t(i)||b(i,"current")&&b(i,"wtBorder"))&&this.open(e))},onMenuAfterOpen:function(){this.hot.runHooks("afterContextMenuShow",this)},onMenuAfterClose:function(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)},destroy:function(){this.close(),this.menu&&this.menu.destroy(),$traceurRuntime.superGet(this,W.prototype,"destroy").call(this)}},{get DEFAULT_ITEMS(){return[x,k,$,I,D,$,P,H,$,L,V,$,j,$,F]}},m),B.SEPARATOR={name:$},p.hooks.register("afterContextMenuDefaultOptions"),p.hooks.register("afterContextMenuShow"),p.hooks.register("afterContextMenuHide"),p.hooks.register("afterContextMenuExecute"),C("contextMenu",B)},{_base:63,browser:24,commandExecutor:70,eventManager:42,"helpers/array":43,"helpers/dom/element":47,"helpers/dom/event":48,itemsFactory:73,menu:74,plugins:62,predefinedItems:75}],72:[function(e,t,n){"use strict";Object.defineProperties(n,{Cursor:{get:function(){return f}},__esModule:{value:!0}});var r,o,i,s=(r=e("browser"),r&&r.__esModule&&r||{default:r}).default,a=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{default:o}),l=a.getWindowScrollLeft,u=a.getWindowScrollTop,d=(i=e("helpers/dom/event"),i&&i.__esModule&&i||{default:i}),c=d.pageX,h=d.pageY,f=function(e){var t,n,r,o,i,s,a=u(),d=l();this.type=this.getSourceType(e),"literal"===this.type?(t=parseInt(e.top,10),r=parseInt(e.left,10),i=e.height||0,s=e.width||0,n=t,o=r,t+=a,r+=d):"event"===this.type&&(t=parseInt(h(e),10),r=parseInt(c(e),10),i=e.target.clientHeight,s=e.target.clientWidth,n=t-a,o=r-d),this.top=t,this.topRelative=n,this.left=r,this.leftRelative=o,this.scrollTop=a,this.scrollLeft=d,this.cellHeight=i,this.cellWidth=s};$traceurRuntime.createClass(f,{getSourceType:function(e){var t="literal";return e instanceof Event&&(t="event"),t},fitsAbove:function(e){return this.topRelative>=e.offsetHeight},fitsBelow:function(e){var t=void 0!==arguments[1]?arguments[1]:window.innerHeight;return this.topRelative+e.offsetHeight<=t},fitsOnRight:function(e){var t=void 0!==arguments[1]?arguments[1]:window.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t},fitsOnLeft:function(e){return this.leftRelative>=e.offsetWidth}},{}),s.plugins.utils=s.plugins.utils||{},s.plugins.utils.Cursor=f},{browser:24,"helpers/dom/element":47,"helpers/dom/event":48}],73:[function(e,t,n){"use strict";function r(){var e=void 0!==arguments[0]?arguments[0]:null,t=void 0!==arguments[1]?arguments[1]:[],n=void 0!==arguments[2]?arguments[2]:{},r=[];return e&&e.items?e=e.items:Array.isArray(e)||(e=t),u(e)?l(e,function(e,t){var o=n["string"==typeof e?e:t];o||(o=e),u(e)?d(o,e):"string"==typeof o&&(o={name:o}),void 0===o.key&&(o.key=t),r.push(o)}):c(e,function(e,t){var o=n[e];!o&&p.indexOf(e)>=0||(o||(o={name:e,key:t+""}),u(e)&&d(o,e),void 0===o.key&&(o.key=t),r.push(o))}),r}Object.defineProperties(n,{ItemsFactory:{get:function(){return g}},__esModule:{value:!0}});var o,i,s,a=(o=e("helpers/object"),o&&o.__esModule&&o||{default:o}),l=a.objectEach,u=a.isObject,d=a.extend,c=(i=e("helpers/array"),i&&i.__esModule&&i||{default:i}).arrayEach,h=(s=e("predefinedItems"),s&&s.__esModule&&s||{default:s}),f=h.SEPARATOR,p=h.ITEMS,m=h.predefinedItems,g=function(e){var t=void 0!==arguments[1]?arguments[1]:null;this.hot=e,this.predefinedItems=m(),this.defaultOrderPattern=t};$traceurRuntime.createClass(g,{setPredefinedItems:function(e){var t=this,n={};this.defaultOrderPattern.length=0,l(e,function(e,r){var o="";e.name===f?(n[f]=e,o=f):isNaN(parseInt(r,10))?(e.key=void 0===e.key?r:e.key,n[r]=e,o=e.key):(n[e.key]=e,o=e.key),t.defaultOrderPattern.push(o)}),this.predefinedItems=n},getItems:function(){var e=void 0!==arguments[0]?arguments[0]:null;return r(e,this.defaultOrderPattern,this.predefinedItems)}},{})},{"helpers/array":43,"helpers/object":53,predefinedItems:75}],74:[function(e,t,n){"use strict";Object.defineProperties(n,{Menu:{get:function(){return W}},__esModule:{value:!0}});var r,o,i,s,a,l,u,d,c,h,f,p,m=(r=e("browser"),r&&r.__esModule&&r||{default:r}).default,g=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{default:o}),v=g.addClass,w=g.empty,b=g.fastInnerHTML,y=g.getScrollbarWidth,_=g.isChildOf,C=g.removeClass,R=(i=e("helpers/array"),i&&i.__esModule&&i||{default:i}),M=R.arrayEach,E=R.arrayFilter,S=R.arrayReduce,O=(s=e("cursor"),s&&s.__esModule&&s||{default:s}).Cursor,T=(a=e("eventManager"),a&&a.__esModule&&a||{default:a}).EventManager,A=(l=e("helpers/object"),l&&l.__esModule&&l||{default:l}).mixin,N=(u=e("helpers/function"),u&&u.__esModule&&u||{default:u}).debounce,x=(d=e("utils"),d&&d.__esModule&&d||{default:d}),k=x.filterSeparators,I=x.hasSubMenu,D=x.isDisabled,P=x.isItemHidden,H=x.isSeparator,L=x.isSelectionDisabled,V=x.normalizeSelection,j=(c=e("helpers/unicode"),c&&c.__esModule&&c||{default:c}).KEY_CODES,F=(h=e("mixins/localHooks"),h&&h.__esModule&&h||{default:h}).localHooks,$=(f=e("predefinedItems"),f&&f.__esModule&&f||{default:f}).SEPARATOR,B=(p=e("helpers/dom/event"),p&&p.__esModule&&p||{default:p}).stopImmediatePropagation,W=function(e,t){this.hot=e,this.options=t||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1},this.eventManager=new T(this),this.container=this.createContainer(this.options.name),this.hotMenu=null,this.hotSubMenus={},this.parentMenu=this.options.parent||null,this.menuItems=null,this.origOutsideClickDeselects=null,this.offset={above:0,below:0,left:0,right:0},this._afterScrollCallback=null,this.registerEvents()},U=W;$traceurRuntime.createClass(W,{registerEvents:function(){var e=this;this.eventManager.addEventListener(document.documentElement,"mousedown",function(t){return e.onDocumentMouseDown(t)})},setMenuItems:function(e){this.menuItems=e},setOffset:function(e){var t=void 0!==arguments[1]?arguments[1]:0;this.offset[e]=t},isSubMenu:function(){return null!==this.parentMenu},open:function(){var e=this;this.container.removeAttribute("style"),this.container.style.display="block";var t=N(function(t){return e.openSubMenu(t)},300),n=E(this.menuItems,function(t){return P(t,e.hot)});n=k(n,$);var r={data:n,colHeaders:!1,colWidths:[200],autoRowSize:!1,readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:function(t,n,r,o,i,s){return e.menuItemRenderer(t,n,r,o,i,s)}}],renderAllRows:!0,fragmentSelection:"cell",disableVisualSelection:"area",beforeKeyDown:function(t){return e.onBeforeKeyDown(t)},afterOnCellMouseOver:function(n,r,o){e.isAllSubMenusClosed()?t(r.row):e.openSubMenu(r.row)}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new m.Core(this.container,r),this.hotMenu.addHook("afterInit",function(){return e.onAfterInit()}),this.hotMenu.init(),this.hotMenu.listen(),this.blockMainTableCallbacks(),this.runLocalHooks("afterOpen")},close:function(){var e=void 0!==arguments[0]&&arguments[0];this.isOpened()&&(e&&this.parentMenu?this.parentMenu.close():(this.closeAllSubMenus(),this.container.style.display="none",this.releaseMainTableCallbacks(),this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.parentMenu&&this.parentMenu.hotMenu.listen()))},openSubMenu:function(e){if(!this.hotMenu)return!1;var t=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!t||!I(t))return!1;var n=this.hotMenu.getSourceDataAtRow(e),r=new U(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0});return r.setMenuItems(n.submenu.items),r.open(),r.setPosition(t.getBoundingClientRect()),this.hotSubMenus[n.key]=r,r},closeSubMenu:function(e){var t=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[t.key];n&&(n.destroy(),delete this.hotSubMenus[t.key])},closeAllSubMenus:function(){var e=this;M(this.hotMenu.getData(),function(t,n){return e.closeSubMenu(n)})},isAllSubMenusClosed:function(){return 0===Object.keys(this.hotSubMenus).length},destroy:function(){this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy()},isOpened:function(){return null!==this.hotMenu},executeCommand:function(e){if(this.isOpened()&&this.hotMenu.getSelected()){var t=this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelected()[0]);if(this.runLocalHooks("select",t,e),t.isCommand!==!1&&t.name!==$){var n=this.hot.getSelectedRange(),r=n?V(n):{},o=!0;(t.disabled===!0||"function"==typeof t.disabled&&t.disabled.call(this.hot)===!0||t.submenu)&&(o=!1),this.runLocalHooks("executeCommand",t.key,r,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,r,e),o&&this.close(!0)}}},setPosition:function(e){var t=new O(e);this.options.keepInViewport?(t.fitsBelow(this.container)?this.setPositionBelowCursor(t):t.fitsAbove(this.container)?this.setPositionAboveCursor(t):this.setPositionBelowCursor(t),t.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(t):this.setPositionOnLeftOfCursor(t)):(this.setPositionBelowCursor(t),this.setPositionOnRightOfCursor(t))},setPositionAboveCursor:function(e){var t=this.offset.above+e.top-this.container.offsetHeight;this.isSubMenu()&&(t=e.top+e.cellHeight-this.container.offsetHeight+3),this.container.style.top=t+"px"},setPositionBelowCursor:function(e){var t=this.offset.below+e.top;this.isSubMenu()&&(t=e.top-1),this.container.style.top=t+"px"},setPositionOnRightOfCursor:function(e){var t;t=this.isSubMenu()?1+e.left+e.cellWidth:this.offset.right+1+e.left,this.container.style.left=t+"px"},setPositionOnLeftOfCursor:function(e){var t=this.offset.left+e.left-this.container.offsetWidth+y()+4;this.container.style.left=t+"px"},selectFirstCell:function(){var e=this.hotMenu.getCell(0,0);H(e)||D(e)||L(e)?this.selectNextCell(0,0):this.hotMenu.selectCell(0,0)},selectLastCell:function(){var e=this.hotMenu.countRows()-1,t=this.hotMenu.getCell(e,0);H(t)||D(t)||L(t)?this.selectPrevCell(e,0):this.hotMenu.selectCell(e,0)},selectNextCell:function(e,t){var n=e+1,r=n<this.hotMenu.countRows()?this.hotMenu.getCell(n,t):null;r&&(H(r)||D(r)||L(r)?this.selectNextCell(n,t):this.hotMenu.selectCell(n,t))},selectPrevCell:function(e,t){var n=e-1,r=n>=0?this.hotMenu.getCell(n,t):null;r&&(H(r)||D(r)||L(r)?this.selectPrevCell(n,t):this.hotMenu.selectCell(n,t))},menuItemRenderer:function(e,t,n,r,o,i){var s=this,a=e.getSourceDataAtRow(n),l=document.createElement("div"),u=function(e){return e.hasOwnProperty("submenu")},d=function(e){return new RegExp($,"i").test(e.name)},c=function(e){return e.disabled===!0||"function"==typeof e.disabled&&e.disabled.call(s.hot)===!0},h=function(e){return e.disableSelection};"function"==typeof i&&(i=i.call(this.hot)),w(t),v(l,"htItemWrapper"),t.appendChild(l),d(a)?v(t,"htSeparator"):"function"==typeof a.renderer?(v(t,"htCustomMenuRenderer"),t.appendChild(a.renderer(e,l,n,r,o,i))):b(l,i),c(a)?(v(t,"htDisabled"),this.eventManager.addEventListener(t,"mouseenter",function(){return e.deselectCell()})):h(a)?(v(t,"htSelectionDisabled"),this.eventManager.addEventListener(t,"mouseenter",function(){return e.deselectCell()})):u(a)?(v(t,"htSubmenu"),h(a)?this.eventManager.addEventListener(t,"mouseenter",function(){return e.deselectCell()}):this.eventManager.addEventListener(t,"mouseenter",function(){return e.selectCell(n,r,void 0,void 0,!1,!1)})):(C(t,"htSubmenu"),C(t,"htDisabled"),h(a)?this.eventManager.addEventListener(t,"mouseenter",function(){return e.deselectCell()}):this.eventManager.addEventListener(t,"mouseenter",function(){return e.selectCell(n,r,void 0,void 0,!1,!1)}))},createContainer:function(){var e=void 0!==arguments[0]?arguments[0]:null;e&&(e=e.replace(/ /g,"_"),e=this.options.className+"Sub_"+e);var t;return t=e?document.querySelector("."+this.options.className+"."+e):document.querySelector("."+this.options.className),t||(t=document.createElement("div"),v(t,"htMenu "+this.options.className),e&&v(t,e),document.getElementsByTagName("body")[0].appendChild(t)),t},blockMainTableCallbacks:function(){this._afterScrollCallback=function(){},this.hot.addHook("afterScrollVertically",this._afterScrollCallback),this.hot.addHook("afterScrollHorizontally",this._afterScrollCallback)},releaseMainTableCallbacks:function(){this._afterScrollCallback&&(this.hot.removeHook("afterScrollVertically",this._afterScrollCallback),this.hot.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)},onBeforeKeyDown:function(e){var t=this.hotMenu.getSelected(),n=!1;switch(e.keyCode){case j.ESCAPE:this.close(),n=!0;break;case j.ENTER:t&&(this.hotMenu.getSourceDataAtRow(t[0]).submenu?n=!0:(this.executeCommand(e),this.close(!0)));break;case j.ARROW_DOWN:t?this.selectNextCell(t[0],t[1]):this.selectFirstCell(),n=!0;break;case j.ARROW_UP:t?this.selectPrevCell(t[0],t[1]):this.selectLastCell(),n=!0;break;case j.ARROW_RIGHT:if(t){var r=this.openSubMenu(t[0]);r&&r.selectFirstCell()}n=!0;break;case j.ARROW_LEFT:t&&this.isSubMenu()&&(this.close(),this.parentMenu&&this.parentMenu.hotMenu.listen(),n=!0)}n&&(e.preventDefault(),B(e))},onAfterInit:function(){var e=this.hotMenu.getSettings().data,t=this.hotMenu.view.wt.wtTable.hider.style,n=this.hotMenu.view.wt.wtTable.holder.style,r=parseInt(t.width,10),o=S(e,function(e,t){return e+(t.name===$?1:26)},0);n.width=r+22+"px",n.height=o+4+"px",t.height=n.height},onDocumentMouseDown:function(e){this.isOpened()&&(this.container&&_(e.target,this.container)&&this.executeCommand(e),this.options.standalone&&this.hotMenu&&!_(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!_(e.target,".htMenu")&&_(e.target,document)&&this.close(!0))}},{}),A(W,F)},{browser:24,cursor:72,eventManager:42,"helpers/array":43,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/function":50,"helpers/object":53,"helpers/unicode":56,"mixins/localHooks":58,predefinedItems:75,utils:88}],75:[function(e,t,n){"use strict";function r(){var e={};return b(re,function(t,n){return e[n]=t()}),e}function o(e,t){ne.indexOf(e)===-1&&(re[e]=t)}var i;Object.defineProperties(n,{ALIGNMENT:{get:function(){return a.KEY}},CLEAR_COLUMN:{get:function(){return l.KEY}},COLUMN_LEFT:{get:function(){return u.KEY}},COLUMN_RIGHT:{get:function(){return d.KEY}},READ_ONLY:{get:function(){return c.KEY}},REDO:{get:function(){return h.KEY}},REMOVE_COLUMN:{get:function(){return f.KEY}},REMOVE_ROW:{get:function(){return p.KEY}},ROW_ABOVE:{get:function(){return m.KEY}},ROW_BELOW:{get:function(){return g.KEY}},SEPARATOR:{get:function(){return v.KEY}},UNDO:{get:function(){return w.KEY}},ITEMS:{get:function(){return ne}},predefinedItems:{get:function(){return r}},addItem:{get:function(){return o}},__esModule:{value:!0}});var s,a,l,u,d,c,h,f,p,m,g,v,w,a,l,u,d,c,h,f,p,m,g,v,w,b=(s=e("helpers/object"),s&&s.__esModule&&s||{default:s}).objectEach,y=(a=e("predefinedItems/alignment"),a&&a.__esModule&&a||{default:a}),_=y.alignmentItem,C=y.KEY,R=(l=e("predefinedItems/clearColumn"),l&&l.__esModule&&l||{default:l}),M=R.clearColumnItem,E=R.KEY,S=(u=e("predefinedItems/columnLeft"),u&&u.__esModule&&u||{default:u}),O=S.columnLeftItem,T=S.KEY,A=(d=e("predefinedItems/columnRight"),d&&d.__esModule&&d||{default:d}),N=A.columnRightItem,x=A.KEY,k=(c=e("predefinedItems/readOnly"),c&&c.__esModule&&c||{default:c}),I=k.readOnlyItem,D=k.KEY,P=(h=e("predefinedItems/redo"),h&&h.__esModule&&h||{default:h}),H=P.redoItem,L=P.KEY,V=(f=e("predefinedItems/removeColumn"),f&&f.__esModule&&f||{default:f}),j=V.removeColumnItem,F=V.KEY,$=(p=e("predefinedItems/removeRow"),p&&p.__esModule&&p||{default:p}),B=$.removeRowItem,W=$.KEY,U=(m=e("predefinedItems/rowAbove"),m&&m.__esModule&&m||{default:m}),Y=U.rowAboveItem,G=U.KEY,z=(g=e("predefinedItems/rowBelow"),g&&g.__esModule&&g||{default:g}),X=z.rowBelowItem,q=z.KEY,K=(v=e("predefinedItems/separator"),v&&v.__esModule&&v||{default:v}),Q=K.separatorItem,Z=K.KEY,J=(w=e("predefinedItems/undo"),w&&w.__esModule&&w||{default:w}),ee=J.undoItem,te=J.KEY,a=(a=e("predefinedItems/alignment"),a&&a.__esModule&&a||{default:a}),l=(l=e("predefinedItems/clearColumn"),l&&l.__esModule&&l||{default:l}),u=(u=e("predefinedItems/columnLeft"),u&&u.__esModule&&u||{default:u}),d=(d=e("predefinedItems/columnRight"),d&&d.__esModule&&d||{default:d}),c=(c=e("predefinedItems/readOnly"),c&&c.__esModule&&c||{default:c}),h=(h=e("predefinedItems/redo"),h&&h.__esModule&&h||{default:h}),f=(f=e("predefinedItems/removeColumn"),f&&f.__esModule&&f||{default:f}),p=(p=e("predefinedItems/removeRow"),p&&p.__esModule&&p||{default:p}),m=(m=e("predefinedItems/rowAbove"),m&&m.__esModule&&m||{default:m}),g=(g=e("predefinedItems/rowBelow"),g&&g.__esModule&&g||{default:g}),v=(v=e("predefinedItems/separator"),v&&v.__esModule&&v||{default:v}),w=(w=e("predefinedItems/undo"),w&&w.__esModule&&w||{default:w}),ne=[G,q,T,x,E,W,F,te,L,D,C,Z],re=(i={},Object.defineProperty(i,Z,{value:Q,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(i,G,{value:Y,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(i,q,{value:X,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(i,T,{value:O,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(i,x,{value:N,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(i,E,{value:M,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(i,W,{value:B,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(i,F,{value:j,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(i,te,{value:ee,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(i,L,{value:H,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(i,D,{value:I,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(i,C,{value:_,configurable:!0,enumerable:!0,writable:!0}),i)},{"helpers/object":53,"predefinedItems/alignment":76,"predefinedItems/clearColumn":77,"predefinedItems/columnLeft":78,"predefinedItems/columnRight":79,"predefinedItems/readOnly":80,"predefinedItems/redo":81,"predefinedItems/removeColumn":82,"predefinedItems/removeRow":83,"predefinedItems/rowAbove":84,"predefinedItems/rowBelow":85,"predefinedItems/separator":86,"predefinedItems/undo":87}],76:[function(e,t,n){"use strict";function r(){return{key:h,name:"Alignment",disabled:function(){return!(this.getSelectedRange()&&!this.selection.selectedHeader.corner)},submenu:{items:[{key:h+":left",name:function(){var e=this,t="Left",n=u(this.getSelectedRange(),function(t,n){var r=e.getCellMeta(t,n).className;if(r&&r.indexOf("htLeft")!==-1)return!0});return n&&(t=d(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=l(t,function(t,n){return e.getCellMeta(t,n).className}),r="horizontal",o="htLeft";this.runHooks("beforeCellAlignment",n,t,r,o),a(t,r,o,function(t,n){return e.getCellMeta(t,n)}),this.render()},disabled:!1},{key:h+":center",name:function(){var e=this,t="Center",n=u(this.getSelectedRange(),function(t,n){var r=e.getCellMeta(t,n).className;if(r&&r.indexOf("htCenter")!==-1)return!0});return n&&(t=d(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=l(t,function(t,n){return e.getCellMeta(t,n).className}),r="horizontal",o="htCenter";this.runHooks("beforeCellAlignment",n,t,r,o),a(t,r,o,function(t,n){return e.getCellMeta(t,n)}),this.render()},disabled:!1},{key:h+":right",name:function(){var e=this,t="Right",n=u(this.getSelectedRange(),function(t,n){var r=e.getCellMeta(t,n).className;if(r&&r.indexOf("htRight")!==-1)return!0});return n&&(t=d(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=l(t,function(t,n){return e.getCellMeta(t,n).className}),r="horizontal",o="htRight";this.runHooks("beforeCellAlignment",n,t,r,o),a(t,r,o,function(t,n){return e.getCellMeta(t,n)}),this.render()},disabled:!1},{key:h+":justify",name:function(){var e=this,t="Justify",n=u(this.getSelectedRange(),function(t,n){var r=e.getCellMeta(t,n).className;if(r&&r.indexOf("htJustify")!==-1)return!0});return n&&(t=d(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=l(t,function(t,n){return e.getCellMeta(t,n).className}),r="horizontal",o="htJustify";this.runHooks("beforeCellAlignment",n,t,r,o),a(t,r,o,function(t,n){return e.getCellMeta(t,n)}),this.render()},disabled:!1},{name:c},{key:h+":top",name:function(){var e=this,t="Top",n=u(this.getSelectedRange(),function(t,n){var r=e.getCellMeta(t,n).className;if(r&&r.indexOf("htTop")!==-1)return!0});return n&&(t=d(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=l(t,function(t,n){return e.getCellMeta(t,n).className}),r="vertical",o="htTop";this.runHooks("beforeCellAlignment",n,t,r,o),a(t,r,o,function(t,n){return e.getCellMeta(t,n)}),this.render()},disabled:!1},{key:h+":middle",name:function(){var e=this,t="Middle",n=u(this.getSelectedRange(),function(t,n){var r=e.getCellMeta(t,n).className;if(r&&r.indexOf("htMiddle")!==-1)return!0});return n&&(t=d(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=l(t,function(t,n){return e.getCellMeta(t,n).className}),r="vertical",o="htMiddle";this.runHooks("beforeCellAlignment",n,t,r,o),a(t,r,o,function(t,n){return e.getCellMeta(t,n)}),this.render()},disabled:!1},{key:h+":bottom",name:function(){var e=this,t="Bottom",n=u(this.getSelectedRange(),function(t,n){var r=e.getCellMeta(t,n).className;if(r&&r.indexOf("htBottom")!==-1)return!0});return n&&(t=d(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=l(t,function(t,n){return e.getCellMeta(t,n).className}),r="vertical",o="htBottom";this.runHooks("beforeCellAlignment",n,t,r,o),a(t,r,o,function(t,n){return e.getCellMeta(t,n)}),this.render()},disabled:!1}]}}}Object.defineProperties(n,{KEY:{get:function(){return h}},alignmentItem:{get:function(){return r}},__esModule:{value:!0}});var o,i,s=(o=e("utils"),o&&o.__esModule&&o||{default:o}),a=s.align,l=s.getAlignmentClasses,u=s.checkSelectionConsistency,d=s.markLabelAsSelected,c=(i=e("separator"),i&&i.__esModule&&i||{default:i}).KEY,h="alignment"},{separator:86,utils:88}],77:[function(e,t,n){"use strict";function r(){return{key:s,name:"Clear column",callback:function(e,t){var n=t.start.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(t.start.row,t.end.row),n)},disabled:function(){var e=i(this);if(!e)return!0;var t=[e[0],0,e[0],this.countCols()-1],n=t.join(",")==e.join(",");return e[1]<0||this.countCols()>=this.getSettings().maxCols||n}}}Object.defineProperties(n,{KEY:{get:function(){return s}},clearColumnItem:{get:function(){return r}},__esModule:{value:!0}});var o,i=(o=e("utils"),o&&o.__esModule&&o||{default:o}).getValidSelection,s="clear_column"},{utils:88}],78:[function(e,t,n){"use strict";function r(){return{key:s,name:"Insert column on the left",callback:function(e,t){this.alter("insert_col",t.start.col)},disabled:function(){var e=i(this);if(!e)return!0;if(!this.isColumnModificationAllowed())return!0;var t=[e[0],0,e[0],this.countCols()-1],n=t.join(",")==e.join(","),r=1===this.countCols();return e[1]<0||this.countCols()>=this.getSettings().maxCols||!r&&n},hidden:function(){return!this.getSettings().allowInsertColumn}}}Object.defineProperties(n,{KEY:{get:function(){return s}},columnLeftItem:{get:function(){return r}},__esModule:{value:!0}});var o,i=(o=e("utils"),o&&o.__esModule&&o||{default:o}).getValidSelection,s="col_left"},{utils:88}],79:[function(e,t,n){"use strict";function r(){return{key:s,name:"Insert column on the right",callback:function(e,t){this.alter("insert_col",t.end.col+1)},disabled:function(){var e=i(this);if(!e)return!0;if(!this.isColumnModificationAllowed())return!0;var t=[e[0],0,e[0],this.countCols()-1],n=t.join(",")==e.join(","),r=1===this.countCols();return e[1]<0||this.countCols()>=this.getSettings().maxCols||!r&&n},hidden:function(){return!this.getSettings().allowInsertColumn}}}Object.defineProperties(n,{KEY:{get:function(){return s}},columnRightItem:{get:function(){return r}},__esModule:{value:!0}});var o,i=(o=e("utils"),o&&o.__esModule&&o||{default:o}).getValidSelection,s="col_right"},{utils:88}],80:[function(e,t,n){"use strict";function r(){return{key:l,name:function(){var e=this,t="Read only",n=s(this.getSelectedRange(),function(t,n){return e.getCellMeta(t,n).readOnly});return n&&(t=a(t)),t},callback:function(){var e=this,t=this.getSelectedRange(),n=s(t,function(t,n){return e.getCellMeta(t,n).readOnly});t.forAll(function(t,r){e.getCellMeta(t,r).readOnly=!n}),this.render()},disabled:function(){return!(this.getSelectedRange()&&!this.selection.selectedHeader.corner)}}}Object.defineProperties(n,{KEY:{get:function(){return l}},readOnlyItem:{get:function(){return r}},__esModule:{value:!0}});var o,i=(o=e("utils"),o&&o.__esModule&&o||{default:o}),s=i.checkSelectionConsistency,a=i.markLabelAsSelected,l="make_read_only"},{utils:88}],81:[function(e,t,n){"use strict";function r(){return{key:o,name:"Redo",callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}}}Object.defineProperties(n,{KEY:{get:function(){return o}},redoItem:{get:function(){return r}},__esModule:{value:!0}});var o="redo"},{}],82:[function(e,t,n){"use strict";function r(){return{key:s,name:"Remove column",callback:function(e,t){var n=t.end.col-t.start.col+1;this.alter("remove_col",t.start.col,n)},disabled:function(){var e=i(this),t=this.countCols();return!e||this.selection.selectedHeader.rows||this.selection.selectedHeader.corner||!this.isColumnModificationAllowed()||!t},hidden:function(){return!this.getSettings().allowRemoveColumn}}}Object.defineProperties(n,{KEY:{get:function(){return s}},removeColumnItem:{get:function(){return r}},__esModule:{value:!0}});var o,i=(o=e("utils"),o&&o.__esModule&&o||{default:o}).getValidSelection,s="remove_col"},{utils:88}],83:[function(e,t,n){"use strict";function r(){return{key:s,name:"Remove row",callback:function(e,t){var n=t.end.row-t.start.row+1;this.alter("remove_row",t.start.row,n)},disabled:function(){var e=i(this),t=this.countRows();return!e||this.selection.selectedHeader.cols||this.selection.selectedHeader.corner||!t},hidden:function(){return!this.getSettings().allowRemoveRow}}}Object.defineProperties(n,{KEY:{get:function(){return s}},removeRowItem:{get:function(){return r}},__esModule:{value:!0}});var o,i=(o=e("utils"),o&&o.__esModule&&o||{default:o}).getValidSelection,s="remove_row"},{utils:88}],84:[function(e,t,n){"use strict";function r(){return{key:s,name:"Insert row above",callback:function(e,t){this.alter("insert_row",t.start.row)},disabled:function(){var e=i(this);return!e||this.selection.selectedHeader.cols||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}Object.defineProperties(n,{KEY:{get:function(){return s}},rowAboveItem:{get:function(){return r}},__esModule:{value:!0}});var o,i=(o=e("utils"),o&&o.__esModule&&o||{default:o}).getValidSelection,s="row_above"},{utils:88}],85:[function(e,t,n){"use strict";function r(){return{key:s,name:"Insert row below",callback:function(e,t){this.alter("insert_row",t.end.row+1)},disabled:function(){var e=i(this);return!e||this.selection.selectedHeader.cols||this.countRows()>=this.getSettings().maxRows},hidden:function(){return!this.getSettings().allowInsertRow}}}Object.defineProperties(n,{KEY:{get:function(){return s}},rowBelowItem:{get:function(){return r}},__esModule:{value:!0}});var o,i=(o=e("utils"),o&&o.__esModule&&o||{default:o}).getValidSelection,s="row_below"},{utils:88}],86:[function(e,t,n){"use strict";function r(){return{name:o}}Object.defineProperties(n,{KEY:{get:function(){return o}},separatorItem:{get:function(){return r}},__esModule:{value:!0}});var o="---------"},{}],87:[function(e,t,n){"use strict";function r(){return{key:o,name:"Undo",callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}}}Object.defineProperties(n,{KEY:{get:function(){return o}},undoItem:{get:function(){return r}},__esModule:{value:!0}});var o="undo"},{}],88:[function(e,t,n){"use strict";function r(e){return{start:e.getTopLeftCorner(),end:e.getBottomRightCorner()}}function o(e){return E(e,"htSeparator")}function i(e){return E(e,"htSubmenu")}function s(e){return E(e,"htDisabled")}function a(e){return E(e,"htSelectionDisabled")}function l(e){var t=e.getSelected();return t?t[0]<0?null:t:null}function u(e,t){return e.indexOf(t)!=-1?e:(e=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ",""),e+=" "+t)}function d(e,t){return e.indexOf(t)!=-1?e:(e=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ",""),e+=" "+t)}function c(e,t){for(var n={},r=e.from.row;r<=e.to.row;r++)for(var o=e.from.col;o<=e.to.col;o++)n[r]||(n[r]=[]),n[r][o]=t(r,o);return n}function h(e,t,n,r){if(e.from.row==e.to.row&&e.from.col==e.to.col)f(e.from.row,e.from.col,t,n,r);else for(var o=e.from.row;o<=e.to.row;o++)for(var i=e.from.col;i<=e.to.col;i++)f(o,i,t,n,r)}function f(e,t,n,r,o){var i=o(e,t),s=r;i.className&&(s="vertical"===n?u(i.className,r):d(i.className,r)),i.className=s}function p(e,t){var n=!1;return e&&e.forAll(function(e,r){if(t(e,r))return n=!0,!1}),n}function m(e){return'<span class="selected">'+String.fromCharCode(10003)+"</span>"+e}function g(e,t){return!e.hidden||!("function"==typeof e.hidden&&e.hidden.call(t))}function v(e,t){for(var n=e.slice(0),r=0;r<n.length&&n[r].name===t;)n.shift();return n}function w(e,t){var n=e.slice(0);return n.reverse(),n=v(n,t),n.reverse(),n}function b(e){var t=[];return M(e,function(e,n){n>0?t[t.length-1].name!==e.name&&t.push(e):t.push(e)}),t}function y(e){var t=void 0!==arguments[1]?arguments[1]:S,n=e.slice(0);return n=v(n,t),n=w(n,t),n=b(n)}Object.defineProperties(n,{normalizeSelection:{get:function(){return r}},isSeparator:{get:function(){return o}},hasSubMenu:{get:function(){return i}},isDisabled:{get:function(){return s}},isSelectionDisabled:{get:function(){return a}},getValidSelection:{get:function(){return l}},prepareVerticalAlignClass:{get:function(){return u}},prepareHorizontalAlignClass:{get:function(){return d}},getAlignmentClasses:{get:function(){return c}},align:{get:function(){return h}},checkSelectionConsistency:{get:function(){return p}},markLabelAsSelected:{get:function(){return m}},isItemHidden:{get:function(){return g}},filterSeparators:{get:function(){return y}},__esModule:{value:!0}});var _,C,R,M=(_=e("helpers/array"),_&&_.__esModule&&_||{default:_}).arrayEach,E=(C=e("helpers/dom/element"),C&&C.__esModule&&C||{default:C}).hasClass,S=(R=e("predefinedItems/separator"),R&&R.__esModule&&R||{default:R}).KEY},{"helpers/array":43,"helpers/dom/element":47,
"predefinedItems/separator":86}],89:[function(e,t,n){"use strict";Object.defineProperties(n,{ContextMenuCopyPaste:{get:function(){return v}},__esModule:{value:!0}});var r,o,i,s,a,l,u,d=(r=e("_base"),r&&r.__esModule&&r||{default:r}).default,c=(o=e("zeroclipboard"),o&&o.__esModule&&o||{default:o}).default,h=(i=e("helpers/dom/element"),i&&i.__esModule&&i||{default:i}).removeClass,f=(s=e("helpers/array"),s&&s.__esModule&&s||{default:s}).arrayEach,p=(a=e("eventManager"),a&&a.__esModule&&a||{default:a}).EventManager,m=(l=e("plugins"),l&&l.__esModule&&l||{default:l}).registerPlugin,g=(u=e("contextMenu/predefinedItems"),u&&u.__esModule&&u||{default:u}).SEPARATOR,v=function(e){$traceurRuntime.superConstructor(w).call(this,e),this.eventManager=new p(this),this.swfPath=null,this.outsideClickDeselectsCache=null},w=v;$traceurRuntime.createClass(v,{isEnabled:function(){return this.hot.getSettings().contextMenuCopyPaste},enablePlugin:function(){var e=this;if(!this.enabled){"object"==typeof this.hot.getSettings().contextMenuCopyPaste&&(this.swfPath=this.hot.getSettings().contextMenuCopyPaste.swfPath),"undefined"==typeof c&&console.error("To be able to use the Copy/Paste feature from the context menu, you need to manually include ZeroClipboard.js file to your website.");try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(e){"undefined"==typeof navigator.mimeTypes["application/x-shockwave-flash"]&&console.error("To be able to use the Copy/Paste feature from the context menu, your browser needs to have Flash Plugin installed.")}this.swfPath&&c.config({swfPath:this.swfPath}),this.hot.addHook("afterContextMenuShow",function(){return e.onAfterContextMenuShow()}),this.hot.addHook("afterContextMenuDefaultOptions",function(t){return e.onAfterContextMenuDefaultOptions(t)}),this.registerEvents(),$traceurRuntime.superGet(this,w.prototype,"enablePlugin").call(this)}},disablePlugin:function(){$traceurRuntime.superGet(this,w.prototype,"disablePlugin").call(this)},registerEvents:function(){var e=this;this.eventManager.addEventListener(document,"mouseenter",function(){return e.removeCurrentClass()}),this.eventManager.addEventListener(document,"mouseleave",function(){return e.removeZeroClipboardClass()})},getCopyValue:function(){return this.hot.copyPaste.setCopyableText(),this.hot.copyPaste.copyPasteInstance.elTextarea.value},onAfterContextMenuDefaultOptions:function(e){e.items.unshift({key:"copy",name:"Copy",disabled:function(){return this.selection.selectedHeader.corner}},{key:"paste",name:"Paste",callback:function(){this.copyPaste.triggerPaste()},disabled:function(){return this.selection.selectedHeader.corner}},{name:g})},onAfterContextMenuShow:function(){var e=this,t=this.hot.getPlugin("contextMenu"),n=t.menu.hotMenu.getSourceData();f(n,function(n,r){if("copy"===n.key){var o=new c(t.menu.hotMenu.getCell(r,0));return o.off(),o.on("copy",function(t){var n=t.clipboardData;n.setData("text/plain",e.getCopyValue()),e.hot.getSettings().outsideClickDeselects=e.outsideClickDeselectsCache}),!1}})},removeCurrentClass:function(){var e=this.hot.getPlugin("contextMenu");if(e.enabled){if(e.menu.isOpened()){var t=e.menu.hotMenu.rootElement.querySelector("td.current");t&&h(t,"current")}this.outsideClickDeselectsCache=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1}},removeZeroClipboardClass:function(){var e=this.hot.getPlugin("contextMenu");if(e.enabled){if(e.menu.isOpened()){var t=e.menu.hotMenu.rootElement.querySelector("td.zeroclipboard-is-hover");t&&h(t,"zeroclipboard-is-hover")}this.hot.getSettings().outsideClickDeselects=this.outsideClickDeselectsCache}}},{},d),m("contextMenuCopyPaste",v)},{_base:63,"contextMenu/predefinedItems":75,eventManager:42,"helpers/array":43,"helpers/dom/element":47,plugins:62,zeroclipboard:"zeroclipboard"}],90:[function(e,t,n){"use strict";function r(e){function t(){e.isListening()&&e.selection.empty()}function n(t){var n,r,o,i,s,a,l,u,d,c;if(e.isListening()&&e.selection.isSelected()){n=t,r=b.parse(n),o=e.getSelected(),i=new N(o[0],o[1]),s=new N(o[2],o[3]),a=new x(i,i,s),l=a.getTopLeftCorner(),u=a.getBottomRightCorner(),d=l,c=new N(Math.max(u.row,r.length-1+l.row),Math.max(u.col,r[0].length-1+l.col));var h=s.row-i.row>=r.length-1,f=s.col-i.col>=r[0].length-1;e.addHookOnce("afterChange",function(t,n){var r=t?t.length:0;if(r){var o={row:0,col:0},i=-1;R(t,function(e,n){var s=r>n+1?t[n+1]:null;s&&(h||(o.row=o.row+Math.max(s[0]-e[0]-1,0)),!f&&e[1]>i&&(i=e[1],o.col=o.col+Math.max(s[1]-e[1]-1,0)))}),e.selectCell(d.row,d.col,c.row+o.row,c.col+o.col)}}),e.populateFromArray(d.row,d.col,r,c.row,c.col,"paste",e.getSettings().pasteMode)}}function r(t){if(e.getSelected()&&!(e.getActiveEditor()&&e.getActiveEditor().isOpened()||O(t))){if(C(t.keyCode)){if(e.getSettings().fragmentSelection&&T())return;return o.setCopyableText(),void S(t)}var n=(t.ctrlKey||t.metaKey)&&!t.altKey;t.keyCode==_.A&&n&&e._registerTimeout(setTimeout(A(o.setCopyableText,o),0))}}var o=this;this.copyPasteInstance=w(),this.copyPasteInstance.onCut(t),this.copyPasteInstance.onPaste(n),this.onPaste=n,e.addHook("beforeKeyDown",r),this.destroy=function(){this.copyPasteInstance&&(this.copyPasteInstance.removeCallback(t),this.copyPasteInstance.removeCallback(n),this.copyPasteInstance.destroy(),this.copyPasteInstance=null),e.removeHook("beforeKeyDown",r)},e.addHook("afterDestroy",A(this.destroy,this)),this.triggerPaste=A(this.copyPasteInstance.triggerPaste,this.copyPasteInstance),this.triggerCut=A(this.copyPasteInstance.triggerCut,this.copyPasteInstance),this.setCopyableText=function(){var t=e.getSettings(),n=t.copyRowsLimit,r=t.copyColsLimit,o=e.getSelectedRange(),i=o.getTopLeftCorner(),s=o.getBottomRightCorner(),a=i.row,l=i.col,u=s.row,d=s.col,c=Math.min(u,a+n-1),h=Math.min(d,l+r-1),f=[];f.push({startRow:a,startCol:l,endRow:c,endCol:h}),f=v.hooks.run(e,"modifyCopyableRange",f);var p=this.getRangedCopyableData(f);e.copyPaste.copyPasteInstance.copyable(p),u===c&&d===h||v.hooks.run(e,"afterCopyLimit",u-a+1,d-l+1,n,r)},this.getRangedCopyableData=function(t){var n=[],r=[],o=[];return R(t,function(e){M(e.startRow,e.endRow,function(e){r.indexOf(e)===-1&&r.push(e)}),M(e.startCol,e.endCol,function(e){o.indexOf(e)===-1&&o.push(e)})}),R(r,function(t){var r=[];R(o,function(n){r.push(e.getCopyableData(t,n))}),n.push(r)}),b.stringify(n)}}function o(){var e=this,t=e.getSettings().copyPaste!==!1;t&&!e.copyPaste?e.copyPaste=new r(e):!t&&e.copyPaste&&(e.copyPaste.destroy(),e.copyPaste=null)}Object.defineProperties(n,{CopyPastePlugin:{get:function(){return r}},__esModule:{value:!0}});var i,s,a,l,u,d,c,h,f,p,m,g,v=(i=e("browser"),i&&i.__esModule&&i||{default:i}).default,w=(s=e("copyPaste"),s&&s.__esModule&&s||{default:s}).default,b=(a=e("SheetClip"),a&&a.__esModule&&a||{default:a}).default,y=(l=e("helpers/unicode"),l&&l.__esModule&&l||{default:l}),_=y.KEY_CODES,C=y.isCtrlKey,R=(u=e("helpers/array"),u&&u.__esModule&&u||{default:u}).arrayEach,M=(d=e("helpers/number"),d&&d.__esModule&&d||{default:d}).rangeEach,E=(c=e("helpers/dom/event"),c&&c.__esModule&&c||{default:c}),S=E.stopImmediatePropagation,O=E.isImmediatePropagationStopped,T=(h=e("helpers/dom/element"),h&&h.__esModule&&h||{default:h}).getSelectionText,A=(f=e("helpers/function"),f&&f.__esModule&&f||{default:f}).proxy,N=((p=e("plugins"),p&&p.__esModule&&p||{default:p}).registerPlugin,(m=e("3rdparty/walkontable/src/cell/coords"),m&&m.__esModule&&m||{default:m}).WalkontableCellCoords),x=(g=e("3rdparty/walkontable/src/cell/range"),g&&g.__esModule&&g||{default:g}).WalkontableCellRange;v.hooks.add("afterInit",o),v.hooks.add("afterUpdateSettings",o),v.hooks.register("afterCopyLimit"),v.hooks.register("modifyCopyableRange")},{"3rdparty/walkontable/src/cell/coords":6,"3rdparty/walkontable/src/cell/range":7,SheetClip:"SheetClip",browser:24,copyPaste:"copyPaste","helpers/array":43,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/function":50,"helpers/number":52,"helpers/unicode":56,plugins:62}],91:[function(e,t,n){"use strict";function r(){}var o,i,s,a,l,u=(o=e("browser"),o&&o.__esModule&&o||{default:o}).default,d=((i=e("plugins"),i&&i.__esModule&&i||{default:i}).registerPlugin,(s=e("3rdparty/walkontable/src/cell/range"),s&&s.__esModule&&s||{default:s}).WalkontableCellRange),c=(a=e("3rdparty/walkontable/src/selection"),a&&a.__esModule&&a||{default:a}).WalkontableSelection,h=function(e){return"boolean"==typeof e&&e===!0||"object"==typeof e&&e.length>0},f=function(){h(this.getSettings().customBorders)&&(this.customBorders||(l=this,this.customBorders=new r))},p=function(e){for(var t=0;t<l.view.wt.selections.length;t++)if(l.view.wt.selections[t].settings.className==e)return t;return-1},m=function(e){var t={row:e.row,col:e.col},n=new c(e,new d(t,t,t)),r=p(e.className);r>=0?l.view.wt.selections[r]=n:l.view.wt.selections.push(n)},g=function(e,t,n){var r=C(e,t);r=R(r,n),this.setCellMeta(e,t,"borders",r),m(r)},v=function(e){for(var t=e.range,n=t.from.row;n<=t.to.row;n++)for(var r=t.from.col;r<=t.to.col;r++){var o=C(n,r),i=0;n==t.from.row&&(i++,e.hasOwnProperty("top")&&(o.top=e.top)),n==t.to.row&&(i++,e.hasOwnProperty("bottom")&&(o.bottom=e.bottom)),r==t.from.col&&(i++,e.hasOwnProperty("left")&&(o.left=e.left)),r==t.to.col&&(i++,e.hasOwnProperty("right")&&(o.right=e.right)),i>0&&(this.setCellMeta(n,r,"borders",o),m(o))}},w=function(e,t){return"border_row"+e+"col"+t},b=function(){return{width:1,color:"#000"}},y=function(){return{hide:!0}},_=function(){return{width:1,color:"#000",cornerVisible:!1}},C=function(e,t){return{className:w(e,t),border:_(),row:e,col:t,top:y(),right:y(),bottom:y(),left:y()}},R=function(e,t){return t.hasOwnProperty("border")&&(e.border=t.border),t.hasOwnProperty("top")&&(e.top=t.top),t.hasOwnProperty("right")&&(e.right=t.right),t.hasOwnProperty("bottom")&&(e.bottom=t.bottom),t.hasOwnProperty("left")&&(e.left=t.left),e},M=function(e){for(var t=document.querySelectorAll("."+e),n=0;n<t.length;n++)if(t[n]&&"TD"!=t[n].nodeName){var r=t[n].parentNode;r.parentNode&&r.parentNode.removeChild(r)}},E=function(e,t){var n=w(e,t);M(n),this.removeCellMeta(e,t,"borders")},S=function(e,t,n,r){var o=this.getCellMeta(e,t).borders;o&&void 0!=o.border||(o=C(e,t)),r?o[n]=y():o[n]=b(),this.setCellMeta(e,t,"borders",o);var i=w(e,t);M(i),m(o),this.render()},O=function(e,t,n){if(e.from.row==e.to.row&&e.from.col==e.to.col)"noBorders"==t?E.call(this,e.from.row,e.from.col):S.call(this,e.from.row,e.from.col,t,n);else switch(t){case"noBorders":for(var r=e.from.col;r<=e.to.col;r++)for(var o=e.from.row;o<=e.to.row;o++)E.call(this,o,r);break;case"top":for(var i=e.from.col;i<=e.to.col;i++)S.call(this,e.from.row,i,t,n);break;case"right":for(var s=e.from.row;s<=e.to.row;s++)S.call(this,s,e.to.col,t);break;case"bottom":for(var a=e.from.col;a<=e.to.col;a++)S.call(this,e.to.row,a,t);break;case"left":for(var l=e.from.row;l<=e.to.row;l++)S.call(this,l,e.from.col,t)}},T=function(e,t){var n=!1;return e.getSelectedRange().forAll(function(r,o){var i=e.getCellMeta(r,o).borders;if(i){if(!t)return n=!0,!1;if(!i[t].hasOwnProperty("hide"))return n=!0,!1}}),n},A=function(e){return'<span class="selected">'+String.fromCharCode(10003)+"</span>"+e},N=function(e){this.getSettings().customBorders&&(e.items.push(u.plugins.ContextMenu.SEPARATOR),e.items.push({key:"borders",name:"Borders",disabled:function(){return this.selection.selectedHeader.corner},submenu:{items:[{key:"borders:top",name:function(){var e="Top",t=T(this,"top");return t&&(e=A(e)),e},callback:function(){var e=T(this,"top");O.call(this,this.getSelectedRange(),"top",e)}},{key:"borders:right",name:function(){var e="Right",t=T(this,"right");return t&&(e=A(e)),e},callback:function(){var e=T(this,"right");O.call(this,this.getSelectedRange(),"right",e)}},{key:"borders:bottom",name:function(){var e="Bottom",t=T(this,"bottom");return t&&(e=A(e)),e},callback:function(){var e=T(this,"bottom");O.call(this,this.getSelectedRange(),"bottom",e)}},{key:"borders:left",name:function(){var e="Left",t=T(this,"left");return t&&(e=A(e)),e},callback:function(){var e=T(this,"left");O.call(this,this.getSelectedRange(),"left",e)}},{key:"borders:no_borders",name:"Remove border(s)",callback:function(){O.call(this,this.getSelectedRange(),"noBorders")},disabled:function(){return!T(this)}}]}}))};u.hooks.add("beforeInit",f),u.hooks.add("afterContextMenuDefaultOptions",N),u.hooks.add("afterInit",function(){var e=this.getSettings().customBorders;if(e){for(var t=0;t<e.length;t++)e[t].range?v.call(this,e[t]):g.call(this,e[t].row,e[t].col,e[t]);this.render(),this.view.wt.draw(!0)}}),u.CustomBorders=r},{"3rdparty/walkontable/src/cell/range":7,"3rdparty/walkontable/src/selection":19,browser:24,plugins:62}],92:[function(e,t,n){"use strict";function r(){this.boundaries=null,this.callback=null}Object.defineProperties(n,{DragToScroll:{get:function(){return r}},__esModule:{value:!0}});var o,i,s,a=(o=e("browser"),o&&o.__esModule&&o||{default:o}).default,l=(i=e("eventManager"),i&&i.__esModule&&i||{default:i}).eventManager;(s=e("plugins"),s&&s.__esModule&&s||{default:s}).registerPlugin;a.plugins.DragToScroll=r,r.prototype.setBoundaries=function(e){this.boundaries=e},r.prototype.setCallback=function(e){this.callback=e},r.prototype.check=function(e,t){var n=0,r=0;t<this.boundaries.top?r=t-this.boundaries.top:t>this.boundaries.bottom&&(r=t-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,r)};var u,d=function(e){e.dragToScrollListening=!1;var t=e.view.wt.wtTable.holder;u=new r,t!==window&&(u.setBoundaries(t.getBoundingClientRect()),u.setCallback(function(e,n){e<0?t.scrollLeft-=50:e>0&&(t.scrollLeft+=50),n<0?t.scrollTop-=20:n>0&&(t.scrollTop+=20)}),e.dragToScrollListening=!0)};a.hooks.add("afterInit",function(){var e=this,t=l(this);t.addEventListener(document,"mouseup",function(){e.dragToScrollListening=!1}),t.addEventListener(document,"mousemove",function(t){e.dragToScrollListening&&u.check(t.clientX,t.clientY)})}),a.hooks.add("afterDestroy",function(){l(this).clear()}),a.hooks.add("afterOnCellMouseDown",function(){d(this)}),a.hooks.add("afterOnCellCornerMouseDown",function(){d(this)}),a.plugins.DragToScroll=r},{browser:24,eventManager:42,plugins:62}],93:[function(e,t,n){"use strict";function r(e){return{key:"freeze_column",name:"Freeze this column",callback:function(){var t=this.getSelectedRange().from.col;e.freezeColumn(t),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},hidden:function(){var e=this.getSelectedRange(),t=!1;return void 0===e?t=!0:(e.from.col!==e.to.col||e.from.col<=this.getSettings().fixedColumnsLeft-1)&&(t=!0),t}}}Object.defineProperties(n,{freezeColumnItem:{get:function(){return r}},__esModule:{value:!0}})},{}],94:[function(e,t,n){"use strict";function r(e){return{key:"unfreeze_column",name:"Unfreeze this column",callback:function(){var t=this.getSelectedRange().from.col;e.unfreezeColumn(t),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},hidden:function(){var e=this.getSelectedRange(),t=!1;return void 0===e?t=!0:(e.from.col!==e.to.col||e.from.col>=this.getSettings().fixedColumnsLeft)&&(t=!0),t}}}Object.defineProperties(n,{unfreezeColumnItem:{get:function(){return r}},__esModule:{value:!0}})},{}],95:[function(e,t,n){"use strict";Object.defineProperties(n,{ManualColumnFreeze:{get:function(){return g}},__esModule:{value:!0}});var r,o,i,s,a,l,u=(r=e("browser"),r&&r.__esModule&&r||{default:r}).default,d=(o=e("_base"),o&&o.__esModule&&o||{default:o}).default,c=(i=e("plugins"),i&&i.__esModule&&i||{default:i}).registerPlugin,h=(s=e("helpers/array"),s&&s.__esModule&&s||{default:s}).arrayEach,f=(a=e("contextMenuItem/freezeColumn"),a&&a.__esModule&&a||{default:a}).freezeColumnItem,p=(l=e("contextMenuItem/unfreezeColumn"),l&&l.__esModule&&l||{default:l}).unfreezeColumnItem,m=new WeakMap,g=function(e){$traceurRuntime.superConstructor(v).call(this,e),m.set(this,{moveByFreeze:!1,afterFirstUse:!1}),this.frozenColumnsBasePositions=[],this.manualColumnMovePlugin=void 0},v=g;$traceurRuntime.createClass(g,{isEnabled:function(){return!!this.hot.getSettings().manualColumnFreeze},enablePlugin:function(){var e=this;this.enabled||(this.addHook("afterContextMenuDefaultOptions",function(t){return e.addContextMenuEntry(t)}),this.addHook("afterInit",function(){return e.onAfterInit()}),this.addHook("beforeColumnMove",function(t,n){return e.onBeforeColumnMove(t,n)}),$traceurRuntime.superGet(this,v.prototype,"enablePlugin").call(this))},disablePlugin:function(){var e=m.get(this);e.afterFirstUse=!1,e.moveByFreeze=!1,$traceurRuntime.superGet(this,v.prototype,"disablePlugin").call(this)},updatePlugin:function(){this.disablePlugin(),this.enablePlugin(),$traceurRuntime.superGet(this,v.prototype,"updatePlugin").call(this)},freezeColumn:function(e){var t=m.get(this),n=this.hot.getSettings();t.afterFirstUse||(t.afterFirstUse=!0),n.fixedColumnsLeft===this.hot.countCols()||e<=n.fixedColumnsLeft-1||(t.moveByFreeze=!0,e!==this.getMovePlugin().columnsMapper.getValueByIndex(e)&&(this.frozenColumnsBasePositions[n.fixedColumnsLeft]=e),this.getMovePlugin().moveColumn(e,n.fixedColumnsLeft++))},unfreezeColumn:function(e){var t=m.get(this),n=this.hot.getSettings();if(t.afterFirstUse||(t.afterFirstUse=!0),!(n.fixedColumnsLeft<=0||e>n.fixedColumnsLeft-1)){var r=this.getBestColumnReturnPosition(e);t.moveByFreeze=!0,n.fixedColumnsLeft--,this.getMovePlugin().moveColumn(e,r+1)}},getMovePlugin:function(){return this.manualColumnMovePlugin||(this.manualColumnMovePlugin=this.hot.getPlugin("manualColumnMove")),this.manualColumnMovePlugin},getBestColumnReturnPosition:function(e){var t,n=this.getMovePlugin(),r=this.hot.getSettings(),o=r.fixedColumnsLeft,i=n.columnsMapper.getValueByIndex(o);if(null==this.frozenColumnsBasePositions[e])for(t=n.columnsMapper.getValueByIndex(e);i<t;)o++,i=n.columnsMapper.getValueByIndex(o);else{for(t=this.frozenColumnsBasePositions[e],this.frozenColumnsBasePositions[e]=void 0;i<=t;)o++,i=n.columnsMapper.getValueByIndex(o);o=i}return o-1},addContextMenuEntry:function(e){e.items.push(u.plugins.ContextMenu.SEPARATOR,f(this),p(this))},onAfterInit:function(){this.getMovePlugin().isEnabled()||this.getMovePlugin().enablePlugin()},onBeforeColumnMove:function(e,t){var n=m.get(this);if(n.afterFirstUse&&!n.moveByFreeze){var r=this.hot.getSettings().fixedColumnsLeft,o=t<r;if(o||h(e,function(e,t,n){if(e<r)return o=!0,!1}),o)return!1}n.moveByFreeze&&(n.moveByFreeze=!1)},destroy:function(){$traceurRuntime.superGet(this,v.prototype,"destroy").call(this)}},{},d),c("manualColumnFreeze",g)},{_base:63,browser:24,"contextMenuItem/freezeColumn":93,"contextMenuItem/unfreezeColumn":94,"helpers/array":43,plugins:62}],96:[function(e,t,n){"use strict";Object.defineProperties(n,{ColumnsMapper:{get:function(){return f}},__esModule:{value:!0}});var r,o,i,s,a,l=(r=e("browser"),r&&r.__esModule&&r||{default:r}).default,u=(o=e("mixins/arrayMapper"),o&&o.__esModule&&o||{default:o}).arrayMapper,d=(i=e("helpers/array"),i&&i.__esModule&&i||{default:i}).arrayFilter,c=(s=e("helpers/object"),s&&s.__esModule&&s||{default:s}).mixin,h=(a=e("helpers/number"),a&&a.__esModule&&a||{default:a}).rangeEach,f=function(e){this.manualColumnMove=e};$traceurRuntime.createClass(f,{createMap:function(e){var t=this,n=void 0===e?this._arrayMap.length:e;this._arrayMap.length=0,h(n-1,function(e){t._arrayMap[e]=e})},destroy:function(){this._arrayMap=null},moveColumn:function(e,t){var n=this._arrayMap[e];this._arrayMap[e]=null,this._arrayMap.splice(t,0,n)},clearNull:function(){this._arrayMap=d(this._arrayMap,function(e){return null!==e})}},{}),c(f,u),l.utils.ManualColumnMoveColumnsMapper=f},{browser:24,"helpers/array":43,"helpers/number":52,"helpers/object":53,"mixins/arrayMapper":57}],97:[function(e,t,n){"use strict";Object.defineProperties(n,{ManualColumnMove:{get:function(){return x}},__esModule:{value:!0}});var r,o,i,s,a,l,u,d,c,h,f=(r=e("_base.js"),r&&r.__esModule&&r||{default:r}).default,p=(o=e("browser"),o&&o.__esModule&&o||{default:o}).default,m=(i=e("helpers/array"),i&&i.__esModule&&i||{default:i}).arrayEach,g=(s=e("helpers/dom/element"),s&&s.__esModule&&s||{default:s}),v=g.addClass,w=g.removeClass,b=g.offset,y=(a=e("helpers/number"),a&&a.__esModule&&a||{default:a}).rangeEach,_=(l=e("eventManager"),l&&l.__esModule&&l||{default:l}).eventManager,C=(u=e("plugins"),u&&u.__esModule&&u||{default:u}).registerPlugin,R=(d=e("columnsMapper"),d&&d.__esModule&&d||{default:d}).ColumnsMapper,M=(c=e("ui/backlight"),c&&c.__esModule&&c||{default:c}).BacklightUI,E=(h=e("ui/guideline"),h&&h.__esModule&&h||{default:h}).GuidelineUI,S=new WeakMap,O="ht__manualColumnMove",T="show-ui",A="on-moving--columns",N="after-selection--columns",x=function(e){$traceurRuntime.superConstructor(k).call(this,e),S.set(this,{columnsToMove:[],countCols:0,fixedColumns:0,pressed:void 0,disallowMoving:void 0,target:{eventPageX:void 0,coords:void 0,TD:void 0,col:void 0}}),this.removedColumns=[],this.columnsMapper=new R(this),this.eventManager=_(this),this.backlight=new M(e),this.guideline=new E(e)},k=x;$traceurRuntime.createClass(x,{isEnabled:function(){return!!this.hot.getSettings().manualColumnMove},enablePlugin:function(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(t,n,r,o){return e.onBeforeOnCellMouseDown(t,n,r,o)}),this.addHook("beforeOnCellMouseOver",function(t,n,r,o){return e.onBeforeOnCellMouseOver(t,n,r,o)}),this.addHook("afterScrollVertically",function(){return e.onAfterScrollVertically()}),this.addHook("modifyCol",function(t,n){return e.onModifyCol(t,n)}),this.addHook("beforeRemoveCol",function(t,n){return e.onBeforeRemoveCol(t,n)}),this.addHook("afterRemoveCol",function(t,n){return e.onAfterRemoveCol(t,n)}),this.addHook("afterCreateCol",function(t,n){return e.onAfterCreateCol(t,n)}),this.addHook("unmodifyCol",function(t){return e.onUnmodifyCol(t)}),this.registerEvents(),v(this.hot.rootElement,O),$traceurRuntime.superGet(this,k.prototype,"enablePlugin").call(this))},updatePlugin:function(){this.disablePlugin(),this.enablePlugin(),this.onAfterPluginsInitialized(),$traceurRuntime.superGet(this,k.prototype,"updatePlugin").call(this)},disablePlugin:function(){var e=this.hot.getSettings().manualColumnMove;Array.isArray(e)&&this.columnsMapper.clearMap(),w(this.hot.rootElement,O),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),$traceurRuntime.superGet(this,k.prototype,"disablePlugin").call(this)},moveColumn:function(e,t){this.moveColumns([e],t)},moveColumns:function(e,t){var n=this,r=S.get(this),o=this.hot.runHooks("beforeColumnMove",e,t);r.disallowMoving=!o,o!==!1&&(m(e,function(e,t,r){r[t]=n.columnsMapper.getValueByIndex(e)}),m(e,function(e,r){var o=n.columnsMapper.getIndexByValue(e);o!==t&&n.columnsMapper.moveColumn(o,t+r)}),this.columnsMapper.clearNull()),this.hot.runHooks("afterColumnMove",e,t)},changeSelection:function(e,t){var n=this.hot.selection,r=this.hot.countRows()-1;n.setRangeStartOnly(new WalkontableCellCoords(0,e)),n.setRangeEnd(new WalkontableCellCoords(r,t),!1)},getColumnsWidth:function(e,t){for(var n=0,r=e;r<t;r++){var o=0;o=r<0?this.hot.view.wt.wtTable.getColumnWidth(r)||0:this.hot.view.wt.wtTable.getStretchedColumnWidth(r)||0,n+=o}return n},initialSettings:function(){var e=this.hot.getSettings().manualColumnMove;if(Array.isArray(e))this.moveColumns(e,0);else if(void 0!==e){var t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}},isFixedColumnsLeft:function(e){return e<this.hot.getSettings().fixedColumnsLeft},persistentStateSave:function(){p.hooks.run(this.hot,"persistentStateSave","manualColumnMove",this.columnsMapper._arrayMap)},persistentStateLoad:function(){var e={};return p.hooks.run(this.hot,"persistentStateLoad","manualColumnsMove",e),e.value?e.value:[]},prepareColumnsToMoving:function(e,t){var n=[];return y(e,t,function(e){n.push(e)}),n},refreshPositions:function(){var e=S.get(this),t=this.hot.view.wt.wtTable.getFirstVisibleColumn(),n=this.hot.view.wt.wtTable.getLastVisibleColumn(),r=this.hot.view.wt.wtTable,o=this.hot.view.wt.wtOverlays.scrollableElement,i="number"==typeof o.scrollX?o.scrollX:o.scrollLeft,s=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,e.coordsColumn),a=e.target.eventPageX-(e.rootElementOffset-(void 0===o.scrollX?i:0)),l=r.hider.offsetWidth,u=r.TBODY.offsetLeft,d=this.backlight.getOffset().left,c=this.backlight.getSize().width,h=0;if(e.rootElementOffset+r.holder.offsetWidth+i<e.target.eventPageX&&e.coordsColumn<e.countCols&&e.coordsColumn++,e.hasRowHeaders&&(h=this.hot.view.wt.wtOverlays.leftOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsLeft(e.coordsColumn)&&(s+=i),s+=h,e.coordsColumn<0)e.fixedColumns>0?e.target.col=0:e.target.col=t>0?t-1:t;else if(e.target.TD.offsetWidth/2+s<=a){var f=e.coordsColumn>=e.countCols?e.countCols-1:e.coordsColumn;e.target.col=f+1,s+=e.target.TD.offsetWidth,e.target.col>n&&this.hot.scrollViewportTo(void 0,n+1,void 0,!0)}else e.target.col=e.coordsColumn,e.target.col<=t&&e.target.col>=e.fixedColumns&&this.hot.scrollViewportTo(void 0,t-1);e.target.col<=t&&e.target.col>=e.fixedColumns&&this.hot.scrollViewportTo(void 0,t-1);var p=a,m=s;a+c+d>=l?p=l-c-d:a+d<u+h&&(p=u+h+Math.abs(d)),s>=l-1?m=l-1:0===m?m=1:void 0!==o.scrollX&&e.coordsColumn<e.fixedColumns&&(m-=e.rootElementOffset<=o.scrollX?e.rootElementOffset:0),this.backlight.setPosition(null,p),this.guideline.setPosition(null,m)},registerEvents:function(){var e=this;this.eventManager.addEventListener(document.documentElement,"mousemove",function(t){return e.onMouseMove(t)}),this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return e.onMouseUp()})},unregisterEvents:function(){this.eventManager.clear()},onBeforeOnCellMouseDown:function(e,t,n,r){var o=this.hot.view.wt.wtTable,i=this.hot.selection.selectedHeader.cols,s=this.hot.getSelectedRange(),a=S.get(this),l=e.realTarget.className.indexOf("columnSorting")>-1;if(!s||!i||a.pressed||0!==e.button||l)return a.pressed=!1,a.columnsToMove.length=0,void w(this.hot.rootElement,[A,T]);var u=this.guideline.isBuilt()&&!this.guideline.isAppended(),d=this.backlight.isBuilt()&&!this.backlight.isAppended();u&&d&&(this.guideline.appendTo(o.hider),this.backlight.appendTo(o.hider));var c=s,h=c.from,f=c.to,p=Math.min(h.col,f.col),m=Math.max(h.col,f.col);if(t.row<0&&t.col>=p&&t.col<=m){r.column=!0,a.pressed=!0,a.target.eventPageX=e.pageX,a.coordsColumn=t.col,a.target.TD=n,a.target.col=t.col,a.columnsToMove=this.prepareColumnsToMoving(p,m),a.hasRowHeaders=!!this.hot.getSettings().rowHeaders,a.countCols=this.hot.countCols(),a.fixedColumns=this.hot.getSettings().fixedColumnsLeft,a.rootElementOffset=b(this.hot.rootElement).left;var g=a.hasRowHeaders?-1:0,y=o.holder.scrollTop+o.getColumnHeaderHeight(0)+1,_=t.col<a.fixedColumns,C=this.hot.view.wt.wtOverlays.scrollableElement,R=C.scrollX?C.scrollX-a.rootElementOffset:0,M=e.layerX-(_?R:0),E=Math.abs(this.getColumnsWidth(p,t.col)+M);this.backlight.setPosition(y,this.getColumnsWidth(g,p)+E),this.backlight.setSize(this.getColumnsWidth(p,m+1),o.hider.offsetHeight-y),this.backlight.setOffset(null,E*-1),v(this.hot.rootElement,A)}else w(this.hot.rootElement,N),a.pressed=!1,a.columnsToMove.length=0},onMouseMove:function(e){var t=S.get(this);if(t.pressed){if(e.realTarget===this.backlight.element){var n=this.backlight.getSize().width;this.backlight.setSize(0),setTimeout(function(){this.backlight.setPosition(n)})}t.target.eventPageX=e.pageX,this.refreshPositions()}},onBeforeOnCellMouseOver:function(e,t,n,r){var o=this.hot.getSelectedRange(),i=S.get(this);o&&i.pressed&&(i.columnsToMove.indexOf(t.col)>-1?w(this.hot.rootElement,T):v(this.hot.rootElement,T),r.row=!0,r.column=!0,r.cell=!0,i.coordsColumn=t.col,i.target.TD=n)},onMouseUp:function(){var e=S.get(this);if(e.coordsColumn=void 0,e.pressed=!1,e.backlightWidth=0,w(this.hot.rootElement,[A,T,N]),this.hot.selection.selectedHeader.cols&&v(this.hot.rootElement,N),!(e.columnsToMove.length<1||void 0===e.target.col||e.columnsToMove.indexOf(e.target.col)>-1)){if(this.moveColumns(e.columnsToMove,e.target.col),this.persistentStateSave(),this.hot.render(),this.hot.view.wt.wtOverlays.adjustElementsSize(!0),!e.disallowMoving){var t=this.columnsMapper.getIndexByValue(e.columnsToMove[0]),n=this.columnsMapper.getIndexByValue(e.columnsToMove[e.columnsToMove.length-1]);this.changeSelection(t,n)}e.columnsToMove.length=0}},onAfterScrollVertically:function(){var e=this.hot.view.wt.wtTable,t=e.getColumnHeaderHeight(0)+1,n=e.holder.scrollTop,r=t+n;this.backlight.setPosition(r),this.backlight.setSize(null,e.hider.offsetHeight-r)},onAfterCreateCol:function(e,t){this.columnsMapper.shiftItems(e,t)},onBeforeRemoveCol:function(e,t){var n=this;this.removedColumns.length=0,e!==!1&&y(e,e+t-1,function(e){n.removedColumns.push(n.hot.runHooks("modifyCol",e,n.pluginName))})},onAfterRemoveCol:function(e,t){this.columnsMapper.unshiftItems(this.removedColumns)},onModifyCol:function(e,t){if(t!==this.pluginName){var n=this.columnsMapper.getValueByIndex(e);e=null===n?e:n}return e},onUnmodifyCol:function(e){var t=this.columnsMapper.getIndexByValue(e);return e=null===t?e:t},onAfterPluginsInitialized:function(){var e=this.hot.countCols(),t=this.columnsMapper._arrayMap.length;if(0===t)this.columnsMapper.createMap(this.hot.countSourceCols()||this.hot.getSettings().startCols);else if(t<e){var n=e-t;this.columnsMapper.insertItems(t,n)}else if(t>e){var r=e-1,o=[];m(this.columnsMapper._arrayMap,function(e,t,n){e>r&&o.push(t)}),this.columnsMapper.removeItems(o)}this.initialSettings(),this.backlight.build(),this.guideline.build()},destroy:function(){this.backlight.destroy(),this.guideline.destroy(),$traceurRuntime.superGet(this,k.prototype,"destroy").call(this)}},{},f),C("ManualColumnMove",x),p.hooks.register("beforeColumnMove"),p.hooks.register("afterColumnMove"),p.hooks.register("unmodifyCol")},{"_base.js":63,browser:24,columnsMapper:96,eventManager:42,"helpers/array":43,"helpers/dom/element":47,"helpers/number":52,plugins:62,"ui/backlight":99,"ui/guideline":100}],98:[function(e,t,n){"use strict";Object.defineProperties(n,{BaseUI:{get:function(){return u}},__esModule:{value:!0}});var r,o=(r=e("helpers/number"),r&&r.__esModule&&r||{default:r}).isNumeric,i=0,s=1,a=2,l="px",u=function(e){this.hot=e,this._element=null,this.state=i};$traceurRuntime.createClass(u,{appendTo:function(e){e.appendChild(this._element),this.state=a},build:function(){this._element=document.createElement("div"),this.state=s},destroy:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=i},isAppended:function(){return this.state===a},isBuilt:function(){return this.state>=s},setPosition:function(e,t){o(e)&&(this._element.style.top=e+l),o(t)&&(this._element.style.left=t+l)},getPosition:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}},setSize:function(e,t){o(e)&&(this._element.style.width=e+l),o(t)&&(this._element.style.height=t+l)},getSize:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}},setOffset:function(e,t){o(e)&&(this._element.style.marginTop=e+l),o(t)&&(this._element.style.marginLeft=t+l)},getOffset:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}},{})},{"helpers/number":52}],99:[function(e,t,n){"use strict";Object.defineProperties(n,{BacklightUI:{get:function(){return l}},__esModule:{value:!0}});var r,o,i=(r=e("_base"),r&&r.__esModule&&r||{default:r}).BaseUI,s=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{default:o}).addClass,a="ht__manualColumnMove--backlight",l=function(e){$traceurRuntime.superConstructor(u).call(this,e)},u=l;$traceurRuntime.createClass(l,{build:function(){$traceurRuntime.superGet(this,u.prototype,"build").call(this),s(this._element,a)}},{},i)},{_base:98,"helpers/dom/element":47
}],100:[function(e,t,n){"use strict";Object.defineProperties(n,{GuidelineUI:{get:function(){return l}},__esModule:{value:!0}});var r,o,i=(r=e("_base"),r&&r.__esModule&&r||{default:r}).BaseUI,s=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{default:o}).addClass,a="ht__manualColumnMove--guideline",l=function(e){$traceurRuntime.superConstructor(u).call(this,e)},u=l;$traceurRuntime.createClass(l,{build:function(){$traceurRuntime.superGet(this,u.prototype,"build").call(this),s(this._element,a)}},{},i)},{_base:98,"helpers/dom/element":47}],101:[function(e,t,n){"use strict";Object.defineProperties(n,{ManualColumnResize:{get:function(){return M}},__esModule:{value:!0}});var r,o,i,s,a,l,u,d,c=(r=e("browser"),r&&r.__esModule&&r||{default:r}).default,h=(o=e("_base.js"),o&&o.__esModule&&o||{default:o}).default,f=(i=e("helpers/dom/element"),i&&i.__esModule&&i||{default:i}),p=f.addClass,m=f.hasClass,g=f.removeClass,v=f.outerHeight,w=(s=e("eventManager"),s&&s.__esModule&&s||{default:s}).eventManager,b=(a=e("helpers/dom/event"),a&&a.__esModule&&a||{default:a}),y=b.pageX,_=(b.pageY,(l=e("helpers/array"),l&&l.__esModule&&l||{default:l}).arrayEach),C=(u=e("helpers/number"),u&&u.__esModule&&u||{default:u}).rangeEach,R=(d=e("plugins"),d&&d.__esModule&&d||{default:d}).registerPlugin,M=function(e){$traceurRuntime.superConstructor(E).call(this,e),this.currentTH=null,this.currentCol=null,this.selectedCols=[],this.currentWidth=null,this.newSize=null,this.startY=null,this.startWidth=null,this.startOffset=null,this.handle=document.createElement("DIV"),this.guide=document.createElement("DIV"),this.eventManager=w(this),this.pressed=null,this.dblclick=0,this.autoresizeTimeout=null,this.manualColumnWidths=[],p(this.handle,"manualColumnResizer"),p(this.guide,"manualColumnResizerGuide")},E=M;$traceurRuntime.createClass(M,{isEnabled:function(){return this.hot.getSettings().manualColumnResize},enablePlugin:function(){var e=this;if(!this.enabled){this.manualColumnWidths=[];var t=this.hot.getSettings().manualColumnResize,n=this.loadManualColumnWidths();this.addHook("modifyColWidth",function(t,n){return e.onModifyColWidth(t,n)}),this.addHook("beforeStretchingColumnWidth",function(t,n){return e.onBeforeStretchingColumnWidth(t,n)}),this.addHook("beforeColumnResize",function(t,n,r){return e.onBeforeColumnResize(t,n,r)}),"undefined"!=typeof n?this.manualColumnWidths=n:Array.isArray(t)?this.manualColumnWidths=t:this.manualColumnWidths=[],c.hooks.register("beforeColumnResize"),c.hooks.register("afterColumnResize"),this.bindEvents(),$traceurRuntime.superGet(this,E.prototype,"enablePlugin").call(this)}},updatePlugin:function(){var e=this.hot.getSettings().manualColumnResize;Array.isArray(e)?this.manualColumnWidths=e:e||(this.manualColumnWidths=[])},disablePlugin:function(){$traceurRuntime.superGet(this,E.prototype,"disablePlugin").call(this)},saveManualColumnWidths:function(){this.hot.runHooks("persistentStateSave","manualColumnWidths",this.manualColumnWidths)},loadManualColumnWidths:function(){var e={};return this.hot.runHooks("persistentStateLoad","manualColumnWidths",e),e.value},setupHandlePosition:function(e){var t=this;if(!e.parentNode)return!1;this.currentTH=e;var n=this.hot.view.wt.wtTable.getCoords(e).col,r=v(this.currentTH);if(n>=0){var o=this.currentTH.getBoundingClientRect();if(this.currentCol=n,this.selectedCols=[],this.hot.selection.isSelected()&&this.hot.selection.selectedHeader.cols){var i=this.hot.getSelectedRange(),s=i.from,a=i.to,l=s.col,u=a.col;l>=u&&(l=a.col,u=s.col),this.currentCol>=l&&this.currentCol<=u?C(l,u,function(e){return t.selectedCols.push(e)}):this.selectedCols.push(this.currentCol)}else this.selectedCols.push(this.currentCol);this.startOffset=o.left-6,this.startWidth=parseInt(o.width,10),this.handle.style.top=o.top+"px",this.handle.style.left=this.startOffset+this.startWidth+"px",this.handle.style.height=r+"px",this.hot.rootElement.appendChild(this.handle)}},refreshHandlePosition:function(){this.handle.style.left=this.startOffset+this.currentWidth+"px"},setupGuidePosition:function(){var e=parseInt(v(this.handle),10),t=parseInt(this.handle.style.top,10)+e,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);p(this.handle,"active"),p(this.guide,"active"),this.guide.style.top=t+"px",this.guide.style.left=this.handle.style.left,this.guide.style.height=n-e+"px",this.hot.rootElement.appendChild(this.guide)},refreshGuidePosition:function(){this.guide.style.left=this.handle.style.left},hideHandleAndGuide:function(){g(this.handle,"active"),g(this.guide,"active")},checkIfColumnHeader:function(e){if(e!=this.hot.rootElement){var t=e.parentNode;return"THEAD"===t.tagName||this.checkIfColumnHeader(t)}return!1},getTHFromTargetElement:function(e){return"TABLE"!=e.tagName?"TH"==e.tagName?e:this.getTHFromTargetElement(e.parentNode):null},onMouseOver:function(e){if(this.checkIfColumnHeader(e.target)){var t=this.getTHFromTargetElement(e.target);if(!t)return;var n=t.getAttribute("colspan");!t||null!==n&&1!==n||this.pressed||this.setupHandlePosition(t)}},afterMouseDownTimeout:function(){var e=this,t=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.wt.wtOverlays.adjustElementsSize(!0)},n=function(n,r){var o=e.hot.runHooks("beforeColumnResize",n,e.newSize,!0);void 0!==o&&(e.newSize=o),"all"===e.hot.getSettings().stretchH?e.clearManualSize(n):e.setManualSize(n,e.newSize),r&&t(),e.saveManualColumnWidths(),e.hot.runHooks("afterColumnResize",n,e.newSize,!0)};if(this.dblclick>=2){var r=this.selectedCols.length;r>1?(_(this.selectedCols,function(e){n(e)}),t()):_(this.selectedCols,function(e){n(e,!0)})}this.dblclick=0,this.autoresizeTimeout=null},onMouseDown:function(e){var t=this;m(e.target,"manualColumnResizer")&&(this.setupGuidePosition(),this.pressed=this.hot,null===this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout(function(){return t.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick++,this.startX=y(e),this.newSize=this.startWidth)},onMouseMove:function(e){var t=this;this.pressed&&(this.currentWidth=this.startWidth+(y(e)-this.startX),_(this.selectedCols,function(e){t.newSize=t.setManualSize(e,t.currentWidth)}),this.refreshHandlePosition(),this.refreshGuidePosition())},onMouseUp:function(e){var t=this,n=function(){t.hot.forceFullRender=!0,t.hot.view.render(),t.hot.view.wt.wtOverlays.adjustElementsSize(!0)},r=function(e,r){t.hot.runHooks("beforeColumnResize",e,t.newSize),r&&n(),t.saveManualColumnWidths(),t.hot.runHooks("afterColumnResize",e,t.newSize)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!=this.startWidth){var o=this.selectedCols.length;o>1?(_(this.selectedCols,function(e){r(e)}),n()):_(this.selectedCols,function(e){r(e,!0)})}this.setupHandlePosition(this.currentTH)}},bindEvents:function(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"mouseover",function(t){return e.onMouseOver(t)}),this.eventManager.addEventListener(this.hot.rootElement,"mousedown",function(t){return e.onMouseDown(t)}),this.eventManager.addEventListener(window,"mousemove",function(t){return e.onMouseMove(t)}),this.eventManager.addEventListener(window,"mouseup",function(t){return e.onMouseUp(t)})},setManualSize:function(e,t){return t=Math.max(t,20),e=this.hot.runHooks("modifyCol",e),this.manualColumnWidths[e]=t,t},clearManualSize:function(e){e=this.hot.runHooks("modifyCol",e),this.manualColumnWidths[e]=void 0},onModifyColWidth:function(e,t){return this.enabled&&(t=this.hot.runHooks("modifyCol",t),this.hot.getSettings().manualColumnResize&&this.manualColumnWidths[t])?this.manualColumnWidths[t]:e},onBeforeStretchingColumnWidth:function(e,t){var n=this.manualColumnWidths[t];return void 0===n&&(n=e),n},onBeforeColumnResize:function(){this.hot.view.wt.wtViewport.hasOversizedColumnHeadersMarked={}}},{},h),R("manualColumnResize",M)},{"_base.js":63,browser:24,eventManager:42,"helpers/array":43,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/number":52,plugins:62}],102:[function(e,t,n){"use strict";Object.defineProperties(n,{ManualRowMove:{get:function(){return x}},__esModule:{value:!0}});var r,o,i,s,a,l,u,d,c,h,f=(r=e("_base.js"),r&&r.__esModule&&r||{default:r}).default,p=(o=e("browser"),o&&o.__esModule&&o||{default:o}).default,m=(i=e("helpers/array"),i&&i.__esModule&&i||{default:i}).arrayEach,g=(s=e("helpers/dom/element"),s&&s.__esModule&&s||{default:s}),v=g.addClass,w=g.removeClass,b=g.offset,y=(a=e("helpers/number"),a&&a.__esModule&&a||{default:a}).rangeEach,_=(l=e("eventManager"),l&&l.__esModule&&l||{default:l}).eventManager,C=(u=e("plugins"),u&&u.__esModule&&u||{default:u}).registerPlugin,R=(d=e("rowsMapper"),d&&d.__esModule&&d||{default:d}).RowsMapper,M=(c=e("ui/backlight"),c&&c.__esModule&&c||{default:c}).BacklightUI,E=(h=e("ui/guideline"),h&&h.__esModule&&h||{default:h}).GuidelineUI,S=new WeakMap,O="ht__manualRowMove",T="show-ui",A="on-moving--rows",N="after-selection--rows",x=function(e){$traceurRuntime.superConstructor(k).call(this,e),S.set(this,{rowsToMove:[],pressed:void 0,disallowMoving:void 0,target:{eventPageY:void 0,coords:void 0,TD:void 0,row:void 0}}),this.removedRows=[],this.rowsMapper=new R(this),this.eventManager=_(this),this.backlight=new M(e),this.guideline=new E(e)},k=x;$traceurRuntime.createClass(x,{isEnabled:function(){return!!this.hot.getSettings().manualRowMove},enablePlugin:function(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(t,n,r,o){return e.onBeforeOnCellMouseDown(t,n,r,o)}),this.addHook("beforeOnCellMouseOver",function(t,n,r,o){return e.onBeforeOnCellMouseOver(t,n,r,o)}),this.addHook("afterScrollHorizontally",function(){return e.onAfterScrollHorizontally()}),this.addHook("modifyRow",function(t,n){return e.onModifyRow(t,n)}),this.addHook("beforeRemoveRow",function(t,n){return e.onBeforeRemoveRow(t,n)}),this.addHook("afterRemoveRow",function(t,n){return e.onAfterRemoveRow(t,n)}),this.addHook("afterCreateRow",function(t,n){return e.onAfterCreateRow(t,n)}),this.addHook("beforeColumnSort",function(t,n){return e.onBeforeColumnSort(t,n)}),this.addHook("unmodifyRow",function(t){return e.onUnmodifyRow(t)}),this.registerEvents(),v(this.hot.rootElement,O),$traceurRuntime.superGet(this,k.prototype,"enablePlugin").call(this))},updatePlugin:function(){this.disablePlugin(),this.enablePlugin(),this.onAfterPluginsInitialized(),$traceurRuntime.superGet(this,k.prototype,"updatePlugin").call(this)},disablePlugin:function(){var e=this.hot.getSettings().manualRowMove;Array.isArray(e)&&this.rowsMapper.clearMap(),w(this.hot.rootElement,O),this.unregisterEvents(),this.backlight.destroy(),this.guideline.destroy(),$traceurRuntime.superGet(this,k.prototype,"disablePlugin").call(this)},moveRow:function(e,t){this.moveRows([e],t)},moveRows:function(e,t){var n=this,r=S.get(this),o=this.hot.runHooks("beforeRowMove",e,t);r.disallowMoving=o===!1,r.disallowMoving||(m(e,function(e,t,r){r[t]=n.rowsMapper.getValueByIndex(e)}),m(e,function(e,r){var o=n.rowsMapper.getIndexByValue(e);o!==t&&n.rowsMapper.moveRow(o,t+r)}),this.rowsMapper.clearNull()),this.hot.runHooks("afterRowMove",e,t)},changeSelection:function(e,t){var n=this.hot.selection,r=this.hot.countCols()-1;n.setRangeStartOnly(new WalkontableCellCoords(e,0)),n.setRangeEnd(new WalkontableCellCoords(t,r),!1)},getRowsHeight:function(e,t){for(var n=0,r=e;r<t;r++){var o=this.hot.view.wt.wtTable.getRowHeight(r)||23;n+=o}return n},initialSettings:function(){var e=this.hot.getSettings().manualRowMove;if(Array.isArray(e))this.moveRows(e,0);else if(void 0!==e){var t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}},isFixedRowTop:function(e){return e<this.hot.getSettings().fixedRowsTop},isFixedRowBottom:function(e){return e>this.hot.getSettings().fixedRowsBottom},persistentStateSave:function(){p.hooks.run(this.hot,"persistentStateSave","manualRowMove",this.rowsMapper._arrayMap)},persistentStateLoad:function(){var e={};return p.hooks.run(this.hot,"persistentStateLoad","manualRowMove",e),e.value?e.value:[]},prepareRowsToMoving:function(){var e=this.hot.getSelectedRange(),t=[];if(!e)return t;var n=e,r=n.from,o=n.to,i=Math.min(r.row,o.row),s=Math.max(r.row,o.row);return y(i,s,function(e){t.push(e)}),t},refreshPositions:function(){var e=S.get(this),t=e.target.coords,n=this.hot.view.wt.wtTable.getFirstVisibleRow(),r=this.hot.view.wt.wtTable.getLastVisibleRow(),o=this.hot.getSettings().fixedRowsTop,i=this.hot.countRows();t.row<o&&n>0&&this.hot.scrollViewportTo(n-1),t.row>=r&&r<i&&this.hot.scrollViewportTo(r+1,void 0,!0);var s=this.hot.view.wt.wtTable,a=e.target.TD,l=b(this.hot.rootElement),u=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,t.row),d=e.target.eventPageY-l.top+s.holder.scrollTop,c=s.hider.offsetHeight,h=s.TBODY.offsetTop,f=this.backlight.getOffset().top,p=this.backlight.getSize().height;l.top+s.holder.offsetHeight<e.target.eventPageY&&e.target.coords.row++,this.isFixedRowTop(t.row)&&(u+=s.holder.scrollTop),t.row<0?e.target.row=n>0?n-1:n:a.offsetHeight/2+u<=d?(e.target.row=t.row+1,u+=0===t.row?a.offsetHeight-1:a.offsetHeight):e.target.row=t.row;var m=d,g=u;d+p+f>=c?m=c-p-f:d+f<h&&(m=h+Math.abs(f)),u>=c-1&&(g=c-1);var v=0;this.hot.view.wt.wtOverlays.topOverlay&&(v=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.TABLE.offsetHeight),t.row>=o&&g-s.holder.scrollTop<v&&this.hot.scrollViewportTo(t.row),this.backlight.setPosition(m),this.guideline.setPosition(g)},registerEvents:function(){var e=this;this.eventManager.addEventListener(document.documentElement,"mousemove",function(t){return e.onMouseMove(t)}),this.eventManager.addEventListener(document.documentElement,"mouseup",function(){return e.onMouseUp()})},unregisterEvents:function(){this.eventManager.clear()},onBeforeColumnSort:function(e,t){var n=S.get(this);n.disallowMoving=void 0!==t},onBeforeOnCellMouseDown:function(e,t,n,r){var o=this.hot.view.wt.wtTable,i=this.hot.selection.selectedHeader.rows,s=this.hot.getSelectedRange(),a=S.get(this);if(!s||!i||a.pressed||0!==e.button)return a.pressed=!1,a.rowsToMove.length=0,void w(this.hot.rootElement,[A,T]);var l=this.guideline.isBuilt()&&!this.guideline.isAppended(),u=this.backlight.isBuilt()&&!this.backlight.isAppended();l&&u&&(this.guideline.appendTo(o.hider),this.backlight.appendTo(o.hider));var d=s,c=d.from,h=d.to,f=Math.min(c.row,h.row),p=Math.max(c.row,h.row);if(t.col<0&&t.row>=f&&t.row<=p){r.row=!0,a.pressed=!0,a.target.eventPageY=e.pageY,a.target.coords=t,a.target.TD=n,a.rowsToMove=this.prepareRowsToMoving();var m=o.holder.scrollLeft+o.getColumnWidth(-1);this.backlight.setPosition(null,m),this.backlight.setSize(o.hider.offsetWidth-m,this.getRowsHeight(f,p+1)),this.backlight.setOffset((this.getRowsHeight(f,t.row)+e.layerY)*-1,null),v(this.hot.rootElement,A),this.refreshPositions()}else w(this.hot.rootElement,N),a.pressed=!1,a.rowsToMove.length=0},onMouseMove:function(e){var t=S.get(this);if(t.pressed){if(e.realTarget===this.backlight.element){var n=this.backlight.getSize().height;this.backlight.setSize(null,0),setTimeout(function(){this.backlight.setPosition(null,n)})}t.target.eventPageY=e.pageY,this.refreshPositions()}},onBeforeOnCellMouseOver:function(e,t,n,r){var o=this.hot.getSelectedRange(),i=S.get(this);o&&i.pressed&&(i.rowsToMove.indexOf(t.row)>-1?w(this.hot.rootElement,T):v(this.hot.rootElement,T),r.row=!0,r.column=!0,r.cell=!0,i.target.coords=t,i.target.TD=n)},onMouseUp:function(){var e=S.get(this);if(e.pressed=!1,e.backlightHeight=0,w(this.hot.rootElement,[A,T,N]),this.hot.selection.selectedHeader.rows&&v(this.hot.rootElement,N),!(e.rowsToMove.length<1)){var t=e.target.row;if(this.moveRows(e.rowsToMove,t),this.persistentStateSave(),this.hot.render(),!e.disallowMoving){var n=this.rowsMapper.getIndexByValue(e.rowsToMove[0]),r=this.rowsMapper.getIndexByValue(e.rowsToMove[e.rowsToMove.length-1]);this.changeSelection(n,r)}e.rowsToMove.length=0}},onAfterScrollHorizontally:function(){var e=this.hot.view.wt.wtTable,t=e.getColumnWidth(-1),n=e.holder.scrollLeft,r=t+n;this.backlight.setPosition(null,r),this.backlight.setSize(e.hider.offsetWidth-r)},onAfterCreateRow:function(e,t){this.rowsMapper.shiftItems(e,t)},onBeforeRemoveRow:function(e,t){var n=this;this.removedRows.length=0,e!==!1&&y(e,e+t-1,function(e){n.removedRows.push(n.hot.runHooks("modifyRow",e,n.pluginName))})},onAfterRemoveRow:function(e,t){this.rowsMapper.unshiftItems(this.removedRows)},onModifyRow:function(e,t){return t!==this.pluginName&&(e=this.rowsMapper.getValueByIndex(e)),e},onUnmodifyRow:function(e){return this.rowsMapper.getIndexByValue(e)},onAfterPluginsInitialized:function(){0===this.rowsMapper._arrayMap.length&&this.rowsMapper.createMap(this.hot.countSourceRows()||this.hot.getSettings().startRows),this.initialSettings(),this.backlight.build(),this.guideline.build()},destroy:function(){this.backlight.destroy(),this.guideline.destroy(),$traceurRuntime.superGet(this,k.prototype,"destroy").call(this)}},{},f),C("ManualRowMove",x),p.hooks.register("beforeRowMove"),p.hooks.register("afterRowMove"),p.hooks.register("unmodifyRow")},{"_base.js":63,browser:24,eventManager:42,"helpers/array":43,"helpers/dom/element":47,"helpers/number":52,plugins:62,rowsMapper:103,"ui/backlight":105,"ui/guideline":106}],103:[function(e,t,n){"use strict";Object.defineProperties(n,{RowsMapper:{get:function(){return f}},__esModule:{value:!0}});var r,o,i,s,a,l=(r=e("browser"),r&&r.__esModule&&r||{default:r}).default,u=(o=e("mixins/arrayMapper"),o&&o.__esModule&&o||{default:o}).arrayMapper,d=(i=e("helpers/array"),i&&i.__esModule&&i||{default:i}).arrayFilter,c=(s=e("helpers/object"),s&&s.__esModule&&s||{default:s}).mixin,h=(a=e("helpers/number"),a&&a.__esModule&&a||{default:a}).rangeEach,f=function(e){this.manualRowMove=e};$traceurRuntime.createClass(f,{createMap:function(e){var t=this,n=void 0===e?this._arrayMap.length:e;this._arrayMap.length=0,h(n-1,function(e){t._arrayMap[e]=e})},destroy:function(){this._arrayMap=null},moveRow:function(e,t){var n=this._arrayMap[e];this._arrayMap[e]=null,this._arrayMap.splice(t,0,n)},clearNull:function(){this._arrayMap=d(this._arrayMap,function(e){return null!==e})}},{}),c(f,u),l.utils.ManualRowMoveRowsMapper=f},{browser:24,"helpers/array":43,"helpers/number":52,"helpers/object":53,"mixins/arrayMapper":57}],104:[function(e,t,n){"use strict";Object.defineProperties(n,{BaseUI:{get:function(){return a}},__esModule:{value:!0}});var r=0,o=1,i=2,s="px",a=function(e){this.hot=e,this._element=null,this.state=r};$traceurRuntime.createClass(a,{appendTo:function(e){e.appendChild(this._element),this.state=i},build:function(){this._element=document.createElement("div"),this.state=o},destroy:function(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=r},isAppended:function(){return this.state===i},isBuilt:function(){return this.state>=o},setPosition:function(e,t){e&&(this._element.style.top=e+s),t&&(this._element.style.left=t+s)},getPosition:function(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}},setSize:function(e,t){e&&(this._element.style.width=e+s),t&&(this._element.style.height=t+s)},getSize:function(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}},setOffset:function(e,t){e&&(this._element.style.marginTop=e+s),t&&(this._element.style.marginLeft=t+s)},getOffset:function(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}},{})},{}],105:[function(e,t,n){"use strict";Object.defineProperties(n,{BacklightUI:{get:function(){return l}},__esModule:{value:!0}});var r,o,i=(r=e("_base"),r&&r.__esModule&&r||{default:r}).BaseUI,s=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{default:o}).addClass,a="ht__manualRowMove--backlight",l=function(e){$traceurRuntime.superConstructor(u).call(this,e)},u=l;$traceurRuntime.createClass(l,{build:function(){$traceurRuntime.superGet(this,u.prototype,"build").call(this),s(this._element,a)}},{},i)},{_base:104,"helpers/dom/element":47}],106:[function(e,t,n){"use strict";Object.defineProperties(n,{GuidelineUI:{get:function(){return l}},__esModule:{value:!0}});var r,o,i=(r=e("_base"),r&&r.__esModule&&r||{default:r}).BaseUI,s=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{default:o}).addClass,a="ht__manualRowMove--guideline",l=function(e){$traceurRuntime.superConstructor(u).call(this,e)},u=l;$traceurRuntime.createClass(l,{build:function(){$traceurRuntime.superGet(this,u.prototype,"build").call(this),s(this._element,a)}},{},i)},{_base:104,"helpers/dom/element":47}],107:[function(e,t,n){"use strict";Object.defineProperties(n,{ManualRowResize:{get:function(){return M}},__esModule:{value:!0}});var r,o,i,s,a,l,u,d,c=(r=e("browser"),r&&r.__esModule&&r||{default:r}).default,h=(o=e("_base.js"),o&&o.__esModule&&o||{default:o}).default,f=(i=e("helpers/dom/element"),i&&i.__esModule&&i||{default:i}),p=f.addClass,m=f.hasClass,g=f.removeClass,v=f.outerWidth,w=(s=e("eventManager"),s&&s.__esModule&&s||{default:s}).eventManager,b=(a=e("helpers/dom/event"),a&&a.__esModule&&a||{default:a}),y=(b.pageX,b.pageY),_=(l=e("helpers/array"),l&&l.__esModule&&l||{default:l}).arrayEach,C=(u=e("helpers/number"),u&&u.__esModule&&u||{default:u}).rangeEach,R=(d=e("plugins"),d&&d.__esModule&&d||{default:d}).registerPlugin,M=function(e){$traceurRuntime.superConstructor(E).call(this,e),this.currentTH=null,this.currentRow=null,this.selectedRows=[],this.currentHeight=null,this.newSize=null,this.startY=null,this.startHeight=null,this.startOffset=null,this.handle=document.createElement("DIV"),this.guide=document.createElement("DIV"),this.eventManager=w(this),this.pressed=null,this.dblclick=0,this.autoresizeTimeout=null,this.manualRowHeights=[],p(this.handle,"manualRowResizer"),p(this.guide,"manualRowResizerGuide")},E=M;$traceurRuntime.createClass(M,{isEnabled:function(){return this.hot.getSettings().manualRowResize},enablePlugin:function(){var e=this;if(!this.enabled){this.manualRowHeights=[];var t=this.hot.getSettings().manualRowResize,n=this.loadManualRowHeights();"undefined"!=typeof n?this.manualRowHeights=n:Array.isArray(t)?this.manualRowHeights=t:this.manualRowHeights=[],this.addHook("modifyRowHeight",function(t,n){return e.onModifyRowHeight(t,n)}),c.hooks.register("beforeRowResize"),c.hooks.register("afterRowResize"),this.bindEvents(),$traceurRuntime.superGet(this,E.prototype,"enablePlugin").call(this)}},updatePlugin:function(){var e=this.hot.getSettings().manualRowResize;Array.isArray(e)?this.manualRowHeights=e:e||(this.manualRowHeights=[])},disablePlugin:function(){$traceurRuntime.superGet(this,E.prototype,"disablePlugin").call(this)},saveManualRowHeights:function(){this.hot.runHooks("persistentStateSave","manualRowHeights",this.manualRowHeights)},loadManualRowHeights:function(){var e={};return this.hot.runHooks("persistentStateLoad","manualRowHeights",e),e.value},setupHandlePosition:function(e){var t=this;this.currentTH=e;var n=this.hot.view.wt.wtTable.getCoords(e).row,r=v(this.currentTH);if(n>=0){var o=this.currentTH.getBoundingClientRect();if(this.currentRow=n,this.selectedRows=[],this.hot.selection.isSelected()&&this.hot.selection.selectedHeader.rows){var i=this.hot.getSelectedRange(),s=i.from,a=i.to,l=s.row,u=a.row;l>=u&&(l=a.row,u=s.row),this.currentRow>=l&&this.currentRow<=u?C(l,u,function(e){return t.selectedRows.push(e)}):this.selectedRows.push(this.currentRow)}else this.selectedRows.push(this.currentRow);this.startOffset=o.top-6,this.startHeight=parseInt(o.height,10),this.handle.style.left=o.left+"px",this.handle.style.top=this.startOffset+this.startHeight+"px",this.handle.style.width=r+"px",this.hot.rootElement.appendChild(this.handle)}},refreshHandlePosition:function(){this.handle.style.top=this.startOffset+this.currentHeight+"px"},setupGuidePosition:function(){var e=parseInt(v(this.handle),10),t=parseInt(this.handle.style.left,10)+e,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);p(this.handle,"active"),p(this.guide,"active"),this.guide.style.top=this.handle.style.top,this.guide.style.left=t+"px",this.guide.style.width=n-e+"px",this.hot.rootElement.appendChild(this.guide)},refreshGuidePosition:function(){this.guide.style.top=this.handle.style.top},hideHandleAndGuide:function(){g(this.handle,"active"),g(this.guide,"active")},checkIfRowHeader:function(e){if(e!=this.hot.rootElement){var t=e.parentNode;return"TBODY"===t.tagName||this.checkIfRowHeader(t)}return!1},getTHFromTargetElement:function(e){return"TABLE"!=e.tagName?"TH"==e.tagName?e:this.getTHFromTargetElement(e.parentNode):null},onMouseOver:function(e){if(this.checkIfRowHeader(e.target)){var t=this.getTHFromTargetElement(e.target);t&&(this.pressed||this.setupHandlePosition(t))}},afterMouseDownTimeout:function(){var e=this,t=function(){e.hot.forceFullRender=!0,e.hot.view.render(),e.hot.view.wt.wtOverlays.adjustElementsSize(!0)},n=function(n,r){var o=e.hot.runHooks("beforeRowResize",n,e.newSize,!0);void 0!==o&&(e.newSize=o),e.setManualSize(n,e.newSize),r&&t(),e.hot.runHooks("afterRowResize",n,e.newSize,!0)};if(this.dblclick>=2){var r=this.selectedRows.length;r>1?(_(this.selectedRows,function(e){n(e)}),t()):_(this.selectedRows,function(e){n(e,!0)})}this.dblclick=0,this.autoresizeTimeout=null},onMouseDown:function(e){var t=this;m(e.target,"manualRowResizer")&&(this.setupGuidePosition(),this.pressed=this.hot,null==this.autoresizeTimeout&&(this.autoresizeTimeout=setTimeout(function(){return t.afterMouseDownTimeout()},500),this.hot._registerTimeout(this.autoresizeTimeout)),this.dblclick++,this.startY=y(e),this.newSize=this.startHeight)},onMouseMove:function(e){var t=this;this.pressed&&(this.currentHeight=this.startHeight+(y(e)-this.startY),_(this.selectedRows,function(e){t.newSize=t.setManualSize(e,t.currentHeight)}),this.refreshHandlePosition(),this.refreshGuidePosition())},onMouseUp:function(e){var t=this,n=function(){t.hot.forceFullRender=!0,t.hot.view.render(),t.hot.view.wt.wtOverlays.adjustElementsSize(!0)},r=function(e,r){t.hot.runHooks("beforeRowResize",e,t.newSize),r&&n(),t.saveManualRowHeights(),t.hot.runHooks("afterRowResize",e,t.newSize)};if(this.pressed){if(this.hideHandleAndGuide(),this.pressed=!1,this.newSize!=this.startHeight){var o=this.selectedRows.length;o>1?(_(this.selectedRows,function(e){r(e)}),n()):_(this.selectedRows,function(e){r(e,!0)})}this.setupHandlePosition(this.currentTH)}},bindEvents:function(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"mouseover",function(t){return e.onMouseOver(t)}),this.eventManager.addEventListener(this.hot.rootElement,"mousedown",function(t){return e.onMouseDown(t)}),this.eventManager.addEventListener(window,"mousemove",function(t){return e.onMouseMove(t)}),this.eventManager.addEventListener(window,"mouseup",function(t){return e.onMouseUp(t)})},setManualSize:function(e,t){return e=this.hot.runHooks("modifyRow",e),this.manualRowHeights[e]=t,t},onModifyRowHeight:function(e,t){if(this.enabled){var n=this.hot.getPlugin("autoRowSize"),r=n?n.heights[t]:null;t=this.hot.runHooks("modifyRow",t);var o=this.manualRowHeights[t];if(void 0!==o&&(o===r||o>(e||0)))return o}return e}},{},h),R("manualRowResize",M)},{"_base.js":63,browser:24,eventManager:42,"helpers/array":43,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/number":52,plugins:62}],108:[function(e,t,n){"use strict";function r(){var e=[];return e.getInfo=function(e,t){for(var n=0,r=this.length;n<r;n++)if(this[n].row<=e&&this[n].row+this[n].rowspan-1>=e&&this[n].col<=t&&this[n].col+this[n].colspan-1>=t)return this[n]},e.setInfo=function(e){for(var t=0,n=this.length;t<n;t++)if(this[t].row===e.row&&this[t].col===e.col)return void(this[t]=e);this.push(e)},e.removeInfo=function(e,t){for(var n=0,r=this.length;n<r;n++)if(this[n].row===e&&this[n].col===t){this.splice(n,1);break}},e}function o(e){if(this.mergedCellInfoCollection=new r,Array.isArray(e))for(var t=0,n=e.length;t<n;t++)this.mergedCellInfoCollection.setInfo(e[t])}function i(e,t){var n=this.getSettings().mergeCells;if(n&&!this.selection.isMultiple()){var r=this.mergeCells.mergedCellInfoCollection.getInfo(e[0],e[1]);r&&(e[0]=r.row,e[1]=r.col,e[2]=r.row+r.rowspan-1,e[3]=r.col+r.colspan-1)}}function s(e,t){this.mergeCells&&this.mergeCells.shiftCollection("right",e,t)}function a(e,t){this.mergeCells&&this.mergeCells.shiftCollection("left",e,t)}function l(e,t){this.mergeCells&&this.mergeCells.shiftCollection("down",e,t)}function u(e,t){this.mergeCells&&this.mergeCells.shiftCollection("up",e,t)}Object.defineProperties(n,{MergeCells:{get:function(){return o}},__esModule:{value:!0}});var d,c,h,f,p,m,g=(d=e("browser"),d&&d.__esModule&&d||{default:d}).default,v=((c=e("plugins"),c&&c.__esModule&&c||{default:c}).registerPlugin,(h=e("helpers/dom/event"),h&&h.__esModule&&h||{default:h}).stopImmediatePropagation),w=(f=e("3rdparty/walkontable/src/cell/coords"),f&&f.__esModule&&f||{default:f}).WalkontableCellCoords,b=(p=e("3rdparty/walkontable/src/cell/range"),p&&p.__esModule&&p||{default:p}).WalkontableCellRange,y=(m=e("3rdparty/walkontable/src/table"),m&&m.__esModule&&m||{default:m}).WalkontableTable;o.prototype.canMergeRange=function(e){return!e.isSingle()},o.prototype.mergeRange=function(e){if(this.canMergeRange(e)){var t=e.getTopLeftCorner(),n=e.getBottomRightCorner(),r={};r.row=t.row,r.col=t.col,r.rowspan=n.row-t.row+1,r.colspan=n.col-t.col+1,this.mergedCellInfoCollection.setInfo(r)}},o.prototype.mergeOrUnmergeSelection=function(e){var t=this.mergedCellInfoCollection.getInfo(e.from.row,e.from.col);t?this.unmergeSelection(e.from):this.mergeSelection(e)},o.prototype.mergeSelection=function(e){this.mergeRange(e)},o.prototype.unmergeSelection=function(e){var t=this.mergedCellInfoCollection.getInfo(e.row,e.col);this.mergedCellInfoCollection.removeInfo(t.row,t.col)},o.prototype.applySpanProperties=function(e,t,n){var r=this.mergedCellInfoCollection.getInfo(t,n);r?r.row===t&&r.col===n?(e.setAttribute("rowspan",r.rowspan),e.setAttribute("colspan",r.colspan)):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"))},o.prototype.modifyTransform=function(e,t,n){var r=function(e,t){return t.row>=e.row&&t.row<=e.row+e.rowspan-1},o=function(e,t){return t.col>=e.col&&t.col<=e.col+e.colspan-1},i=function(e){return new w(t.to.row+e.row,t.to.col+e.col)},s={row:n.row,col:n.col};if("modifyTransformStart"==e){this.lastDesiredCoords||(this.lastDesiredCoords=new w(null,null));for(var a,l=new w(t.highlight.row,t.highlight.col),u=this.mergedCellInfoCollection.getInfo(l.row,l.col),d=0,c=this.mergedCellInfoCollection.length;d<c;d++){var h=this.mergedCellInfoCollection[d];if(h=new w(h.row+h.rowspan-1,h.col+h.colspan-1),t.includes(h)){a=!0;break}}if(u){var f=new w(u.row,u.col),p=new w(u.row+u.rowspan-1,u.col+u.colspan-1),m=new b(f,f,p);m.includes(this.lastDesiredCoords)||(this.lastDesiredCoords=new w(null,null)),s.row=this.lastDesiredCoords.row?this.lastDesiredCoords.row-l.row:s.row,s.col=this.lastDesiredCoords.col?this.lastDesiredCoords.col-l.col:s.col,n.row>0?s.row=u.row+u.rowspan-1-l.row+n.row:n.row<0&&(s.row=l.row-u.row+n.row),n.col>0?s.col=u.col+u.colspan-1-l.col+n.col:n.col<0&&(s.col=l.col-u.col+n.col)}var g=new w(t.highlight.row+s.row,t.highlight.col+s.col),v=this.mergedCellInfoCollection.getInfo(g.row,g.col);v&&(this.lastDesiredCoords=g,s={row:v.row-l.row,col:v.col-l.col})}else if("modifyTransformEnd"==e)for(var d=0,c=this.mergedCellInfoCollection.length;d<c;d++){var y=this.mergedCellInfoCollection[d],f=new w(y.row,y.col),p=new w(y.row+y.rowspan-1,y.col+y.colspan-1),_=new b(f,f,p),C=t.getBordersSharedWith(_);if(_.isEqual(t))t.setDirection("NW-SE");else if(C.length>0){var R=t.highlight.isEqual(_.from);C.indexOf("top")>-1?t.to.isSouthEastOf(_.from)&&R?t.setDirection("NW-SE"):t.to.isSouthWestOf(_.from)&&R&&t.setDirection("NE-SW"):C.indexOf("bottom")>-1&&(t.to.isNorthEastOf(_.from)&&R?t.setDirection("SW-NE"):t.to.isNorthWestOf(_.from)&&R&&t.setDirection("SE-NW"));
}var g=i(s),M=r(y,g),E=o(y,g);t.includesRange(_)&&(_.includes(g)||M||E)&&(M&&(s.row<0?s.row-=y.rowspan-1:s.row>0&&(s.row+=y.rowspan-1)),E&&(s.col<0?s.col-=y.colspan-1:s.col>0&&(s.col+=y.colspan-1)))}0!==s.row&&(n.row=s.row),0!==s.col&&(n.col=s.col)},o.prototype.shiftCollection=function(e,t,n){var r=[0,0];switch(e){case"right":r[0]+=1;break;case"left":r[0]-=1;break;case"down":r[1]+=1;break;case"up":r[1]-=1}for(var o=0;o<this.mergedCellInfoCollection.length;o++){var i=this.mergedCellInfoCollection[o];"right"===e||"left"===e?t<=i.col&&(i.col+=r[0]):t<=i.row&&(i.row+=r[1])}};var _=function(){var e=this,t=e.getSettings().mergeCells;t&&(e.mergeCells||(e.mergeCells=new o(t)))},C=function(){var e=this;e.mergeCells&&(e.view.wt.wtTable.getCell=function(t){if(e.getSettings().mergeCells){var n=e.mergeCells.mergedCellInfoCollection.getInfo(t.row,t.col);n&&(t=n)}return y.prototype.getCell.call(this,t)})},R=function(){var e=this,t=e.getSettings().mergeCells;if(t)if(e.mergeCells){if(e.mergeCells.mergedCellInfoCollection=new r,Array.isArray(t))for(var n=0,i=t.length;n<i;n++)e.mergeCells.mergedCellInfoCollection.setInfo(t[n])}else e.mergeCells=new o(t);else e.mergeCells&&(e.mergeCells.mergedCellInfoCollection=new r)},M=function(e){if(this.mergeCells){var t=(e.ctrlKey||e.metaKey)&&!e.altKey;t&&77===e.keyCode&&(this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render(),v(e))}},E=function(e){this.getSettings().mergeCells&&(e.items.push(g.plugins.ContextMenu.SEPARATOR),e.items.push({key:"mergeCells",name:function(){var e=this.getSelected(),t=this.mergeCells.mergedCellInfoCollection.getInfo(e[0],e[1]);return t?"Unmerge cells":"Merge cells"},callback:function(){this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render()},disabled:function(){return this.selection.selectedHeader.corner}}))},S=function(e,t,n,r,o,i){this.mergeCells&&this.mergeCells.applySpanProperties(e,t,n)},O=function(e){return function(t){var n=this.getSettings().mergeCells;if(n){var r=this.getSelectedRange();if(this.mergeCells.modifyTransform(e,r,t),"modifyTransformEnd"===e){var o=this.countRows(),i=this.countCols();r.from.row<0?r.from.row=0:r.from.row>0&&r.from.row>=o&&(r.from.row=r.from-1),r.from.col<0?r.from.col=0:r.from.col>0&&r.from.col>=i&&(r.from.col=i-1)}}}},T=function(e){this.lastDesiredCoords=null;var t=this.getSettings().mergeCells;if(t){var n=this.getSelectedRange();n.highlight=new w(n.highlight.row,n.highlight.col),n.to=e;var r=!1;do{r=!1;for(var o=0,i=this.mergeCells.mergedCellInfoCollection.length;o<i;o++){var s=this.mergeCells.mergedCellInfoCollection[o],a=new w(s.row,s.col),l=new w(s.row+s.rowspan-1,s.col+s.colspan-1),u=new b(a,a,l);n.expandByRange(u)&&(e.row=n.to.row,e.col=n.to.col,r=!0)}}while(r)}},A=function(e,t){if(t&&"area"==t){var n=this.getSettings().mergeCells;if(n)for(var r=this.getSelectedRange(),o=new b(r.from,r.from,r.from),i=new b(r.to,r.to,r.to),s=0,a=this.mergeCells.mergedCellInfoCollection.length;s<a;s++){var l=this.mergeCells.mergedCellInfoCollection[s],u=new w(l.row,l.col),d=new w(l.row+l.rowspan-1,l.col+l.colspan-1),c=new b(u,u,d);o.expandByRange(c)&&(e[0]=o.from.row,e[1]=o.from.col),i.expandByRange(c)&&(e[2]=i.from.row,e[3]=i.from.col)}}},N=function(e,t,n){var r=this.getSettings().mergeCells;if(r){var o=this.mergeCells.mergedCellInfoCollection.getInfo(e,t);!o||o.row==e&&o.col==t||(n.copyable=!1)}},x=function(e){var t=this.getSettings().mergeCells;if(t)for(var n,r=this.countCols(),o=0;o<r;o++){if(n=this.mergeCells.mergedCellInfoCollection.getInfo(e.startRow,o),n&&n.row<e.startRow)return e.startRow=n.row,x.call(this,e);if(n=this.mergeCells.mergedCellInfoCollection.getInfo(e.endRow,o)){var i=n.row+n.rowspan-1;if(i>e.endRow)return e.endRow=i,x.call(this,e)}}},k=function(e){var t=this.getSettings().mergeCells;if(t)for(var n,r=this.countRows(),o=0;o<r;o++){if(n=this.mergeCells.mergedCellInfoCollection.getInfo(o,e.startColumn),n&&n.col<e.startColumn)return e.startColumn=n.col,k.call(this,e);if(n=this.mergeCells.mergedCellInfoCollection.getInfo(o,e.endColumn)){var i=n.col+n.colspan-1;if(i>e.endColumn)return e.endColumn=i,k.call(this,e)}}},I=function(e){if(e&&this.mergeCells){var t=this.mergeCells.mergedCellInfoCollection,n=this.getSelectedRange();for(var r in t)if(n.highlight.row==t[r].row&&n.highlight.col==t[r].col&&n.to.row==t[r].row+t[r].rowspan-1&&n.to.col==t[r].col+t[r].colspan-1)return!1}return e};g.hooks.add("beforeInit",_),g.hooks.add("afterInit",C),g.hooks.add("afterUpdateSettings",R),g.hooks.add("beforeKeyDown",M),g.hooks.add("modifyTransformStart",O("modifyTransformStart")),g.hooks.add("modifyTransformEnd",O("modifyTransformEnd")),g.hooks.add("beforeSetRangeEnd",T),g.hooks.add("beforeDrawBorders",A),g.hooks.add("afterIsMultipleSelection",I),g.hooks.add("afterRenderer",S),g.hooks.add("afterContextMenuDefaultOptions",E),g.hooks.add("afterGetCellMeta",N),g.hooks.add("afterViewportRowCalculatorOverride",x),g.hooks.add("afterViewportColumnCalculatorOverride",k),g.hooks.add("afterAutofillApplyValues",i),g.hooks.add("afterCreateCol",s),g.hooks.add("afterRemoveCol",a),g.hooks.add("afterCreateRow",l),g.hooks.add("afterRemoveRow",u),g.MergeCells=o},{"3rdparty/walkontable/src/cell/coords":6,"3rdparty/walkontable/src/cell/range":7,"3rdparty/walkontable/src/table":21,browser:24,"helpers/dom/event":48,plugins:62}],109:[function(e,t,n){"use strict";Object.defineProperties(n,{MultipleSelectionHandles:{get:function(){return v}},__esModule:{value:!0}});var r,o,i,s,a,l,u=((r=e("browser"),r&&r.__esModule&&r||{default:r}).default,o=e("helpers/dom/element"),o&&o.__esModule&&o||{default:o}),d=u.getWindowScrollTop,c=u.hasClass,h=u.getWindowScrollLeft,f=(i=e("helpers/browser"),i&&i.__esModule&&i||{default:i}).isMobileBrowser,p=(s=e("_base"),s&&s.__esModule&&s||{default:s}).default,m=(a=e("eventManager"),a&&a.__esModule&&a||{default:a}).EventManager,g=(l=e("plugins"),l&&l.__esModule&&l||{default:l}).registerPlugin,v=function(e){$traceurRuntime.superConstructor(w).call(this,e),this.dragged=[],this.eventManager=null,this.lastSetCell=null},w=v;$traceurRuntime.createClass(v,{isEnabled:function(){return f()},enablePlugin:function(){this.enabled||(this.eventManager||(this.eventManager=new m(this)),this.registerListeners(),$traceurRuntime.superGet(this,w.prototype,"enablePlugin").call(this))},registerListeners:function(){function e(e){if(1===t.dragged.length)return t.dragged.splice(0,t.dragged.length),!0;var n=t.dragged.indexOf(e);return n!=-1&&void(0===n?t.dragged=t.dragged.slice(0,1):1==n&&(t.dragged=t.dragged.slice(-1)))}var t=this;this.eventManager.addEventListener(this.hot.rootElement,"touchstart",function(e){var n;return c(e.target,"topLeftSelectionHandle-HitArea")?(n=t.hot.getSelectedRange(),t.dragged.push("topLeft"),t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},e.preventDefault(),!1):c(e.target,"bottomRightSelectionHandle-HitArea")?(n=t.hot.getSelectedRange(),t.dragged.push("bottomRight"),t.touchStartRange={width:n.getWidth(),height:n.getHeight(),direction:n.getDirection()},e.preventDefault(),!1):void 0}),this.eventManager.addEventListener(this.hot.rootElement,"touchend",function(n){return c(n.target,"topLeftSelectionHandle-HitArea")?(e.call(t,"topLeft"),t.touchStartRange=void 0,n.preventDefault(),!1):c(n.target,"bottomRightSelectionHandle-HitArea")?(e.call(t,"bottomRight"),t.touchStartRange=void 0,n.preventDefault(),!1):void 0}),this.eventManager.addEventListener(this.hot.rootElement,"touchmove",function(e){var n,r,o,i,s,a,l,u=d(),c=h();0!==t.dragged.length&&(n=document.elementFromPoint(e.touches[0].screenX-c,e.touches[0].screenY-u),n&&n!==t.lastSetCell&&("TD"!=n.nodeName&&"TH"!=n.nodeName||(r=t.hot.getCoords(n),r.col==-1&&(r.col=0),o=t.hot.getSelectedRange(),i=o.getWidth(),s=o.getHeight(),a=o.getDirection(),1==i&&1==s&&t.hot.selection.setRangeEnd(r),l=t.getCurrentRangeCoords(o,r,t.touchStartRange.direction,a,t.dragged[0]),null!==l.start&&t.hot.selection.setRangeStart(l.start),t.hot.selection.setRangeEnd(l.end),t.lastSetCell=n),e.preventDefault()))})},getCurrentRangeCoords:function(e,t,n,r,o){var i=e.getTopLeftCorner(),s=e.getBottomRightCorner(),a=e.getBottomLeftCorner(),l=e.getTopRightCorner(),u={start:null,end:null};switch(n){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":u="topLeft"==o?{start:new WalkontableCellCoords(t.row,e.highlight.col),end:new WalkontableCellCoords(a.row,t.col)}:{start:new WalkontableCellCoords(e.highlight.row,t.col),end:new WalkontableCellCoords(t.row,i.col)};break;case"SE-NW":"bottomRight"==o&&(u={start:new WalkontableCellCoords(s.row,t.col),end:new WalkontableCellCoords(t.row,i.col)})}break;case"NW-SE":switch(r){case"NE-SW":"topLeft"==o?u={start:t,end:a}:u.end=t;break;case"NW-SE":"topLeft"==o?u={start:t,end:s}:u.end=t;break;case"SE-NW":"topLeft"==o?u={start:t,end:i}:u.end=t;break;case"SW-NE":"topLeft"==o?u={start:t,end:l}:u.end=t}break;case"SW-NE":switch(r){case"NW-SE":u="bottomRight"==o?{start:new WalkontableCellCoords(t.row,i.col),end:new WalkontableCellCoords(a.row,t.col)}:{start:new WalkontableCellCoords(i.row,t.col),end:new WalkontableCellCoords(t.row,s.col)};break;case"SW-NE":u="topLeft"==o?{start:new WalkontableCellCoords(e.highlight.row,t.col),end:new WalkontableCellCoords(t.row,s.col)}:{start:new WalkontableCellCoords(t.row,i.col),end:new WalkontableCellCoords(i.row,t.col)};break;case"SE-NW":"bottomRight"==o?u={start:new WalkontableCellCoords(t.row,l.col),end:new WalkontableCellCoords(i.row,t.col)}:"topLeft"==o&&(u={start:a,end:t})}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":"topLeft"==o&&(u.end=t);break;case"SE-NW":"topLeft"==o?u.end=t:u={start:t,end:i}}}return u},isDragged:function(){return this.dragged.length>0}},{},p),g("multipleSelectionHandles",v)},{_base:63,browser:24,eventManager:42,"helpers/browser":44,"helpers/dom/element":47,plugins:62}],110:[function(e,t,n){"use strict";Object.defineProperties(n,{DataObserver:{get:function(){return c}},__esModule:{value:!0}});var r,o,i,s,a=(r=e("jsonpatch"),r&&r.__esModule&&r||{default:r}).default,l=(o=e("../../mixins/localHooks"),o&&o.__esModule&&o||{default:o}).localHooks,u=(i=e("../../helpers/object"),i&&i.__esModule&&i||{default:i}).mixin,d=(s=e("utils"),s&&s.__esModule&&s||{default:s}).cleanPatches,c=function(e){this.observedData=null,this.observer=null,this.paused=!1,this.setObservedData(e)};$traceurRuntime.createClass(c,{setObservedData:function(e){var t=this;this.observer&&a.unobserve(this.observedData,this.observer),this.observedData=e,this.observer=a.observe(this.observedData,function(e){return t.onChange(e)})},isPaused:function(){return this.paused},pause:function(){this.paused=!0},resume:function(){this.paused=!1},onChange:function(e){this.runLocalHooks("change",d(e))},destroy:function(){a.unobserve(this.observedData,this.observer),this.observedData=null,this.observer=null}},{}),u(c,l)},{"../../helpers/object":53,"../../mixins/localHooks":58,jsonpatch:"jsonpatch",utils:112}],111:[function(e,t,n){"use strict";Object.defineProperties(n,{ObserveChanges:{get:function(){return p}},__esModule:{value:!0}});var r,o,i,s,a,l,u=(r=e("browser"),r&&r.__esModule&&r||{default:r}).default,d=(o=e("_base"),o&&o.__esModule&&o||{default:o}).default,c=((i=e("jsonpatch"),i&&i.__esModule&&i||{default:i}).default,(s=e("dataObserver"),s&&s.__esModule&&s||{default:s}).DataObserver),h=(a=e("helpers/array"),a&&a.__esModule&&a||{default:a}).arrayEach,f=(l=e("plugins"),l&&l.__esModule&&l||{default:l}).registerPlugin;u.hooks.register("afterChangesObserved");var p=function(e){$traceurRuntime.superConstructor(m).call(this,e),this.observer=null},m=p;$traceurRuntime.createClass(p,{isEnabled:function(){return this.hot.getSettings().observeChanges},enablePlugin:function(){var e=this;this.enabled||(this.observer||(this.observer=new c(this.hot.getSourceData()),this._exposePublicApi()),this.observer.addLocalHook("change",function(t){return e.onDataChange(t)}),this.addHook("afterCreateRow",function(){return e.onAfterTableAlter()}),this.addHook("afterRemoveRow",function(){return e.onAfterTableAlter()}),this.addHook("afterCreateCol",function(){return e.onAfterTableAlter()}),this.addHook("afterRemoveCol",function(){return e.onAfterTableAlter()}),this.addHook("afterChange",function(t,n){return e.onAfterTableAlter(n)}),this.addHook("afterLoadData",function(t){return e.onAfterLoadData(t)}),$traceurRuntime.superGet(this,m.prototype,"enablePlugin").call(this))},disablePlugin:function(){this.observer&&(this.observer.destroy(),this.observer=null,this._deletePublicApi()),$traceurRuntime.superGet(this,m.prototype,"disablePlugin").call(this)},onDataChange:function(e){var t=this;if(!this.observer.isPaused()){var n={add:function(e){isNaN(e.col)?t.hot.runHooks("afterCreateRow",e.row):t.hot.runHooks("afterCreateCol",e.col)},remove:function(e){isNaN(e.col)?t.hot.runHooks("afterRemoveRow",e.row,1):t.hot.runHooks("afterRemoveCol",e.col,1)},replace:function(e){t.hot.runHooks("afterChange",[e.row,e.col,null,e.value],"external")}};h(e,function(e){n[e.op]&&n[e.op](e)}),this.hot.render()}this.hot.runHooks("afterChangesObserved")},onAfterTableAlter:function(e){var t=this;"loadData"!==e&&(this.observer.pause(),this.hot.addHookOnce("afterChangesObserved",function(){return t.observer.resume()}))},onAfterLoadData:function(e){e||this.observer.setObservedData(this.hot.getSourceData())},destroy:function(){this.observer&&(this.observer.destroy(),this._deletePublicApi()),$traceurRuntime.superGet(this,m.prototype,"destroy").call(this)},_exposePublicApi:function(){var e=this,t=this.hot;t.pauseObservingChanges=function(){return e.observer.pause()},t.resumeObservingChanges=function(){return e.observer.resume()},t.isPausedObservingChanges=function(){return e.observer.isPaused()}},_deletePublicApi:function(){var e=this.hot;delete e.pauseObservingChanges,delete e.resumeObservingChanges,delete e.isPausedObservingChanges}},{},d),f("observeChanges",p)},{_base:63,browser:24,dataObserver:110,"helpers/array":43,jsonpatch:"jsonpatch",plugins:62}],112:[function(e,t,n){"use strict";function r(e){var t=[];return e=a(e,function(e){return!/[\/]length/gi.test(e.path)&&!!o(e.path)}),e=l(e,function(e){var t=o(e.path);return e.row=t.row,e.col=t.col,e}),e=a(e,function(e){if(["add","remove"].indexOf(e.op)!==-1&&!isNaN(e.col)){if(t.indexOf(e.col)!==-1)return!1;t.push(e.col)}return!0}),t.length=0,e}function o(e){var t=e.match(/^\/(\d+)\/?(.*)?$/);if(!t)return null;var n=t,r=n[1],o=n[2];return{row:parseInt(r,10),col:/^\d*$/.test(o)?parseInt(o,10):o}}Object.defineProperties(n,{cleanPatches:{get:function(){return r}},parsePath:{get:function(){return o}},__esModule:{value:!0}});var i,s=(i=e("../../helpers/array"),i&&i.__esModule&&i||{default:i}),a=s.arrayFilter,l=s.arrayMap},{"../../helpers/array":43}],113:[function(e,t,n){"use strict";function r(e){var t,n=function(){window.localStorage[e+"__persistentStateKeys"]=JSON.stringify(t)},r=function(){var n=window.localStorage[e+"__persistentStateKeys"],r="string"==typeof n?JSON.parse(n):void 0;t=r?r:[]},o=function(){t=[],n()};r(),this.saveValue=function(r,o){window.localStorage[e+"_"+r]=JSON.stringify(o),t.indexOf(r)==-1&&(t.push(r),n())},this.loadValue=function(t,n){t="undefined"==typeof t?n:t;var r=window.localStorage[e+"_"+t];return"undefined"==typeof r?void 0:JSON.parse(r)},this.reset=function(t){window.localStorage.removeItem(e+"_"+t)},this.resetAll=function(){for(var n=0;n<t.length;n++)window.localStorage.removeItem(e+"_"+t[n]);o()}}function o(){function e(){var e=this;for(var t in o)o.hasOwnProperty(t)&&e.addHook(t,o[t])}function t(){var e=this;for(var t in o)o.hasOwnProperty(t)&&e.removeHook(t,o[t])}var n=this;this.init=function(){var o=this,i=o.getSettings().persistentState;return n.enabled=!!i,n.enabled?(o.storage||(o.storage=new r(o.rootElement.id)),o.resetState=n.resetValue,void e.call(o)):void t.call(o)},this.saveValue=function(e,t){var n=this;n.storage.saveValue(e,t)},this.loadValue=function(e,t){var n=this;t.value=n.storage.loadValue(e)},this.resetValue=function(e){var t=this;"undefined"==typeof e?t.storage.resetAll():t.storage.reset(e)};var o={persistentStateSave:n.saveValue,persistentStateLoad:n.loadValue,persistentStateReset:n.resetValue};for(var i in o)o.hasOwnProperty(i)&&a.hooks.register(i)}Object.defineProperties(n,{HandsontablePersistentState:{get:function(){return o}},__esModule:{value:!0}});var i,s,a=(i=e("browser"),i&&i.__esModule&&i||{default:i}).default,l=((s=e("plugins"),s&&s.__esModule&&s||{default:s}).registerPlugin,new o);a.hooks.add("beforeInit",l.init),a.hooks.add("afterUpdateSettings",l.init)},{browser:24,plugins:62}],114:[function(e,t,n){"use strict";function r(){var e=this,t=!!e.getSettings().search;t?e.search=new a.Search(e):delete e.search}var o,i,s,a=(o=e("browser"),o&&o.__esModule&&o||{default:o}).default,l=(i=e("helpers/dom/element"),i&&i.__esModule&&i||{default:i}),u=l.addClass,d=l.removeClass,c=(s=e("renderers"),s&&s.__esModule&&s||{default:s}),h=c.registerRenderer,f=c.getRenderer;a.Search=function(e){this.query=function(t,n,r){var o=e.countRows(),i=e.countCols(),s=[];n||(n=a.Search.global.getDefaultCallback()),r||(r=a.Search.global.getDefaultQueryMethod());for(var l=0;l<o;l++)for(var u=0;u<i;u++){var d=e.getDataAtCell(l,u),c=e.getCellMeta(l,u),h=c.search.callback||n,f=c.search.queryMethod||r,p=f(t,d);if(p){var m={row:l,col:u,data:d};s.push(m)}h&&h(e,l,u,d,p)}return s}},a.Search.DEFAULT_CALLBACK=function(e,t,n,r,o){e.getCellMeta(t,n).isSearchResult=o},a.Search.DEFAULT_QUERY_METHOD=function(e,t){return!("undefined"==typeof e||null==e||!e.toLowerCase||0===e.length)&&("undefined"!=typeof t&&null!=t&&t.toString().toLowerCase().indexOf(e.toLowerCase())!=-1)},a.Search.DEFAULT_SEARCH_RESULT_CLASS="htSearchResult",a.Search.global=function(){var e=a.Search.DEFAULT_CALLBACK,t=a.Search.DEFAULT_QUERY_METHOD,n=a.Search.DEFAULT_SEARCH_RESULT_CLASS;return{getDefaultCallback:function(){return e},setDefaultCallback:function(t){e=t},getDefaultQueryMethod:function(){return t},setDefaultQueryMethod:function(e){t=e},getDefaultSearchResultClass:function(){return n},setDefaultSearchResultClass:function(e){n=e}}}(),a.SearchCellDecorator=function(e,t,n,r,o,i,s){var l=null!==s.search&&"object"==typeof s.search&&s.search.searchResultClass||a.Search.global.getDefaultSearchResultClass();s.isSearchResult?u(t,l):d(t,l)};var p=f("base");h("base",function(e,t,n,r,o,i,s){p.apply(this,arguments),a.SearchCellDecorator.apply(this,arguments)}),a.hooks.add("afterInit",r),a.hooks.add("afterUpdateSettings",r)},{browser:24,"helpers/dom/element":47,renderers:117}],115:[function(e,t,n){"use strict";Object.defineProperties(n,{TouchScroll:{get:function(){return f}},__esModule:{value:!0}});var r,o,i,s,a=(r=e("browser"),r&&r.__esModule&&r||{default:r}).default,l=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{default:o}),u=l.addClass,d=l.removeClass,c=(i=e("_base"),i&&i.__esModule&&i||{default:i}).default,h=(s=e("plugins"),s&&s.__esModule&&s||{default:s}).registerPlugin,f=function(e){var t=this;$traceurRuntime.superConstructor(p).call(this,e),this.hot.addHook("afterInit",function(){return t.afterInit()}),this.hot.addHook("afterUpdateSettings",function(){return t.onAfterUpdateSettings()}),this.scrollbars=[],this.clones=[]},p=f;$traceurRuntime.createClass(f,{afterInit:function(){this.registerEvents(),this.onAfterUpdateSettings()},onAfterUpdateSettings:function(){var e=this;this.hot.addHookOnce("afterRender",function(){var t=e.hot.view.wt.wtOverlays;e.scrollbars=[],e.scrollbars.push(t.topOverlay),t.bottomOverlay.clone&&e.scrollbars.push(t.bottomOverlay),e.scrollbars.push(t.leftOverlay),t.topLeftCornerOverlay&&e.scrollbars.push(t.topLeftCornerOverlay),t.bottomLeftCornerOverlay&&t.bottomLeftCornerOverlay.clone&&e.scrollbars.push(t.bottomLeftCornerOverlay),e.clones=[],t.topOverlay.needFullRender&&e.clones.push(t.topOverlay.clone.wtTable.holder.parentNode),t.bottomOverlay.needFullRender&&e.clones.push(t.bottomOverlay.clone.wtTable.holder.parentNode),t.leftOverlay.needFullRender&&e.clones.push(t.leftOverlay.clone.wtTable.holder.parentNode),t.topLeftCornerOverlay&&e.clones.push(t.topLeftCornerOverlay.clone.wtTable.holder.parentNode),t.bottomLeftCornerOverlay&&t.bottomLeftCornerOverlay.clone&&e.clones.push(t.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode)})},registerEvents:function(){var e=this;this.hot.addHook("beforeTouchScroll",function(){return e.onBeforeTouchScroll()}),this.hot.addHook("afterMomentumScroll",function(){return e.onAfterMomentumScroll()})},onBeforeTouchScroll:function(){a.freezeOverlays=!0;for(var e=0,t=this.clones.length;e<t;e++)u(this.clones[e],"hide-tween")},onAfterMomentumScroll:function(){a.freezeOverlays=!1;for(var e=this,t=0,n=this.clones.length;t<n;t++)d(this.clones[t],"hide-tween");for(var r=0,o=this.clones.length;r<o;r++)u(this.clones[r],"show-tween");setTimeout(function(){for(var t=0,n=e.clones.length;t<n;t++)d(e.clones[t],"show-tween")},400);for(var i=0,s=this.scrollbars.length;i<s;i++)this.scrollbars[i].refresh(),this.scrollbars[i].resetFixedPosition();this.hot.view.wt.wtOverlays.syncScrollWithMaster()}},{},c),h("touchScroll",f)},{_base:63,browser:24,"helpers/dom/element":47,plugins:62}],116:[function(e,t,n){"use strict";function r(){var e=this,t="undefined"==typeof e.getSettings().undo||e.getSettings().undo;t?e.undoRedo||(e.undoRedo=new f.UndoRedo(e),s(e),e.addHook("beforeKeyDown",o),e.addHook("afterChange",i)):e.undoRedo&&(delete e.undoRedo,a(e),e.removeHook("beforeKeyDown",o),e.removeHook("afterChange",i))}function o(e){var t=this,n=(e.ctrlKey||e.metaKey)&&!e.altKey;n&&(89===e.keyCode||e.shiftKey&&90===e.keyCode?(t.undoRedo.redo(),b(e)):90===e.keyCode&&(t.undoRedo.undo(),b(e)))}function i(e,t){var n=this;if("loadData"==t)return n.undoRedo.clear()}function s(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function a(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}var l,u,d,c,h,f=(l=e("browser"),l&&l.__esModule&&l||{default:l}).default,p=(u=e("helpers/array"),u&&u.__esModule&&u||{default:u}).arrayMap,m=(d=e("helpers/number"),d&&d.__esModule&&d||{default:d}).rangeEach,g=(c=e("helpers/object"),c&&c.__esModule&&c||{default:c}),v=g.inherit,w=g.deepClone,b=(h=e("helpers/dom/event"),h&&h.__esModule&&h||{default:h}).stopImmediatePropagation;f.UndoRedo=function(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,e.addHook("afterChange",function(e,n){e&&"undo"!==n&&"redo"!==n&&t.done(new f.UndoRedo.ChangeAction(e))}),e.addHook("afterCreateRow",function(e,n,r){if("undo"!==r&&"redo"!==r&&"auto"!==r){var o=new f.UndoRedo.CreateRowAction(e,n);t.done(o)}}),e.addHook("beforeRemoveRow",function(e,n,r,o){if("undo"!==o&&"redo"!==o&&"auto"!==o){var i=t.instance.getSourceDataArray();e=(i.length+e)%i.length;var s=w(i.slice(e,e+n));t.done(new f.UndoRedo.RemoveRowAction(e,s))}}),e.addHook("afterCreateCol",function(e,n,r){"undo"!==r&&"redo"!==r&&"auto"!==r&&t.done(new f.UndoRedo.CreateColumnAction(e,n))}),e.addHook("beforeRemoveCol",function(n,r,o,i){if("undo"!==i&&"redo"!==i&&"auto"!==i){var s=t.instance.getSourceDataArray();n=(t.instance.countCols()+n)%t.instance.countCols();var a=[],l=[],u=[];m(s.length-1,function(t){var o=[],i=s[t];m(n,n+(r-1),function(t){o.push(i[e.runHooks("modifyCol",t)])}),a.push(o)}),m(r-1,function(t){u.push(e.runHooks("modifyCol",n+t))}),Array.isArray(e.getSettings().colHeaders)&&m(r-1,function(t){l.push(e.getSettings().colHeaders[e.runHooks("modifyCol",n+t)]||null)});var d=t.instance.getPlugin("manualColumnMove"),c=d.isEnabled()?d.columnsMapper.__arrayMap:[],h=new f.UndoRedo.RemoveColumnAction(n,u,a,l,c);t.done(h)}}),e.addHook("beforeCellAlignment",function(e,n,r,o){var i=new f.UndoRedo.CellAlignmentAction(e,n,r,o);t.done(i)}),e.addHook("beforeFilter",function(e){t.done(new f.UndoRedo.FiltersAction(e))}),e.addHook("beforeRowMove",function(e,n){e!==!1&&t.done(new f.UndoRedo.RowMoveAction(e,n))})},f.UndoRedo.prototype.done=function(e){this.ignoreNewActions||(this.doneActions.push(e),this.undoneActions.length=0)},f.UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.pop(),t=w(e),n=this.instance,r=n.runHooks("beforeUndo",t);if(r===!1)return;this.ignoreNewActions=!0;var o=this;e.undo(this.instance,function(){o.ignoreNewActions=!1,o.undoneActions.push(e)}),n.runHooks("afterUndo",t)}},f.UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.pop(),t=w(e),n=this.instance,r=n.runHooks("beforeRedo",t);if(r===!1)return;this.ignoreNewActions=!0;var o=this;e.redo(this.instance,function(){o.ignoreNewActions=!1,o.doneActions.push(e)}),n.runHooks("afterRedo",t)}},f.UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0},f.UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},f.UndoRedo.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},f.UndoRedo.Action=function(){},f.UndoRedo.Action.prototype.undo=function(){},f.UndoRedo.Action.prototype.redo=function(){},f.UndoRedo.ChangeAction=function(e){this.changes=e,this.actionType="change"},v(f.UndoRedo.ChangeAction,f.UndoRedo.Action),f.UndoRedo.ChangeAction.prototype.undo=function(e,t){for(var n=w(this.changes),r=e.countEmptyRows(!0),o=e.countEmptyCols(!0),i=0,s=n.length;i<s;i++)n[i].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtRowProp(n,null,null,"undo");for(var a=0,l=n.length;a<l;a++)e.getSettings().minSpareRows&&n[a][0]+1+e.getSettings().minSpareRows===e.countRows()&&r==e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(n[a][0]+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&n[a][1]+1+e.getSettings().minSpareCols===e.countCols()&&o==e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(n[a][1]+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())},f.UndoRedo.ChangeAction.prototype.redo=function(e,t){for(var n=w(this.changes),r=0,o=n.length;r<o;r++)n[r].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtRowProp(n,null,null,"redo")},f.UndoRedo.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"},v(f.UndoRedo.CreateRowAction,f.UndoRedo.Action),f.UndoRedo.CreateRowAction.prototype.undo=function(e,t){var n=e.countRows(),r=e.getSettings().minSpareRows;this.index>=n&&this.index-r<n&&(this.index-=r),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"undo")},f.UndoRedo.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row",this.index,this.amount,"redo")},f.UndoRedo.RemoveRowAction=function(e,t){this.index=e,this.data=t,this.actionType="remove_row"},v(f.UndoRedo.RemoveRowAction,f.UndoRedo.Action),f.UndoRedo.RemoveRowAction.prototype.undo=function(e,t){e.alter("insert_row",this.index,this.data.length,"undo"),e.addHookOnce("afterRender",t),e.populateFromArray(this.index,0,this.data,void 0,void 0,"undo")},f.UndoRedo.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"redo")},f.UndoRedo.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"},v(f.UndoRedo.CreateColumnAction,f.UndoRedo.Action),f.UndoRedo.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"undo")},f.UndoRedo.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col",this.index,this.amount,"redo")},f.UndoRedo.RemoveColumnAction=function(e,t,n,r,o){this.index=e,this.indexes=t,this.data=n,this.amount=this.data[0].length,this.headers=r,this.columnPositions=o.slice(0),this.actionType="remove_col"},v(f.UndoRedo.RemoveColumnAction,f.UndoRedo.Action),f.UndoRedo.RemoveColumnAction.prototype.undo=function(e,t){var n,r=this,o=this.indexes.slice(0).sort(),i=function(e,t,n){return n[r.indexes.indexOf(o[t])]},s=[];m(this.data.length-1,function(e){s[e]=p(r.data[e],i)});var a=[];a=p(this.headers,i);var l=[];f.hooks.run(e,"beforeCreateCol",this.indexes[0],this.indexes[this.indexes.length-1],"undo"),m(this.data.length-1,function(t){n=e.getSourceDataAtRow(t),m(o.length-1,function(e){n.splice(o[e],0,s[t][e]),l.push([t,o[e],null,s[t][e]])})}),e.getPlugin("formulas")&&e.getPlugin("formulas").onAfterSetDataAtCell(l),"undefined"!=typeof this.headers&&m(a.length-1,function(t){e.getSettings().colHeaders.splice(o[t],0,a[t])}),e.getPlugin("manualColumnMove")&&(e.getPlugin("manualColumnMove").columnsMapper.__arrayMap=this.columnPositions),e.addHookOnce("afterRender",t),f.hooks.run(e,"afterCreateCol",this.indexes[0],this.indexes[this.indexes.length-1],"undo"),e.getPlugin("formulas")&&e.getPlugin("formulas").recalculateFull(),e.render()},f.UndoRedo.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"redo")},f.UndoRedo.CellAlignmentAction=function(e,t,n,r){this.stateBefore=e,this.range=t,this.type=n,this.alignment=r},f.UndoRedo.CellAlignmentAction.prototype.undo=function(e,t){if(e.getPlugin("contextMenu").isEnabled()){for(var n=this.range.from.row;n<=this.range.to.row;n++)for(var r=this.range.from.col;r<=this.range.to.col;r++)e.setCellMeta(n,r,"className",this.stateBefore[n][r]||" htLeft");e.addHookOnce("afterRender",t),e.render()}},f.UndoRedo.CellAlignmentAction.prototype.redo=function(e,t){e.getPlugin("contextMenu").isEnabled()&&(e.selectCell(this.range.from.row,this.range.from.col,this.range.to.row,this.range.to.col),e.getPlugin("contextMenu").executeCommand("alignment:"+this.alignment.replace("ht","").toLowerCase()),e.addHookOnce("afterRender",t),e.render())},f.UndoRedo.FiltersAction=function(e){this.formulaStacks=e,this.actionType="filter"},v(f.UndoRedo.FiltersAction,f.UndoRedo.Action),f.UndoRedo.FiltersAction.prototype.undo=function(e,t){var n=e.getPlugin("filters");e.addHookOnce("afterRender",t),n.formulaCollection.importAllFormulas(this.formulaStacks.slice(0,this.formulaStacks.length-1)),n.filter()},f.UndoRedo.FiltersAction.prototype.redo=function(e,t){var n=e.getPlugin("filters");e.addHookOnce("afterRender",t),n.formulaCollection.importAllFormulas(this.formulaStacks),n.filter()},f.UndoRedo.RowMoveAction=function(e,t){this.rows=e.slice(),this.target=t},v(f.UndoRedo.RowMoveAction,f.UndoRedo.Action),f.UndoRedo.RowMoveAction.prototype.undo=function(e,t){var n=e.getPlugin("manualRowMove");e.addHookOnce("afterRender",t);for(var r=this.rows[0]<this.target?-1*this.rows.length:0,o=this.rows[0]>this.target?this.rows[0]+this.rows.length:this.rows[0],i=[],s=this.rows.length+r,a=r;a<s;a++)i.push(this.target+a);n.moveRows(i.slice(),o),e.render(),e.selection.setRangeStartOnly(new WalkontableCellCoords(this.rows[0],0)),e.selection.setRangeEnd(new WalkontableCellCoords(this.rows[this.rows.length-1],e.countCols()-1))},f.UndoRedo.RowMoveAction.prototype.redo=function(e,t){var n=e.getPlugin("manualRowMove");e.addHookOnce("afterRender",t),n.moveRows(this.rows.slice(),this.target),e.render();var r=this.rows[0]<this.target?this.target-this.rows.length:this.target;e.selection.setRangeStartOnly(new WalkontableCellCoords(r,0)),e.selection.setRangeEnd(new WalkontableCellCoords(r+this.rows.length-1,e.countCols()-1))},f.hooks.add("afterInit",r),f.hooks.add("afterUpdateSettings",r),f.hooks.register("beforeUndo"),f.hooks.register("afterUndo"),f.hooks.register("beforeRedo"),f.hooks.register("afterRedo")},{browser:24,"helpers/array":43,"helpers/dom/event":48,"helpers/number":52,"helpers/object":53}],117:[function(e,t,n){"use strict";function r(e,t){var n;d[e]=t,n=u(e)+"Renderer",l.renderers[n]=t,l[n]=t,"base"===e&&(l.renderers.cellDecorator=t)}function o(e){if("function"==typeof e)return e;if("string"!=typeof e)throw Error('Only strings and functions can be passed as "renderer" parameter');
if(!(e in d))throw Error('No editor registered under name "'+e+'"');return d[e]}function i(e){return e in d}Object.defineProperties(n,{registerRenderer:{get:function(){return r}},getRenderer:{get:function(){return o}},hasRenderer:{get:function(){return i}},__esModule:{value:!0}});var s,a,l=(s=e("browser"),s&&s.__esModule&&s||{default:s}).default,u=(a=e("helpers/string"),a&&a.__esModule&&a||{default:a}).toUpperCaseFirst,d={};l.renderers=l.renderers||{},l.renderers.registerRenderer=r,l.renderers.getRenderer=o},{browser:24,"helpers/string":55}],118:[function(e,t,n){"use strict";function r(e,t,n,r,o,i,s){s.className&&(t.className?t.className=t.className+" "+s.className:t.className=s.className),s.readOnly&&a(t,s.readOnlyCellClassName),s.valid===!1&&s.invalidCellClassName?a(t,s.invalidCellClassName):l(t,s.invalidCellClassName),s.wordWrap===!1&&s.noWordWrapClassName&&a(t,s.noWordWrapClassName),!i&&s.placeholder&&a(t,s.placeholderCellClassName)}Object.defineProperties(n,{cellDecorator:{get:function(){return r}},__esModule:{value:!0}});var o,i,s=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{default:o}),a=s.addClass,l=s.removeClass,u=(i=e("renderers"),i&&i.__esModule&&i||{default:i}).registerRenderer;u("base",r)},{"helpers/dom/element":47,renderers:117}],119:[function(e,t,n){"use strict";function r(e,t,n,r,o,i,s){var a=(g.cloneNode(!0),v.cloneNode(!0));if(s.allowHtml?f("html").apply(this,arguments):f("text").apply(this,arguments),t.appendChild(a),u(t,"htAutocomplete"),t.firstChild||t.appendChild(document.createTextNode(String.fromCharCode(160))),!e.acArrowListener){var l=c(e);e.acArrowListener=function(o){d(o.target,"htAutocompleteArrow")&&e.view.wt.getSetting("onCellDblClick",null,new m(n,r),t)},l.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",function(){l.destroy()})}}Object.defineProperties(n,{autocompleteRenderer:{get:function(){return r}},__esModule:{value:!0}});var o,i,s,a,l=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{default:o}),u=l.addClass,d=l.hasClass,c=(l.empty,(i=e("eventManager"),i&&i.__esModule&&i||{default:i}).eventManager),h=(s=e("renderers"),s&&s.__esModule&&s||{default:s}),f=h.getRenderer,p=h.registerRenderer,m=(a=e("3rdparty/walkontable/src/cell/coords"),a&&a.__esModule&&a||{default:a}).WalkontableCellCoords,g=document.createElement("DIV");g.className="htAutocompleteWrapper";var v=document.createElement("DIV");v.className="htAutocompleteArrow",v.appendChild(document.createTextNode(String.fromCharCode(9660)));p("autocomplete",r)},{"3rdparty/walkontable/src/cell/coords":6,eventManager:42,"helpers/dom/element":47,renderers:117}],120:[function(e,t,n){"use strict";function r(e,t,n,r,a,l,u){function d(e){var t="SPACE|ENTER",n="DELETE|BACKSPACE",r=T(O,e.keyCode);r(t+"|"+n)&&!x(e)&&f(function(){N(e),e.preventDefault()}),r(t)&&c(),r(n)&&c(!1)}function c(){var t=void 0!==arguments[0]?arguments[0]:null;f(function(){if(arguments.length>1){var n=arguments[0],r=arguments[1],o=arguments[2];if(o.checkedTemplate){var i=e.getDataAtCell(n,r);null===t?i===o.checkedTemplate?e.setDataAtCell(n,r,o.uncheckedTemplate):i===o.uncheckedTemplate&&e.setDataAtCell(n,r,o.checkedTemplate):e.setDataAtCell(n,r,o.uncheckedTemplate)}}else for(var s=arguments[0],a=0,l=s.length;a<l;a++){if(_(s[a],D)&&null===t)return;h(s[a],t)}})}function h(e){var t=void 0!==arguments[1]?arguments[1]:null;null===t?e.checked=!e.checked:e.checked=t,p.fireEvent(e,"change")}function f(t){var n=e.getSelectedRange();if(n)for(var r=n.getTopLeftCorner(),o=n.getBottomRightCorner(),i=r.row;i<=o.row;i++)for(var s=r.col;s<=o.col;s++){var a=e.getCellMeta(i,s);if("checkbox"!==a.type)return;var l=e.getCell(i,s);if(null==l)t(i,s,a);else{var u=l.querySelectorAll("input[type=checkbox]");u.length>0&&!a.readOnly&&t(u)}}}E("base").apply(this,arguments);var p=o(e),m=i(),g=u.label,v=!1;if("undefined"==typeof u.checkedTemplate&&(u.checkedTemplate=!0),"undefined"==typeof u.uncheckedTemplate&&(u.uncheckedTemplate=!1),b(t),l===u.checkedTemplate||C(l,u.checkedTemplate)?m.checked=!0:l===u.uncheckedTemplate||C(l,u.uncheckedTemplate)?m.checked=!1:null===l?y(m,"noValue"):(m.style.display="none",y(m,D),v=!0),m.setAttribute("data-row",n),m.setAttribute("data-col",r),!v&&g){var w="";g.value?w="function"==typeof g.value?g.value.call(this,n,r,a,l):g.value:g.property&&(w=e.getDataAtRowProp(n,g.property));var R=s(w);"before"===g.position?R.appendChild(m):R.insertBefore(m,R.firstChild),m=R}t.appendChild(m),v&&t.appendChild(document.createTextNode("#bad-value#")),k.has(e)||(k.set(e,!0),e.addHook("beforeKeyDown",d))}function o(e){var t=I.get(e);return t||(t=new R(e),t.addEventListener(e.rootElement,"click",function(t){return l(t,e)}),t.addEventListener(e.rootElement,"mouseup",function(t){return a(t,e)}),t.addEventListener(e.rootElement,"change",function(t){return u(t,e)}),I.set(e,t)),t}function i(){var e=document.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function s(e){var t=document.createElement("label");return t.className="htCheckboxRendererLabel",t.appendChild(document.createTextNode(e)),t.cloneNode(!0)}function a(e,t){d(e.target)&&setTimeout(t.listen,10)}function l(e,t){if(!d(e.target))return!1;var n=parseInt(e.target.getAttribute("data-row"),10),r=parseInt(e.target.getAttribute("data-col"),10),o=t.getCellMeta(n,r);o.readOnly&&e.preventDefault()}function u(e,t){if(!d(e.target))return!1;var n=parseInt(e.target.getAttribute("data-row"),10),r=parseInt(e.target.getAttribute("data-col"),10),o=t.getCellMeta(n,r);if(!o.readOnly){var i=null;i=e.target.checked?void 0===o.checkedTemplate||o.checkedTemplate:void 0!==o.uncheckedTemplate&&o.uncheckedTemplate,t.setDataAtCell(n,r,i)}}function d(e){return"INPUT"===e.tagName&&"checkbox"===e.getAttribute("type")}Object.defineProperties(n,{checkboxRenderer:{get:function(){return r}},__esModule:{value:!0}});var c,h,f,p,m,g,v,w=(c=e("helpers/dom/element"),c&&c.__esModule&&c||{default:c}),b=w.empty,y=w.addClass,_=w.hasClass,C=(h=e("helpers/string"),h&&h.__esModule&&h||{default:h}).equalsIgnoreCase,R=(f=e("eventManager"),f&&f.__esModule&&f||{default:f}).EventManager,M=(p=e("renderers"),p&&p.__esModule&&p||{default:p}),E=M.getRenderer,S=M.registerRenderer,O=(m=e("helpers/unicode"),m&&m.__esModule&&m||{default:m}).isKey,T=(g=e("helpers/function"),g&&g.__esModule&&g||{default:g}).partial,A=(v=e("helpers/dom/event"),v&&v.__esModule&&v||{default:v}),N=A.stopImmediatePropagation,x=A.isImmediatePropagationStopped,k=new WeakMap,I=new WeakMap,D="htBadValue";S("checkbox",r)},{eventManager:42,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/function":50,"helpers/string":55,"helpers/unicode":56,renderers:117}],121:[function(e,t,n){"use strict";function r(e,t,n,r,o,i,a){l("base").apply(this,arguments),null!==i&&void 0!==i||(i=""),s(t,i)}Object.defineProperties(n,{htmlRenderer:{get:function(){return r}},__esModule:{value:!0}});var o,i,s=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{default:o}).fastInnerHTML,a=(i=e("renderers"),i&&i.__esModule&&i||{default:i}),l=a.getRenderer,u=a.registerRenderer;u("html",r)},{"helpers/dom/element":47,renderers:117}],122:[function(e,t,n){"use strict";function r(e,t,n,r,o,i,s){if(c(i)){"undefined"!=typeof s.language&&a.culture(s.language),i=a(i).format(s.format||"0");var l=s.className||"",d=l.length?l.split(" "):[];d.indexOf("htLeft")<0&&d.indexOf("htCenter")<0&&d.indexOf("htRight")<0&&d.indexOf("htJustify")<0&&d.push("htRight"),d.indexOf("htNumeric")<0&&d.push("htNumeric"),s.className=d.join(" ")}u("text")(e,t,n,r,o,i,s)}Object.defineProperties(n,{numericRenderer:{get:function(){return r}},__esModule:{value:!0}});var o,i,s,a=(o=e("numbro"),o&&o.__esModule&&o||{default:o}).default,l=(i=e("renderers"),i&&i.__esModule&&i||{default:i}),u=l.getRenderer,d=l.registerRenderer,c=(s=e("helpers/number"),s&&s.__esModule&&s||{default:s}).isNumeric;d("numeric",r)},{"helpers/number":52,numbro:"numbro",renderers:117}],123:[function(e,t,n){"use strict";function r(e,t,n,r,o,i,a){l("text").apply(this,arguments),i=t.innerHTML;var u,d=a.hashLength||i.length,c=a.hashSymbol||"*";for(u="";u.split(c).length-1<d;u+=c);s(t,u)}Object.defineProperties(n,{passwordRenderer:{get:function(){return r}},__esModule:{value:!0}});var o,i,s=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{default:o}).fastInnerHTML,a=(i=e("renderers"),i&&i.__esModule&&i||{default:i}),l=a.getRenderer,u=a.registerRenderer;u("password",r)},{"helpers/dom/element":47,renderers:117}],124:[function(e,t,n){"use strict";function r(e,t,n,r,o,i,s){h("base").apply(this,arguments),!i&&s.placeholder&&(i=s.placeholder);var a=d(i);if(e.getSettings().trimWhitespace||(a=a.replace(/ /g,String.fromCharCode(160))),s.rendererTemplate){l(t);var c=document.createElement("TEMPLATE");c.setAttribute("bind","{{}}"),c.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(c),c.model=e.getSourceDataAtRow(n),t.appendChild(c)}else u(t,a)}Object.defineProperties(n,{textRenderer:{get:function(){return r}},__esModule:{value:!0}});var o,i,s,a=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{default:o}),l=a.empty,u=a.fastInnerText,d=(i=e("helpers/mixed"),i&&i.__esModule&&i||{default:i}).stringify,c=(s=e("renderers"),s&&s.__esModule&&s||{default:s}),h=c.getRenderer,f=c.registerRenderer;f("text",r)},{"helpers/dom/element":47,"helpers/mixed":51,renderers:117}],125:[function(e,t,n){!function(e){"use strict";function t(e){return{configurable:!0,enumerable:!1,value:e,writable:!0}}function n(){return"__$"+Math.floor(1e9*Math.random())+"$"+ ++k+"$__"}function r(e){return L[e]}function o(){var e=n();return L[e]=!0,e}function i(e){return"object"==typeof e&&e instanceof l}function s(e){return i(e)?"symbol":typeof e}function a(e){var t=new l(e);if(!(this instanceof a))return t;throw new TypeError("Symbol cannot be new'ed")}function l(e){var t=n();E(this,P,{value:this}),E(this,I,{value:t}),E(this,D,{value:e}),d(this),H[t]=this}function u(e){var t=e[V];return t&&t.self===e?t:N(e)?(F.hash.value=$++,F.self.value=e,j.value=R(null,F),E(e,V,j),j.value):void 0}function d(e){return u(e),S.apply(this,arguments)}function c(e){return H[e]||L[e]}function h(e){return i(e)?e[I]:e}function f(e){for(var t=[],n=T(e),r=0;r<n.length;r++){var o=H[n[r]];o&&t.push(o)}return t}function p(t){return e.traceur&&e.traceur.options[t]}function m(e){for(var t=1;t<arguments.length;t++)for(var n=T(arguments[t]),r=0;r<n.length;r++){var o=n[r];c(o)||!function(t,n){E(e,n,{get:function(){return t[n]},enumerable:!0})}(arguments[t],n[r])}return e}function g(e){return null!=e&&("object"==typeof e||"function"==typeof e)}function v(e){if(null==e)throw C();return _(e)}function w(e){if(null==e)throw new TypeError("Value cannot be converted to an Object");return e}function b(e,t){e.Symbol||(e.Symbol=t,Object.getOwnPropertySymbols=f),e.Symbol.iterator||(e.Symbol.iterator=t("Symbol.iterator"))}function y(e){b(e,a),e.Reflect=e.Reflect||{},e.Reflect.global=e.Reflect.global||e}if(!e.$traceurRuntime){var _=Object,C=TypeError,R=_.create,M=_.defineProperties,E=_.defineProperty,S=_.freeze,O=_.getOwnPropertyDescriptor,T=_.getOwnPropertyNames,A=_.keys,N=Object.isExtensible,x=t,k=0,I=n(),D=n(),P=n(),H=R(null),L=R(null);E(a.prototype,"constructor",t(a)),E(a.prototype,"toString",x(function(){var e=this[P];if(!p("symbols"))return e[I];if(!e)throw TypeError("Conversion from symbol to string");var t=e[D];return void 0===t&&(t=""),"Symbol("+t+")"})),E(a.prototype,"valueOf",x(function(){var e=this[P];if(!e)throw TypeError("Conversion from symbol to string");return p("symbols")?e:e[I]})),E(l.prototype,"constructor",t(a)),E(l.prototype,"toString",{value:a.prototype.toString,enumerable:!1}),E(l.prototype,"valueOf",{value:a.prototype.valueOf,enumerable:!1});var V=o(),j={value:void 0},F={hash:{value:void 0},self:{value:void 0}},$=0;d(l.prototype),y(e),e.$traceurRuntime={checkObjectCoercible:w,createPrivateName:o,defineProperties:M,defineProperty:E,exportStar:m,getOwnHashObject:u,getOwnPropertyDescriptor:O,getOwnPropertyNames:T,isObject:g,isPrivateName:r,isSymbolString:c,keys:A,setupGlobals:y,toObject:v,toProperty:h,typeof:s}}}(window),function(){"use strict";function e(){for(var e,n=[],r=0,o=0;o<arguments.length;o++){var i=$traceurRuntime.checkObjectCoercible(arguments[o]);"function"!=typeof i[t(Symbol.iterator)]&&(i[t(Symbol.iterator)]=function(){var e=this,t=e.length,n=0;return{next:function(){var r={done:!0};return n<t&&(r.done=!1,r.value=e[n],++n),r}}});for(var s=i[t(Symbol.iterator)]();!(e=s.next()).done;)n[r++]=e.value}return n}var t=$traceurRuntime.toProperty;$traceurRuntime.spread=e}(),function(){"use strict";function e(e,t){var n=m(e);do{var r=p(n,t);if(r)return r;n=m(n)}while(n)}function t(e){return e.__proto__}function n(e,t,n,o){return r(e,t,n).apply(e,o)}function r(t,n,r){var o=e(n,r);if(o)return o.get?o.get.call(t):o.value}function o(t,n,r,o){var i=e(n,r);if(i&&i.set)return i.set.call(t,o),o;throw d("super has no setter '"+r+"'.")}function i(e){for(var t={},n=w(e),r=0;r<n.length;r++){var o=n[r];t[o]=p(e,o)}for(var i=b(e),r=0;r<i.length;r++){var s=i[r];t[g(s)]=p(e,g(s))}return t}function s(e,t,n,r){return f(t,"constructor",{value:e,configurable:!0,enumerable:!1,writable:!0}),arguments.length>3?("function"==typeof r&&(e.__proto__=r),e.prototype=c(a(r),i(t))):e.prototype=t,f(e,"prototype",{configurable:!1,writable:!1}),h(e,i(n))}function a(e){if("function"==typeof e){var t=e.prototype;if(u(t)===t||null===t)return e.prototype;throw new d("super prototype must be an Object or null")}if(null===e)return null;throw new d("Super expression must either be null or a function, not "+typeof e+".")}function l(e,t,r){null!==m(t)&&n(e,t,"constructor",r)}var u=Object,d=TypeError,c=u.create,h=$traceurRuntime.defineProperties,f=$traceurRuntime.defineProperty,p=$traceurRuntime.getOwnPropertyDescriptor,m=Object.getPrototypeOf,g=$traceurRuntime.toProperty,v=Object,w=v.getOwnPropertyNames,b=v.getOwnPropertySymbols;$traceurRuntime.createClass=s,$traceurRuntime.defaultSuperCall=l,$traceurRuntime.superCall=n,$traceurRuntime.superConstructor=t,$traceurRuntime.superGet=r,$traceurRuntime.superSet=o}()},{}],126:[function(e,t,n){"use strict";function r(e){var t=this,n=this;this.eventManager=M(e),this.instance=e,this.settings=e.getSettings(),this.selectionMouseDown=!1;var r=e.rootElement.getAttribute("style");r&&e.rootElement.setAttribute("data-originalstyle",r),p(e.rootElement,"handsontable");var o=document.createElement("TABLE");p(o,"htCore"),e.getSettings().tableClassName&&p(o,e.getSettings().tableClassName),this.THEAD=document.createElement("THEAD"),o.appendChild(this.THEAD),this.TBODY=document.createElement("TBODY"),o.appendChild(this.TBODY),e.table=o,e.container.insertBefore(o,e.container.firstChild),this.eventManager.addEventListener(e.rootElement,"mousedown",function(e){this.selectionMouseDown=!0,n.isTextSelectionAllowed(e.target)||(s(),e.preventDefault(),window.focus())}),this.eventManager.addEventListener(e.rootElement,"mouseup",function(e){this.selectionMouseDown=!1}),this.eventManager.addEventListener(e.rootElement,"mousemove",function(e){this.selectionMouseDown&&!n.isTextSelectionAllowed(e.target)&&(s(),e.preventDefault())}),this.eventManager.addEventListener(document.documentElement,"keyup",function(t){e.selection.isInProgress()&&!t.shiftKey&&e.selection.finish()});var i;this.isMouseDown=function(){return i},this.eventManager.addEventListener(document.documentElement,"mouseup",function(t){e.selection.isInProgress()&&1===t.which&&e.selection.finish(),i=!1,C(document.activeElement)&&e.unlisten()}),this.eventManager.addEventListener(document.documentElement,"mousedown",function(t){var r=t.target,o=t.target,s=t.x||t.clientX,a=t.y||t.clientY;if(!i&&e.rootElement){if(o===e.view.wt.wtTable.holder){var l=w();if(document.elementFromPoint(s+l,a)!==e.view.wt.wtTable.holder||document.elementFromPoint(s,a+l)!==e.view.wt.wtTable.holder)return}else for(;o!==document.documentElement;){if(null===o){if(t.isTargetWebComponent)break;return}if(o===e.rootElement)return;o=o.parentNode}var u="function"==typeof n.settings.outsideClickDeselects?n.settings.outsideClickDeselects(r):n.settings.outsideClickDeselects;u?e.deselectCell():e.destroyEditor()}}),this.eventManager.addEventListener(o,"selectstart",function(e){n.settings.fragmentSelection||_(e.target)||e.preventDefault()});var s=function(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()},a=[new x({className:"current",border:{width:2,color:"#5292F7",cornerVisible:function(){return n.settings.fillHandle&&!n.isCellEdited()&&!e.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!n.isCellEdited()&&!e.selection.isMultiple()}}}),new x({className:"area",border:{width:1,color:"#89AFF9",cornerVisible:function(){return n.settings.fillHandle&&!n.isCellEdited()&&e.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!n.isCellEdited()&&e.selection.isMultiple()}}}),new x({className:"highlight",highlightHeaderClassName:n.settings.currentHeaderClassName,highlightRowClassName:n.settings.currentRowClassName,highlightColumnClassName:n.settings.currentColClassName}),new x({className:"fill",border:{width:1,color:"red"}})];a.current=a[0],a.area=a[1],a.highlight=a[2],a.fill=a[3];var l={debug:function(){return n.settings.debug},externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:o,preventOverflow:function(){return t.settings.preventOverflow},stretchH:function(){return n.settings.stretchH},data:e.getDataAtCell,totalRows:function(){return e.countRows()},totalColumns:function(){return e.countCols()},fixedColumnsLeft:function(){return n.settings.fixedColumnsLeft},fixedRowsTop:function(){return n.settings.fixedRowsTop},fixedRowsBottom:function(){return n.settings.fixedRowsBottom},minSpareRows:function(){return n.settings.minSpareRows},renderAllRows:n.settings.renderAllRows,rowHeaders:function(){var t=[];return e.hasRowHeaders()&&t.push(function(e,t){n.appendRowHeader(e,t)}),h.hooks.run(e,"afterGetRowHeaderRenderers",t),t},columnHeaders:function(){var t=[];return e.hasColHeaders()&&t.push(function(e,t){n.appendColHeader(e,t)}),h.hooks.run(e,"afterGetColumnHeaderRenderers",t),t},columnWidth:e.getColWidth,rowHeight:e.getRowHeight,cellRenderer:function(e,t,r){var o=n.instance.getCellMeta(e,t),i=n.instance.colToProp(t),s=n.instance.getDataAtRowProp(e,i);n.instance.hasHook("beforeValueRender")&&(s=n.instance.runHooks("beforeValueRender",s)),n.instance.runHooks("beforeRenderer",r,e,t,i,s,o),n.instance.getCellRenderer(o)(n.instance,r,e,t,i,s,o),n.instance.runHooks("afterRenderer",r,e,t,i,s,o)},selections:a,hideBorderOnMouseDownOver:function(){return n.settings.fragmentSelection},onCellMouseDown:function(t,r,o,s){var a={row:!1,column:!1,cells:!1};if(e.listen(),n.activeWt=s,i=!0,h.hooks.run(e,"beforeOnCellMouseDown",t,r,o,a),!O(t)){var l=e.getSelectedRange(),u=e.selection,d=u.selectedHeader;if(t.shiftKey&&l)r.row>=0&&r.col>=0&&!a.cells?(u.setSelectedHeaders(!1,!1),u.setRangeEnd(r)):(d.cols||d.rows)&&r.row>=0&&r.col>=0&&!a.cells?(u.setSelectedHeaders(!1,!1),u.setRangeEnd(new N(r.row,r.col))):d.cols&&r.row<0&&!a.column?u.setRangeEnd(new N(l.to.row,r.col)):d.rows&&r.col<0&&!a.row?u.setRangeEnd(new N(r.row,l.to.col)):(!d.cols&&!d.rows&&r.col<0||d.cols&&r.col<0)&&!a.row?(u.setSelectedHeaders(!0,!1),u.setRangeStartOnly(new N(l.from.row,0)),u.setRangeEnd(new N(r.row,e.countCols()-1))):(!d.cols&&!d.rows&&r.row<0||d.rows&&r.row<0)&&!a.column&&(u.setSelectedHeaders(!1,!0),u.setRangeStartOnly(new N(0,l.from.col)),u.setRangeEnd(new N(e.countRows()-1,r.col)));else{var c=!0;if(l){var f=l,m=f.from,g=f.to,v=!u.inInSelection(r);if(r.row<0&&d.cols){var w=Math.min(m.col,g.col),b=Math.max(m.col,g.col);c=r.col<w||r.col>b}else if(r.col<0&&d.rows){var y=Math.min(m.row,g.row),_=Math.max(m.row,g.row);c=r.row<y||r.row>_}else c=v}var C=T(t),M=A(t)||"touchstart"===t.type;r.row<0&&r.col>=0&&!a.column?(u.setSelectedHeaders(!1,!0),(M||C&&c)&&(u.setRangeStartOnly(new N(0,r.col)),u.setRangeEnd(new N(Math.max(e.countRows()-1,0),r.col),!1))):r.col<0&&r.row>=0&&!a.row?(u.setSelectedHeaders(!0,!1),(M||C&&c)&&(u.setRangeStartOnly(new N(r.row,0)),u.setRangeEnd(new N(r.row,Math.max(e.countCols()-1,0)),!1))):r.col>=0&&r.row>=0&&!a.cells?(M||C&&c)&&(u.setSelectedHeaders(!1,!1),u.setRangeStart(r)):r.col<0&&r.row<0&&(r.row=0,r.col=0,u.setSelectedHeaders(!1,!1,!0),u.setRangeStart(r))}u.selectedHeader.rows?(R(e.rootElement,"ht__selection--columns"),p(e.rootElement,"ht__selection--rows")):u.selectedHeader.cols?(R(e.rootElement,"ht__selection--rows"),p(e.rootElement,"ht__selection--columns")):R(e.rootElement,["ht__selection--rows","ht__selection--columns"]),h.hooks.run(e,"afterOnCellMouseDown",t,r,o),n.activeWt=n.wt}},onCellMouseOver:function(t,r,o,s){var a={row:!1,column:!1,cell:!1};n.activeWt=s,h.hooks.run(e,"beforeOnCellMouseOver",t,r,o,a),O(t)||(0===t.button&&i&&(r.row>=0&&r.col>=0?e.selection.selectedHeader.cols&&!a.column?e.selection.setRangeEnd(new N(e.countRows()-1,r.col),!1):e.selection.selectedHeader.rows&&!a.row?e.selection.setRangeEnd(new N(r.row,e.countCols()-1),!1):a.cell||e.selection.setRangeEnd(r):e.selection.selectedHeader.cols&&!a.column?e.selection.setRangeEnd(new N(e.countRows()-1,r.col),!1):e.selection.selectedHeader.rows&&!a.row?e.selection.setRangeEnd(new N(r.row,e.countCols()-1),!1):a.cell||e.selection.setRangeEnd(r)),h.hooks.run(e,"afterOnCellMouseOver",t,r,o),n.activeWt=n.wt)},onCellMouseUp:function(t,r,o,i){n.activeWt=i,h.hooks.run(e,"beforeOnCellMouseUp",t,r,o),h.hooks.run(e,"afterOnCellMouseUp",t,r,o),n.activeWt=n.wt},onCellCornerMouseDown:function(t){t.preventDefault(),h.hooks.run(e,"afterOnCellCornerMouseDown",t)},beforeDraw:function(e,t){n.beforeRender(e,t)},onDraw:function(e){n.onDraw(e)},onScrollVertically:function(){e.runHooks("afterScrollVertically")},onScrollHorizontally:function(){e.runHooks("afterScrollHorizontally")},onBeforeDrawBorders:function(t,n){e.runHooks("beforeDrawBorders",t,n)},onBeforeTouchScroll:function(){e.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){e.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(t,n){return e.runHooks("beforeStretchingColumnWidth",t,n)},onModifyRowHeaderWidth:function(t){return e.runHooks("modifyRowHeaderWidth",t)},viewportRowCalculatorOverride:function(t){var r=e.countRows(),o=n.settings.viewportRowRenderingOffset;if("auto"===o&&n.settings.fixedRowsTop&&(o=10),"number"==typeof o&&(t.startRow=Math.max(t.startRow-o,0),t.endRow=Math.min(t.endRow+o,r-1)),"auto"===o){var i=t.startRow+t.endRow-t.startRow,s=Math.ceil(i/r*12);t.startRow=Math.max(t.startRow-s,0),t.endRow=Math.min(t.endRow+s,r-1)}e.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:function(t){var r=e.countCols(),o=n.settings.viewportColumnRenderingOffset;if("auto"===o&&n.settings.fixedColumnsLeft&&(o=10),"number"==typeof o&&(t.startColumn=Math.max(t.startColumn-o,0),t.endColumn=Math.min(t.endColumn+o,r-1)),"auto"===o){var i=t.startColumn+t.endColumn-t.startColumn,s=Math.ceil(i/r*12);t.startRow=Math.max(t.startColumn-s,0),t.endColumn=Math.min(t.endColumn+s,r-1)}e.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:function(){return n.settings.rowHeaderWidth},columnHeaderHeight:function(){var t=e.runHooks("modifyColumnHeaderHeight");return n.settings.columnHeaderHeight||t}};h.hooks.run(e,"beforeInitWalkontable",l),this.wt=new k(l),this.activeWt=this.wt,this.eventManager.addEventListener(n.wt.wtTable.spreader,"mousedown",function(e){e.target===n.wt.wtTable.spreader&&3===e.which&&S(e)}),this.eventManager.addEventListener(n.wt.wtTable.spreader,"contextmenu",function(e){e.target===n.wt.wtTable.spreader&&3===e.which&&S(e)}),this.eventManager.addEventListener(document.documentElement,"click",function(){n.settings.observeDOMVisibility&&n.wt.drawInterrupted&&(n.instance.forceFullRender=!0,n.render())})}Object.defineProperties(n,{TableView:{get:function(){return r}},__esModule:{value:!0}});var o,i,s,a,l,u,d,c,h=(o=e("browser"),o&&o.__esModule&&o||{default:o}).default,f=(i=e("helpers/dom/element"),i&&i.__esModule&&i||{default:i}),p=f.addClass,m=f.empty,g=f.fastInnerHTML,v=f.fastInnerText,w=f.getScrollbarWidth,b=f.hasClass,y=f.isChildOf,_=f.isInput,C=f.isOutsideInput,R=f.removeClass,M=((s=e("helpers/object"),s&&s.__esModule&&s||{default:s}).createObjectPropListener,(a=e("eventManager"),a&&a.__esModule&&a||{default:a}).eventManager),E=(l=e("helpers/dom/event"),l&&l.__esModule&&l||{default:l}),S=E.stopPropagation,O=E.isImmediatePropagationStopped,T=E.isRightClick,A=E.isLeftClick,N=(u=e("3rdparty/walkontable/src/cell/coords"),u&&u.__esModule&&u||{default:u}).WalkontableCellCoords,x=(d=e("3rdparty/walkontable/src/selection"),d&&d.__esModule&&d||{default:d}).WalkontableSelection,k=(c=e("3rdparty/walkontable/src/core"),c&&c.__esModule&&c||{default:c}).Walkontable;h.TableView=r,r.prototype.isTextSelectionAllowed=function(e){if(_(e))return!0;var t=y(e,this.instance.view.wt.wtTable.spreader);return!(this.settings.fragmentSelection!==!0||!t)||(!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!t)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))},r.prototype.isSelectedOnlyCell=function(){var e=this.instance.getSelected()||[],t=e[0],n=e[1],r=e[2],o=e[3];return void 0!==t&&t===r&&n===o},r.prototype.isCellEdited=function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()},r.prototype.beforeRender=function(e,t){e&&h.hooks.run(this.instance,"beforeRender",this.instance.forceFullRender,t)},r.prototype.onDraw=function(e){e&&h.hooks.run(this.instance,"afterRender",this.instance.forceFullRender)},r.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1},r.prototype.getCellAtCoords=function(e,t){var n=this.wt.getCell(e,t);return n<0?null:n},r.prototype.scrollViewport=function(e){this.wt.scrollViewport(e)},r.prototype.appendRowHeader=function(e,t){if(t.firstChild){var n=t.firstChild;if(!b(n,"relative"))return m(t),void this.appendRowHeader(e,t);this.updateCellHeader(n.querySelector(".rowHeader"),e,this.instance.getRowHeader)}else{var r=document.createElement("div"),o=document.createElement("span");r.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,this.instance.getRowHeader),r.appendChild(o),t.appendChild(r)}h.hooks.run(this.instance,"afterGetRowHeader",e,t)},r.prototype.appendColHeader=function(e,t){if(t.firstChild){var n=t.firstChild;b(n,"relative")?this.updateCellHeader(n.querySelector(".colHeader"),e,this.instance.getColHeader):(m(t),this.appendColHeader(e,t))}else{var r=document.createElement("div"),o=document.createElement("span");r.className="relative",o.className="colHeader",this.updateCellHeader(o,e,this.instance.getColHeader),r.appendChild(o),t.appendChild(r)}h.hooks.run(this.instance,"afterGetColHeader",e,t)},r.prototype.updateCellHeader=function(e,t,n){var r=t,o=this.wt.wtOverlays.getParentOverlay(e)||this.wt;e.parentNode&&(b(e,"colHeader")?r=o.wtTable.columnFilter.sourceToRendered(t):b(e,"rowHeader")&&(r=o.wtTable.rowFilter.sourceToRendered(t))),r>-1?g(e,n(t)):(v(e,String.fromCharCode(160)),p(e,"cornerHeader"))},r.prototype.maximumVisibleElementWidth=function(e){var t=this.wt.wtViewport.getWorkspaceWidth(),n=t-e;return n>0?n:0},r.prototype.maximumVisibleElementHeight=function(e){var t=this.wt.wtViewport.getWorkspaceHeight(),n=t-e;return n>0?n:0},r.prototype.mainViewIsActive=function(){return this.wt===this.activeWt},r.prototype.destroy=function(){this.wt.destroy(),this.eventManager.destroy()}},{"3rdparty/walkontable/src/cell/coords":6,"3rdparty/walkontable/src/core":8,"3rdparty/walkontable/src/selection":19,browser:24,eventManager:42,"helpers/dom/element":47,"helpers/dom/event":48,"helpers/object":53}],127:[function(e,t,n){"use strict";Object.defineProperties(n,{Stack:{get:function(){return i}},__esModule:{value:!0}});var r,o=(r=e("browser"),r&&r.__esModule&&r||{default:r}).default,i=function(){var e=void 0!==arguments[0]?arguments[0]:[];this.items=e};$traceurRuntime.createClass(i,{push:function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(e=this.items).push.apply(e,$traceurRuntime.spread(t))},pop:function(){return this.items.pop()},peek:function(){return this.isEmpty()?void 0:this.items[this.items.length-1]},isEmpty:function(){return!this.size()},size:function(){return this.items.length}},{}),o.utils.Stack=i},{browser:24}],128:[function(e,t,n){"use strict";Object.defineProperties(n,{GhostTable:{get:function(){return m}},__esModule:{value:!0}});var r,o,i,s,a,l,u=(r=e("browser"),r&&r.__esModule&&r||{default:r}).default,d=(o=e("helpers/dom/element"),o&&o.__esModule&&o||{default:o}),c=d.addClass,h=d.outerHeight,f=d.outerWidth,p=(i=e("helpers/array"),i&&i.__esModule&&i||{default:i}).arrayEach,m=((s=e("helpers/object"),s&&s.__esModule&&s||{default:s}).objectEach,(a=e("helpers/number"),a&&a.__esModule&&a||{default:a}).rangeEach,(l=e("helpers/mixed"),l&&l.__esModule&&l||{default:l}).stringify,function(e){this.hot=e,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}});$traceurRuntime.createClass(m,{addRow:function(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={row:e};this.rows.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table},addColumnHeadersRow:function(e){if(null!=this.hot.getColHeader(0)){var t={row:-1};this.rows.push(t),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tHead.appendChild(this.createColumnHeadersRow()),this.container.container.appendChild(this.table.fragment),t.table=this.table.table}},addColumn:function(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={col:e};this.columns.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(e)&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table},getHeights:function(e){this.injected||this.injectTable(),p(this.rows,function(t){e(t.row,h(t.table)-1)})},getWidths:function(e){this.injected||this.injectTable(),p(this.columns,function(t){e(t.col,f(t.table))})},setSettings:function(e){this.settings=e},setSetting:function(e,t){this.settings||(this.settings={}),this.settings[e]=t},getSettings:function(){return this.settings},getSetting:function(e){return this.settings?this.settings[e]:null},createColGroupsCol:function(){var e=this,t=document,n=t.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(t){p(t.strings,function(t){n.appendChild(e.createColElement(t.col))})}),n},createRow:function(e){var t=this,n=document,r=n.createDocumentFragment(),o=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,o),r.appendChild(o)),this.samples.forEach(function(o){p(o.strings,function(o){var i=o.col,s=t.hot.getCellMeta(e,i);s.col=i,s.row=e;var a=t.hot.getCellRenderer(s),l=n.createElement("td");a(t.hot,l,e,i,t.hot.colToProp(i),o.value,s),r.appendChild(l)})}),r},createColumnHeadersRow:function(){
var e=this,t=document,n=t.createDocumentFragment();if(this.hot.hasRowHeaders()){var r=t.createElement("th");this.hot.view.appendColHeader(-1,r),n.appendChild(r)}return this.samples.forEach(function(r){p(r.strings,function(r){var o=r.col,i=t.createElement("th");e.hot.view.appendColHeader(o,i),n.appendChild(i)})}),n},createCol:function(e){var t=this,n=document,r=n.createDocumentFragment();return this.samples.forEach(function(o){p(o.strings,function(o){var i=o.row,s=t.hot.getCellMeta(i,e);s.col=e,s.row=i;var a=t.hot.getCellRenderer(s),l=n.createElement("td"),u=n.createElement("tr");a(t.hot,l,i,e,t.hot.colToProp(e),o.value,s),u.appendChild(l),r.appendChild(u)})}),r},clean:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()},injectTable:function(){var e=void 0!==arguments[0]?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)},removeTable:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)},createColElement:function(e){var t=document,n=t.createElement("col");return n.style.width=this.hot.view.wt.wtTable.getStretchedColumnWidth(e)+"px",n},createTable:function(){var e=void 0!==arguments[0]?arguments[0]:"",t=document,n=t.createDocumentFragment(),r=t.createElement("table"),o=t.createElement("thead"),i=t.createElement("tbody"),s=t.createElement("colgroup"),a=t.createElement("tr"),l=t.createElement("th");return this.isVertical()&&r.appendChild(s),this.isHorizontal()&&(a.appendChild(l),o.appendChild(a),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(o),this.isVertical()&&i.appendChild(a),r.appendChild(i),c(r,e),n.appendChild(r),{fragment:n,table:r,tHead:o,tBody:i,colGroup:s,tr:a,th:l}},createContainer:function(){var e=void 0!==arguments[0]?arguments[0]:"",t=document,n=t.createDocumentFragment(),r=t.createElement("div");return e="htGhostTable htAutoSize "+e.trim(),c(r,e),n.appendChild(r),{fragment:n,container:r}},isVertical:function(){return!(!this.rows.length||this.columns.length)},isHorizontal:function(){return!(!this.columns.length||this.rows.length)}},{}),u.utils.GhostTable=m},{browser:24,"helpers/array":43,"helpers/dom/element":47,"helpers/mixed":51,"helpers/number":52,"helpers/object":53}],129:[function(e,t,n){"use strict";function r(e){return"string"==typeof e&&/fps$/.test(e)&&(e=1e3/parseInt(e.replace("fps","")||0,10)),e}Object.defineProperties(n,{Interval:{get:function(){return d}},__esModule:{value:!0}});var o,i,s=(o=e("browser"),o&&o.__esModule&&o||{default:o}).default,a=(i=e("helpers/feature"),i&&i.__esModule&&i||{default:i}),l=a.requestAnimationFrame,u=a.cancelAnimationFrame,d=function(e,t){var n=this;this.timer=null,this.func=e,this.delay=r(t),this.stopped=!0,this._then=null,this._callback=function(){return n.__callback()}},c=d;$traceurRuntime.createClass(d,{start:function(){return this.stopped&&(this._then=Date.now(),this.stopped=!1,this.timer=l(this._callback)),this},stop:function(){return this.stopped||(this.stopped=!0,u(this.timer),this.timer=null),this},__callback:function(){if(this.timer=l(this._callback),this.delay){var e=Date.now(),t=e-this._then;t>this.delay&&(this._then=e-t%this.delay,this.func())}else this.func()}},{create:function(e,t){return new c(e,t)}}),s.utils.Interval=d},{browser:24,"helpers/feature":49}],130:[function(e,t,n){"use strict";function r(e,t){d.set(e,t)}function o(e){var t;if(!(e instanceof a.Core)){if(!d.has(e))throw Error("Record translator was not registered for this object identity");e=d.get(e)}return c.has(e)?t=c.get(e):(t=new u(e),c.set(e,t)),t}Object.defineProperties(n,{registerIdentity:{get:function(){return r}},getTranslator:{get:function(){return o}},__esModule:{value:!0}});var i,s,a=(i=e("browser"),i&&i.__esModule&&i||{default:i}).default,l=(s=e("helpers/object"),s&&s.__esModule&&s||{default:s}).isObject,u=function(e){this.hot=e};$traceurRuntime.createClass(u,{toVisualRow:function(e){return this.hot.runHooks("unmodifyRow",e)},toVisualColumn:function(e){return this.hot.runHooks("unmodifyCol",e)},toVisual:function(e,t){var n;return n=l(e)?{row:this.toVisualRow(e.row),column:this.toVisualColumn(e.column)}:[this.toVisualRow(e),this.toVisualColumn(t)]},toPhysicalRow:function(e){return this.hot.runHooks("modifyRow",e)},toPhysicalColumn:function(e){return this.hot.runHooks("modifyCol",e)},toPhysical:function(e,t){var n;return n=l(e)?{row:this.toPhysicalRow(e.row),column:this.toPhysicalColumn(e.column)}:[this.toPhysicalRow(e),this.toPhysicalColumn(t)]}},{});var d=new WeakMap,c=new WeakMap;a.utils.RecordTranslator=u,a.utils.RecordTranslatorUtils={registerIdentity:r,getTranslator:o}},{browser:24,"helpers/object":53}],131:[function(e,t,n){"use strict";var r;Object.defineProperties(n,{SamplesGenerator:{get:function(){return g}},__esModule:{value:!0}});var o,i,s,a,l,u,d=(o=e("browser"),o&&o.__esModule&&o||{default:o}).default,c=(i=e("helpers/dom/element"),i&&i.__esModule&&i||{default:i}),h=(c.addClass,c.outerHeight,c.outerWidth,(s=e("helpers/array"),s&&s.__esModule&&s||{default:s}).arrayEach,a=e("helpers/object"),a&&a.__esModule&&a||{default:a}),f=(h.objectEach,h.isObject),p=(l=e("helpers/number"),l&&l.__esModule&&l||{default:l}).rangeEach,m=(u=e("helpers/mixed"),u&&u.__esModule&&u||{default:u}).stringify,g=function(e){this.samples=null,this.dataFactory=e,this.customSampleCount=null,this.allowDuplicates=!1},v=g;$traceurRuntime.createClass(g,(r={},Object.defineProperty(r,"getSampleCount",{value:function(){return this.customSampleCount?this.customSampleCount:v.SAMPLE_COUNT},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"setSampleCount",{value:function(e){this.customSampleCount=e},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"setAllowDuplicates",{value:function(e){this.allowDuplicates=e},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"generateRowSamples",{value:function(e,t){return this.generateSamples("row",t,e)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"generateColumnSamples",{value:function(e,t){return this.generateSamples("col",t,e)},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"generateSamples",{value:function(e,t,n){var r=this,o=new Map;return"number"==typeof n&&(n={from:n,to:n}),p(n.from,n.to,function(n){var i=r.generateSample(e,t,n);o.set(n,i)}),o},configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(r,"generateSample",{value:function(e,t,n){var r,o=this,i=new Map,s=[];return p(t.from,t.to,function(t){var a,l;if("row"===e)l=o.dataFactory(n,t);else{if("col"!==e)throw new Error("Unsupported sample type");l=o.dataFactory(t,n)}r=f(l)?Object.keys(l).length:Array.isArray(l)?l.length:m(l).length,i.has(r)||i.set(r,{needed:o.getSampleCount(),strings:[]});var u=i.get(r);if(u.needed){var d=s.indexOf(l)>-1;if(!d||o.allowDuplicates){var c="row"===e?"col":"row";u.strings.push((a={},Object.defineProperty(a,"value",{value:l,configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(a,c,{value:t,configurable:!0,enumerable:!0,writable:!0}),a)),s.push(l),u.needed--}}}),i},configurable:!0,enumerable:!0,writable:!0}),r),{get SAMPLE_COUNT(){return 3}}),d.utils.SamplesGenerator=g},{browser:24,"helpers/array":43,"helpers/dom/element":47,"helpers/mixed":51,"helpers/number":52,"helpers/object":53}],132:[function(e,t,n){"use strict";function r(e,t){var n=e,r="string"==typeof n?n.toLowerCase():null;return function(e){for(var o=!1,i=0,s=e.length;i<s;i++){if(n===e[i]){o=!0;break}if(r===a(e[i]).toLowerCase()){o=!0;break}}t(o)}}var o,i,s=(o=e("browser"),o&&o.__esModule&&o||{default:o}).default,a=(i=e("helpers/mixed"),i&&i.__esModule&&i||{default:i}).stringify;s.AutocompleteValidator=function(e,t){return null==e&&(e=""),this.allowEmpty&&""===e?void t(!0):void(this.strict&&this.source?"function"==typeof this.source?this.source(e,r(e,t)):r(e,t)(this.source):t(!0))}},{browser:24,"helpers/mixed":51}],133:[function(e,t,n){"use strict";var r,o,i,s,a=(r=e("browser"),r&&r.__esModule&&r||{default:r}).default,l=(o=e("moment"),o&&o.__esModule&&o||{default:o}).default,u=(i=e("../helpers/date"),i&&i.__esModule&&i||{default:i}).getNormalizedDate,d=(s=e("editors"),s&&s.__esModule&&s||{default:s}).getEditor;a.DateValidator=function(e,t){var n=!0,r=d("date",this.instance);null==e&&(e="");var o=l(new Date(e)).isValid()||l(e,r.defaultDateFormat).isValid(),i=l(e,this.dateFormat||r.defaultDateFormat,!0).isValid();if(this.allowEmpty&&""===e&&(o=!0,i=!0),o||(n=!1),!o&&i&&(n=!0),o&&!i)if(this.correctFormat===!0){var s=c(e,this.dateFormat);this.instance.setDataAtCell(this.row,this.col,s,"dateValidator"),n=!0}else n=!1;t(n)};var c=function(e,t){var n,r=l(u(e)),o=l(e,t),i=e.search(/[A-z]/g)>-1;return n=r.isValid()&&r.format("x")===o.format("x")||!o.isValid()||i?r:o,n.format(t)}},{"../helpers/date":46,browser:24,editors:30,moment:"moment"}],134:[function(e,t,n){"use strict";var r,o=(r=e("browser"),r&&r.__esModule&&r||{default:r}).default;o.NumericValidator=function(e,t){null==e&&(e=""),t(this.allowEmpty&&""===e?!0:""===e?!1:/^-?\d*(\.|\,)?\d*$/.test(e))}},{browser:24}],135:[function(e,t,n){"use strict";var r,o,i=(r=e("browser"),r&&r.__esModule&&r||{default:r}).default,s=(o=e("moment"),o&&o.__esModule&&o||{default:o}).default,a=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];i.TimeValidator=function(e,t){var n=!0,r=this.timeFormat||"h:mm:ss a";null===e&&(e=""),e=/^\d{3,}$/.test(e)?parseInt(e,10):e;var o=/^\d{1,2}$/.test(e);o&&(e+=":00");var i=s(e,a,!0).isValid()?s(e):s(e,r),l=i.isValid(),u=s(e,r,!0).isValid()&&!o;if(this.allowEmpty&&""===e&&(l=!0,u=!0),l||(n=!1),!l&&u&&(n=!0),l&&!u)if(this.correctFormat===!0){var d=i.format(r);this.instance.setDataAtCell(this.row,this.col,d,"timeValidator"),n=!0}else n=!1;t(n)}},{browser:24,moment:"moment"}],136:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableBottomOverlay:{get:function(){return m}},__esModule:{value:!0}});var r,o,i=(r=e("../../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),r&&r.__esModule&&r||{default:r}),s=i.addClass,a=i.getScrollbarWidth,l=i.getScrollTop,u=i.getWindowScrollLeft,d=i.hasClass,c=i.outerHeight,h=(i.innerHeight,i.removeClass),f=(i.setOverlayPosition,i.resetCssTransform),p=(o=e("../../../../../node_modules/hot-builder/node_modules/handsontable/src/3rdparty/walkontable/src/overlay/_base.js"),o&&o.__esModule&&o||{default:o}).WalkontableOverlay,m=function(e){$traceurRuntime.superConstructor(g).call(this,e),this.clone=this.makeClone(p.CLONE_BOTTOM)},g=m;$traceurRuntime.createClass(m,{repositionOverlay:function(){var e=a(),t=this.clone.wtTable.holder.parentNode;this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight&&(e=0),t.style.top="",t.style.bottom=e+"px"},shouldBeRendered:function(){return!!this.wot.getSetting("fixedRowsBottom")},resetFixedPosition:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,t=0;if(e.style.top="",this.wot.wtOverlays.leftOverlay.trimmingContainer===window){var n,r,o=this.wot.wtTable.hider.getBoundingClientRect(),i=Math.ceil(o.bottom),s=document.body.offsetHeight;n=this.wot.wtTable.hider.style.left,n=""===n?0:n,r=i>s?i-s:0,t=r,r+="px",e.style.top="",e.style.left=n,e.style.bottom=r}else t=this.getScrollPosition(),f(e),this.repositionOverlay();this.adjustHeaderBordersPosition(t)}},setScrollPosition:function(e){this.mainTableScrollableElement===window?window.scrollTo(u(),e):this.mainTableScrollableElement.scrollTop=e},onScroll:function(){this.wot.getSetting("onScrollVertically")},sumCellSizes:function(e,t){for(var n=0,r=this.wot.wtSettings.settings.defaultRowHeight;e<t;){var o=this.wot.wtTable.getRowHeight(e);n+=void 0===o?r:o,e++}return n},adjustElementsSize:function(){var e=void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),e||(this.areElementSizesAdjusted=!0))},adjustRootElementSize:function(){var e,t=this.wot.wtTable.holder,n=t.clientWidth===t.offsetWidth?0:a(),r=this.clone.wtTable.holder.parentNode,o=r.style;this.trimmingContainer===window?o.width="":o.width=this.wot.wtViewport.getWorkspaceWidth()-n+"px",this.clone.wtTable.holder.style.width=o.width,e=c(this.clone.wtTable.TABLE),o.height=(0===e?e:e)+"px"},adjustRootChildrenSize:function(){var e=a();this.clone.wtTable.hider.style.width=this.hider.style.width,this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width,0===e&&(e=30),this.clone.wtTable.holder.style.height=parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+e+"px"},applyToDOM:function(){var e=this.wot.getSetting("totalRows");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()},syncOverlayOffset:function(){"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":this.clone.wtTable.spreader.style.left=""},scrollTo:function(e,t){var n=this.getTableParentOffset(),r=this.wot.cloneSource?this.wot.cloneSource:this.wot,o=r.wtTable.holder,i=0;t&&o.offsetHeight!==o.clientHeight&&(i=a()),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wot.getSetting("fixedRowsBottom"),e),n+=i,this.setScrollPosition(n)},getTableParentOffset:function(){return this.mainTableScrollableElement===window?this.wot.wtTable.holderOffset.top:0},getScrollPosition:function(){return l(this.mainTableScrollableElement)},adjustHeaderBordersPosition:function(e){if(0===this.wot.getSetting("fixedRowsBottom")&&this.wot.getSetting("columnHeaders").length>0){var t=this.wot.wtTable.holder.parentNode,n=d(t,"innerBorderTop");e?s(t,"innerBorderTop"):h(t,"innerBorderTop"),(!n&&e||n&&!e)&&this.wot.wtOverlays.adjustElementsSize()}if(0===this.wot.getSetting("rowHeaders").length){var r=this.clone.wtTable.THEAD.querySelector("th:nth-of-type(2)");r&&(r.style["border-left-width"]=0)}}},{},p),window.WalkontableBottomOverlay=m,p.registerOverlay(p.CLONE_BOTTOM,m)},{"../../../../../node_modules/hot-builder/node_modules/handsontable/src/3rdparty/walkontable/src/overlay/_base.js":12,"../../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47}],137:[function(e,t,n){"use strict";Object.defineProperties(n,{WalkontableBottomLeftCornerOverlay:{get:function(){return c}},__esModule:{value:!0}});var r,o,i=(r=e("../../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),r&&r.__esModule&&r||{default:r}),s=i.getScrollbarWidth,a=i.outerHeight,l=i.outerWidth,u=(i.setOverlayPosition,i.resetCssTransform),d=(o=e("../../../../../node_modules/hot-builder/node_modules/handsontable/src/3rdparty/walkontable/src/overlay/_base.js"),o&&o.__esModule&&o||{default:o}).WalkontableOverlay,c=function(e){$traceurRuntime.superConstructor(h).call(this,e),this.clone=this.makeClone(d.CLONE_BOTTOM_LEFT_CORNER)},h=c;$traceurRuntime.createClass(c,{shouldBeRendered:function(){return!(!this.wot.getSetting("fixedRowsBottom")||!this.wot.getSetting("fixedColumnsLeft")&&!this.wot.getSetting("rowHeaders").length)},repositionOverlay:function(){var e=s(),t=this.clone.wtTable.holder.parentNode;this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight&&(e=0),t.style.top="",t.style.bottom=e+"px"},resetFixedPosition:function(){if(this.updateTrimmingContainer(),this.wot.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,t=a(this.clone.wtTable.TABLE),n=l(this.clone.wtTable.TABLE);if(e.style.top="",this.trimmingContainer===window){var r,o,i=this.wot.wtTable.hider.getBoundingClientRect(),s=Math.ceil(i.bottom),d=Math.ceil(i.left),c=document.body.offsetHeight;r=d<0?-d:0,o=s>c?s-c:0,o+="px",r+="px",e.style.top="",e.style.left=r,e.style.bottom=o}else u(e),this.repositionOverlay();e.style.height=(0===t?t:t)+"px",e.style.width=(0===n?n:n)+"px"}}},{},d),window.WalkontableBottomLeftCornerOverlay=c,d.registerOverlay(d.CLONE_BOTTOM_LEFT_CORNER,c)},{"../../../../../node_modules/hot-builder/node_modules/handsontable/src/3rdparty/walkontable/src/overlay/_base.js":12,"../../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47}],138:[function(e,t,n){"use strict";var r,o,i,s=(r=e("../node_modules/hot-builder/node_modules/handsontable/src/browser"),r&&r.__esModule&&r||{default:r}).default;(o=e("3rdparty/walkontable/src/overlay/bottom"),o&&o.__esModule&&o||{default:o}).WalkontableBottomOverlay,(i=e("3rdparty/walkontable/src/overlay/bottomLeftCorner"),i&&i.__esModule&&i||{default:i}).WalkontableBottomLeftCornerOverlay;t.exports=s},{"../node_modules/hot-builder/node_modules/handsontable/src/browser":24,"3rdparty/walkontable/src/overlay/bottom":136,"3rdparty/walkontable/src/overlay/bottomLeftCorner":137}],139:[function(e,t,n){"use strict";Object.defineProperties(n,{BindRowsWithHeaders:{get:function(){return h}},__esModule:{value:!0}});var r,o,i,s,a,l=(r=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),r&&r.__esModule&&r||{default:r}).default,u=((o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),o&&o.__esModule&&o||{default:o}).arrayEach,(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),i&&i.__esModule&&i||{default:i}).rangeEach),d=(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),s&&s.__esModule&&s||{default:s}).registerPlugin,c=(a=e("bindStrategy"),a&&a.__esModule&&a||{default:a}).BindStrategy,h=function(e){$traceurRuntime.superConstructor(f).call(this,e),this.bindStrategy=new c,this.removedRows=[]},f=h;$traceurRuntime.createClass(h,{isEnabled:function(){return!!this.hot.getSettings().bindRowsWithHeaders},enablePlugin:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().bindRowsWithHeaders;"string"!=typeof t&&(t=c.DEFAULT_STRATEGY),this.bindStrategy.setStrategy(t),this.bindStrategy.createMap(this.hot.countSourceRows()),this.addHook("modifyRowHeader",function(t){return e.onModifyRowHeader(t)}),this.addHook("afterCreateRow",function(t,n){return e.onAfterCreateRow(t,n)}),this.addHook("beforeRemoveRow",function(t,n){return e.onBeforeRemoveRow(t,n)}),this.addHook("afterRemoveRow",function(t,n){return e.onAfterRemoveRow(t,n)}),this.addHook("afterLoadData",function(t){return e.onAfterLoadData(t)}),$traceurRuntime.superGet(this,f.prototype,"enablePlugin").call(this)}},updatePlugin:function(){$traceurRuntime.superGet(this,f.prototype,"updatePlugin").call(this)},disablePlugin:function(){this.removedRows.length=0,this.bindStrategy.clearMap(),$traceurRuntime.superGet(this,f.prototype,"disablePlugin").call(this)},onModifyRowHeader:function(e){return this.bindStrategy.translate(this.hot.runHooks("modifyRow",e))},onAfterCreateRow:function(e,t){this.bindStrategy.createRow(e,t)},onBeforeRemoveRow:function(e,t){var n=this;this.removedRows.length=0,e!==!1&&u(e,e+t-1,function(e){n.removedRows.push(n.hot.runHooks("modifyRow",e))})},onAfterRemoveRow:function(e,t){this.bindStrategy.removeRow(this.removedRows)},onAfterLoadData:function(e){e||this.bindStrategy.createMap(this.hot.countSourceRows())},destroy:function(){this.bindStrategy.destroy(),$traceurRuntime.superGet(this,f.prototype,"destroy").call(this)}},{},l),d("bindRowsWithHeaders",h)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,bindStrategy:140}],140:[function(e,t,n){"use strict";Object.defineProperties(n,{BindStrategy:{get:function(){return d}},__esModule:{value:!0}});var r,o,i,s,a=(r=e("../../browser"),r&&r.__esModule&&r||{default:r}).default,l=((o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper"),o&&o.__esModule&&o||{default:o}).arrayMapper,(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),i&&i.__esModule&&i||{default:i}).mixin,(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),s&&s.__esModule&&s||{default:s}).rangeEach),u={},d=function(){this.strategy=null};$traceurRuntime.createClass(d,{setStrategy:function(e){var t=u[e];if(!t)throw new Error('Bind strategy "'+e+'" does not exist.');this.strategy=new t},createMap:function(e){var t=this.strategy,n=void 0===e?t._arrayMap.length:e;t._arrayMap.length=0,l(n-1,function(e){t._arrayMap.push(e)})},createRow:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.strategy.createRow.apply(this.strategy,e)},removeRow:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.strategy.removeRow.apply(this.strategy,e)},translate:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.strategy.getValueByIndex.apply(this.strategy,e)},clearMap:function(){this.strategy.clearMap()},destroy:function(){this.strategy&&this.strategy.destroy(),this.strategy=null}},{get DEFAULT_STRATEGY(){return"loose"},registerStrategy:function(e,t){u[e]=t}}),a.utils.BindStrategy=d},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper":57,"../../browser":138}],141:[function(e,t,n){"use strict";Object.defineProperties(n,{LooseBindStrategy:{get:function(){return u}},__esModule:{value:!0}});var r,o,i,s=(r=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper"),r&&r.__esModule&&r||{default:r}).arrayMapper,a=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),o&&o.__esModule&&o||{default:o}).mixin,l=(i=e("bindStrategy"),i&&i.__esModule&&i||{default:i}).BindStrategy,u=function(){};$traceurRuntime.createClass(u,{createRow:function(e,t){this.shiftItems(e,t)},removeRow:function(e,t){this.unshiftItems(e,t)},destroy:function(){this._arrayMap=null}},{get STRATEGY_NAME(){return"loose"}}),a(u,s),l.registerStrategy(u.STRATEGY_NAME,u)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper":57,bindStrategy:140}],142:[function(e,t,n){"use strict";Object.defineProperties(n,{StrictBindStrategy:{get:function(){return u}},__esModule:{value:!0}});var r,o,i,s=(r=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper"),r&&r.__esModule&&r||{default:r}).arrayMapper,a=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),o&&o.__esModule&&o||{default:o}).mixin,l=(i=e("bindStrategy"),i&&i.__esModule&&i||{default:i}).BindStrategy,u=function(){};$traceurRuntime.createClass(u,{createRow:function(e,t){this.insertItems(e,t)},removeRow:function(e,t){this.removeItems(e,t)},destroy:function(){this._arrayMap=null}},{get STRATEGY_NAME(){return"strict"}}),a(u,s),l.registerStrategy(u.STRATEGY_NAME,u)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper":57,bindStrategy:140}],143:[function(e,t,n){"use strict";Object.defineProperties(n,{CollapsibleColumns:{get:function(){return R}},__esModule:{value:!0}});var r,o,i,s,a,l,u,a,d,c=(r=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),r&&r.__esModule&&r||{default:r}).objectEach,h=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),o&&o.__esModule&&o||{default:o}).arrayEach,f=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),i&&i.__esModule&&i||{default:i}).rangeEach,p=(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),s&&s.__esModule&&s||{default:s}),m=p.addClass,g=p.hasClass,v=p.fastInnerText,w=((a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager"),a&&a.__esModule&&a||{default:a}).EventManager,l=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),l&&l.__esModule&&l||{default:l}),b=w.registerPlugin,y=(w.getPlugin,(u=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event"),u&&u.__esModule&&u||{default:u}).stopImmediatePropagation),_=(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager"),a&&a.__esModule&&a||{default:a}).eventManager,C=(d=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),d&&d.__esModule&&d||{default:d}).default,R=function(e){$traceurRuntime.superConstructor(M).call(this,e),this.settings=null,this.buttonEnabledList={},this.hiddenColumnsPlugin=null,this.nestedHeadersPlugin=null,this.collapsedSections={},this.columnHeaderLevelCount=null,this.eventManager=null},M=R;$traceurRuntime.createClass(R,{isEnabled:function(){return!!this.hot.getSettings().collapsibleColumns},enablePlugin:function(){var e=this;this.enabled||(this.settings=this.hot.getSettings().collapsibleColumns,"boolean"!=typeof this.settings&&this.parseSettings(),this.hiddenColumnsPlugin=this.hot.getPlugin("hiddenColumns"),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.checkDependencies(),this.addHook("afterRender",function(){return e.onAfterRender()}),this.addHook("afterInit",function(){return e.onAfterInit()}),this.addHook("afterGetColHeader",function(t,n){return e.onAfterGetColHeader(t,n)}),this.addHook("beforeOnCellMouseDown",function(t,n,r){return e.onBeforeOnCellMouseDown(t,n,r)}),this.eventManager=_(this.hot),$traceurRuntime.superGet(this,M.prototype,"enablePlugin").call(this))},disablePlugin:function(){this.settings=null,this.buttonEnabledList={},this.hiddenColumnsPlugin=null,this.collapsedSections={},this.clearButtons(),$traceurRuntime.superGet(this,M.prototype,"disablePlugin").call(this)},clearButtons:function(){if(this.hot.view){var e=this.hot.view.wt.getSetting("columnHeaders").length,t=this.hot.view.wt.wtTable.THEAD,n=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null,o=function(e){e&&e.parentNode.removeChild(e)};f(0,e-1,function(e){var i=t.childNodes[e],s=n.childNodes[e],a=r?r.childNodes[e]:null;f(0,i.childNodes.length-1,function(e){var t=i.childNodes[e].querySelector(".collapsibleIndicator");o(t),s&&s.childNodes[e]&&(t=s.childNodes[e].querySelector(".collapsibleIndicator"),o(t)),r&&a&&a.childNodes[e]&&(t=a.childNodes[e].querySelector(".collapsibleIndicator"),o(t))})},!0)}},parseSettings:function(){var e=this;c(this.settings,function(t){e.buttonEnabledList[t.row]||(e.buttonEnabledList[t.row]={}),e.buttonEnabledList[t.row][t.col]=t.collapsible})},meetsDependencies:function(){var e=this.hot.getSettings();return e.nestedHeaders&&e.hiddenColumns},checkDependencies:function(){var e=this.hot.getSettings();this.meetsDependencies()||(e.nestedHeaders||console.warn("You need to configure the Nested Headers plugin in order to use collapsible headers."),e.hiddenColumns||console.warn("You need to configure the Hidden Columns plugin in order to use collapsible headers."))},generateIndicator:function(e,t){var n=t.parentNode,r=n.parentNode,o=-1*r.childNodes.length+Array.prototype.indexOf.call(r.childNodes,n);if(Object.keys(this.buttonEnabledList).length>0&&(!this.buttonEnabledList[o]||!this.buttonEnabledList[o][e]))return null;var i=document.createElement("DIV");return m(i,"collapsibleIndicator"),this.collapsedSections[o]&&this.collapsedSections[o][e]===!0?(m(i,"collapsed"),v(i,"+")):(m(i,"expanded"),v(i,"-")),i},markSectionAs:function(e,t,n,r){switch(this.collapsedSections[t]||(this.collapsedSections[t]={}),e){case"collapsed":this.collapsedSections[t][n]=!0;break;case"expanded":this.collapsedSections[t][n]=void 0}if(r)for(var o=this.nestedHeadersPlugin.colspanArray,i=this.nestedHeadersPlugin.rowCoordsToLevel(t),s=this.nestedHeadersPlugin.getChildHeaders(t,n),a=o[i+1],l=1;l<s.length;l++)a&&a[s[l]].colspan>1&&this.markSectionAs(e,t+1,s[l],!0)},expandSection:function(e){this.markSectionAs("expanded",e.row,e.col,!0),this.toggleCollapsibleSection(e,"expand")},collapseSection:function(e){this.markSectionAs("collapsed",e.row,e.col,!0),this.toggleCollapsibleSection(e,"collapse")},toggleAllCollapsibleSections:function(e){var t=this,n=this.nestedHeadersPlugin.colspanArray;this.settings===!0?h(n,function(n,r){h(n,function(n,o){if(n.colspan>1){var i=t.nestedHeadersPlugin.levelToRowCoords(r),s=o;t.markSectionAs("collapse"===e?"collapsed":"expanded",i,s,!0),t.toggleCollapsibleSection({row:i,col:s},e)}})}):c(this.buttonEnabledList,function(n,r){c(n,function(n,o){t.markSectionAs("collapse"===e?"collapsed":"expanded",r,o,!0),t.toggleCollapsibleSection({row:r,col:o},e)})})},collapseAll:function(){this.toggleAllCollapsibleSections("collapse")},expandAll:function(){this.toggleAllCollapsibleSections("expand")},toggleCollapsibleSection:function(e,t){var n=this;e.row&&(e.row=parseInt(e.row,10)),e.col&&(e.col=parseInt(e.col,10));for(var r=this.hiddenColumnsPlugin.hiddenColumns,o=this.nestedHeadersPlugin.colspanArray,i=this.nestedHeadersPlugin.rowCoordsToLevel(e.row),s=o[i][e.col].colspan,a=this.nestedHeadersPlugin.getChildHeaders(e.row,e.col),l=i+1,u=o[l],d=u?u[a[0]].colspan||1:1;d===s&&l<this.columnHeaderLevelCount;)l+=1,u=o[l],d=u?u[a[0]].colspan||1:1;f(d,s-1,function(o){var i=e.col+o;switch(t){case"collapse":n.hiddenColumnsPlugin.isHidden(i)||r.push(i);break;case"expand":n.hiddenColumnsPlugin.isHidden(i)&&r.splice(r.indexOf(i),1)}}),this.hot.render()},onAfterGetColHeader:function(e,t){if(t.hasAttribute("colspan")&&t.getAttribute("colspan")>1&&e>=this.hot.getSettings().fixedColumnsLeft){var n=this.generateIndicator(e,t);null!==n&&t.querySelector("div:first-child").appendChild(n)}},onBeforeOnCellMouseDown:function(e,t){if(g(e.target,"collapsibleIndicator"))return g(e.target,"expanded")?(this.collapsedSections[t.row]||(this.collapsedSections[t.row]=[]),this.markSectionAs("collapsed",t.row,t.col,!0),this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection(t,"collapse")):g(e.target,"collapsed")&&(this.markSectionAs("expanded",t.row,t.col,!0),this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection(t,"expand")),y(e),!1},onAfterInit:function(){this.columnHeaderLevelCount=this.hot.view.wt.getSetting("columnHeaders").length},onAfterRender:function(){this.nestedHeadersPlugin.enabled&&this.hiddenColumnsPlugin.enabled||this.disablePlugin()},destroy:function(){this.settings=null,this.buttonEnabledList=null,this.hiddenColumnsPlugin=null,this.nestedHeadersPlugin=null,this.collapsedSections=null,this.columnHeaderLevelCount=null,$traceurRuntime.superGet(this,M.prototype,"destroy").call(this)}},{},C),b("collapsibleColumns",R)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager":42,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event":48,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,
"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63}],144:[function(e,t,n){"use strict";Object.defineProperties(n,{ColumnSummary:{get:function(){return f}},__esModule:{value:!0}});var r,o,i,s,a,l=(r=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base.js"),r&&r.__esModule&&r||{default:r}).default,u=(o=e("endpoints"),o&&o.__esModule&&o||{default:o}).Endpoints,d=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),i&&i.__esModule&&i||{default:i}),c=(d.deepClone,d.objectEach,(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),s&&s.__esModule&&s||{default:s}).arrayEach,a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins.js"),a&&a.__esModule&&a||{default:a}),h=c.registerPlugin,f=(c.getPlugin,function(e){$traceurRuntime.superConstructor(p).call(this,e),this.endpoints=null}),p=f;$traceurRuntime.createClass(f,{isEnabled:function(){return!!this.hot.getSettings().columnSummary},enablePlugin:function(){var e=this;this.enabled||(this.settings=this.hot.getSettings().columnSummary,this.endpoints=new u(this,this.settings),this.addHook("afterInit",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onAfterInit.apply(t,$traceurRuntime.spread(n))}),this.addHook("afterChange",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onAfterChange.apply(t,$traceurRuntime.spread(n))}),this.addHook("beforeCreateRow",function(t,n,r){return e.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,n,null,r)}),this.addHook("beforeCreateCol",function(t,n,r){return e.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,n,null,r)}),this.addHook("beforeRemoveRow",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e.endpoints).resetSetupBeforeStructureAlteration.apply(t,$traceurRuntime.spread(["remove_row"],n))}),this.addHook("beforeRemoveCol",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e.endpoints).resetSetupBeforeStructureAlteration.apply(t,$traceurRuntime.spread(["remove_col"],n))}),this.addHook("afterCreateRow",function(t,n,r){return e.endpoints.resetSetupAfterStructureAlteration("insert_row",t,n,null,r)}),this.addHook("afterCreateCol",function(t,n,r){return e.endpoints.resetSetupAfterStructureAlteration("insert_col",t,n,null,r)}),this.addHook("afterRemoveRow",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e.endpoints).resetSetupAfterStructureAlteration.apply(t,$traceurRuntime.spread(["remove_row"],n))}),this.addHook("afterRemoveCol",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e.endpoints).resetSetupAfterStructureAlteration.apply(t,$traceurRuntime.spread(["remove_col"],n))}),$traceurRuntime.superGet(this,p.prototype,"enablePlugin").call(this))},disablePlugin:function(){this.endpoints=null,this.settings=null,this.currentEndpoint=null},onAfterInit:function(){this.endpoints.endpoints=this.endpoints.parseSettings(),this.endpoints.refreshAllEndpoints(!0)},onAfterChange:function(e,t){e&&"columnSummary"!==t&&"loadData"!==t&&this.endpoints.refreshChangedEndpoints(e)},calculate:function(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e)}},calculateSum:function(e){var t=0;for(var n in e.ranges)e.ranges.hasOwnProperty(n)&&(t+=this.getPartialSum(e.ranges[n],e.sourceColumn));return t},getPartialSum:function(e,t){var n=0,r=e[1]||e[0],o=null,i=0;do{o=this.getCellValue(r,t)||0;var s=((o+"").split(".")[1]||[]).length||1;s>i&&(i=s),n+=o||0,r--}while(r>=e[0]);return Math.round(10*n*i)/10*i},calculateMinMax:function(e,t){var n=null;for(var r in e.ranges)if(e.ranges.hasOwnProperty(r)){var o=this.getPartialMinMax(e.ranges[r],e.sourceColumn,t);if(null===n&&null!==o&&(n=o),null!==o)switch(t){case"min":n=Math.min(n,o);break;case"max":n=Math.max(n,o)}}return null===n?"Not enough data":n},getPartialMinMax:function(e,t,n){var r,o=null,i=e[1]||e[0];do{if(r=this.getCellValue(i,t)||null,null===o)o=r;else if(null!==r)switch(n){case"min":o=Math.min(o,r);break;case"max":o=Math.max(o,r)}i--}while(i>=e[0]);return o},countEmpty:function(e,t){var n,r=0,o=e[1]||e[0];do n=this.getCellValue(o,t),n||r++,o--;while(o>=e[0]);return r},countEntries:function(e){var t=0,n=e.ranges;for(var r in n)if(n.hasOwnProperty(r)){var o=void 0===n[r][1]?1:n[r][1]-n[r][0]+1,i=this.countEmpty(n[r],e.sourceColumn);t+=o,t-=i}return t},calculateAverage:function(e){var t=this.calculateSum(e),n=this.countEntries(e);return t/n},getCellValue:function(e,t){var n=this.hot.getSourceDataAtCell(e,t),r=this.endpoints.getVisualRowIndex(e),o=this.hot.getCellMeta(r,t).className||"";if(o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof n&&(n=n.replace(/,/,".")),n=parseFloat(n,10)),isNaN(n)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error("ColumnSummary plugin: cell at ("+e+", "+t+") is not in a numeric format. Cannot do the calculation.");return n}},{},l),h("columnSummary",f)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins.js":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base.js":63,endpoints:145}],145:[function(e,t,n){"use strict";Object.defineProperties(n,{Endpoints:{get:function(){return s}},__esModule:{value:!0}});var r,o,i=(r=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),r&&r.__esModule&&r||{default:r}).arrayEach,s=((o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),o&&o.__esModule&&o||{default:o}).deepClone,function(e,t){this.plugin=e,this.hot=this.plugin.hot,this.endpoints=[],this.settings=t,this.settingsType="array",this.currentEndpoint=null,this.cellsToSetCache=[]});$traceurRuntime.createClass(s,{getEndpoint:function(e){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]},getAllEndpoints:function(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints},fillMissingEndpointData:function(e){return this.parseSettings(e.call(this))},parseSettings:function(e){var t=this,n=[];return e||"function"!=typeof this.settings?(e||(e=this.settings),i(e,function(e){var r={};t.assignSetting(e,r,"ranges",[[0,t.hot.countRows()-1]]),t.assignSetting(e,r,"reversedRowCoords",!1),t.assignSetting(e,r,"destinationRow",new Error("You must provide a destination row for the Column Summary plugin in order to work properly!")),t.assignSetting(e,r,"destinationColumn",new Error("You must provide a destination column for the Column Summary plugin in order to work properly!")),t.assignSetting(e,r,"sourceColumn",e.destinationColumn),t.assignSetting(e,r,"type","sum"),t.assignSetting(e,r,"forceNumeric",!1),t.assignSetting(e,r,"suppressDataTypeErrors",!0),t.assignSetting(e,r,"suppressDataTypeErrors",!0),t.assignSetting(e,r,"customFunction",null),t.assignSetting(e,r,"readOnly",!0),t.assignSetting(e,r,"roundFloat",!1),n.push(r)}),n):void(this.settingsType="function")},assignSetting:function(e,t,n,r){if("ranges"===n&&void 0===e[n])return void(t[n]=r);if("ranges"!==n||0!==e[n].length)if(void 0===e[n]){if(r instanceof Error)throw r;t[n]=r}else"destinationRow"===n&&t.reversedRowCoords?t[n]=this.hot.countRows()-e[n]-1:t[n]=e[n]},resetSetupBeforeStructureAlteration:function(e,t,n,r,o){if("function"===this.settingsType){var s=e.indexOf("row")>-1?"row":"col",a=this.getAllEndpoints();i(a,function(r,o,i){"row"===s&&r.destinationRow>=t&&("insert_row"===e?r.alterRowOffset=n:"remove_row"===e&&(r.alterRowOffset=-1*n)),"col"===s&&r.destinationColumn>=t&&("insert_col"===e?r.alterColumnOffset=n:"remove_col"===e&&(r.alterColumnOffset=-1*n))}),this.resetAllEndpoints(a,!1)}},resetSetupAfterStructureAlteration:function(e,t,n,r,o){var s=this;if("function"===this.settingsType){var a=function(){return s.hot.removeHook("beforeRender",a),s.refreshAllEndpoints(!0)};return void this.hot.addHookOnce("beforeRender",a)}var l=e.indexOf("row")>-1?"row":"col",u=e.indexOf("insert")>-1?1:-1,d=this.getAllEndpoints(),c=0,h=0;"row"===l?c=u*n:"col"===l&&(h=u*n),i(d,function(e,r,o){"row"===l&&e.destinationRow>=t&&(e.alterRowOffset=u*n),"col"===l&&e.destinationColumn>=t&&(e.alterColumnOffset=u*n)}),this.resetAllEndpoints(d),i(d,function(e,n,r){s.shiftEndpointCoordinates(e,t,c,h)}),this.refreshAllEndpoints(!0)},shiftEndpointCoordinates:function(e,t){e.alterRowOffset&&0!==e.alterRowOffset?(e.destinationRow+=e.alterRowOffset||0,i(e.ranges,function(n,r){i(n,function(r,o){r>=t&&(n[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&0!==e.alterColumnOffset&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)},resetAllEndpoints:function(e){var t=void 0===arguments[1]||arguments[1],n=this;this.cellsToSetCache=[],e||(e=this.getAllEndpoints()),i(e,function(e){n.resetEndpointValue(e,t)}),this.hot.setDataAtCell(this.cellsToSetCache,"columnSummary"),this.cellsToSetCache=[]},refreshAllEndpoints:function(e){var t=this;this.cellsToSetCache=[],i(this.getAllEndpoints(),function(e){t.currentEndpoint=e,t.plugin.calculate(e),t.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"columnSummary"),this.cellsToSetCache=[]},refreshChangedEndpoints:function(e){var t=this,n=[];this.cellsToSetCache=[],i(e,function(e,r,o){(e[2]||"")+""!=e[3]+""&&i(t.getAllEndpoints(),function(e,i){t.hot.propToCol(o[r][1])===e.sourceColumn&&n.indexOf(i)===-1&&n.push(i)})}),i(n,function(e){t.refreshEndpoint(t.getEndpoint(e))}),this.hot.setDataAtCell(this.cellsToSetCache,"columnSummary"),this.cellsToSetCache=[]},refreshEndpoint:function(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null},resetEndpointValue:function(e){var t=void 0===arguments[1]||arguments[1],n=e.alterRowOffset||0,r=e.alterColumnOffset||0,o=this.getVisualRowIndex(e.destinationRow);this.hot.setCellMeta(o,e.destinationColumn,"readOnly",!1),this.hot.setCellMeta(o,e.destinationColumn,"className",""),this.cellsToSetCache.push([this.getVisualRowIndex(e.destinationRow+(t?n:0)),e.destinationColumn+(t?r:0),""])},setEndpointValue:function(e,t){var n=void 0!==arguments[2]&&arguments[2],r=-1*e.alterRowOffset||0,o=-1*e.alterColumnOffset||0,i=this.getVisualRowIndex(e.destinationRow),s=this.hot.getCellMeta(this.getVisualRowIndex(e.destinationRow+r),e.destinationColumn+o);return i>this.hot.countRows()||e.destinationColumn>this.hot.countCols()?void this.throwOutOfBoundsWarning():("init"!==t&&s.readOnly===e.readOnly||(s.readOnly=e.readOnly,s.className="columnSummaryResult"),e.roundFloat&&!isNaN(e.result)&&(e.result=e.result.toFixed(e.roundFloat)),n?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"columnSummary"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,void(e.alterColumnOffset=void 0))},getVisualRowIndex:function(e){return this.hot.runHooks("unmodifyRow",e,"columnSummary")},throwOutOfBoundsWarning:function(){console.warn("One of the  Column Summary plugins' destination points you provided is beyond the table boundaries!")}},{})},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53}],146:[function(e,t,n){"use strict";Object.defineProperties(n,{DropdownMenu:{get:function(){return P}},__esModule:{value:!0}});var r,o,i,s,a,l,u,d,c,h,f,p,m=(r=e("../../browser"),r&&r.__esModule&&r||{default:r}).default,g=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),o&&o.__esModule&&o||{default:o}).default,v=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),i&&i.__esModule&&i||{default:i}).arrayEach,w=((s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),s&&s.__esModule&&s||{default:s}).objectEach,(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/commandExecutor"),a&&a.__esModule&&a||{default:a}).CommandExecutor),b=(l=e("../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager"),l&&l.__esModule&&l||{default:l}).EventManager,y=(u=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),u&&u.__esModule&&u||{default:u}),_=(y.getWindowScrollTop,y.getWindowScrollLeft,y.hasClass),C=(y.closest,(d=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/itemsFactory"),d&&d.__esModule&&d||{default:d}).ItemsFactory),R=(c=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/menu"),c&&c.__esModule&&c||{default:c}).Menu,M=(h=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),h&&h.__esModule&&h||{default:h}).registerPlugin,E=(f=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event"),f&&f.__esModule&&f||{default:f}).stopPropagation,S=(p=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems"),p&&p.__esModule&&p||{default:p}),O=S.COLUMN_LEFT,T=S.COLUMN_RIGHT,A=S.REMOVE_COLUMN,N=S.CLEAR_COLUMN,x=S.READ_ONLY,k=S.ALIGNMENT,I=S.SEPARATOR,D="changeType",P=function(e){var t=this;$traceurRuntime.superConstructor(H).call(this,e),this.eventManager=new b(this),this.commandExecutor=new w(this.hot),this.itemsFactory=null,this.menu=null,this.hot.addHook("afterGetColHeader",function(e,n){return t.onAfterGetColHeader(e,n)})},H=P;$traceurRuntime.createClass(P,{isEnabled:function(){return this.hot.getSettings().dropdownMenu},enablePlugin:function(){var e=this;if(!this.enabled){this.itemsFactory=new C(this.hot,H.DEFAULT_ITEMS);var t=this.hot.getSettings().dropdownMenu,n={items:this.itemsFactory.getItems(t)};this.registerEvents(),"function"==typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),$traceurRuntime.superGet(this,H.prototype,"enablePlugin").call(this),this.callOnPluginsReady(function(){e.hot.runHooks("afterDropdownMenuDefaultOptions",n),e.itemsFactory.setPredefinedItems(n.items);var r=e.itemsFactory.getItems(t);e.menu=new R(e.hot,{className:"htDropdownMenu",keepInViewport:!0}),e.hot.runHooks("beforeDropdownMenuSetItems",r),e.menu.setMenuItems(r),e.menu.addLocalHook("afterOpen",function(){return e.onMenuAfterOpen()}),e.menu.addLocalHook("afterClose",function(){return e.onMenuAfterClose()}),e.menu.addLocalHook("executeCommand",function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.executeCommand.apply(e,t)}),v(r,function(t){return e.commandExecutor.registerCommand(t.key,t)})})}},updatePlugin:function(){this.disablePlugin(),this.enablePlugin(),$traceurRuntime.superGet(this,H.prototype,"updatePlugin").call(this)},disablePlugin:function(){this.close(),this.menu&&this.menu.destroy(),$traceurRuntime.superGet(this,H.prototype,"disablePlugin").call(this)},registerEvents:function(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(t){return e.onTableClick(t)})},open:function(e){this.menu&&(this.menu.open(),e.width&&this.menu.setOffset("left",e.width),this.menu.setPosition(e),this.menu.hotMenu.isHotTableEnv=this.hot.isHotTableEnv,m.eventManager.isHotTableEnv=this.hot.isHotTableEnv)},close:function(){this.menu&&this.menu.close()},executeCommand:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.commandExecutor.execute.apply(this.commandExecutor,e)},onTableClick:function(e){if(E(e),_(e.target,D)&&!this.menu.isOpened()){var t=e.target.getBoundingClientRect();this.open({left:t.left,top:t.top+e.target.offsetHeight+3,width:t.width,height:t.height})}},onAfterGetColHeader:function(e,t){var n=t.parentNode;if(n){var r=n.parentNode.childNodes,o=Array.prototype.indexOf.call(r,n);if(!(e<0||o!==r.length-1)){var i=t.querySelector("."+D);if(!this.enabled||!i){if(!this.enabled)return void(i&&i.parentNode.removeChild(i));var s=document.createElement("button");s.className=D,s.onclick=function(){return!1},t.firstChild.insertBefore(s,t.firstChild.firstChild)}}}},onMenuAfterOpen:function(){this.hot.runHooks("afterDropdownMenuShow",this)},onMenuAfterClose:function(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)},destroy:function(){this.close(),this.menu&&this.menu.destroy(),$traceurRuntime.superGet(this,H.prototype,"destroy").call(this)}},{get DEFAULT_ITEMS(){return[O,T,I,A,I,N,I,x,I,k]}},g),P.SEPARATOR={name:I},m.hooks.register("afterDropdownMenuDefaultOptions"),m.hooks.register("afterDropdownMenuShow"),m.hooks.register("afterDropdownMenuHide"),m.hooks.register("afterDropdownMenuExecute"),M("dropdownMenu",P)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager":42,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event":48,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/commandExecutor":70,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/itemsFactory":73,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/menu":74,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems":75,"../../browser":138}],147:[function(e,t,n){"use strict";Object.defineProperties(n,{DataProvider:{get:function(){return l}},__esModule:{value:!0}});var r,o,i,s=((r=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),r&&r.__esModule&&r||{default:r}).arrayEach,o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),o&&o.__esModule&&o||{default:o}),a=(s.extend,s.clone,(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),i&&i.__esModule&&i||{default:i}).rangeEach),l=function(e){this.hot=e,this.options={}};$traceurRuntime.createClass(l,{setOptions:function(e){this.options=e},getData:function(){var e=this,t=this._getDataRange(),n=t.startRow,r=t.startCol,o=t.endRow,i=t.endCol,s=this.options,l=[];return a(n,o,function(t){var n=[];!s.exportHiddenRows&&e._isHiddenRow(t)||(a(r,i,function(r){!s.exportHiddenColumns&&e._isHiddenColumn(r)||n.push(e.hot.getDataAtCell(t,r))}),l.push(n))}),l},getRowHeaders:function(){var e=this,t=[];if(this.options.rowHeaders){var n=this._getDataRange(),r=n.startRow,o=n.endRow,i=this.hot.getRowHeader();a(r,o,function(n){!e.options.exportHiddenRows&&e._isHiddenRow(n)||t.push(i[n])})}return t},getColumnHeaders:function(){var e=this,t=[];if(this.options.columnHeaders){var n=this._getDataRange(),r=n.startCol,o=n.endCol,i=this.hot.getColHeader();a(r,o,function(n){!e.options.exportHiddenColumns&&e._isHiddenColumn(n)||t.push(i[n])})}return t},_getDataRange:function(){var e,t,n,r,o=this.hot.countCols()-1,i=this.hot.countRows()-1,s=this.options.range,a=void 0===(e=s[0])?0:e,l=void 0===(t=s[1])?0:t,u=void 0===(n=s[2])?i:n,d=void 0===(r=s[3])?o:r;return a=Math.max(a,0),l=Math.max(l,0),u=Math.min(u,i),d=Math.min(d,o),{startRow:a,startCol:l,endRow:u,endCol:d}},_isHiddenRow:function(e){return this.hot.hasHook("hiddenRow")&&this.hot.runHooks("hiddenRow",e)},_isHiddenColumn:function(e){return this.hot.hasHook("hiddenColumn")&&this.hot.runHooks("hiddenColumn",e)}},{})},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53}],148:[function(e,t,n){"use strict";Object.defineProperties(n,{ExportFile:{get:function(){return m}},__esModule:{value:!0}});var r,o,i,s,a,l=(r=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),r&&r.__esModule&&r||{default:r}).default,u=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),o&&o.__esModule&&o||{default:o}),d=(u.objectEach,u.extend,u.clone,(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),i&&i.__esModule&&i||{default:i}).registerPlugin),c=(s=e("dataProvider"),s&&s.__esModule&&s||{default:s}).DataProvider,h=(a=e("typeFactory"),a&&a.__esModule&&a||{default:a}),f=h.typeFactory,p=h.EXPORT_TYPES,m=function(e){$traceurRuntime.superConstructor(g).call(this,e)},g=m;$traceurRuntime.createClass(m,{isEnabled:function(){return!0},exportAsString:function(e){var t=void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(e,t).export()},exportAsBlob:function(e){var t=void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))},downloadFile:function(e){var t=void 0!==arguments[1]?arguments[1]:{},n=this._createTypeFormatter(e,t),r=this._createBlob(n),o=window.URL||window.webkitURL,i=document.createElement("a"),s=n.options.filename+"."+n.options.fileExtension;if(void 0!==i.download){var a=o.createObjectURL(r);i.style.display="none",i.setAttribute("href",a),i.setAttribute("download",s),document.body.appendChild(i),i.dispatchEvent(new MouseEvent("click")),document.body.removeChild(i),setTimeout(function(){o.revokeObjectURL(a)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(r,s)},_createTypeFormatter:function(e){var t=void 0!==arguments[1]?arguments[1]:{};if(!p[e])throw new Error('Export format type "'+e+'" is not supported.');return f(e,new c(this.hot),t)},_createBlob:function(e){var t=null;return"undefined"!=typeof Blob&&(t=new Blob([e.export()],{type:e.options.mimeType+";charset="+e.options.encoding})),t}},{},l),d("exportFile",m)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,dataProvider:147,typeFactory:149}],149:[function(e,t,n){"use strict";function r(e,t,n){return"function"==typeof d[e]?new d[e](t,n):null}var o;Object.defineProperties(n,{TYPE_CSV:{get:function(){return a}},TYPE_EXCEL:{get:function(){return l}},TYPE_PDF:{get:function(){return u}},EXPORT_TYPES:{get:function(){return d}},typeFactory:{get:function(){return r}},__esModule:{value:!0}});var i,s=(i=e("types/csv.js"),i&&i.__esModule&&i||{default:i}).Csv,a="csv",l="excel",u="pdf",d=(o={},Object.defineProperty(o,a,{value:s,configurable:!0,enumerable:!0,writable:!0}),o)},{"types/csv.js":151}],150:[function(e,t,n){"use strict";Object.defineProperties(n,{BaseType:{get:function(){return f}},__esModule:{value:!0}});var r,o,i,s,a=((r=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),r&&r.__esModule&&r||{default:r}).arrayEach,o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),o&&o.__esModule&&o||{default:o}),l=a.extend,u=a.clone,d=((i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),i&&i.__esModule&&i||{default:i}).rangeEach,s=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string"),s&&s.__esModule&&s||{default:s}),c=d.substitute,h=d.padStart,f=function(e,t){this.dataProvider=e,this.options=this._mergeOptions(t),this.dataProvider.setOptions(this.options)},p=f;$traceurRuntime.createClass(f,{_mergeOptions:function(e){var t=u(this.constructor.DEFAULT_OPTIONS),n=new Date;return t=l(u(p.DEFAULT_OPTIONS),t),t=l(t,e),t.filename=c(t.filename,{YYYY:n.getFullYear(),MM:h(n.getMonth()+1,2,"0"),DD:h(n.getDate(),2,"0")}),t}},{get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string":55}],151:[function(e,t,n){"use strict";Object.defineProperties(n,{Csv:{get:function(){return p}},__esModule:{value:!0}});var r,o,i,s=(r=e("_base.js"),r&&r.__esModule&&r||{default:r}).BaseType,a=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),o&&o.__esModule&&o||{default:o}),l=a.arrayEach,u=a.arrayMap,d=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed"),i&&i.__esModule&&i||{default:i}).stringify,c=String.fromCharCode(13),h=String.fromCharCode(34),f=String.fromCharCode(10),p=function(e,t){$traceurRuntime.superConstructor(m).call(this,e,t)},m=p;$traceurRuntime.createClass(p,{export:function(){var e=this,t=this.options,n=this.dataProvider.getData(),r=this.dataProvider.getColumnHeaders(),o=r.length>0,i=this.dataProvider.getRowHeaders(),s=i.length>0,a="\ufeff";return o&&(r=u(r,function(t){return e._escapeCell(t,!0)}),s&&(a+=t.columnDelimiter),a+=r.join(t.columnDelimiter),a+=t.rowDelimiter),l(n,function(n,r){r>0&&(a+=t.rowDelimiter),s&&(a+=e._escapeCell(i[r])+t.columnDelimiter),a+=n.map(function(t){return e._escapeCell(t)}).join(t.columnDelimiter)}),a},_escapeCell:function(e){var t=void 0!==arguments[1]&&arguments[1];return e=d(e),""!==e&&(t||e.indexOf(c)>=0||e.indexOf(h)>=0||e.indexOf(f)>=0||e.indexOf(this.options.columnDelimiter)>=0)&&(e=e.replace(new RegExp('"',"g"),'""'),e='"'+e+'"'),e}},{get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",columnDelimiter:",",rowDelimiter:"\r\n"}}},s)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed":51,"_base.js":150}],152:[function(e,t,n){"use strict";Object.defineProperties(n,{BaseComponent:{get:function(){return c}},__esModule:{value:!0}});var r,o,i,s,a=(r=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),r&&r.__esModule&&r||{default:r}).arrayEach,l=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),o&&o.__esModule&&o||{default:o}).mixin,u=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks"),i&&i.__esModule&&i||{default:i}).localHooks,d=(s=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/stateSaver"),s&&s.__esModule&&s||{default:s}).stateSaver,c=function(e){this.hot=e,this.elements=[],this.hidden=!1};$traceurRuntime.createClass(c,{reset:function(){a(this.elements,function(e){return e.reset()})},hide:function(){this.hidden=!0},show:function(){this.hidden=!1},isHidden:function(){return this.hidden},destroy:function(){this.clearLocalHooks(),a(this.elements,function(e){return e.destroy()}),this.elements=null,this.hot=null}},{}),l(c,u),l(c,d)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks":58,"../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/stateSaver":59}],153:[function(e,t,n){"use strict";Object.defineProperties(n,{ActionBarComponent:{get:function(){return h}},__esModule:{value:!0}});var r,o,i,s,a,l=(r=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),r&&r.__esModule&&r||{default:r}).addClass,u=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),o&&o.__esModule&&o||{default:o}).arrayEach,d=(i=e("_base"),i&&i.__esModule&&i||{default:i}).BaseComponent,c=(s=e("ui/input"),s&&s.__esModule&&s||{default:s}).InputUI,h=((a=e("ui/select"),a&&a.__esModule&&a||{default:a}).SelectUI,function(e){$traceurRuntime.superConstructor(f).call(this,e),this.elements.push(new c(this.hot,{type:"button",value:"OK",className:"htUIButton htUIButtonOK",identifier:f.BUTTON_OK})),this.elements.push(new c(this.hot,{type:"button",value:"Cancel",className:"htUIButton htUIButtonCancel",identifier:f.BUTTON_CANCEL})),this.registerHooks()}),f=h;$traceurRuntime.createClass(h,{registerHooks:function(){var e=this;u(this.elements,function(t){t.addLocalHook("click",function(t,n){return e.onButtonClick(t,n)})})},getMenuItemDescriptor:function(){var e=this;return{key:"filter_action_bar",name:"Action bar",isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,n,r,o,i,s){return l(n.parentNode,"htFiltersMenuActionBar"),u(e.elements,function(e){return n.appendChild(e.element)}),n}}},accept:function(){this.runLocalHooks("accept")},cancel:function(){this.runLocalHooks("cancel")},onButtonClick:function(e,t){t.options.identifier===f.BUTTON_OK?this.accept():this.cancel()}},{get BUTTON_OK(){return"ok"},get BUTTON_CANCEL(){return"cancel"}},d)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,_base:152,"ui/input":184,"ui/select":186}],154:[function(e,t,n){"use strict";Object.defineProperties(n,{ConditionComponent:{get:function(){return O}},__esModule:{value:!0}});var r,o,i,s,a,l,u,d,c,h,f=(r=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),r&&r.__esModule&&r||{default:r}).addClass,p=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event"),o&&o.__esModule&&o||{default:o}).stopImmediatePropagation,m=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),i&&i.__esModule&&i||{default:i}),g=m.arrayEach,v=m.arrayFilter,w=((s=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),s&&s.__esModule&&s||{default:s}).extend,(a=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/unicode"),a&&a.__esModule&&a||{default:a}).isKey),b=(l=e("_base"),l&&l.__esModule&&l||{default:l}).BaseComponent,y=(u=e("constants"),u&&u.__esModule&&u||{default:u}),_=y.getOptionsList,C=y.FORMULA_NONE,R=y.FORMULA_BY_VALUE,M=(d=e("ui/input"),d&&d.__esModule&&d||{default:d}).InputUI,E=(c=e("ui/select"),c&&c.__esModule&&c||{default:c}).SelectUI,S=(h=e("formulaRegisterer"),h&&h.__esModule&&h||{default:h}).getFormulaDescriptor,O=function(e){$traceurRuntime.superConstructor(T).call(this,e),this.elements.push(new E(this.hot)),this.elements.push(new M(this.hot,{placeholder:"Value"})),this.elements.push(new M(this.hot,{placeholder:"Second value"})),this.registerHooks()},T=O;$traceurRuntime.createClass(O,{registerHooks:function(){var e=this;this.getSelectElement().addLocalHook("select",function(t){return e.onConditionSelect(t)}),g(this.getInputElements(),function(t){t.addLocalHook("keydown",function(t){return e.onInputKeyDown(t)})})},setState:function(e){var t=this;this.reset(),e&&(this.getSelectElement().setValue(e.command),g(e.args,function(n,r){var o=t.getInputElement(r);o.setValue(n),o[e.command.inputsCount>r?"show":"hide"](),r||setTimeout(function(){return o.focus()},10)}))},getState:function(){
var e=this.getSelectElement().getValue()||S(C),t=[];return g(this.getInputElements(),function(n,r){e.inputsCount>r&&t.push(n.getValue())}),{command:e,args:t}},updateState:function(e){var t=e,n=t.column,r=t.formulas,o=v(r,function(e){return e.name!==R})[0];o&&o.name===R||this.setCachedState(n,{command:S(o?o.name:C),args:o?o.args:[]})},getSelectElement:function(){return this.elements.filter(function(e){return e instanceof E})[0]},getInputElement:function(){var e=void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[e]},getInputElements:function(){return this.elements.filter(function(e){return e instanceof M})},getMenuItemDescriptor:function(){var e=this;return{key:"filter_by_condition",name:"",isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,n,r,o,i,s){f(n.parentNode,"htFiltersMenuCondition");var a=document.createElement("div");return f(a,"htFiltersMenuLabel"),a.textContent="Filter by condition:",n.appendChild(a),g(e.elements,function(e){return n.appendChild(e.element)}),n}}},reset:function(){var e=this.hot.getPlugin("filters").getSelectedColumn(),t=this.hot.getDataType.apply(this.hot,this.hot.getSelected()||[0,e]),n=_(t);g(this.getInputElements(),function(e){return e.hide()}),this.getSelectElement().setItems(n),$traceurRuntime.superGet(this,T.prototype,"reset").call(this),this.getSelectElement().setValue(n[0])},onConditionSelect:function(e){g(this.getInputElements(),function(t,n){t[e.inputsCount>n?"show":"hide"](),n||setTimeout(function(){return t.focus()},10)})},onInputKeyDown:function(e){w(e.keyCode,"ENTER")?(this.runLocalHooks("accept"),p(e)):w(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),p(e))}},{},b)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event":48,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/unicode":56,_base:152,constants:156,formulaRegisterer:181,"ui/input":184,"ui/select":186}],155:[function(e,t,n){"use strict";Object.defineProperties(n,{ValueComponent:{get:function(){return N}},__esModule:{value:!0}});var r,o,i,s,a,l,u,d,c,h,f=(r=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),r&&r.__esModule&&r||{default:r}).addClass,p=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event"),o&&o.__esModule&&o||{default:o}).stopImmediatePropagation,m=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),i&&i.__esModule&&i||{default:i}),g=m.arrayEach,v=(m.arrayUnique,m.arrayFilter),w=m.arrayMap,b=((s=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string"),s&&s.__esModule&&s||{default:s}).stringify,a=e("utils"),a&&a.__esModule&&a||{default:a}),y=b.unifyColumnValues,_=b.intersectValues,C=b.toEmptyString,R=(l=e("_base"),l&&l.__esModule&&l||{default:l}).BaseComponent,M=(u=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/unicode"),u&&u.__esModule&&u||{default:u}).isKey,E=(d=e("ui/multipleSelect"),d&&d.__esModule&&d||{default:d}).MultipleSelectUI,S=(c=e("constants"),c&&c.__esModule&&c||{default:c}),O=S.FORMULA_BY_VALUE,T=S.FORMULA_NONE,A=(h=e("formulaRegisterer"),h&&h.__esModule&&h||{default:h}).getFormulaDescriptor,N=function(e){$traceurRuntime.superConstructor(x).call(this,e),this.elements.push(new E(this.hot)),this.registerHooks()},x=N;$traceurRuntime.createClass(N,{registerHooks:function(){var e=this;this.getMultipleSelectElement().addLocalHook("keydown",function(t){return e.onInputKeyDown(t)})},setState:function(e){if(this.reset(),e&&e.command.key===O){var t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0])}},getState:function(){var e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?T:O},args:[e.getValue()],itemsSnapshot:t}},updateState:function(e,t,n){var r=this,o=e,i=o.column,s=o.formulas,a=function(e,t,o){var i=v(t,function(e){return e.name===O})[0],s={};if(i){var a=w(n(e,o),function(e){return e.value});a=y(a);var l=[],u=_(a,i.args[0],function(e){e.checked&&l.push(e.value)});s.args=[l],s.command=A(O),s.itemsSnapshot=u}else s.args=[],s.command=A(T);r.setCachedState(e,s)};if(a(i,s),t.length){var l=t[0],u=l.column,d=l.formulas;a(u,d,e)}},getMultipleSelectElement:function(){return this.elements.filter(function(e){return e instanceof E})[0]},getMenuItemDescriptor:function(){var e=this;return{key:"filter_by_value",name:"Filter by value",isCommand:!1,disableSelection:!0,hidden:function(){return e.isHidden()},renderer:function(t,n,r,o,i,s){f(n.parentNode,"htFiltersMenuValue");var a=document.createElement("div");return f(a,"htFiltersMenuLabel"),a.textContent="Filter by value:",n.appendChild(a),g(e.elements,function(e){return n.appendChild(e.element)}),n}}},reset:function(){var e=y(this._getColumnVisibleValues()),t=_(e,e);this.getMultipleSelectElement().setItems(t),$traceurRuntime.superGet(this,x.prototype,"reset").call(this),this.getMultipleSelectElement().setValue(e)},onInputKeyDown:function(e){M(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),p(e))},_getColumnVisibleValues:function(){var e=this.hot.getPlugin("filters").getSelectedColumn();return w(this.hot.getDataAtCol(e),function(e){return C(e)})}},{},R)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event":48,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string":55,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/unicode":56,_base:152,constants:156,formulaRegisterer:181,"ui/multipleSelect":185,utils:187}],156:[function(e,t,n){"use strict";function r(e){var t=[];return oe[e]||(e=ne),x(oe[e],function(e){var n;n=e===k?{name:k}:N(I(e)),t.push(n)}),t}var o;Object.defineProperties(n,{FORMULA_NONE:{get:function(){return D}},FORMULA_EMPTY:{get:function(){return P}},FORMULA_NOT_EMPTY:{get:function(){return H}},FORMULA_EQUAL:{get:function(){return L}},FORMULA_NOT_EQUAL:{get:function(){return V}},FORMULA_GREATER_THAN:{get:function(){return j}},FORMULA_GREATER_THAN_OR_EQUAL:{get:function(){return F}},FORMULA_LESS_THAN:{get:function(){return $}},FORMULA_LESS_THAN_OR_EQUAL:{get:function(){return B}},FORMULA_BETWEEN:{get:function(){return W}},FORMULA_NOT_BETWEEN:{get:function(){return U}},FORMULA_BEGINS_WITH:{get:function(){return Y}},FORMULA_ENDS_WITH:{get:function(){return G}},FORMULA_CONTAINS:{get:function(){return z}},FORMULA_NOT_CONTAINS:{get:function(){return X}},FORMULA_DATE_BEFORE:{get:function(){return q}},FORMULA_DATE_AFTER:{get:function(){return K}},FORMULA_TOMORROW:{get:function(){return Q}},FORMULA_TODAY:{get:function(){return Z}},FORMULA_YESTERDAY:{get:function(){return J}},FORMULA_BY_VALUE:{get:function(){return ee}},TYPE_NUMERIC:{get:function(){return te}},TYPE_TEXT:{get:function(){return ne}},TYPE_DATE:{get:function(){return re}},TYPES:{get:function(){return oe}},getOptionsList:{get:function(){return r}},__esModule:{value:!0}});var i,s,a,l,u,d,c,h,f,p,m,g,v,w,b,y,_,C,R,M,E,S,O,T,A,N=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),i&&i.__esModule&&i||{default:i}).clone,x=(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),s&&s.__esModule&&s||{default:s}).arrayEach,k=(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems"),a&&a.__esModule&&a||{default:a}).SEPARATOR,I=(l=e("formulaRegisterer"),l&&l.__esModule&&l||{default:l}).getFormulaDescriptor,D=(u=e("formula/none"),u&&u.__esModule&&u||{default:u}).FORMULA_NAME,P=(d=e("formula/empty"),d&&d.__esModule&&d||{default:d}).FORMULA_NAME,H=(c=e("formula/notEmpty"),c&&c.__esModule&&c||{default:c}).FORMULA_NAME,L=(h=e("formula/equal"),h&&h.__esModule&&h||{default:h}).FORMULA_NAME,V=(f=e("formula/notEqual"),f&&f.__esModule&&f||{default:f}).FORMULA_NAME,j=(p=e("formula/greaterThan"),p&&p.__esModule&&p||{default:p}).FORMULA_NAME,F=(m=e("formula/greaterThanOrEqual"),m&&m.__esModule&&m||{default:m}).FORMULA_NAME,$=(g=e("formula/lessThan"),g&&g.__esModule&&g||{default:g}).FORMULA_NAME,B=(v=e("formula/lessThanOrEqual"),v&&v.__esModule&&v||{default:v}).FORMULA_NAME,W=(w=e("formula/between"),w&&w.__esModule&&w||{default:w}).FORMULA_NAME,U=(b=e("formula/notBetween"),b&&b.__esModule&&b||{default:b}).FORMULA_NAME,Y=(y=e("formula/beginsWith"),y&&y.__esModule&&y||{default:y}).FORMULA_NAME,G=(_=e("formula/endsWith"),_&&_.__esModule&&_||{default:_}).FORMULA_NAME,z=(C=e("formula/contains"),C&&C.__esModule&&C||{default:C}).FORMULA_NAME,X=(R=e("formula/notContains"),R&&R.__esModule&&R||{default:R}).FORMULA_NAME,q=(M=e("formula/date/before"),M&&M.__esModule&&M||{default:M}).FORMULA_NAME,K=(E=e("formula/date/after"),E&&E.__esModule&&E||{default:E}).FORMULA_NAME,Q=(S=e("formula/date/tomorrow"),S&&S.__esModule&&S||{default:S}).FORMULA_NAME,Z=(O=e("formula/date/today"),O&&O.__esModule&&O||{default:O}).FORMULA_NAME,J=(T=e("formula/date/yesterday"),T&&T.__esModule&&T||{default:T}).FORMULA_NAME,ee=(A=e("formula/byValue"),A&&A.__esModule&&A||{default:A}).FORMULA_NAME,te="numeric",ne="text",re="date",oe=(o={},Object.defineProperty(o,te,{value:[D,k,P,H,k,L,V,k,j,F,$,B,W,U],configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(o,ne,{value:[D,k,P,H,k,L,V,k,Y,G,k,z,X],configurable:!0,enumerable:!0,writable:!0}),Object.defineProperty(o,re,{value:[D,k,P,H,k,L,V,k,q,K,W,k,Q,Z,J],configurable:!0,enumerable:!0,writable:!0}),o)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems":75,"formula/beginsWith":159,"formula/between":160,"formula/byValue":161,"formula/contains":162,"formula/date/after":163,"formula/date/before":164,"formula/date/today":165,"formula/date/tomorrow":166,"formula/date/yesterday":167,"formula/empty":168,"formula/endsWith":169,"formula/equal":170,"formula/greaterThan":171,"formula/greaterThanOrEqual":172,"formula/lessThan":173,"formula/lessThanOrEqual":174,"formula/none":175,"formula/notBetween":176,"formula/notContains":177,"formula/notEmpty":178,"formula/notEqual":179,formulaRegisterer:181}],157:[function(e,t,n){"use strict";Object.defineProperties(n,{DataFilter:{get:function(){return a}},__esModule:{value:!0}});var r,o,i=(r=e("../../browser"),r&&r.__esModule&&r||{default:r}).default,s=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),o&&o.__esModule&&o||{default:o}).arrayEach,a=function(e){var t=void 0!==arguments[1]?arguments[1]:function(e){return[]};this.formulaCollection=e,this.columnDataFactory=t};$traceurRuntime.createClass(a,{filter:function(){var e=this,t=[];return this.formulaCollection.isEmpty()||s(this.formulaCollection.orderStack,function(n,r){var o=e.columnDataFactory(n);r&&(o=e._getIntersectData(o,t)),t=e.filterByColumn(n,o)}),t},filterByColumn:function(e){var t=void 0!==arguments[1]?arguments[1]:[],n=this,r=[];return s(t,function(t){void 0!==t&&n.formulaCollection.isMatch(t,e)&&r.push(t)}),r},_getIntersectData:function(e,t){var n=[];return s(t,function(t){var r=t.meta.visualRow;void 0!==e[r]&&(n[r]=e[r])}),n}},{}),i.utils.FiltersDataFilter=a},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../browser":138}],158:[function(e,t,n){"use strict";Object.defineProperties(n,{Filters:{get:function(){return F}},__esModule:{value:!0}});var r,o,i,s,a,l,u,d,c,h,f,p,m,g,v,w=(r=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),r&&r.__esModule&&r||{default:r}).default,b=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),o&&o.__esModule&&o||{default:o}),y=b.arrayEach,_=b.arrayMap,C=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),i&&i.__esModule&&i||{default:i}).rangeEach,R=(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager"),s&&s.__esModule&&s||{default:s}).EventManager,M=(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),a&&a.__esModule&&a||{default:a}),E=M.addClass,S=M.removeClass,O=M.closest,T=(l=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),l&&l.__esModule&&l||{default:l}).registerPlugin,A=(u=e("component/condition"),u&&u.__esModule&&u||{default:u}).ConditionComponent,N=(d=e("component/value"),d&&d.__esModule&&d||{default:d}).ValueComponent,x=(c=e("component/actionBar"),c&&c.__esModule&&c||{default:c}).ActionBarComponent,k=(h=e("formulaCollection"),h&&h.__esModule&&h||{default:h}).FormulaCollection,I=(f=e("dataFilter"),f&&f.__esModule&&f||{default:f}).DataFilter,D=(p=e("formulaUpdateObserver"),p&&p.__esModule&&p||{default:p}).FormulaUpdateObserver,P=(m=e("utils"),m&&m.__esModule&&m||{default:m}),H=P.createArrayAssertion,L=P.toEmptyString,V=(g=e("constants"),g&&g.__esModule&&g||{default:g}).FORMULA_NONE,j=(v=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems"),v&&v.__esModule&&v||{default:v}).SEPARATOR,F=function(e){var t=this;$traceurRuntime.superConstructor($).call(this,e),this.eventManager=new R(this),this.trimRowsPlugin=null,this.dropdownMenuPlugin=null,this.formulaCollection=null,this.formulaUpdateObserver=null,this.conditionComponent=null,this.valueComponent=null,this.actionBarComponent=null,this.lastSelectedColumn=null,this.hot.addHook("afterGetColHeader",function(e,n){return t.onAfterGetColHeader(e,n)})},$=F;$traceurRuntime.createClass(F,{isEnabled:function(){return!!this.hot.getSettings().filters},enablePlugin:function(){var e=this;if(!this.enabled){this.trimRowsPlugin=this.hot.getPlugin("trimRows"),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");var t=function(t){return t.addLocalHook("accept",function(){return e.onActionBarSubmit("accept")}),t.addLocalHook("cancel",function(){return e.onActionBarSubmit("cancel")}),t};this.conditionComponent||(this.conditionComponent=t(new A(this.hot))),this.valueComponent||(this.valueComponent=t(new N(this.hot))),this.actionBarComponent||(this.actionBarComponent=t(new x(this.hot))),this.formulaCollection||(this.formulaCollection=new k),this.formulaUpdateObserver||(this.formulaUpdateObserver=new D(this.formulaCollection,function(t){return e.getDataMapAtColumn(t)}),this.formulaUpdateObserver.addLocalHook("update",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e.conditionComponent).updateState.apply(t,$traceurRuntime.spread(n))}),this.formulaUpdateObserver.addLocalHook("update",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e.valueComponent).updateState.apply(t,$traceurRuntime.spread(n))})),this.conditionComponent.show(),this.valueComponent.show(),this.actionBarComponent.show(),this.registerEvents(),this.addHook("beforeDropdownMenuSetItems",function(t){return e.onBeforeDropdownMenuSetItems(t)}),this.addHook("afterDropdownMenuDefaultOptions",function(t){return e.onAfterDropdownMenuDefaultOptions(t)}),this.addHook("afterDropdownMenuShow",function(){return e.onAfterDropdownMenuShow()}),this.addHook("afterDropdownMenuHide",function(){return e.onAfterDropdownMenuHide()}),this.hot.getSettings().trimRows=!0,this.trimRowsPlugin.enablePlugin(),this.hot.getSettings().dropdownMenu&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),$traceurRuntime.superGet(this,$.prototype,"enablePlugin").call(this)}},registerEvents:function(){var e=this;this.eventManager.addEventListener(this.hot.rootElement,"click",function(t){return e.onTableClick(t)})},disablePlugin:function(){this.enabled&&(this.conditionComponent.hide(),this.valueComponent.hide(),this.actionBarComponent.hide(),this.formulaCollection.clean(),this.trimRowsPlugin.untrimAll()),$traceurRuntime.superGet(this,$.prototype,"disablePlugin").call(this)},addFormula:function(e,t,n){this.formulaCollection.addFormula(e,{command:{key:t},args:n})},removeFormulas:function(e){this.formulaCollection.removeFormulas(e)},clearFormulas:function(e){void 0===e?this.formulaCollection.clean():this.formulaCollection.clearFormulas(e)},filter:function(){var e=this._createDataFilter(),t=!this.formulaCollection.isEmpty(),n=[],r=this.formulaCollection.exportAllFormulas(),o=this.hot.runHooks("beforeFilter",r);if(o!==!1)if(t){var i=[];this.trimRowsPlugin.trimmedRows.length=0,n=_(e.filter(),function(e){return e.meta.visualRow});var s=H(n);C(this.hot.countSourceRows()-1,function(e){s(e)||i.push(e)}),this.trimRowsPlugin.trimRows(i),n.length||this.hot.deselectCell()}else this.trimRowsPlugin.untrimAll();this.hot.view.wt.wtOverlays.adjustElementsSize(!0),this.hot.render(),this.clearColumnSelection(),this.hot.runHooks("afterFilter",r)},getSelectedColumn:function(){return this.lastSelectedColumn},clearColumnSelection:function(){var e=this.hot.getSelected()||[],t=e[0],n=e[1];void 0!==t&&void 0!==n&&this.hot.selectCell(t,n)},getDataMapAtColumn:function(e){var t=this,n=[];return y(this.hot.getSourceDataAtCol(e),function(r,o){var i=t.hot.getCellMeta(o,e),s=i.row,a=i.col,l=i.visualCol,u=i.visualRow,d=i.type,c=i.instance,h=i.dateFormat;n.push({meta:{row:s,col:a,visualCol:l,visualRow:u,type:d,instance:c,dateFormat:h},value:L(r)})}),n},onAfterDropdownMenuShow:function(){var e=this.getSelectedColumn(),t=this.conditionComponent,n=this.valueComponent;t.isHidden()||t.restoreState(e),n.isHidden()||n.restoreState(e)},onAfterDropdownMenuHide:function(){this.conditionComponent.getSelectElement().closeOptions()},onBeforeDropdownMenuSetItems:function(e){var t=_(e,function(e){return e.key}),n=this.conditionComponent,r=this.valueComponent;n[t.indexOf(n.getMenuItemDescriptor().key)===-1?"hide":"show"](),r[t.indexOf(r.getMenuItemDescriptor().key)===-1?"hide":"show"]()},onAfterDropdownMenuDefaultOptions:function(e){e.items.push({name:j}),e.items.push(this.conditionComponent.getMenuItemDescriptor()),e.items.push(this.valueComponent.getMenuItemDescriptor()),e.items.push(this.actionBarComponent.getMenuItemDescriptor())},onActionBarSubmit:function(e){if("accept"===e){var t=this.getSelectedColumn(),n=this.conditionComponent.getState(),r=this.valueComponent.getState();this.formulaUpdateObserver.groupChanges(),this.formulaCollection.clearFormulas(t),n.command.key===V&&r.command.key===V&&this.formulaCollection.removeFormulas(t),n.command.key!==V&&this.formulaCollection.addFormula(t,n),r.command.key!==V&&this.formulaCollection.addFormula(t,r),this.formulaUpdateObserver.flush(),this.conditionComponent.saveState(t),this.valueComponent.saveState(t),this.filter()}this.dropdownMenuPlugin.close()},onAfterGetColHeader:function(e,t){this.enabled&&this.formulaCollection.hasFormulas(e)?E(t,"htFiltersActive"):S(t,"htFiltersActive")},onTableClick:function(e){var t=O(e.target,"TH");t&&(this.lastSelectedColumn=this.hot.getCoords(t).col)},destroy:function(){this.enabled&&(this.conditionComponent.destroy(),this.valueComponent.destroy(),this.actionBarComponent.destroy(),this.formulaCollection.destroy(),this.formulaUpdateObserver.destroy()),$traceurRuntime.superGet(this,$.prototype,"destroy").call(this)},_createDataFilter:function(){var e=void 0!==arguments[0]?arguments[0]:this.formulaCollection,t=this;return new I(e,function(e){return t.getDataMapAtColumn(e)})}},{},w),T("filters",F)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager":42,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems":75,"component/actionBar":153,"component/condition":154,"component/value":155,constants:156,dataFilter:157,formulaCollection:180,formulaUpdateObserver:182,utils:187}],159:[function(e,t,n){"use strict";function r(e){var t=(void 0!==arguments[1]?arguments[1]:inputValues)[0];return l(u(e.value).toLowerCase(),u(t))}Object.defineProperties(n,{FORMULA_NAME:{get:function(){return d}},__esModule:{value:!0}});var o,i,s,a=(o=e("formulaRegisterer"),o&&o.__esModule&&o||{default:o}).registerFormula,l=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string"),i&&i.__esModule&&i||{default:i}).startsWith,u=(s=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed"),s&&s.__esModule&&s||{default:s}).stringify,d="begins_with";a(d,r,{name:"Begins with",inputsCount:1})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed":51,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string":55,formulaRegisterer:181}],160:[function(e,t,n){"use strict";function r(e){var t=void 0!==arguments[1]?arguments[1]:inputValues,n=t[0],r=t[1];if("numeric"===e.meta.type){var o=parseFloat(n,10),i=parseFloat(r,10);n=Math.min(o,i),r=Math.max(o,i)}else if("date"===e.meta.type){var s=u(c,[r]),a=u(d,[n]);return s(e)&&a(e)}return e.value>=n&&e.value<=r}Object.defineProperties(n,{FORMULA_NAME:{get:function(){return h}},__esModule:{value:!0}});var o,i,s,a=(o=e("formulaRegisterer"),o&&o.__esModule&&o||{default:o}),l=a.registerFormula,u=a.getFormula,d=(i=e("date/after"),i&&i.__esModule&&i||{default:i}).FORMULA_NAME,c=(s=e("date/before"),s&&s.__esModule&&s||{default:s}).FORMULA_NAME,h="between";l(h,r,{name:"Is between",inputsCount:2})},{"date/after":163,"date/before":164,formulaRegisterer:181}],161:[function(e,t,n){"use strict";function r(e){var t=(void 0!==arguments[1]?arguments[1]:inputValues)[0];return t(e.value)}Object.defineProperties(n,{FORMULA_NAME:{get:function(){return l}},__esModule:{value:!0}});var o,i,s=(o=e("formulaRegisterer"),o&&o.__esModule&&o||{default:o}).registerFormula,a=(i=e("utils"),i&&i.__esModule&&i||{default:i}).createArrayAssertion,l="by_value";s(l,r,{name:"By value",inputsCount:0,inputValuesDecorator:function(){var e=(void 0!==arguments[0]?arguments[0]:inputValues)[0];return[a(e)]}})},{formulaRegisterer:181,utils:187}],162:[function(e,t,n){"use strict";function r(e){var t=(void 0!==arguments[1]?arguments[1]:inputValues)[0];return a(e.value).toLowerCase().indexOf(a(t))>=0}Object.defineProperties(n,{FORMULA_NAME:{get:function(){return l}},__esModule:{value:!0}});var o,i,s=(o=e("formulaRegisterer"),o&&o.__esModule&&o||{default:o}).registerFormula,a=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed"),i&&i.__esModule&&i||{default:i}).stringify,l="contains";s(l,r,{name:"Contains",inputsCount:1})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed":51,formulaRegisterer:181}],163:[function(e,t,n){"use strict";function r(e){var t=(void 0!==arguments[1]?arguments[1]:inputValues)[0],n=a(e.value,e.meta.dateFormat),r=a(t,e.meta.dateFormat);return!(!n.isValid()||!r.isValid())&&n.diff(r)>=0}Object.defineProperties(n,{FORMULA_NAME:{get:function(){return l}},__esModule:{value:!0}});var o,i,s=(o=e("formulaRegisterer"),o&&o.__esModule&&o||{default:o}).registerFormula,a=(i=e("moment"),i&&i.__esModule&&i||{default:i}).default,l="date_after";s(l,r,{name:"After",inputsCount:1})},{formulaRegisterer:181,moment:"moment"}],164:[function(e,t,n){"use strict";function r(e){var t=(void 0!==arguments[1]?arguments[1]:inputValues)[0],n=a(e.value,e.meta.dateFormat),r=a(t,e.meta.dateFormat);return!(!n.isValid()||!r.isValid())&&n.diff(r)<=0}Object.defineProperties(n,{FORMULA_NAME:{get:function(){return l}},__esModule:{value:!0}});var o,i,s=(o=e("formulaRegisterer"),o&&o.__esModule&&o||{default:o}).registerFormula,a=(i=e("moment"),i&&i.__esModule&&i||{default:i}).default,l="date_before";s(l,r,{name:"Before",inputsCount:1})},{formulaRegisterer:181,moment:"moment"}],165:[function(e,t,n){"use strict";function r(e){var t=a(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(a().startOf("day"),"d")}Object.defineProperties(n,{FORMULA_NAME:{get:function(){return l}},__esModule:{value:!0}});var o,i,s=(o=e("formulaRegisterer"),o&&o.__esModule&&o||{default:o}).registerFormula,a=(i=e("moment"),i&&i.__esModule&&i||{default:i}).default,l="date_today";s(l,r,{name:"Today",inputsCount:0})},{formulaRegisterer:181,moment:"moment"}],166:[function(e,t,n){"use strict";function r(e){var t=a(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(a().subtract(-1,"days").startOf("day"),"d")}Object.defineProperties(n,{FORMULA_NAME:{get:function(){return l}},__esModule:{value:!0}});var o,i,s=(o=e("formulaRegisterer"),o&&o.__esModule&&o||{default:o}).registerFormula,a=(i=e("moment"),i&&i.__esModule&&i||{default:i}).default,l="date_tomorrow";s(l,r,{name:"Tomorrow",inputsCount:0})},{formulaRegisterer:181,moment:"moment"}],167:[function(e,t,n){"use strict";function r(e){var t=a(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(a().subtract(1,"days").startOf("day"),"d")}Object.defineProperties(n,{FORMULA_NAME:{get:function(){return l}},__esModule:{value:!0}});var o,i,s=(o=e("formulaRegisterer"),o&&o.__esModule&&o||{default:o}).registerFormula,a=(i=e("moment"),i&&i.__esModule&&i||{default:i}).default,l="date_yesterday";s(l,r,{name:"Yesterday",inputsCount:0})},{formulaRegisterer:181,moment:"moment"}],168:[function(e,t,n){"use strict";function r(e){return""===e.value||null===e.value||void 0===e.value}Object.defineProperties(n,{FORMULA_NAME:{get:function(){return s}},__esModule:{value:!0}});var o,i=(o=e("formulaRegisterer"),o&&o.__esModule&&o||{default:o}).registerFormula,s="empty";i(s,r,{name:"Is empty",inputsCount:0})},{formulaRegisterer:181}],169:[function(e,t,n){"use strict";function r(e){var t=(void 0!==arguments[1]?arguments[1]:inputValues)[0];return l(u(e.value).toLowerCase(),u(t))}Object.defineProperties(n,{FORMULA_NAME:{get:function(){return d}},__esModule:{value:!0}});var o,i,s,a=(o=e("formulaRegisterer"),o&&o.__esModule&&o||{default:o}).registerFormula,l=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string"),i&&i.__esModule&&i||{default:i}).endsWith,u=(s=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed"),s&&s.__esModule&&s||{default:s}).stringify,d="ends_with";a(d,r,{name:"Ends with",inputsCount:1})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed":51,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string":55,formulaRegisterer:181}],170:[function(e,t,n){"use strict";function r(e){var t=(void 0!==arguments[1]?arguments[1]:inputValues)[0];return s(e.value).toLowerCase()===s(t)}Object.defineProperties(n,{FORMULA_NAME:{get:function(){return l}},__esModule:{value:!0}});var o,i,s=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed"),o&&o.__esModule&&o||{default:o}).stringify,a=(i=e("formulaRegisterer"),i&&i.__esModule&&i||{default:i}).registerFormula,l="eq";a(l,r,{name:"Is equal to",inputsCount:1})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/mixed":51,formulaRegisterer:181}],171:[function(e,t,n){"use strict";function r(e){var t=(void 0!==arguments[1]?arguments[1]:inputValues)[0];return"numeric"===e.meta.type&&(t=parseFloat(t,10)),e.value>t}Object.defineProperties(n,{FORMULA_NAME:{get:function(){return s}},__esModule:{value:!0}});var o,i=(o=e("formulaRegisterer"),o&&o.__esModule&&o||{default:o}).registerFormula,s="gt";i(s,r,{name:"Greater than",inputsCount:1})},{formulaRegisterer:181}],172:[function(e,t,n){"use strict";function r(e){var t=(void 0!==arguments[1]?arguments[1]:inputValues)[0];return"numeric"===e.meta.type&&(t=parseFloat(t,10)),e.value>=t}Object.defineProperties(n,{FORMULA_NAME:{get:function(){return s}},__esModule:{value:!0}});var o,i=(o=e("formulaRegisterer"),o&&o.__esModule&&o||{default:o}).registerFormula,s="gte";i(s,r,{name:"Greater than or equal to",inputsCount:1})},{formulaRegisterer:181}],173:[function(e,t,n){"use strict";function r(e){var t=(void 0!==arguments[1]?arguments[1]:inputValues)[0];return"numeric"===e.meta.type&&(t=parseFloat(t,10)),e.value<t}Object.defineProperties(n,{FORMULA_NAME:{get:function(){return s}},__esModule:{value:!0}});var o,i=(o=e("formulaRegisterer"),o&&o.__esModule&&o||{default:o}).registerFormula,s="lt";i(s,r,{name:"Less than",inputsCount:1})},{formulaRegisterer:181}],174:[function(e,t,n){"use strict";function r(e){var t=(void 0!==arguments[1]?arguments[1]:inputValues)[0];return"numeric"===e.meta.type&&(t=parseFloat(t,10)),e.value<=t}Object.defineProperties(n,{FORMULA_NAME:{get:function(){return s}},__esModule:{value:!0}});var o,i=(o=e("formulaRegisterer"),o&&o.__esModule&&o||{default:o}).registerFormula,s="lte";i(s,r,{name:"Less than or equal to",inputsCount:1})},{formulaRegisterer:181}],175:[function(e,t,n){"use strict";function r(){return!0}Object.defineProperties(n,{FORMULA_NAME:{get:function(){return s}},__esModule:{value:!0}});var o,i=(o=e("formulaRegisterer"),o&&o.__esModule&&o||{default:o}).registerFormula,s="none";i(s,r,{name:"None",inputsCount:0})},{formulaRegisterer:181}],176:[function(e,t,n){"use strict";function r(e,t){return!l(u,t)(e)}Object.defineProperties(n,{FORMULA_NAME:{get:function(){return d}},__esModule:{value:!0}});var o,i,s=(o=e("formulaRegisterer"),o&&o.__esModule&&o||{default:o}),a=s.registerFormula,l=s.getFormula,u=(i=e("between"),i&&i.__esModule&&i||{default:i}).FORMULA_NAME,d="not_between";a(d,r,{name:"Is not between",inputsCount:2})},{between:160,formulaRegisterer:181}],177:[function(e,t,n){"use strict";function r(e,t){return!l(u,t)(e)}Object.defineProperties(n,{FORMULA_NAME:{get:function(){return d}},__esModule:{value:!0}});var o,i,s=(o=e("formulaRegisterer"),o&&o.__esModule&&o||{default:o}),a=s.registerFormula,l=s.getFormula,u=(i=e("contains"),i&&i.__esModule&&i||{default:i}).FORMULA_NAME,d="not_contains";a(d,r,{name:"Does not contain",inputsCount:1})},{contains:162,formulaRegisterer:181}],178:[function(e,t,n){"use strict";function r(e,t){return!l(u,t)(e)}Object.defineProperties(n,{FORMULA_NAME:{get:function(){return d}},__esModule:{value:!0}});var o,i,s=(o=e("formulaRegisterer"),o&&o.__esModule&&o||{default:o}),a=s.registerFormula,l=s.getFormula,u=(i=e("empty"),i&&i.__esModule&&i||{default:i}).FORMULA_NAME,d="not_empty";a(d,r,{name:"Is not empty",inputsCount:0})},{empty:168,formulaRegisterer:181}],179:[function(e,t,n){"use strict";function r(e,t){return!l(u,t)(e)}Object.defineProperties(n,{FORMULA_NAME:{get:function(){return d}},__esModule:{value:!0}});var o,i,s=(o=e("formulaRegisterer"),o&&o.__esModule&&o||{default:o}),a=s.registerFormula,l=s.getFormula,u=(i=e("equal"),i&&i.__esModule&&i||{default:i}).FORMULA_NAME,d="neq";a(d,r,{name:"Is not equal to",inputsCount:1})},{equal:170,formulaRegisterer:181}],180:[function(e,t,n){"use strict";Object.defineProperties(n,{FormulaCollection:{get:function(){return g}},__esModule:{value:!0}});var r,o,i,s,a=(r=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),r&&r.__esModule&&r||{default:r}),l=a.arrayEach,u=a.arrayMap,d=a.arrayFilter,c=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),o&&o.__esModule&&o||{default:o}),h=c.objectEach,f=c.mixin,p=(i=e("formulaRegisterer"),i&&i.__esModule&&i||{default:i}).getFormula,m=(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks"),
s&&s.__esModule&&s||{default:s}).localHooks,g=function(){this.formulas=Object.create(null),this.orderStack=[]};$traceurRuntime.createClass(g,{isEmpty:function(){return!this.orderStack.length},isMatch:function(e,t){var n=this,r=!0;return void 0===t?h(this.formulas,function(t){return r=n.isMatchInFormulas(t,e)}):r=this.isMatchInFormulas(this.getFormulas(t),e),r},isMatchInFormulas:function(e,t){var n=!1;return e.length?l(e,function(e){return n=e.func(t)}):n=!0,n},addFormula:function(e,t){var n=u(t.args,function(e){return"string"==typeof e?e.toLowerCase():e}),r=t.name||t.command.key;this.runLocalHooks("beforeAdd",e),this.orderStack.indexOf(e)===-1&&this.orderStack.push(e),this.hasFormulas(e,r)?l(this.getFormulas(e),function(e){if(e.name===r)return e.func=p(e.name,n),e.args=n,!1}):this.getFormulas(e).push({name:r,args:n,func:p(r,n)}),this.runLocalHooks("afterAdd",e)},getFormulas:function(e){return this.formulas[e]||(this.formulas[e]=[]),this.formulas[e]},exportAllFormulas:function(){var e=this,t=[];return l(this.orderStack,function(n){var r=u(e.getFormulas(n),function(){var e=void 0!==arguments[0]?arguments[0]:formula,t=e.name,n=e.args;return{name:t,args:n}});t.push({column:n,formulas:r})}),t},importAllFormulas:function(e){var t=this;this.clean(),l(e,function(e){t.orderStack.push(e.column),l(e.formulas,function(n){return t.addFormula(e.column,n)})})},removeFormulas:function(e){this.runLocalHooks("beforeRemove",e),this.orderStack.indexOf(e)>=0&&this.orderStack.splice(this.orderStack.indexOf(e),1),this.clearFormulas(e),this.runLocalHooks("afterRemove",e)},clearFormulas:function(e){this.runLocalHooks("beforeClear",e),this.getFormulas(e).length=0,this.runLocalHooks("afterClear",e)},hasFormulas:function(e,t){var n=!1,r=this.getFormulas(e);return n=t?d(r,function(e){return e.name===t}).length>0:r.length>0},clean:function(){this.runLocalHooks("beforeClean"),this.formulas=Object.create(null),this.orderStack.length=0,this.runLocalHooks("afterClean")},destroy:function(){this.clearLocalHooks(),this.formulas=null,this.orderStack=null}},{}),f(g,m)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks":58,formulaRegisterer:181}],181:[function(e,t,n){"use strict";function r(e,t){if(!l[e])throw Error('Filter formula "'+e+'" does not exist.');var n=l[e],r=n.formula,o=n.descriptor;return o.inputValuesDecorator&&(t=o.inputValuesDecorator(t)),function(e){return r.apply(e.meta.instance,[].concat([e],[t]))}}function o(e){if(!l[e])throw Error('Filter formula "'+e+'" does not exist.');return l[e].descriptor}function i(e,t,n){n.key=e,l[e]={formula:t,descriptor:n}}Object.defineProperties(n,{getFormula:{get:function(){return r}},getFormulaDescriptor:{get:function(){return o}},registerFormula:{get:function(){return i}},__esModule:{value:!0}});var s,a=(s=e("../../browser"),s&&s.__esModule&&s||{default:s}).default,l={};a.utils.FiltersFormulaRegisterer={getFormula:r,registerFormula:i,getFormulaDescriptor:o,formulas:l}},{"../../browser":138}],182:[function(e,t,n){"use strict";Object.defineProperties(n,{FormulaUpdateObserver:{get:function(){return R}},__esModule:{value:!0}});var r,o,i,s,a,l,u,d=(r=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),r&&r.__esModule&&r||{default:r}),c=d.arrayEach,h=d.arrayMap,f=d.arrayFilter,p=(o=e("formulaCollection"),o&&o.__esModule&&o||{default:o}).FormulaCollection,m=(i=e("dataFilter"),i&&i.__esModule&&i||{default:i}).DataFilter,g=(s=e("utils"),s&&s.__esModule&&s||{default:s}).createArrayAssertion,v=(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),a&&a.__esModule&&a||{default:a}),w=v.mixin,b=v.objectEach,y=(l=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/function"),l&&l.__esModule&&l||{default:l}),_=y.curry,C=(y.debounce,(u=e("../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks"),u&&u.__esModule&&u||{default:u}).localHooks),R=function(e){var t=void 0!==arguments[1]?arguments[1]:function(e){return[]},n=this;this.formulaCollection=e,this.columnDataFactory=t,this.changes=[],this.grouping=!1,this.latestEditedColumnPosition=-1,this.latestOrderStack=[],this.formulaCollection.addLocalHook("beforeRemove",function(e){return n._onFormulaBeforeModify(e)}),this.formulaCollection.addLocalHook("afterAdd",function(e){return n._onFormulaAfterModify(e)}),this.formulaCollection.addLocalHook("afterClear",function(e){return n._onFormulaAfterModify(e)}),this.formulaCollection.addLocalHook("beforeClean",function(){return n._onFormulaBeforeClean()}),this.formulaCollection.addLocalHook("afterClean",function(){return n._onFormulaAfterClean()})};$traceurRuntime.createClass(R,{groupChanges:function(){this.grouping=!0},flush:function(){var e=this;this.grouping=!1,c(this.changes,function(t){return e._onFormulaAfterModify(t)}),this.changes.length=0},_onFormulaBeforeModify:function(e){this.latestEditedColumnPosition=this.formulaCollection.orderStack.indexOf(e)},_onFormulaAfterModify:function(e){var t=this;if(this.grouping)return void(this.changes.indexOf(e)===-1&&this.changes.push(e));var n=this.formulaCollection.exportAllFormulas(),r=this.formulaCollection.orderStack.indexOf(e);r===-1&&(r=this.latestEditedColumnPosition);var o=n.slice(0,r),i=n.slice(r);i.length&&i[0].column===e&&i.shift();var s=_(function(e,n){var r=void 0!==arguments[2]?arguments[2]:[],o=new p;e=[].concat(e,r),o.importAllFormulas(e);var i,s=t.columnDataFactory(n);i=o.isEmpty()?s:new m(o,function(e){return t.columnDataFactory(e)}).filter(),i=h(i,function(e){return e.meta.visualRow});var a=g(i);return f(s,function(e){return a(e.meta.visualRow)})})(o),a=[].concat(this.formulaCollection.getFormulas(e));this.runLocalHooks("update",{column:e,formulas:a},i,s)},_onFormulaBeforeClean:function(){this.latestOrderStack=[].concat(this.formulaCollection.orderStack)},_onFormulaAfterClean:function(){var e=this;c(this.latestOrderStack,function(t){return e._onFormulaAfterModify(t)})},destroy:function(){var e=this;this.clearLocalHooks(),b(this,function(t,n){return e[n]=null})}},{}),w(R,C)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/function":50,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks":58,dataFilter:157,formulaCollection:180,utils:187}],183:[function(e,t,n){"use strict";Object.defineProperties(n,{BaseUI:{get:function(){return y}},__esModule:{value:!0}});var r,o,i,s,a,r,l=(r=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),r&&r.__esModule&&r||{default:r}),u=l.clone,d=l.extend,c=l.mixin,h=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks"),o&&o.__esModule&&o||{default:o}).localHooks,f=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager"),i&&i.__esModule&&i||{default:i}).EventManager,p=(s=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),s&&s.__esModule&&s||{default:s}).addClass,m=(a=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),a&&a.__esModule&&a||{default:a}).arrayEach,g=(r=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),r&&r.__esModule&&r||{default:r}).objectEach,v="built",w="building",b=["click","input","keydown","keypress","keyup","focus","blur"],y=function(e,t){this.hot=e,this.eventManager=new f(this),this.options=d(_.DEFAULTS,t),this._element=document.createElement(this.options.wrapIt?"div":this.options.tagName),this.buildState=!1},_=y;$traceurRuntime.createClass(y,{setValue:function(e){this.options.value=e,this.update()},getValue:function(){return this.options.value},get element(){return this.buildState===w?this._element:this.buildState===v?(this.update(),this._element):(this.buildState=w,this.build(),this.buildState=v,this._element)},isBuilt:function(){return this.buildState===v},build:function(){var e=this,t=function(t,n){e.eventManager.addEventListener(t,n,function(t){return e.runLocalHooks(n,t,e)})};if(this.buildState||(this.buildState=w),this.options.className&&p(this._element,this.options.className),this.options.children.length)m(this.options.children,function(t){return e._element.appendChild(t.element)});else if(this.options.wrapIt){var n=document.createElement(this.options.tagName);g(this.options,function(e,t){void 0!==n[t]&&"className"!==t&&"tagName"!==t&&"children"!==t&&(n[t]=e)}),this._element.appendChild(n),m(b,function(e){return t(n,e)})}else m(b,function(n){return t(e._element,n)})},update:function(){},reset:function(){this.options.value="",this.update()},show:function(){this.element.style.display=""},hide:function(){this.element.style.display="none"},focus:function(){},destroy:function(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}},{get DEFAULTS(){return u({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}}),c(y,h)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager":42,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks":58}],184:[function(e,t,n){"use strict";Object.defineProperties(n,{InputUI:{get:function(){return f}},__esModule:{value:!0}});var r,o,i,s,a=(r=e("_base"),r&&r.__esModule&&r||{default:r}).BaseUI,l=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),o&&o.__esModule&&o||{default:o}).addClass,u=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),i&&i.__esModule&&i||{default:i}),d=u.clone,c=u.extend,h=((s=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),s&&s.__esModule&&s||{default:s}).arrayEach,new WeakMap),f=function(e,t){h.set(this,{}),$traceurRuntime.superConstructor(p).call(this,e,c(p.DEFAULTS,t)),this.registerHooks()},p=f;$traceurRuntime.createClass(f,{registerHooks:function(){var e=this;this.addLocalHook("click",function(t){return e.onClick(t)}),this.addLocalHook("keyup",function(t){return e.onKeyup(t)})},build:function(){$traceurRuntime.superGet(this,p.prototype,"build").call(this);var e=h.get(this),t=document.createElement("div");e.input=this._element.firstChild,l(this._element,"htUIInput"),l(t,"htUIInputIcon"),this._element.appendChild(t),this.update()},update:function(){if(this.isBuilt()){var e=h.get(this).input;e.type=this.options.type,e.value=this.options.value}},focus:function(){this.isBuilt()&&h.get(this).input.focus()},onClick:function(e){},onKeyup:function(e){this.options.value=e.target.value}},{get DEFAULTS(){return d({placeholder:"",type:"text",tagName:"input"})}},a)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,_base:183}],185:[function(e,t,n){"use strict";function r(e,t){var n=x(t);return E(e,function(e){return e.checked=n(e.value),e})}function o(e){var t=[];return S(e,function(e){e.checked&&t.push(e.value)}),t}Object.defineProperties(n,{MultipleSelectUI:{get:function(){return I}},__esModule:{value:!0}});var i,s,a,l,u,d,c,h,f,p,m,g,v=(i=e("../../../browser"),i&&i.__esModule&&i||{default:i}).default,w=(s=e("_base"),s&&s.__esModule&&s||{default:s}).BaseUI,b=(a=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),a&&a.__esModule&&a||{default:a}).addClass,y=((l=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/menu"),l&&l.__esModule&&l||{default:l}).Menu,u=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),u&&u.__esModule&&u||{default:u}),_=y.clone,C=y.extend,R=(d=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),d&&d.__esModule&&d||{default:d}),M=R.arrayFilter,E=R.arrayMap,S=R.arrayEach,O=((c=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string"),c&&c.__esModule&&c||{default:c}).startsWith,(h=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/unicode"),h&&h.__esModule&&h||{default:h}).isKey),T=(f=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/function"),f&&f.__esModule&&f||{default:f}).partial,A=(p=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event"),p&&p.__esModule&&p||{default:p}).stopImmediatePropagation,N=(m=e("input"),m&&m.__esModule&&m||{default:m}).InputUI,x=(g=e("utils"),g&&g.__esModule&&g||{default:g}).createArrayAssertion,k=new WeakMap,I=function(e,t){k.set(this,{}),$traceurRuntime.superConstructor(D).call(this,e,C(D.DEFAULTS,t)),this.searchInput=new N(this.hot,{placeholder:"Search...",className:"htUIMultipleSelectSearch"}),this.selectAllUI=new w(this.hot,{tagName:"a",textContent:"Select all",href:"#",className:"htUISelectAll"}),this.clearAllUI=new w(this.hot,{tagName:"a",textContent:"Clear",href:"#",className:"htUIClearAll"}),this.items=[],this.itemsBox=null,this.registerHooks()},D=I;$traceurRuntime.createClass(I,{registerHooks:function(){var e=this;this.searchInput.addLocalHook("keydown",function(t){return e.onInputKeyDown(t)}),this.searchInput.addLocalHook("input",function(t){return e.onInput(t)}),this.selectAllUI.addLocalHook("click",function(t){return e.onSelectAllClick(t)}),this.clearAllUI.addLocalHook("click",function(t){return e.onClearAllClick(t)})},setItems:function(e){this.items=e,this.itemsBox&&this.itemsBox.loadData(this.items)},getItems:function(){return $traceurRuntime.spread(this.items)},getValue:function(){return o(this.items)},isSelectedAllValues:function(){return this.items.length===this.getValue().length},build:function(){var e=this;$traceurRuntime.superGet(this,D.prototype,"build").call(this);var t=document.createElement("div"),n=new w(this.hot,{className:"htUISelectionControls",children:[this.selectAllUI,this.clearAllUI]});this._element.appendChild(this.searchInput.element),this._element.appendChild(n.element),this._element.appendChild(t);var r=function(t){e._element&&(e.itemsBox&&e.itemsBox.destroy(),b(t,"htUIMultipleSelectHot"),e.itemsBox=new v(t,{data:e.items,columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],autoWrapCol:!0,colWidths:150,height:110,width:168,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},beforeKeyDown:function(t){return e.onItemsBoxBeforeKeyDown(t)}}))};r(t),setTimeout(function(){return r(t)},100)},reset:function(){this.searchInput.reset()},update:function(){this.isBuilt()&&(this.itemsBox.loadData(r(this.items,this.options.value)),$traceurRuntime.superGet(this,D.prototype,"update").call(this))},destroy:function(){this.itemsBox&&this.itemsBox.destroy(),this.itemsBox=null,this.searchInput=null,this.items=null,$traceurRuntime.superGet(this,D.prototype,"destroy").call(this)},onInput:function(e){var t,n=e.target.value.toLowerCase();t=""===n?$traceurRuntime.spread(this.items):M(this.items,function(e){return(e.value+"").toLowerCase().indexOf(n)>=0}),this.itemsBox.loadData(t)},onInputKeyDown:function(e){this.runLocalHooks("keydown",e,this);var t=T(O,e.keyCode);t("ARROW_DOWN|TAB")&&!this.itemsBox.isListening()&&(A(e),this.itemsBox.listen(),this.itemsBox.selectCell(0,0))},onItemsBoxBeforeKeyDown:function(e){var t=T(O,e.keyCode);t("ESCAPE")&&this.runLocalHooks("keydown",e,this),t("ARROW_UP|ARROW_DOWN|ARROW_LEFT|ARROW_RIGHT|TAB|SPACE|ENTER")||(A(e),this.itemsBox.unlisten(),this.itemsBox.deselectCell(),this.searchInput.focus())},onSelectAllClick:function(e){e.preventDefault(),S(this.itemsBox.getSourceData(),function(e){e.checked=!0}),this.itemsBox.render()},onClearAllClick:function(e){e.preventDefault(),S(this.itemsBox.getSourceData(),function(e){e.checked=!1}),this.itemsBox.render()}},{get DEFAULTS(){return _({className:"htUIMultipleSelect",value:[]})}},w)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event":48,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/function":50,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string":55,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/unicode":56,"../../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/menu":74,"../../../browser":138,_base:183,input:184,utils:187}],186:[function(e,t,n){"use strict";Object.defineProperties(n,{SelectUI:{get:function(){return w}},__esModule:{value:!0}});var r,o,i,s,a,l,u=(r=e("_base"),r&&r.__esModule&&r||{default:r}).BaseUI,d=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),o&&o.__esModule&&o||{default:o}),c=(d.addClass,d.getWindowScrollTop,d.getWindowScrollLeft,(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/menu"),i&&i.__esModule&&i||{default:i}).Menu),h=(s=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),s&&s.__esModule&&s||{default:s}),f=h.clone,p=h.extend,m=(a=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),a&&a.__esModule&&a||{default:a}).arrayEach,g=(l=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems"),l&&l.__esModule&&l||{default:l}).SEPARATOR,v=new WeakMap,w=function(e,t){v.set(this,{}),$traceurRuntime.superConstructor(b).call(this,e,p(b.DEFAULTS,t)),this.menu=null,this.items=[],this.registerHooks()},b=w;$traceurRuntime.createClass(w,{registerHooks:function(){var e=this;this.addLocalHook("click",function(t){return e.onClick(t)})},setItems:function(e){this.items=e,this.menu&&this.menu.setMenuItems(this.items)},build:function(){var e=this;$traceurRuntime.superGet(this,b.prototype,"build").call(this),this.menu=new c(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0}),this.menu.setMenuItems(this.items);var t=new u(this.hot,{className:"htUISelectCaption"}),n=new u(this.hot,{className:"htUISelectDropdown"});v.get(this).caption=t.element,m([t,n],function(t){return e._element.appendChild(t.element)}),this.menu.addLocalHook("select",function(t){return e.onMenuSelect(t)}),this.update()},update:function(){this.isBuilt()&&(v.get(this).caption.textContent=this.options.value?this.options.value.name:"None",$traceurRuntime.superGet(this,b.prototype,"update").call(this))},openOptions:function(){var e=this.element.getBoundingClientRect();this.menu&&(this.menu.open(),this.menu.setPosition({left:e.left-5,top:e.top,width:e.width,height:e.height}))},closeOptions:function(){this.menu&&this.menu.close()},onMenuSelect:function(e){e.name!==g&&(this.options.value=e,this.closeOptions(),this.update(),this.runLocalHooks("select",this.options.value))},onClick:function(e){this.openOptions()},destroy:function(){this.menu&&(this.menu.destroy(),this.menu=null),$traceurRuntime.superGet(this,b.prototype,"destroy").call(this)}},{get DEFAULTS(){return f({className:"htUISelect",wrapIt:!1})}},u)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/menu":74,"../../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems":75,_base:183}],187:[function(e,t,n){"use strict";function r(e,t){return"number"==typeof e&&"number"==typeof t?e-t:m(e,t)}function o(e){return""===e&&(e="(Blank cells)"),e}function i(e){return g&&(e=new Set(e)),function(t){var n;return n=g?e.has(t):!!~e.indexOf(t)}}function s(e){return null==e?"":e}function a(e){return e=v?Array.from(new Set(e)):f(e),e=e.sort(function(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e===t?0:e>t?1:-1})}function l(e,t,n){var r,s=[],a=e===t;return a||(r=i(t)),p(e,function(e){var t=!1;(a||r(e))&&(t=!0);var i={checked:t,value:e,visualValue:o(e)};n&&n(i),s.push(i)}),s}Object.defineProperties(n,{sortComparison:{get:function(){return r}},toVisualValue:{get:function(){return o}},createArrayAssertion:{get:function(){return i}},toEmptyString:{get:function(){return s}},unifyColumnValues:{get:function(){return a}},intersectValues:{get:function(){return l}},__esModule:{value:!0}});var u,d,c=(u=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/feature"),u&&u.__esModule&&u||{default:u}).getComparisonFunction,h=(d=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),d&&d.__esModule&&d||{default:d}),f=(h.arrayMap,h.arrayUnique),p=h.arrayEach,m=c(),g=new Set([1]).has(1),v=g&&"function"==typeof Array.from},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/feature":49}],188:[function(e,t,n){"use strict";function r(e,t){b.has(e)||b.set(e,{prepare:t.prepare||_,operate:t.operate||_})}Object.defineProperties(n,{AlterManager:{get:function(){return y}},registerOperation:{get:function(){return r}},__esModule:{value:!0}});var o,i,s,a,l,u,d,c,h=((o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),o&&o.__esModule&&o||{default:o}).arrayEach,(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),i&&i.__esModule&&i||{default:i}).mixin),f=(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks"),s&&s.__esModule&&s||{default:s}).localHooks,p=(a=e("alterOperation/columnSorting"),a&&a.__esModule&&a||{default:a}),m=(l=e("alterOperation/insertColumn"),l&&l.__esModule&&l||{default:l}),g=(u=e("alterOperation/insertRow"),u&&u.__esModule&&u||{default:u}),v=(d=e("alterOperation/removeColumn"),d&&d.__esModule&&d||{default:d}),w=(c=e("alterOperation/removeRow"),c&&c.__esModule&&c||{default:c}),b=new Map;r(p.OPERATION_NAME,p),r(m.OPERATION_NAME,m),r(g.OPERATION_NAME,g),r(v.OPERATION_NAME,v),r(w.OPERATION_NAME,w);var y=function(e){this.sheet=e,this.hot=e.hot,this.dataProvider=e.dataProvider,this.matrix=e.matrix};$traceurRuntime.createClass(y,{prepareAlter:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!b.has(e))throw Error('Alter operation "'+e+'" not exist.');b.get(e).prepare.apply(this,t)},triggerAlter:function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if(!b.has(e))throw Error('Alter operation "'+e+'" not exist.');b.get(e).operate.apply(this,n),(t=this).runLocalHooks.apply(t,$traceurRuntime.spread(["afterAlter"],n))},destroy:function(){this.sheet=null,this.hot=null,this.dataProvider=null,this.matrix=null}},{}),h(y,f);var _=function(){}},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks":58,"alterOperation/columnSorting":189,"alterOperation/insertColumn":190,"alterOperation/insertRow":191,"alterOperation/removeColumn":192,"alterOperation/removeRow":193}],189:[function(e,t,n){"use strict";function r(){var e=this,t=e.matrix,n=e.dataProvider;u=new WeakMap,d(t.data,function(e){u.set(e,n.t.toVisualRow(e.row))})}function o(){var e=this,t=e.matrix,n=e.dataProvider;t.cellReferences.length=0,d(t.data,function(e){e.setState(h.STATE_OUT_OFF_DATE),e.clearPrecedents();var t=e,r=t.row,o=t.column,i=n.getSourceDataAtCell(r,o);if(c(i)){var s=u.get(e),a=new f(i);a.translate({row:n.t.toVisualRow(r)-s}),n.updateSourceData(r,o,a.toString())}}),u=null}Object.defineProperties(n,{OPERATION_NAME:{get:function(){return p}},prepare:{get:function(){return r}},operate:{get:function(){return o}},__esModule:{value:!0}});var i,s,a,l,u,d=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),i&&i.__esModule&&i||{default:i}).arrayEach,c=(s=e("utils"),s&&s.__esModule&&s||{default:s}).isFormulaExpression,h=(a=e("cell/value"),a&&a.__esModule&&a||{default:a}).CellValue,f=(l=e("expressionModifier"),l&&l.__esModule&&l||{default:l}).ExpressionModifier,p="column_sorting"},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"cell/value":196,expressionModifier:198,utils:203}],190:[function(e,t,n){"use strict";function r(e,t){var n=void 0===arguments[2]||arguments[2],r=this,i=r.matrix,s=r.dataProvider,a=[0,t];u(i.cellReferences,function(t){var n;t.column>=e&&(n=t).translateTo.apply(n,$traceurRuntime.spread(a))}),u(i.data,function(r){var i,l=r,u=l.row,d=l.column;if(r.column>=e&&((i=r).translateTo.apply(i,$traceurRuntime.spread(a)),r.setState(f.STATE_OUT_OFF_DATE)),n){var m=r,g=m.row,v=m.column,w=s.getSourceDataAtCell(g,v);if(h(w)){var b=c("column",e),y=new p(w);y.useCustomModifier(o),y.translate({column:t},b({row:u,column:d})),s.updateSourceData(g,v,y.toString())}}})}function o(e,t,n,r){var o=e,i=o.start,s=o.end,a=i[t].index,l=s[t].index,u=n,d=n;return r>a&&(u=0),r>l&&(d=0),[u,d,!1]}Object.defineProperties(n,{OPERATION_NAME:{get:function(){return m}},operate:{get:function(){return r}},__esModule:{value:!0}});var i,s,a,l,u=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),i&&i.__esModule&&i||{default:i}).arrayEach,d=(s=e("utils"),s&&s.__esModule&&s||{default:s}),c=d.cellCoordFactory,h=d.isFormulaExpression,f=(a=e("cell/value"),a&&a.__esModule&&a||{default:a}).CellValue,p=(l=e("expressionModifier"),l&&l.__esModule&&l||{default:l}).ExpressionModifier,m="insert_column"},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"cell/value":196,expressionModifier:198,utils:203}],191:[function(e,t,n){"use strict";function r(e,t){var n=void 0===arguments[2]||arguments[2],r=this,i=r.matrix,s=r.dataProvider,a=[t,0];u(i.cellReferences,function(t){var n;t.row>=e&&(n=t).translateTo.apply(n,$traceurRuntime.spread(a))}),u(i.data,function(r){var i,l=r,u=l.row,d=l.column;if(r.row>=e&&((i=r).translateTo.apply(i,$traceurRuntime.spread(a)),r.setState(f.STATE_OUT_OFF_DATE)),n){var m=r,g=m.row,v=m.column,w=s.getSourceDataAtCell(g,v);if(h(w)){var b=c("row",e),y=new p(w);y.useCustomModifier(o),y.translate({row:t},b({row:u,column:d})),s.updateSourceData(g,v,y.toString())}}})}function o(e,t,n,r){var o=e,i=o.start,s=o.end,a=i[t].index,l=s[t].index,u=n,d=n;return r>a&&(u=0),r>l&&(d=0),[u,d,!1]}Object.defineProperties(n,{OPERATION_NAME:{get:function(){return m}},operate:{get:function(){return r}},__esModule:{value:!0}});var i,s,a,l,u=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),i&&i.__esModule&&i||{default:i}).arrayEach,d=(s=e("utils"),s&&s.__esModule&&s||{default:s}),c=d.cellCoordFactory,h=d.isFormulaExpression,f=(a=e("cell/value"),a&&a.__esModule&&a||{default:a}).CellValue,p=(l=e("expressionModifier"),l&&l.__esModule&&l||{default:l}).ExpressionModifier,m="insert_row"},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"cell/value":196,expressionModifier:198,utils:203}],192:[function(e,t,n){"use strict";function r(e,t){var n=void 0===arguments[2]||arguments[2];t=-t;var r=this,i=r.matrix,s=r.dataProvider,a=r.sheet,l=[0,t],d=Math.abs(t)-1,m=i.removeCellRefsAtRange({column:e},{column:e+d}),g=[];u(i.data,function(t){u(m,function(e){t.hasPrecedent(e)&&(t.removePrecedent(e),t.setState(f.STATE_OUT_OFF_DATE),u(a.getCellDependencies(t.row,t.column),function(e){e.setState(f.STATE_OUT_OFF_DATE)}))}),t.column>=e&&t.column<=e+d&&g.push(t)}),i.remove(g),u(i.cellReferences,function(t){var n;t.column>=e&&(n=t).translateTo.apply(n,$traceurRuntime.spread(l))}),u(i.data,function(r){var i,a=r,u=a.row,d=a.column;if(r.column>=e&&((i=r).translateTo.apply(i,$traceurRuntime.spread(l)),r.setState(f.STATE_OUT_OFF_DATE)),n){var m=r,g=m.row,v=m.column,w=s.getSourceDataAtCell(g,v);if(h(w)){var b=c("column",e),y=new p(w);y.useCustomModifier(o),y.translate({column:t},b({row:u,column:d})),s.updateSourceData(g,v,y.toString())}}})}function o(e,t,n,r){var o=e,i=o.start,s=o.end,a=o.type,l=i[t].index,u=s[t].index,d=Math.abs(n)-1,c=n,h=n,f=!1;return l>=r&&u<=r+d&&(f=!0),f||"cell"!==a||r>=l&&(c=0,h=0),f||"range"!==a||(r>=l&&(c=0),r>u?h=0:u<=r+d&&(h-=Math.min(u-(r+d),0))),l+c<0&&(c-=l+c),[c,h,f]}Object.defineProperties(n,{OPERATION_NAME:{get:function(){return m}},operate:{get:function(){return r}},__esModule:{value:!0}});var i,s,a,l,u=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),i&&i.__esModule&&i||{default:i}).arrayEach,d=(s=e("utils"),s&&s.__esModule&&s||{default:s}),c=d.cellCoordFactory,h=d.isFormulaExpression,f=(a=e("cell/value"),a&&a.__esModule&&a||{default:a}).CellValue,p=(l=e("expressionModifier"),l&&l.__esModule&&l||{default:l}).ExpressionModifier,m="remove_column"},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"cell/value":196,expressionModifier:198,utils:203}],193:[function(e,t,n){"use strict";function r(e,t){var n=void 0===arguments[2]||arguments[2];t=-t;var r=this,i=r.matrix,s=r.dataProvider,a=r.sheet,l=[t,0],d=Math.abs(t)-1,m=i.removeCellRefsAtRange({row:e},{row:e+d}),g=[];u(i.data,function(t){u(m,function(e){t.hasPrecedent(e)&&(t.removePrecedent(e),t.setState(f.STATE_OUT_OFF_DATE),u(a.getCellDependencies(t.row,t.column),function(e){e.setState(f.STATE_OUT_OFF_DATE)}))}),t.row>=e&&t.row<=e+d&&g.push(t)}),i.remove(g),u(i.cellReferences,function(t){var n;t.row>=e&&(n=t).translateTo.apply(n,$traceurRuntime.spread(l))}),u(i.data,function(r){var i,a=r,u=a.row,d=a.column;if(r.row>=e&&((i=r).translateTo.apply(i,$traceurRuntime.spread(l)),r.setState(f.STATE_OUT_OFF_DATE)),n){var m=r,g=m.row,v=m.column,w=s.getSourceDataAtCell(g,v);if(h(w)){var b=c("row",e),y=new p(w);y.useCustomModifier(o),y.translate({row:t},b({row:u,column:d})),s.updateSourceData(g,v,y.toString())}}})}function o(e,t,n,r){var o=e,i=o.start,s=o.end,a=o.type,l=i[t].index,u=s[t].index,d=Math.abs(n)-1,c=n,h=n,f=!1;return l>=r&&u<=r+d&&(f=!0),f||"cell"!==a||r>=l&&(c=0,h=0),f||"range"!==a||(r>=l&&(c=0),r>u?h=0:u<=r+d&&(h-=Math.min(u-(r+d),0))),l+c<0&&(c-=l+c),[c,h,f]}Object.defineProperties(n,{OPERATION_NAME:{get:function(){return m}},operate:{get:function(){return r}},__esModule:{value:!0}});var i,s,a,l,u=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),i&&i.__esModule&&i||{default:i}).arrayEach,d=(s=e("utils"),s&&s.__esModule&&s||{default:s}),c=d.cellCoordFactory,h=d.isFormulaExpression,f=(a=e("cell/value"),a&&a.__esModule&&a||{default:a}).CellValue,p=(l=e("expressionModifier"),l&&l.__esModule&&l||{default:l}).ExpressionModifier,m="remove_row"},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"cell/value":196,expressionModifier:198,utils:203}],194:[function(e,t,n){"use strict";Object.defineProperties(n,{BaseCell:{get:function(){return a}},__esModule:{value:!0}
});var r,o,i=(r=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),r&&r.__esModule&&r||{default:r}).isObject,s=(o=e("hot-formula-parser"),o&&o.__esModule&&o||{default:o}).toLabel,a=function(e,t){var n=i(e),r=i(t);this._row=n?e.index:e,this.rowAbsolute=!n||e.isAbsolute,this._column=r?t.index:t,this.columnAbsolute=!r||t.isAbsolute,this.rowOffset=0,this.columnOffset=0,Object.defineProperty(this,"row",{get:function(){return this.rowOffset+this._row},set:function(e){this._row=e},enumerable:!0,configurable:!0}),Object.defineProperty(this,"column",{get:function(){return this.columnOffset+this._column},set:function(e){this._column=e},enumerable:!0,configurable:!0})};$traceurRuntime.createClass(a,{translateTo:function(e,t){this.row=this.row+e,this.column=this.column+t},isEqual:function(e){return e.row===this.row&&e.column===this.column},toString:function(){return s({index:this.row,isAbsolute:this.rowAbsolute},{index:this.column,isAbsolute:this.columnAbsolute})}},{})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"hot-formula-parser":"hot-formula-parser"}],195:[function(e,t,n){"use strict";Object.defineProperties(n,{CellReference:{get:function(){return a}},__esModule:{value:!0}});var r,o,i=(r=e("_base"),r&&r.__esModule&&r||{default:r}).BaseCell,s=(o=e("hot-formula-parser"),o&&o.__esModule&&o||{default:o}).toLabel,a=function(e,t){$traceurRuntime.superConstructor(l).call(this,e,t)},l=a;$traceurRuntime.createClass(a,{toString:function(){return s({index:this.row,isAbsolute:!1},{index:this.column,isAbsolute:!1})}},{},i)},{_base:194,"hot-formula-parser":"hot-formula-parser"}],196:[function(e,t,n){"use strict";Object.defineProperties(n,{CellValue:{get:function(){return f}},__esModule:{value:!0}});var r,o,i,s=(r=e("_base"),r&&r.__esModule&&r||{default:r}).BaseCell,a=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),o&&o.__esModule&&o||{default:o}).arrayFilter,l=(i=e("hot-formula-parser"),i&&i.__esModule&&i||{default:i}).ERROR_REF,u=1,d=2,c=3,h=[u,d,c],f=function(e,t){$traceurRuntime.superConstructor(p).call(this,e,t),this.precedents=[],this.value=null,this.error=null,this.state=p.STATE_UP_TO_DATE},p=f;$traceurRuntime.createClass(f,{setValue:function(e){this.value=e},getValue:function(){return this.value},setError:function(e){this.error=e},getError:function(){return this.error},hasError:function(){return null!==this.error},setState:function(e){if(h.indexOf(e)===-1)throw Error("Unrecognized state: "+e);this.state=e},isState:function(e){return this.state===e},addPrecedent:function(e){if(this.isEqual(e))throw Error(l);this.hasPrecedent(e)||this.precedents.push(e)},removePrecedent:function(e){if(this.isEqual(e))throw Error(l);this.precedents=a(this.precedents,function(t){return!t.isEqual(e)})},clearPrecedents:function(){this.precedents.length=0},getPrecedents:function(){return this.precedents},hasPrecedents:function(){return this.precedents.length>0},hasPrecedent:function(e){return!!a(this.precedents,function(t){return t.isEqual(e)}).length}},{get STATE_OUT_OFF_DATE(){return 1},get STATE_COMPUTING(){return 2},get STATE_UP_TO_DATE(){return 3}},s)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,_base:194,"hot-formula-parser":"hot-formula-parser"}],197:[function(e,t,n){"use strict";Object.defineProperties(n,{DataProvider:{get:function(){return d}},__esModule:{value:!0}});var r,o,i,s,a=(r=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),r&&r.__esModule&&r||{default:r}).arrayEach,l=((o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),o&&o.__esModule&&o||{default:o}).rangeEach,(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/utils/recordTranslator"),i&&i.__esModule&&i||{default:i}).getTranslator),u=(s=e("utils"),s&&s.__esModule&&s||{default:s}).isFormulaExpression,d=function(e){this.hot=e,this.changes={},this.t=l(this.hot)};$traceurRuntime.createClass(d,{collectChanges:function(e,t,n){u(n)||(this.changes[this._coordId(e,t)]=n)},clearChanges:function(){this.changes={}},isInDataRange:function(e,t){return e>=0&&e<this.hot.countRows()&&t>=0&&t<this.hot.countCols()},getDataAtCell:function(e,t){var n,r,o=(n=this)._coordId.apply(n,$traceurRuntime.spread(this.t.toPhysical(e,t)));return r=this.changes.hasOwnProperty(o)?this.changes[o]:this.hot.getDataAtCell(e,t)},getDataByRange:function(e,t,n,r){var o=this,i=this.hot.getData(e,t,n,r);return a(i,function(n,r){a(n,function(n,s){var a,l=(a=o)._coordId.apply(a,$traceurRuntime.spread(o.t.toPhysical(r+e,s+t)));o.changes.hasOwnProperty(l)&&(i[r][s]=o.changes[l])})}),i},getSourceDataAtCell:function(e,t){return this.hot.getSourceDataAtCell(e,t)},getRawDataAtCell:function(e,t){var n;return(n=this).getSourceDataAtCell.apply(n,$traceurRuntime.spread(this.t.toPhysical(e,t)))},getSourceDataByRange:function(e,t,n,r){return this.hot.getSourceDataArray(e,t,n,r)},getRawDataByRange:function(e,t,n,r){var o,i=$traceurRuntime.spread(this.t.toPhysical(e,t),this.t.toPhysical(n,r));return(o=this).getSourceDataByRange.apply(o,$traceurRuntime.spread(i))},updateSourceData:function(e,t,n){this.hot.getSourceData()[e][this.hot.colToProp(t)]=n},_coordId:function(e,t){return e+":"+t},destroy:function(){this.hot=null,this.changes=null,this.t=null}},{})},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/utils/recordTranslator":130,utils:203}],198:[function(e,t,n){"use strict";Object.defineProperties(n,{ExpressionModifier:{get:function(){return T}},__esModule:{value:!0}});var r,o,i,s,a,l,u,d=(r=e("../../browser"),r&&r.__esModule&&r||{default:r}).default,c=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),o&&o.__esModule&&o||{default:o}),h=c.arrayEach,f=c.arrayFilter,p=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string"),i&&i.__esModule&&i||{default:i}).startsWith,m=(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),s&&s.__esModule&&s||{default:s}).mixin,g=(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks"),a&&a.__esModule&&a||{default:a}).localHooks,v=(l=e("utils"),l&&l.__esModule&&l||{default:l}).toUpperCaseFormula,w=(u=e("hot-formula-parser"),u&&u.__esModule&&u||{default:u}),b=w.toLabel,y=w.extractLabel,_=w.error,C=w.ERROR_REF,R=/^\$?[A-Z]+\$?\d+$/,M=/\$?[A-Z]+\$?\d+/,E=/(?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ])/g,S=/\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+/g,O=/((?:[^0-9A-Z$: ]|^)\s*(\$?[A-Z]+\$?\d+)\s*(?![0-9A-Z_: ]))|(\$?[A-Z]+\$?\d+\s*:\s*\$?[A-Z]+\$?\d+)/g,T=function(e){this.expression="",this.cells=[],this.customModifier=null,"string"==typeof e&&this.setExpression(e)};$traceurRuntime.createClass(T,{setExpression:function(e){return this.cells.length=0,this.expression=v(e),this._extractCells(),this._extractCellsRange(),this},useCustomModifier:function(e){this.customModifier=e},translate:function(e){var t=e,n=t.row,r=t.column,o=void 0!==arguments[1]?arguments[1]:{},i=this;return h(this.cells,function(e){null!=n&&i._translateCell(e,"row",n,o.row),null!=r&&i._translateCell(e,"column",r,o.column)}),this},toString:function(){var e=this,t=this.expression.replace(O,function(t,n,r){var o=t.indexOf(":")===-1,i=t,s=t,a=null;o&&(s=R.test(n)?n:r);var l=e._searchCell(s);return l&&(a=l.refError?_(C):l.toLabel(),i=o?t.replace(s,a):a),i});return p(t,"=")||(t="="+t),t},_translateCell:function(e,t,n,r){var o,i=e,s=i.start,a=i.end,l=s[t].index,u=a[t].index,d=n,c=n,h=!1;this.customModifier?(o=this.customModifier(e,t,n,r),d=o[0],c=o[1],h=o[2],o):(s[t].isAbsolute&&(d=0),a[t].isAbsolute&&(c=0)),d&&!h&&(l+d<0&&(h=!0),s[t].index=Math.max(l+d,0)),c&&!h&&(u+c<0&&(h=!0),a[t].index=Math.max(u+c,0)),h&&(e.refError=!0)},_extractCells:function(){var e=this,t=this.expression.match(E);t&&h(t,function(t){if(t=t.match(M)){var n=y(t[0]),r=n[0],o=n[1];e.cells.push(e._createCell({row:r,column:o},{row:r,column:o},t[0]))}})},_extractCellsRange:function(){var e=this,t=this.expression.match(S);t&&h(t,function(t){var n=t.split(":"),r=n[0],o=n[1],i=y(r),s=i[0],a=i[1],l=y(o),u=l[0],d=l[1],c={row:s,column:a},h={row:u,column:d};e.cells.push(e._createCell(c,h,t))})},_searchCell:function(e){var t=f(this.cells,function(t){return t.origLabel===e})[0];return t||null},_createCell:function(e,t,n){return{start:e,end:t,origLabel:n,type:n.indexOf(":")===-1?"cell":"range",refError:!1,toLabel:function(){var e=b(this.start.row,this.start.column);return"range"===this.type&&(e+=":"+b(this.end.row,this.end.column)),e}}}},{}),m(T,g),d.utils.FormulasUtils=d.utils.FormulasUtils||{},d.utils.FormulasUtils.ExpressionModifier=T},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/string":55,"../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks":58,"../../browser":138,"hot-formula-parser":"hot-formula-parser",utils:203}],199:[function(e,t,n){"use strict";Object.defineProperties(n,{Formulas:{get:function(){return O}},__esModule:{value:!0}});var r,o,i,s,a,l,u,d,c,h=(r=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),r&&r.__esModule&&r||{default:r}).default,f=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),o&&o.__esModule&&o||{default:o}).arrayEach,p=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),i&&i.__esModule&&i||{default:i}),m=p.isObject,g=p.objectEach,v=(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager"),s&&s.__esModule&&s||{default:s}).EventManager,w=(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),a&&a.__esModule&&a||{default:a}).registerPlugin,b=(l=e("utils"),l&&l.__esModule&&l||{default:l}),y=b.isFormulaExpression,_=b.toUpperCaseFormula,C=b.isFormulaExpressionEscaped,R=b.unescapeFormulaExpression,M=(u=e("sheet"),u&&u.__esModule&&u||{default:u}).Sheet,E=(d=e("dataProvider"),d&&d.__esModule&&d||{default:d}).DataProvider,S=(c=e("undoRedoSnapshot"),c&&c.__esModule&&c||{default:c}).UndoRedoSnapshot,O=function(e){$traceurRuntime.superConstructor(T).call(this,e),this.eventManager=new v(this),this.dataProvider=new E(this.hot),this.sheet=new M(this.hot,this.dataProvider),this.undoRedoSnapshot=new S(this.sheet),this._skipRendering=!1},T=O;$traceurRuntime.createClass(O,{isEnabled:function(){return!!this.hot.getSettings().formulas},enablePlugin:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().formulas;m(t)&&m(t.variables)&&g(t.variables,function(t,n){return e.setVariable(n,t)}),this.addHook("afterColumnSort",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onAfterColumnSort.apply(t,$traceurRuntime.spread(n))}),this.addHook("afterCreateCol",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onAfterCreateCol.apply(t,$traceurRuntime.spread(n))}),this.addHook("afterCreateRow",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onAfterCreateRow.apply(t,$traceurRuntime.spread(n))}),this.addHook("afterLoadData",function(){return e.onAfterLoadData()}),this.addHook("afterRemoveCol",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onAfterRemoveCol.apply(t,$traceurRuntime.spread(n))}),this.addHook("afterRemoveRow",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onAfterRemoveRow.apply(t,$traceurRuntime.spread(n))}),this.addHook("afterSetDataAtCell",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onAfterSetDataAtCell.apply(t,$traceurRuntime.spread(n))}),this.addHook("afterSetDataAtRowProp",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onAfterSetDataAtCell.apply(t,$traceurRuntime.spread(n))}),this.addHook("beforeColumnSort",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onBeforeColumnSort.apply(t,$traceurRuntime.spread(n))}),this.addHook("beforeCreateCol",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onBeforeCreateCol.apply(t,$traceurRuntime.spread(n))}),this.addHook("beforeCreateRow",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onBeforeCreateRow.apply(t,$traceurRuntime.spread(n))}),this.addHook("beforeRemoveCol",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onBeforeRemoveCol.apply(t,$traceurRuntime.spread(n))}),this.addHook("beforeRemoveRow",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onBeforeRemoveRow.apply(t,$traceurRuntime.spread(n))}),this.addHook("beforeValidate",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onBeforeValidate.apply(t,$traceurRuntime.spread(n))}),this.addHook("beforeValueRender",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onBeforeValueRender.apply(t,$traceurRuntime.spread(n))}),this.addHook("modifyData",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onModifyData.apply(t,$traceurRuntime.spread(n))}),this.sheet.addLocalHook("afterRecalculate",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onSheetAfterRecalculate.apply(t,$traceurRuntime.spread(n))}),$traceurRuntime.superGet(this,T.prototype,"enablePlugin").call(this)}},disablePlugin:function(){$traceurRuntime.superGet(this,T.prototype,"disablePlugin").call(this)},getCellValue:function(e,t){var n=this.sheet.getCellAt(e,t);return n?n.getError()||n.getValue():void 0},hasComputedCellValue:function(e,t){return!!this.sheet.getCellAt(e,t)},recalculate:function(){this.sheet.recalculate()},recalculateFull:function(){this.sheet.recalculateFull()},recalculateOptimized:function(){this.sheet.recalculateOptimized()},setVariable:function(e,t){this.sheet.setVariable(e,t)},getVariable:function(e){return this.sheet.getVariable(e)},onSheetAfterRecalculate:function(e,t){if(this._skipRendering)return void(this._skipRendering=!1);var n=this.hot;f(e,function(e){var t=e,r=t.row,o=t.column;n.validateCell(n.getDataAtCell(r,o),n.getCellMeta(r,o),function(){})}),n.render()},onModifyData:function(e,t,n,r){"get"===r&&this.hasComputedCellValue(e,t)?n.value=this.getCellValue(e,t):"set"===r&&y(n.value)&&(n.value=_(n.value))},onBeforeValueRender:function(e){return C(e)&&(e=R(e)),e},onBeforeValidate:function(e,t,n,r){var o=this.hot.propToCol(n);return this.hasComputedCellValue(t,o)&&(e=this.getCellValue(t,o)),e},onAfterSetDataAtCell:function(e,t){var n=this;"loadData"!==t&&(this.dataProvider.clearChanges(),f(e,function(e){var t=e,r=t[0],o=t[1],i=t[2],s=t[3];o=n.hot.propToCol(o),r=n.t.toPhysicalRow(r),y(s)&&(s=_(s)),n.dataProvider.collectChanges(r,o,s),i!==s&&n.sheet.applyChanges(r,o,s)}),this.recalculate())},onBeforeCreateRow:function(e,t,n){"undo"===n&&this.undoRedoSnapshot.restore()},onAfterCreateRow:function(e,t,n){this.sheet.alterManager.triggerAlter("insert_row",e,t,"undo"!==n)},onBeforeRemoveRow:function(e,t){this.undoRedoSnapshot.save("row",e,t)},onAfterRemoveRow:function(e,t){this.sheet.alterManager.triggerAlter("remove_row",e,t)},onBeforeCreateCol:function(e,t,n){"undo"===n&&this.undoRedoSnapshot.restore()},onAfterCreateCol:function(e,t,n){this.sheet.alterManager.triggerAlter("insert_column",e,t,"undo"!==n)},onBeforeRemoveCol:function(e,t){this.undoRedoSnapshot.save("column",e,t)},onAfterRemoveCol:function(e,t){this.sheet.alterManager.triggerAlter("remove_column",e,t)},onBeforeColumnSort:function(e,t){this.sheet.alterManager.prepareAlter("column_sorting",e,t)},onAfterColumnSort:function(e,t){this.sheet.alterManager.triggerAlter("column_sorting",e,t)},onAfterLoadData:function(){this._skipRendering=!0,this.recalculateFull()},destroy:function(){this.dataProvider.destroy(),this.dataProvider=null,this.sheet.destroy(),this.sheet=null,$traceurRuntime.superGet(this,T.prototype,"destroy").call(this)}},{},h),w("formulas",O)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/eventManager":42,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,dataProvider:197,sheet:201,undoRedoSnapshot:202,utils:203}],200:[function(e,t,n){"use strict";Object.defineProperties(n,{Matrix:{get:function(){return d}},__esModule:{value:!0}});var r,o,i=(r=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),r&&r.__esModule&&r||{default:r}),s=i.arrayEach,a=i.arrayFilter,l=i.arrayReduce,u=(o=e("cell/value"),o&&o.__esModule&&o||{default:o}).CellValue,d=function(e){this.t=e,this.data=[],this.cellReferences=[]};$traceurRuntime.createClass(d,{getCellAt:function(e,t){var n=null;return s(this.data,function(r){if(r.row===e&&r.column===t)return n=r,!1}),n},getOutOfDateCells:function(){return a(this.data,function(e){return e.isState(u.STATE_OUT_OFF_DATE)})},add:function(e){a(this.data,function(t){return t.isEqual(e)}).length||this.data.push(e)},remove:function(e){var t=Array.isArray(e),n=function(e,n){var r=!1;return t?s(n,function(t){if(e.isEqual(t))return r=!0,!1}):r=e.isEqual(n),r};this.data=a(this.data,function(t){return!n(t,e)})},getDependencies:function(e){var t=this,n=function(e){return l(t.data,function(t,n){return n.hasPrecedent(e)&&t.indexOf(n)===-1&&t.push(n),t},[])},r=function(e){var o=n(e);return o.length&&s(o,function(e){e.hasPrecedents()&&(o=o.concat(r(t.t.toVisual(e))))}),o};return r(e)},registerCellRef:function(e){a(this.cellReferences,function(t){return t.isEqual(e)}).length||this.cellReferences.push(e)},removeCellRefsAtRange:function(e,t){var n=e,r=n.row,o=n.column,i=t,s=i.row,l=i.column,u=[],d=function(e){return void 0===r||e.row>=r&&e.row<=s},c=function(e){return void 0===o||e.column>=o&&e.column<=l};return this.cellReferences=a(this.cellReferences,function(e){return!d(e)||!c(e)||(u.push(e),!1)}),u},reset:function(){this.data.length=0,this.cellReferences.length=0}},{})},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"cell/value":196}],201:[function(e,t,n){"use strict";Object.defineProperties(n,{Sheet:{get:function(){return D}},__esModule:{value:!0}});var r,o,i,s,a,l,u,d,c,h,f,p=(r=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),r&&r.__esModule&&r||{default:r}),m=p.arrayEach,g=(p.arrayMap,(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),o&&o.__esModule&&o||{default:o}).rangeEach),v=(i=e("cell/value"),i&&i.__esModule&&i||{default:i}).CellValue,w=(s=e("cell/reference"),s&&s.__esModule&&s||{default:s}).CellReference,b=(a=e("utils"),a&&a.__esModule&&a||{default:a}),y=b.isFormulaExpression,_=b.toUpperCaseFormula,C=(l=e("matrix"),l&&l.__esModule&&l||{default:l}).Matrix,R=(u=e("alterManager"),u&&u.__esModule&&u||{default:u}).AlterManager,M=(d=e("../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks"),d&&d.__esModule&&d||{default:d}).localHooks,E=(c=e("../../../node_modules/hot-builder/node_modules/handsontable/src/utils/recordTranslator"),c&&c.__esModule&&c||{default:c}).getTranslator,S=(h=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),h&&h.__esModule&&h||{default:h}),O=(S.objectEach,S.mixin),T=(f=e("hot-formula-parser"),f&&f.__esModule&&f||{default:f}),A=T.Parser,N=T.ERROR_REF,x=1,k=2,I=3,D=function(e,t){var n=this;this.hot=e,this.t=E(this.hot),this.dataProvider=t,this.parser=new A,this.matrix=new C(this.t),this.alterManager=new R(this),this._processingCell=null,this._state=I,this.parser.on("callCellValue",function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=n)._onCallCellValue.apply(e,$traceurRuntime.spread(t))}),this.parser.on("callRangeValue",function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=n)._onCallRangeValue.apply(e,$traceurRuntime.spread(t))}),this.alterManager.addLocalHook("afterAlter",function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=n)._onAfterAlter.apply(e,$traceurRuntime.spread(t))})};$traceurRuntime.createClass(D,{recalculate:function(){switch(this._state){case I:this.recalculateFull();break;case k:this.recalculateOptimized()}},recalculateOptimized:function(){var e=this,t=this.matrix.getOutOfDateCells();m(t,function(t){var n=e.dataProvider.getSourceDataAtCell(t.row,t.column);y(n)&&e.parseExpression(t,n.substr(1))}),this._state=x,this.runLocalHooks("afterRecalculate",t,"optimized")},recalculateFull:function(){var e=this,t=this.dataProvider.getSourceDataByRange();this.matrix.reset(),m(t,function(t,n){m(t,function(t,r){y(t)&&e.parseExpression(new v(n,r),t.substr(1))})}),this._state=x,this.runLocalHooks("afterRecalculate",t,"full")},setVariable:function(e,t){this.parser.setVariable(e,t)},getVariable:function(e){return this.parser.getVariable(e)},applyChanges:function(e,t,n){var r;this.matrix.remove({row:e,column:t}),y(n)&&this.parseExpression(new v(e,t),n.substr(1));var o=(r=this).getCellDependencies.apply(r,$traceurRuntime.spread(this.t.toVisual(e,t)));m(o,function(e){e.setState(v.STATE_OUT_OFF_DATE)}),this._state=k},parseExpression:function(e,t){e.setState(v.STATE_COMPUTING),this._processingCell=e;var n=this.parser.parse(_(t)),r=n.error,o=n.result;e.setValue(o),e.setError(r),e.setState(v.STATE_UP_TO_DATE),this.matrix.add(e),this._processingCell=null},getCellAt:function(e,t){return this.matrix.getCellAt(e,t)},getCellDependencies:function(e,t){return this.matrix.getDependencies({row:e,column:t})},_onCallCellValue:function(e,t){var n=e,r=n.row,o=n.column,i=new w(r,o);if(!this.dataProvider.isInDataRange(i.row,i.column))throw Error(N);this.matrix.registerCellRef(i),this._processingCell.addPrecedent(i),t(this.dataProvider.getDataAtCell(r.index,o.index))},_onCallRangeValue:function(e,t,n){var r=e,o=r.row,i=r.column,s=t,a=s.row,l=s.column,u=this;g(o.index,a.index,function(e){g(i.index,l.index,function(t){var n=new w(e,t);u.matrix.registerCellRef(n),u._processingCell.addPrecedent(n)})}),n(this.dataProvider.getDataByRange(o.index,i.index,a.index,l.index))},_onAfterAlter:function(){this.recalculateOptimized()},destroy:function(){this.hot=null,this.t=null,this.dataProvider.destroy(),this.dataProvider=null,this.alterManager.destroy(),this.alterManager=null,this.parser=null,this.matrix.reset(),this.matrix=null}},{}),O(D,M)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/localHooks":58,"../../../node_modules/hot-builder/node_modules/handsontable/src/utils/recordTranslator":130,alterManager:188,"cell/reference":195,"cell/value":196,"hot-formula-parser":"hot-formula-parser",matrix:200,utils:203}],202:[function(e,t,n){"use strict";Object.defineProperties(n,{UndoRedoSnapshot:{get:function(){return d}},__esModule:{value:!0}});var r,o,i,s,a=(r=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),r&&r.__esModule&&r||{default:r}).arrayEach,l=((o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),o&&o.__esModule&&o||{default:o}).rangeEach,(i=e("cell/value"),i&&i.__esModule&&i||{default:i}).CellValue),u=(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/utils/dataStructures/stack"),s&&s.__esModule&&s||{default:s}).Stack,d=function(e){this.sheet=e,this.stack=new u};$traceurRuntime.createClass(d,{save:function(e,t,n){var r=this.sheet,o=r.matrix,i=r.dataProvider,s=[];a(o.data,function(r){var o=r,a=o.row,l=o.column;if(r[e]<t||r[e]>t+(n-1)){var u=i.getSourceDataAtCell(a,l);s.push({row:a,column:l,value:u})}}),this.stack.push({axis:e,index:t,amount:n,changes:s})},restore:function(){var e=this.sheet,t=e.matrix,n=e.dataProvider,r=this.stack.pop(),o=r.axis,i=r.index,s=r.amount,u=r.changes;u&&a(u,function(e){e[o]>i+(s-1)&&(e[o]-=s);var r=e,a=r.row,u=r.column,d=r.value,c=n.getSourceDataAtCell(a,u);c!==d&&(n.updateSourceData(a,u,d),t.getCellAt(a,u).setState(l.STATE_OUT_OFF_DATE))})},destroy:function(){this.sheet=null,this.stack=null}},{})},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/utils/dataStructures/stack":127,"cell/value":196}],203:[function(e,t,n){"use strict";function r(e){return e+="",!!(e&&e.length>=2&&"="===e.charAt(0))}function o(e){return!(!e||"'"!==(e+"").charAt(0)||"="!==(e+"").charAt(1))}function i(e){return o(e)?e.substr(1):e}function s(e){var t=/(\\"|"(?:\\"|[^"])*"|(\+))|(\\'|'(?:\\'|[^'])*'|(\+))/g,n=e.match(t)||[],r=-1;return e.toUpperCase().replace(t,function(){return++r,n[r]})}function a(e,t){return function(n){return{row:"row"===e?t:n.row,column:"column"===e?t:n.column}}}Object.defineProperties(n,{isFormulaExpression:{get:function(){return r}},isFormulaExpressionEscaped:{get:function(){return o}},unescapeFormulaExpression:{get:function(){return i}},toUpperCaseFormula:{get:function(){return s}},cellCoordFactory:{get:function(){return a}},__esModule:{value:!0}});var l,u=(l=e("../../browser"),l&&l.__esModule&&l||{default:l}).default;u.utils.FormulasUtils=u.utils.FormulasUtils||{},u.utils.FormulasUtils.isFormulaExpression=r,u.utils.FormulasUtils.isFormulaExpressionEscaped=o,u.utils.FormulasUtils.unescapeFormulaExpression=i,u.utils.FormulasUtils.toUpperCaseFormula=s},{"../../browser":138}],204:[function(e,t,n){"use strict";Object.defineProperties(n,{DateCalculator:{get:function(){return a}},__esModule:{value:!0}});var r,o,i=(r=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),r&&r.__esModule&&r||{default:r}).arrayEach,s=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),o&&o.__esModule&&o||{default:o}).objectEach,a=function(e){this.year=e,this.firstWeekDay="monday",this.weekSectionCount=0,this.monthList=this.calculateMonthData(),this.daysInColumns={},this.calculateWeekStructure()};$traceurRuntime.createClass(a,{setYear:function(e){this.year=e,this.monthList=this.calculateMonthData(),this.calculateWeekStructure()},setFirstWeekDay:function(e){var t=e.toLowerCase();"monday"!==t&&"sunday"!==t&&console.warn("First day of the week must be set to either Monday or Sunday"),this.firstWeekDay=t,this.calculateWeekStructure()},countWeekSections:function(){return this.weekSectionCount},getFirstWeekDay:function(){return this.firstWeekDay},getYear:function(){return this.year},getMonthList:function(){return this.monthList},parseDate:function(e){return e instanceof Date||(e=new Date(e),"Invalid Date"!==e.toString())?e:null},dateToColumn:function(e){if(e=this.parseDate(e),!e||e.getFullYear()!==this.year)return!1;var t=e.getMonth(),n=e.getDate()-1,r=this.daysInColumns[t],o=null;return s(r,function(e,t){if(e.indexOf(n+1)>-1)return o=parseInt(t,10),!1}),o},columnToDate:function(e){var t=null;return s(this.daysInColumns,function(n,r){if(n[e])return t=r,!1}),1===this.daysInColumns[t][e].length?new Date(this.year,t,this.daysInColumns[t][e][0]):this.daysInColumns[t][e]},isOnTheEdgeOfWeek:function(e){if(e=this.parseDate(e),!e)return null;var t=e.getMonth(),n=e.getDate()-1,r=this.daysInColumns[t],o=!1;return s(r,function(e){var t=e.indexOf(n+1);return 0===t?(o=[1,0],!1):t===e.length-1?(o=[0,1],!1):void 0}),o},addDaysToCache:function(e,t,n,r){this.daysInColumns[e]||(this.daysInColumns[e]={}),this.daysInColumns[e][t]||(this.daysInColumns[e][t]=[]);for(var o=n;o<=r;o++)this.daysInColumns[e][t].push(o)},isValidRangeBarData:function(e,t){var n=this.parseDate(e),r=this.parseDate(t);return n&&r&&n.getTime()<=r.getTime()},calculateMonthData:function(){return[{name:"January",days:31},{name:"February",days:new Date(this.year,2,0).getDate()},{name:"March",days:31},{name:"April",days:30},{name:"May",days:31},{name:"June",days:30},{name:"July",days:31},{name:"August",days:31},{name:"September",days:30},{name:"October",days:31},{name:"November",days:30},{name:"December",days:31}]},countMonths:function(){return this.monthList.length},countMonthDays:function(e){return this.monthList[e-1].days},countMonthFullWeeks:function(e){return this.monthList[e-1].fullWeeks},calculateWeekStructure:function(){var e=0,t=0,n=this.getFirstWeekDay(),r=this.getMonthList(),o=this.getYear();"monday"===n&&(e=1),i(r,function(n,r){var i=new Date(o,r,1).getDay();n.daysBeforeFullWeeks=(7-i+e)%7,n.fullWeeks=Math.floor((n.days-n.daysBeforeFullWeeks)/7),n.daysAfterFullWeeks=n.days-n.daysBeforeFullWeeks-7*n.fullWeeks,t+=n.fullWeeks+(n.daysBeforeFullWeeks?1:0)+(n.daysAfterFullWeeks?1:0)}),this.weekSectionCount=t}},{})},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53}],205:[function(e,t,n){"use strict";Object.defineProperties(n,{GanttChart:{get:function(){return M}},__esModule:{value:!0}});var r,o,i,s,a,l,u,d,c,h=(r=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),r&&r.__esModule&&r||{default:r}),f=h.addClass,p=h.removeClass,m=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),o&&o.__esModule&&o||{default:o}),g=m.objectEach,v=m.deepClone,w=m.extend,b=((i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),i&&i.__esModule&&i||{default:i}).arrayEach,(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),s&&s.__esModule&&s||{default:s}).rangeEach,(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/data"),a&&a.__esModule&&a||{default:a}).createEmptySpreadsheetData),y=(l=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins.js"),l&&l.__esModule&&l||{default:l}).registerPlugin,_=(u=e("dateCalculator"),u&&u.__esModule&&u||{default:u}).DateCalculator,C=(d=e("ganttChartDataFeed"),d&&d.__esModule&&d||{default:d}).GanttChartDataFeed,R=(c=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base.js"),c&&c.__esModule&&c||{default:c}).default,M=function(e){$traceurRuntime.superConstructor(E).call(this,e),this.settings={},this.dateCalculator=null,this.currentYear=null,this.monthList=[],this.monthHeadersArray=[],this.weekHeadersArray=[],this.rangeBars={},this.rangeList={},this.nestedHeadersPlugin=null,this.hotSource=null,this.overallWeekSectionCount=null,this.initialSettings=null,this.dataFeed=null,this.colorData={},this.rangeBarMeta=Object.create(null)},E=M;$traceurRuntime.createClass(M,{checkDependencies:function(){this.hot.getSettings().colHeaders||console.warn("You need to enable the colHeaders property in your Gantt Chart Handsontable in order for it to work properly.")},isEnabled:function(){return!!this.hot.getSettings().ganttChart},enablePlugin:function(){var e=this;this.enabled||(this.checkDependencies(),this.parseSettings(),this.currentYear=this.settings.startYear||(new Date).getFullYear(),this.dateCalculator=new _(this.currentYear),this.dateCalculator.setFirstWeekDay(this.settings.firstWeekDay),this.monthList=this.dateCalculator.getMonthList(),this.monthHeadersArray=this.generateMonthHeaders(),this.weekHeadersArray=this.generateWeekHeaders(),
this.overallWeekSectionCount=this.dateCalculator.countWeekSections(),this.assignGanttSettings(),this.nestedHeadersPlugin&&(this.applyDataSource(),this.colorData&&this.setRangeBarColors(this.colorData)),this.addHook("afterInit",function(){return e.onAfterInit()}),f(this.hot.rootElement,"ganttChart"),$traceurRuntime.superGet(this,E.prototype,"enablePlugin").call(this))},disablePlugin:function(){this.internalUpdateSettings||(this.dataFeed&&this.dataFeed.hotSource&&this.dataFeed.removeSourceHotHooks(this.dataFeed.hotSource),this.settings={},this.dataFeed={},this.currentYear=null,this.monthList=[],this.rangeBars={},this.rangeList={},this.rangeBarMeta={},this.hotSource=null,this.deassignGanttSettings(),this.hot.getPlugin("collapsibleColumns").disablePlugin(),this.hot.getPlugin("nestedHeaders").disablePlugin(),p(this.hot.rootElement,"ganttChart"),$traceurRuntime.superGet(this,E.prototype,"disablePlugin").call(this))},updatePlugin:function(){this.disablePlugin(),this.enablePlugin(),$traceurRuntime.superGet(this,E.prototype,"updatePlugin").call(this)},parseSettings:function(){this.settings=this.hot.getSettings().ganttChart,"boolean"==typeof this.settings&&(this.settings={}),this.settings.firstWeekDay||(this.settings.firstWeekDay="monday")},applyDataSource:function(){if(this.settings.dataSource){var e=this.settings.dataSource;e.instance?this.loadData(e.instance,e.startDateColumn,e.endDateColumn,e.additionalData,e.asyncUpdates):this.loadData(e)}},loadData:function(e,t,n,r,o){e.length>1&&this.hot.alter("insert_row",0,e.length-1),this.dataFeed=new C(this.hot,e,t,n,r,o),this.hot.render()},clearRangeBars:function(){this.rangeBars={}},clearRangeList:function(){this.rangeList={}},getRangeBarCoordinates:function(e){return this.rangeList[e]},generateHeaderSet:function(e){var t=this,n=[];return g(this.monthList,function(r,o){var i=r.daysBeforeFullWeeks>0?1:0,s=r.daysAfterFullWeeks>0?1:0,a=r.fullWeeks+i+s,l=parseInt(o,10);if("months"===e)n.push({label:r.name,colspan:a});else if("weeks"===e)for(var u=0;u<a;u++)if(i&&0===u){var d=u+1,c=r.daysBeforeFullWeeks;d===c?n.push(d):n.push(d+" - "+c),t.dateCalculator.addDaysToCache(l,n.length-1,d,c)}else if(s&&u===a-1){var h=r.days-r.daysAfterFullWeeks+1,f=r.days;h===f?n.push(h):n.push(h+" - "+f),t.dateCalculator.addDaysToCache(l,n.length-1,h,f)}else{var p=r.daysBeforeFullWeeks+7*(u-i)+1,m=p+6;n.push(p+" - "+m),t.dateCalculator.addDaysToCache(l,n.length-1,p,m)}else if("days"===e)for(var g=0;g<r.days;g++)n.push(g+1)}),n},generateMonthHeaders:function(){return this.generateHeaderSet("months")},generateWeekHeaders:function(){return this.generateHeaderSet("weeks")},generateDayHeaders:function(){return this.generateHeaderSet("days")},assignGanttSettings:function(){var e=this;this.initialSettings=v(this.hot.getSettings());var t={data:b(1,this.overallWeekSectionCount),readOnly:!0,renderer:function(t,n,r,o,i,s,a){return e.uniformBackgroundRenderer(t,n,r,o,i,s,a)},colWidths:60,hiddenColumns:!0,nestedHeaders:[this.monthHeadersArray.slice(),this.weekHeadersArray.slice()],collapsibleColumns:!0,columnSorting:!1};this.internalUpdateSettings=!0,this.hot.updateSettings(t),this.internalUpdateSettings=void 0},deassignGanttSettings:function(){this.internalUpdateSettings=!0,this.initialSettings&&this.hot.updateSettings(this.initialSettings),this.internalUpdateSettings=void 0},cacheRangeBarMeta:function(e,t,n,r){this.rangeBarMeta[e]||(this.rangeBarMeta[e]={}),this.rangeBarMeta[e][t]||(this.rangeBarMeta[e][t]={}),this.rangeBarMeta[e][t][n]=r},applyRangeBarMetaCache:function(){var e=this;g(this.rangeBarMeta,function(t,n){g(t,function(t,r){g(t,function(t,o){e.hot.setCellMeta(n,r,o,t)})})})},addRangeBar:function(e,t,n,r){var o=this,i=this.dateCalculator.dateToColumn(t),s=this.dateCalculator.dateToColumn(n);return!(!this.dateCalculator.isValidRangeBarData(t,n)||null==i||null==s)&&(this.rangeBars[e]||(this.rangeBars[e]={}),this.rangeBars[e][i]={barLength:s-i+1,partialStart:!this.dateCalculator.isOnTheEdgeOfWeek(t)[0],partialEnd:!this.dateCalculator.isOnTheEdgeOfWeek(n)[1],additionalData:{}},g(r,function(t,n){o.rangeBars[e][i].additionalData[n]=t}),this.colorData[e]&&(this.rangeBars[e][i].colors=this.colorData[e]),this.rangeList[e]=[e,i],this.renderRangeBar(e,i,s,r),[e,i])},getRangeBarData:function(e,t){var n=this.getRangeBarCoordinates(e);if(!n)return!1;var r=this.rangeBars[n[0]][n[1]];return!(!r||e!==n[0]||!(t===n[1]||t>n[1]&&t<n[1]+r.barLength))&&r},updateRangeBarData:function(e,t,n){var r=this.getRangeBarData(e,t);g(n,function(e,t){r[t]!==e&&(r[t]=e)})},renderRangeBar:function(e,t,n,r){for(var o=this.rangeBars[e][t],i=t;i<=n;i++){var s=this.hot.getCellMeta(e,i),a=(s.className||"")+" rangeBar";(i===t&&o.partialStart||i===n&&o.partialEnd)&&(a+=" partial"),i===n&&(a+=" last"),this.hot.setCellMeta(e,i,"originalClassName",s.className),this.hot.setCellMeta(e,i,"className",a),this.hot.setCellMeta(e,i,"additionalData",o.additionalData),this.cacheRangeBarMeta(e,i,"originalClassName",s.className),this.cacheRangeBarMeta(e,i,"className",a),this.cacheRangeBarMeta(e,i,"additionalData",o.additionalData)}},removeRangeBarByDate:function(e,t){var n=this.dateCalculator.dateToColumn(t);this.removeRangeBarByColumn(e,n)},removeRangeBarByColumn:function(e,t){var n=this,r=this.rangeBars[e][t];r&&(this.unrenderRangeBar(e,t,t+r.barLength-1),this.rangeBars[e][t]=null,g(this.rangeList,function(r,o){o=parseInt(o,10),JSON.stringify(r)===JSON.stringify([e,t])&&(n.rangeList[o]=null)}))},removeAllRangeBars:function(){var e=this;g(this.rangeBars,function(t,n){g(t,function(t,r){e.removeRangeBarByColumn(n,r)})})},unrenderRangeBar:function(e,t,n){for(var r=t;r<=n;r++){var o=this.hot.getCellMeta(e,r);this.hot.setCellMeta(e,r,"className",o.originalClassName),this.hot.setCellMeta(e,r,"originalClassName",void 0),this.cacheRangeBarMeta(e,r,"className",o.originalClassName),this.cacheRangeBarMeta(e,r,"originalClassName",void 0)}this.hot.render()},uniformBackgroundRenderer:function(e,t,n,r,o,i,s){var a=this.getRangeBarData(n,r),l=this.getRangeBarCoordinates(n);s.className&&(t.className=s.className);var u="";g(s.additionalData,function(e,t){u+=t+": "+e+"\n"}),u=u.replace(/\n$/,""),t.title=u,a&&a.colors?r===l[1]&&a.partialStart||r===l[1]+a.barLength-1&&a.partialEnd?t.style.background=a.colors[1]:t.style.background=a.colors[0]:t.style.background=""},setRangeBarColors:function(e){var t=this;this.colorData=e,g(e,function(e,n){var r=t.getRangeBarCoordinates(n);r&&t.updateRangeBarData(r[0],r[1],{colors:e})}),this.hot.render()},setYear:function(e){var t=w(this.hot.getSettings().ganttChart,{startYear:e});this.hot.updateSettings({ganttChart:t})},onAfterInit:function(){this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.applyDataSource()},onUpdateSettings:function(){return this.internalUpdateSettings?void this.applyRangeBarMetaCache():void $traceurRuntime.superGet(this,E.prototype,"onUpdateSettings").call(this)},destroy:function(){this.hotSource&&this.dataFeed.removeSourceHotHooks(this.hotSource),$traceurRuntime.superGet(this,E.prototype,"destroy").call(this)}},{},R),y("ganttChart",M)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/data":45,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins.js":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base.js":63,dateCalculator:204,ganttChartDataFeed:206}],206:[function(e,t,n){"use strict";Object.defineProperties(n,{GanttChartDataFeed:{get:function(){return u}},__esModule:{value:!0}});var r,o,i,s=(r=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),r&&r.__esModule&&r||{default:r}),a=s.objectEach,l=(s.deepClone,(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),o&&o.__esModule&&o||{default:o}).arrayEach),u=((i=e("dateCalculator"),i&&i.__esModule&&i||{default:i}).DateCalculator,function(e,t,n,r,o,i){this.data=t,this.chartInstance=e,this.chartPlugin=this.chartInstance.getPlugin("ganttChart"),this.hotSource=null,this.sourceHooks={},this.ongoingAsync=!1,this.applyData(t,n,r,o,i||!1)});$traceurRuntime.createClass(u,{applyData:function(e,t,n,r,o){"[object Array]"===Object.prototype.toString.call(e)?this.loadData(e):e.guid&&this.bindWithHotInstance(e,t,n,r,o)},bindWithHotInstance:function(e,t,n,r,o){this.hotSource={instance:e,startColumn:t,endColumn:n,additionalData:r,asyncUpdates:o},this.addSourceHotHooks(),this.asyncCall(this.updateFromSource)},asyncCall:function(e){var t=this;return this.hotSource.asyncUpdates?(this.asyncStart(),void setTimeout(function(){e.call(t),t.asyncEnd()},0)):void e.call(this)},asyncStart:function(){this.ongoingAsync=!0},asyncEnd:function(){this.ongoingAsync=!1},addSourceHotHooks:function(){var e=this;this.sourceHooks={afterLoadData:function(t){return e.onAfterSourceLoadData(t)},afterChange:function(t,n){return e.onAfterSourceChange(t,n)},afterColumnSort:function(t,n){return e.onAfterColumnSort(t,n)}},this.hotSource.instance.addHook("afterLoadData",this.sourceHooks.afterLoadData),this.hotSource.instance.addHook("afterChange",this.sourceHooks.afterChange),this.hotSource.instance.addHook("afterColumnSort",this.sourceHooks.afterColumnSort)},removeSourceHotHooks:function(e){this.sourceHooks.afterLoadData&&e.instance.removeHook("afterLoadData",this.sourceHooks.afterLoadData),this.sourceHooks.afterChange&&e.instance.removeHook("afterChange",this.sourceHooks.afterChange),this.sourceHooks.afterColumnSort&&e.instance.removeHook("afterColumnSort",this.sourceHooks.afterColumnSort)},getDataFromSource:function(e){var t,n={},r=this.hotSource,o=[];void 0===e?t=r.instance.getData(0,0,r.instance.countRows()-1,r.instance.countCols()-1):(t=[],t[e]=r.instance.getDataAtRow(e));var i,s=function(e,i){n={};var s=t[e];return null===s[r.startColumn]||""===s[r.startColumn]?0:(a(r.additionalData,function(e,t){n[t]=s[e]}),void o.push([e,s[r.startColumn],s[r.endColumn],n,e]))};e:for(var l=e||0,u=t.length;l<(e?e+1:u);l++)switch(i=s(l,u)){case 0:continue e}return o},updateFromSource:function(e){var t=this,n=this.getDataFromSource(e);!e&&isNaN(e)&&(this.chartPlugin.clearRangeBars(),this.chartPlugin.clearRangeList()),l(n,function(e){e=t.trimRangeIfNeeded(e),t.chartPlugin.addRangeBar.apply(t.chartPlugin,e)})},loadData:function(e){var t=this;l(e,function(e,n){e=t.trimRangeIfNeeded(e),t.chartPlugin.addRangeBar(n,e.startDate,e.endDate,e.additionalData)})},trimRangeIfNeeded:function(e){var t=null;t=e[1]?{startDate:1,endDate:2}:{startDate:"startDate",endDate:"endDate"};var n=new Date(e[t.startDate]),r=new Date(e[t.endDate]);if("string"==typeof n||"string"==typeof r)return!1;var o=n.getFullYear(),i=r.getFullYear();return o<this.chartPlugin.currentYear&&i>=this.chartPlugin.currentYear&&(e[t.startDate]="01/01/"+this.chartPlugin.currentYear),i>this.chartPlugin.currentYear&&o<=this.chartPlugin.currentYear&&(e[t.endDate]="12/31/"+this.chartPlugin.currentYear),e},onAfterSourceChange:function(e,t){var n=this;this.asyncCall(function(){if(e){for(var t={},r=0,o=e.length;r<o;r++){var i=e[r],s=parseInt(i[0],10),l=parseInt(i[1],10);t[s]||(t[s]={}),t[s][l]=[i[2],i[3]]}a(t,function(e,t){t=parseInt(t,10),n.chartPlugin.getRangeBarCoordinates(t)&&n.chartPlugin.removeRangeBarByColumn(t,n.chartPlugin.rangeList[t][1]),n.updateFromSource(t)})}})},onAfterSourceLoadData:function(e){var t=this;this.asyncCall(function(e){t.chartPlugin.removeAllRangeBars(),t.updateFromSource()})},onAfterColumnSort:function(e,t){var n=this;this.asyncCall(function(){n.chartPlugin.removeAllRangeBars(),n.updateFromSource()})}},{})},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,dateCalculator:204}],207:[function(e,t,n){"use strict";Object.defineProperties(n,{HeaderTooltips:{get:function(){return c}},__esModule:{value:!0}});var r,o,i,s,a=(r=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element.js"),r&&r.__esModule&&r||{default:r}).outerWidth,l=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins.js"),o&&o.__esModule&&o||{default:o}).registerPlugin,u=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),i&&i.__esModule&&i||{default:i}).rangeEach,d=(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base.js"),s&&s.__esModule&&s||{default:s}).default,c=function(e){$traceurRuntime.superConstructor(h).call(this,e),this.settings=null},h=c;$traceurRuntime.createClass(c,{isEnabled:function(){return!!this.hot.getSettings().headerTooltips},enablePlugin:function(){var e=this;this.enabled||(this.settings=this.hot.getSettings().headerTooltips,this.parseSettings(),this.addHook("afterGetColHeader",function(t,n){return e.onAfterGetHeader(t,n)}),this.addHook("afterGetRowHeader",function(t,n){return e.onAfterGetHeader(t,n)}),$traceurRuntime.superGet(this,h.prototype,"enablePlugin").call(this))},disablePlugin:function(){this.settings=null,this.clearTitleAttributes(),$traceurRuntime.superGet(this,h.prototype,"disablePlugin").call(this)},parseSettings:function(){"boolean"==typeof this.settings&&(this.settings={rows:!0,columns:!0,onlyTrimmed:!1})},clearTitleAttributes:function(){var e=this.hot.view.wt.getSetting("columnHeaders").length,t=this.hot.view.wt.wtTable.THEAD,n=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null;u(0,e-1,function(e){var o=t.childNodes[e],i=n.childNodes[e],s=r?r.childNodes[e]:null;u(0,o.childNodes.length-1,function(e){o.childNodes[e].removeAttribute("title"),i&&i.childNodes[e]&&i.childNodes[e].removeAttribute("title"),r&&s&&s.childNodes[e]&&s.childNodes[e].removeAttribute("title")})},!0)},onAfterGetHeader:function(e,t){var n=t.querySelector("span"),r="THEAD"===t.parentNode.parentNode.nodeName;(r&&this.settings.columns||!r&&this.settings.rows)&&(this.settings.onlyTrimmed?a(n)>=a(t)&&0!==a(n)&&t.setAttribute("title",n.textContent):t.setAttribute("title",n.textContent))},destroy:function(){this.settings=null,$traceurRuntime.superGet(this,h.prototype,"destroy").call(this)}},{},d),l("headerTooltips",c)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element.js":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins.js":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base.js":63}],208:[function(e,t,n){"use strict";function r(e){return{key:"hidden_columns_hide",name:"Hide column",callback:function(){var t=this.getSelectedRange(),n=t.from,r=t.to,o=Math.min(n.col,r.col),s=Math.max(n.col,r.col);i(o,s,function(t){return e.hideColumn(t)}),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!this.selection.selectedHeader.cols}}}Object.defineProperties(n,{hideColumnItem:{get:function(){return r}},__esModule:{value:!0}});var o,i=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),o&&o.__esModule&&o||{default:o}).rangeEach},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52}],209:[function(e,t,n){"use strict";function r(e){var t=[],n=[];return{key:"hidden_columns_show",name:"Show column",callback:function(){var r=this.getSelectedRange(),o=r.from,s=r.to,a=Math.min(o.col,s.col),l=Math.max(o.col,s.col);a===l?(t.length===a&&(e.showColumns(t),t.length=0),n.length===this.countSourceCols()-(a+1)&&(e.showColumns(n),n.length=0)):i(a,l,function(t){return e.showColumn(t)}),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){if(!e.hiddenColumns.length||!this.selection.selectedHeader.cols)return!0;t.length=0,n.length=0;var r=this.getSelectedRange(),o=r.from,s=r.to,a=Math.min(o.col,s.col),l=Math.max(o.col,s.col),u=!1;if(a===l){var d=this.countSourceCols();i(0,d,function(r){var o=t.length+n.length;return o!==e.hiddenColumns.length&&void(r<a&&e.isHidden(r)?t.push(r):e.isHidden(r)&&n.push(r))}),d-=1,(t.length===a&&a>0||n.length===d-a&&a<d)&&(u=!0)}else i(a,l,function(t){if(e.isHidden(t))return u=!0,!1});return!u}}}Object.defineProperties(n,{showColumnItem:{get:function(){return r}},__esModule:{value:!0}});var o,i=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),o&&o.__esModule&&o||{default:o}).rangeEach},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52}],210:[function(e,t,n){"use strict";function r(e,t){t.textContent=""}Object.defineProperties(n,{HiddenColumns:{get:function(){return C}},__esModule:{value:!0}});var o,i,s,a,l,u,d,c,h=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),o&&o.__esModule&&o||{default:o}).default,f=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),i&&i.__esModule&&i||{default:i}),p=f.addClass,m=(f.removeClass,(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),s&&s.__esModule&&s||{default:s}).rangeEach),g=(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),a&&a.__esModule&&a||{default:a}).arrayEach,v=(l=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),l&&l.__esModule&&l||{default:l}),w=v.registerPlugin,b=(v.getPlugin,(u=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems"),u&&u.__esModule&&u||{default:u}).SEPARATOR),y=(d=e("contextMenuItem/hideColumn"),d&&d.__esModule&&d||{default:d}).hideColumnItem,_=(c=e("contextMenuItem/showColumn"),c&&c.__esModule&&c||{default:c}).showColumnItem,C=function(e){$traceurRuntime.superConstructor(R).call(this,e),this.settings={},this.hiddenColumns=[],this.lastSelectedColumn=-1},R=C;$traceurRuntime.createClass(C,{isEnabled:function(){return!!this.hot.getSettings().hiddenColumns},enablePlugin:function(){var e=this;this.enabled||(this.hot.hasColHeaders()?this.addHook("afterGetColHeader",function(t,n){return e.onAfterGetColHeader(t,n)}):this.addHook("afterRenderer",function(t,n,r){return e.onAfterGetColHeader(r,t)}),this.addHook("afterContextMenuDefaultOptions",function(t){return e.onAfterContextMenuDefaultOptions(t)}),this.addHook("afterGetCellMeta",function(t,n,r){return e.onAfterGetCellMeta(t,n,r)}),this.addHook("modifyColWidth",function(t,n){return e.onModifyColWidth(t,n)}),this.addHook("beforeSetRangeStartOnly",function(t){return e.onBeforeSetRangeStart(t)}),this.addHook("beforeSetRangeEnd",function(t){return e.onBeforeSetRangeEnd(t)}),this.addHook("hiddenColumn",function(t){return e.isHidden(t)}),this.addHook("beforeStretchingColumnWidth",function(t,n){return e.onBeforeStretchingColumnWidth(t,n)}),this.addHook("afterCreateCol",function(t,n){return e.onAfterCreateCol(t,n)}),this.addHook("afterRemoveCol",function(t,n){return e.onAfterRemoveCol(t,n)}),this.hot.view&&this.onAfterPluginsInitialized(),$traceurRuntime.superGet(this,R.prototype,"enablePlugin").call(this))},updatePlugin:function(){this.disablePlugin(),this.enablePlugin(),$traceurRuntime.superGet(this,R.prototype,"updatePlugin").call(this)},disablePlugin:function(){this.settings={},this.hiddenColumns=[],this.lastSelectedColumn=-1,this.hot.render(),$traceurRuntime.superGet(this,R.prototype,"disablePlugin").call(this),this.resetCellsMeta()},showColumns:function(e){var t=this;g(e,function(e){e=parseInt(e,10),e=t.getLogicalColumnIndex(e),t.isHidden(e,!0)&&t.hiddenColumns.splice(t.hiddenColumns.indexOf(e),1)})},showColumn:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.showColumns(e)},hideColumns:function(e){var t=this;g(e,function(e){e=parseInt(e,10),e=t.getLogicalColumnIndex(e),t.isHidden(e,!0)||t.hiddenColumns.push(e)})},hideColumn:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.hideColumns(e)},isHidden:function(e){var t=void 0!==arguments[1]&&arguments[1];return t||(e=this.getLogicalColumnIndex(e)),this.hiddenColumns.indexOf(e)>-1},resetCellsMeta:function(){g(this.hot.getCellsMeta(),function(e){e&&(e.skipColumnOnPaste=!1,null!==e.baseRenderer&&(e.renderer=e.baseRenderer,e.baseRenderer=null))})},getLogicalColumnIndex:function(e){return this.hot.runHooks("modifyCol",e)},onBeforeStretchingColumnWidth:function(e,t){return this.isHidden(t)&&(e=0),e},onModifyColWidth:function(e,t){return this.isHidden(t)?.1:this.settings.indicators&&(this.isHidden(t+1)||this.isHidden(t-1))?e+(this.hot.hasColHeaders()?15:0):void 0},onAfterGetCellMeta:function(e,t,n){if(t=this.hot.runHooks("unmodifyCol",t),this.settings.copyPasteEnabled===!1&&this.isHidden(t)&&(n.skipColumnOnPaste=!0),this.isHidden(t)?(n.renderer!==r&&(n.baseRenderer=n.renderer),n.renderer=r):null!==n.baseRenderer&&(n.renderer=n.baseRenderer,n.baseRenderer=null),this.isHidden(n.visualCol-1)){var o=!0,i=n.visualCol-1;n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");do{if(!this.isHidden(i)){o=!1;break}i--}while(i>=0);o&&n.className.indexOf("firstVisibleColumn")===-1&&(n.className+=" firstVisibleColumn")}else if(n.className){var s=n.className.split(" ");if(s.length){var a=s.indexOf("afterHiddenColumn"),l=s.indexOf("firstVisibleColumn");a>-1&&s.splice(a,1),l>-1&&s.splice(l,1),n.className=s.join(" ")}}},onModifyCopyableRange:function(e){var t=this,n=[],r=function(e,t,r,o){n.push({startRow:e,endRow:t,startCol:r,endCol:o})};return g(e,function(e){var n=!0,o=0;m(e.startCol,e.endCol,function(i){t.isHidden(i)?(n||r(e.startRow,e.endRow,o,i-1),n=!0):(n&&(o=i),i===e.endCol&&r(e.startRow,e.endRow,o,i),n=!1)})}),n},onAfterGetColHeader:function(e,t){if(!this.isHidden(e)){var n=!0,r=e-1;do{if(!this.isHidden(r)){n=!1;break}r--}while(r>=0);n&&p(t,"firstVisibleColumn"),this.settings.indicators&&(this.isHidden(e-1)&&p(t,"afterHiddenColumn"),this.isHidden(e+1)&&e>-1&&p(t,"beforeHiddenColumn"))}},onBeforeSetRangeStart:function(e){var t=this;if(!(e.col>0)){e.col=0;var n=function(e){var r=t.getLogicalColumnIndex(e);return t.isHidden(r,!0)&&(e=n(++e)),e};e.col=n(e.col)}},onBeforeSetRangeEnd:function(e){var t=this,n=this.hot.countCols(),r=function(o){var i=t.getLogicalColumnIndex(o);return t.isHidden(i,!0)&&(t.lastSelectedColumn>o||e.col===n-1?o>0?o=r(--o):m(0,t.lastSelectedColumn,function(e){if(!t.isHidden(e))return o=e,!1}):o=r(++o)),o};e.col=r(e.col),this.lastSelectedColumn=e.col},onAfterContextMenuDefaultOptions:function(e){e.items.push({name:b},y(this),_(this))},onAfterCreateCol:function(e,t){var n=[];g(this.hiddenColumns,function(r){r>=e&&(r+=t),n.push(r)}),this.hiddenColumns=n},onAfterRemoveCol:function(e,t){var n=[];g(this.hiddenColumns,function(r){r>=e&&(r-=t),n.push(r)}),this.hiddenColumns=n},onAfterPluginsInitialized:function(){var e=this,t=this.hot.getSettings().hiddenColumns;"object"==typeof t&&(this.settings=t,void 0===t.copyPasteEnabled&&(t.copyPasteEnabled=!0),Array.isArray(t.columns)&&this.hideColumns(t.columns),t.copyPasteEnabled||this.addHook("modifyCopyableRange",function(t){return e.onModifyCopyableRange(t)}))},destroy:function(){$traceurRuntime.superGet(this,R.prototype,"destroy").call(this)}},{},h),w("hiddenColumns",C)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/contextMenu/predefinedItems":75,"contextMenuItem/hideColumn":208,"contextMenuItem/showColumn":209}],211:[function(e,t,n){"use strict";function r(e){return{key:"hidden_rows_hide",name:"Hide row",callback:function(){var t=this.getSelectedRange(),n=t.from,r=t.to,o=Math.min(n.row,r.row),s=Math.max(n.row,r.row);i(o,s,function(t){return e.hideRow(t)}),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){return!this.selection.selectedHeader.rows}}}Object.defineProperties(n,{hideRowItem:{get:function(){return r}},__esModule:{value:!0}});var o,i=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),o&&o.__esModule&&o||{default:o}).rangeEach},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52}],212:[function(e,t,n){"use strict";function r(e){var t=[],n=[];return{key:"hidden_rows_show",name:"Show row",callback:function(){var r=this.getSelectedRange(),o=r.from,s=r.to,a=Math.min(o.row,s.row),l=Math.max(o.row,s.row);a===l?(t.length===a&&(e.showRows(t),t.length=0),n.length===this.countSourceRows()-(a+1)&&(e.showRows(n),n.length=0)):i(a,l,function(t){return e.showRow(t)}),this.render(),this.view.wt.wtOverlays.adjustElementsSize(!0)},disabled:!1,hidden:function(){if(!e.hiddenRows.length||!this.selection.selectedHeader.rows)return!0;t.length=0,n.length=0;var r=this.getSelectedRange(),o=r.from,s=r.to,a=Math.min(o.row,s.row),l=Math.max(o.row,s.row),u=!1;if(a===l){var d=this.countSourceRows();i(0,d,function(r){var o=t.length+n.length;return o!==e.hiddenRows.length&&void(r<a?e.isHidden(r)&&t.push(r):e.isHidden(r)&&n.push(r))}),d-=1,(t.length===a&&a>0||n.length===d-a&&a<d)&&(u=!0)}else i(a,l,function(t){if(e.isHidden(t))return u=!0,!1});return!u}}}Object.defineProperties(n,{showRowItem:{get:function(){return r}},__esModule:{value:!0}});var o,i=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),o&&o.__esModule&&o||{default:o}).rangeEach},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52}],213:[function(e,t,n){"use strict";Object.defineProperties(n,{HiddenRows:{get:function(){return _}},__esModule:{value:!0}});var r,o,i,s,a,l,u,d=(r=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),r&&r.__esModule&&r||{default:r}).default,c=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),o&&o.__esModule&&o||{default:o}),h=c.addClass,f=c.removeClass,p=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),i&&i.__esModule&&i||{default:i}).rangeEach,m=(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),s&&s.__esModule&&s||{default:s}),g=m.arrayEach,v=(m.arrayFilter,a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),a&&a.__esModule&&a||{default:a}),w=v.registerPlugin,b=(v.getPlugin,(l=e("contextMenuItem/hideRow"),l&&l.__esModule&&l||{default:l}).hideRowItem),y=(u=e("contextMenuItem/showRow"),u&&u.__esModule&&u||{default:u}).showRowItem,_=function(e){$traceurRuntime.superConstructor(C).call(this,e),this.settings={},this.hiddenRows=[],this.lastSelectedRow=-1},C=_;$traceurRuntime.createClass(_,{isEnabled:function(){return!!this.hot.getSettings().hiddenRows},enablePlugin:function(){var e=this;this.enabled||(this.hot.hasRowHeaders()?this.addHook("afterGetRowHeader",function(t,n){return e.onAfterGetRowHeader(t,n)}):this.addHook("afterRenderer",function(t,n){return e.onAfterGetRowHeader(n,t)}),this.addHook("afterContextMenuDefaultOptions",function(t){return e.onAfterContextMenuDefaultOptions(t)}),this.addHook("afterGetCellMeta",function(t,n,r){return e.onAfterGetCellMeta(t,n,r)}),this.addHook("modifyRowHeight",function(t,n){return e.onModifyRowHeight(t,n)}),this.addHook("beforeSetRangeStartOnly",function(t){return e.onBeforeSetRangeStartOnly(t)}),this.addHook("beforeSetRangeStart",function(t){return e.onBeforeSetRangeStart(t)}),this.addHook("beforeSetRangeEnd",function(t){return e.onBeforeSetRangeEnd(t)}),this.addHook("hiddenRow",function(t){return e.isHidden(t)}),this.addHook("afterCreateRow",function(t,n){return e.onAfterCreateRow(t,n)}),this.addHook("afterRemoveRow",function(t,n){return e.onAfterRemoveRow(t,n)}),this.hot.view&&this.onAfterPluginsInitialized(),$traceurRuntime.superGet(this,C.prototype,"enablePlugin").call(this))},updatePlugin:function(){this.disablePlugin(),this.enablePlugin(),this.onAfterPluginsInitialized(),$traceurRuntime.superGet(this,C.prototype,"updatePlugin").call(this)},disablePlugin:function(){this.settings={},this.hiddenRows=[],this.lastSelectedRow=-1,$traceurRuntime.superGet(this,C.prototype,"disablePlugin").call(this),this.resetCellsMeta()},showRows:function(e){var t=this;g(e,function(e){e=parseInt(e,10),e=t.getLogicalRowIndex(e),t.isHidden(e,!0)&&t.hiddenRows.splice(t.hiddenRows.indexOf(e),1)})},showRow:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.showRows(e)},hideRows:function(e){var t=this;g(e,function(e){e=parseInt(e,10),e=t.getLogicalRowIndex(e),t.isHidden(e,!0)||t.hiddenRows.push(e)})},hideRow:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.hideRows(e)},isHidden:function(e){var t=void 0!==arguments[1]&&arguments[1];return t||(e=this.getLogicalRowIndex(e)),this.hiddenRows.indexOf(e)>-1},resetCellsMeta:function(){g(this.hot.getCellsMeta(),function(e){e&&(e.skipRowOnPaste=!1)})},getLogicalRowIndex:function(e){return this.hot.runHooks("modifyRow",e)},onAfterGetCellMeta:function(e,t,n){if(e=this.hot.runHooks("unmodifyRow",e),this.settings.copyPasteEnabled===!1&&this.isHidden(e)?n.skipRowOnPaste=!0:n.skipRowOnPaste=!1,this.isHidden(e-1)){var r=!0,o=e-1;n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");do{if(!this.isHidden(o)){r=!1;break}o--}while(o>=0);r&&n.className.indexOf("firstVisibleRow")===-1&&(n.className+=" firstVisibleRow")}else if(n.className){var i=n.className.split(" ");if(i.length){var s=i.indexOf("afterHiddenRow"),a=i.indexOf("firstVisibleRow");s>-1&&i.splice(s,1),a>-1&&i.splice(a,1),n.className=i.join(" ")}}},onAfterGetRowHeader:function(e,t){var n=t.parentNode;n&&(this.isHidden(e)?h(n,"hide"):f(n,"hide"));var r=!0,o=e-1;do{if(!this.isHidden(o)){r=!1;break}o--}while(o>=0);r&&h(t,"firstVisibleRow"),this.settings.indicators&&this.hot.hasRowHeaders()&&(this.isHidden(e-1)&&h(t,"afterHiddenRow"),this.isHidden(e+1)&&h(t,"beforeHiddenRow"))},onModifyRowHeight:function(e,t){return this.isHidden(t)?.1:e},onModifyCopyableRange:function(e){var t=this,n=[],r=function(e,t,r,o){n.push({startRow:e,endRow:t,startCol:r,endCol:o})};return g(e,function(e){var n=!0,o=0;p(e.startRow,e.endRow,function(i){t.isHidden(i)?(n||r(o,i-1,e.startCol,e.endCol),n=!0):(n&&(o=i),i===e.endRow&&r(o,i,e.startCol,e.endCol),n=!1)})}),n},onBeforeSetRangeStart:function(e){var t=this,n=this.hot.getSelected()||!1,r=this.hot.countRows()-1,o=function(e){var i=0;return n&&(i=e>n[0]?1:-1,t.lastSelectedRow=n[0]),r<e||e<0?t.lastSelectedRow:(t.isHidden(e)&&(e=o(e+i)),e)};e.row=o(e.row)},onBeforeSetRangeStartOnly:function(e){var t=this;if(!(e.row>0)){e.row=0;var n=function(e){return t.isHidden(e)&&(e=n(++e)),e};e.row=n(e.row)}},onBeforeSetRangeEnd:function(e){var t=this,n=this.hot.countRows(),r=function(o){return t.isHidden(o)&&(t.lastSelectedRow>o||e.row===n-1?o>0?o=r(--o):p(0,t.lastSelectedRow,function(e){if(!t.isHidden(e))return o=e,!1}):o=r(++o)),o};e.row=r(e.row),this.lastSelectedRow=e.row},onAfterContextMenuDefaultOptions:function(e){e.items.push(Handsontable.plugins.ContextMenu.SEPARATOR,b(this),y(this))},onAfterCreateRow:function(e,t){var n=[];g(this.hiddenRows,function(r){r>=e&&(r+=t),n.push(r)}),this.hiddenRows=n},onAfterRemoveRow:function(e,t){var n=[];g(this.hiddenRows,function(r){r>=e&&(r-=t),n.push(r)}),this.hiddenRows=n},onAfterPluginsInitialized:function(){
var e=this,t=this.hot.getSettings().hiddenRows;"object"==typeof t&&(this.settings=t,void 0===t.copyPasteEnabled&&(t.copyPasteEnabled=!0),Array.isArray(t.rows)&&this.hideRows(t.rows),t.copyPasteEnabled||this.addHook("modifyCopyableRange",function(t){return e.onModifyCopyableRange(t)}))},destroy:function(){$traceurRuntime.superGet(this,C.prototype,"destroy").call(this)}},{},d),w("hiddenRows",_)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,"contextMenuItem/hideRow":211,"contextMenuItem/showRow":212}],214:[function(e,t,n){"use strict";Object.defineProperties(n,{NestedHeaders:{get:function(){return R}},__esModule:{value:!0}});var r,o,i,s,a,l,u,d=(r=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),r&&r.__esModule&&r||{default:r}),c=d.addClass,h=d.removeClass,f=d.hasClass,p=d.fastInnerHTML,m=d.empty,g=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),o&&o.__esModule&&o||{default:o}).rangeEach,v=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),i&&i.__esModule&&i||{default:i}).arrayEach,w=(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),s&&s.__esModule&&s||{default:s}).objectEach,b=(a=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),a&&a.__esModule&&a||{default:a}),y=b.registerPlugin,_=(b.getPlugin,(l=e("utils/ghostTable"),l&&l.__esModule&&l||{default:l}).GhostTable),C=(u=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),u&&u.__esModule&&u||{default:u}).default,R=function(e){$traceurRuntime.superConstructor(M).call(this,e),this.settings=[],this.columnHeaderLevelCount=0,this.colspanArray=[],this.ghostTable=new _(this)},M=R;$traceurRuntime.createClass(R,{isEnabled:function(){return!!this.hot.getSettings().nestedHeaders},enablePlugin:function(){var e=this;this.enabled||(this.settings=this.hot.getSettings().nestedHeaders,this.addHook("afterGetColumnHeaderRenderers",function(t){return e.onAfterGetColumnHeaderRenderers(t)}),this.addHook("afterInit",function(){return e.onAfterInit()}),this.addHook("afterOnCellMouseDown",function(t,n,r){return e.onAfterOnCellMouseDown(t,n,r)}),this.addHook("beforeOnCellMouseOver",function(t,n,r,o){return e.onBeforeOnCellMouseOver(t,n,r,o)}),this.addHook("afterViewportColumnCalculatorOverride",function(t){return e.onAfterViewportColumnCalculatorOverride(t)}),this.addHook("modifyColWidth",function(t,n){return e.onModifyColWidth(t,n)}),this.setupColspanArray(),this.checkForFixedColumnsCollision(),this.columnHeaderLevelCount=this.hot.view?this.hot.view.wt.getSetting("columnHeaders").length:0,$traceurRuntime.superGet(this,M.prototype,"enablePlugin").call(this))},disablePlugin:function(){this.clearColspans(),this.settings=[],this.columnHeaderLevelCount=0,this.colspanArray=[],this.ghostTable.clear(),$traceurRuntime.superGet(this,M.prototype,"disablePlugin").call(this)},updatePlugin:function(){this.disablePlugin(),this.enablePlugin(),$traceurRuntime.superGet(this,M.prototype,"updatePlugin").call(this),this.ghostTable.buildWidthsMapper()},clearColspans:function(){if(this.hot.view)for(var e=this.hot.view.wt.getSetting("columnHeaders").length,t=this.hot.view.wt.wtTable.THEAD,n=this.hot.view.wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view.wt.wtOverlays.topLeftCornerOverlay?this.hot.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.THEAD:null,o=0;o<e;o++){var i=t.childNodes[o];if(!i)break;for(var s=n.childNodes[o],a=r?r.childNodes[o]:null,l=0,u=i.childNodes.length;l<u;l++)i.childNodes[l].removeAttribute("colspan"),s&&s.childNodes[l]&&s.childNodes[l].removeAttribute("colspan"),r&&a&&a.childNodes[l]&&a.childNodes[l].removeAttribute("colspan")}},checkForFixedColumnsCollision:function(){var e=this,t=this.hot.getSettings().fixedColumnsLeft;v(this.colspanArray,function(n,r){e.getNestedParent(r,t)!==t&&console.warn("You have declared a Nested Header overlapping the Fixed Columns section - it may lead to visual glitches. To prevent that kind of problems, split the nested headers between the fixed and non-fixed columns.")})},checkForOverlappingHeaders:function(){var e=this;v(this.colspanArray,function(t,n){v(e.colspanArray[n],function(t,r){if(t.colspan>1){var o=e.levelToRowCoords(n),i=e.getChildHeaders(o,r);if(i.length>0){var s=0;return v(i,function(t,n){s+=e.getColspan(o+1,t)}),s>t.colspan&&console.warn("Your Nested Headers plugin setup contains overlapping headers. This kind of configuration is currently not supported and might result in glitches."),!1}}})})},setupColspanArray:function(){function e(e,t){e[t]||(e[t]=[])}var t=this;w(this.settings,function(n,r){w(n,function(n,o,i){if(e(t.colspanArray,r),void 0===i[o].colspan)t.colspanArray[r].push({label:i[o]||"",colspan:1,hidden:!1});else{var s=i[o].colspan||1;t.colspanArray[r].push({label:i[o].label||"",colspan:s,hidden:!1}),t.fillColspanArrayWithDummies(s,r)}})})},fillColspanArrayWithDummies:function(e,t){var n=this;g(0,e-2,function(e){n.colspanArray[t].push({label:"",colspan:1,hidden:!0})})},headerRendererFactory:function(e){var t=this;return function(n,r){if(r.removeAttribute("colspan"),h(r,"hiddenHeader"),t.colspanArray[e][n]&&t.colspanArray[e][n].colspan){var o=t.colspanArray[e][n].colspan,i=t.hot.getSettings().fixedColumnsLeft||0,s=t.hot.view.wt.wtOverlays.topLeftCornerOverlay,a=t.hot.view.wt.wtOverlays.leftOverlay,l=!!s&&s.clone.wtTable.THEAD.contains(r),u=!!a&&a.clone.wtTable.THEAD.contains(r);o>1&&r.setAttribute("colspan",l||u?Math.min(o,i-n):o),(l||u&&n===i-1)&&c(r,"overlayEdge")}t.colspanArray[e][n]&&t.colspanArray[e][n].hidden&&c(r,"hiddenHeader"),m(r);var d=document.createElement("DIV");c(d,"relative");var f=document.createElement("SPAN");c(f,"colHeader"),p(f,t.colspanArray[e][n]?t.colspanArray[e][n].label||"":""),d.appendChild(f),r.appendChild(d),t.hot.runHooks("afterGetColHeader",n,r)}},getColspan:function(e,t){var n=this.colspanArray[this.rowCoordsToLevel(e)][t];return n?n.colspan:1},levelToRowCoords:function(e){return e-this.columnHeaderLevelCount},rowCoordsToLevel:function(e){return e+this.columnHeaderLevelCount},getNestedParent:function(e,t){if(e<0)return!1;var n=this.colspanArray[e][t]?this.colspanArray[e][t].colspan:1,r=!!this.colspanArray[e][t]&&this.colspanArray[e][t].hidden;if(n>1||1===n&&r===!1)return t;var o=t-1;do{if(this.colspanArray[e][o].colspan>1)break;o--}while(t>=0);return o},getChildHeaders:function(e,t){var n=this.rowCoordsToLevel(e),r=this.colspanArray[n+1],o=this.getNestedParent(n,t),i=this.colspanArray[n][t].colspan,s=[];return r?(g(o,o+i-1,function(e){r[e]&&r[e].colspan>1&&(i-=r[e].colspan-1),r[e]&&!r[e].hidden&&s.indexOf(e)===-1&&s.push(e)}),s):s},fillTheRemainingColspans:function(){var e=this;w(this.settings,function(t,n){g(e.colspanArray[n].length-1,e.hot.countCols()-1,function(r){e.colspanArray[n].push({label:t[r]||"",colspan:1,hidden:!1})},!0)})},updateHeadersHighlight:function(){var e=this,t=this.hot.getSelected();if(void 0!==t){var n="ht__highlight",r=this.hot.view.wt.wtOverlays,o=this.hot.selection.selectedHeader.cols,i=Math.min(t[1],t[3]),s=Math.max(t[1],t[3]),a=o?-1:this.columnHeaderLevelCount-1;g(i,s,function(t){for(var l=function(l){var u=e.getNestedParent(l,t),d=r.topOverlay?r.topOverlay.clone.wtTable.getColumnHeader(u,l):void 0,p=r.topLeftCornerOverlay?r.topLeftCornerOverlay.clone.wtTable.getColumnHeader(u,l):void 0,m=[d,p],g=e.getColspan(l-e.columnHeaderLevelCount,u),w=u>=i&&u+g-1<=s;v(m,function(e,t,r){return void 0!==e&&void(!o&&l<a||o&&!w?f(e,n)&&h(e,n):f(e,n)||c(e,n))})},u=e.columnHeaderLevelCount-1;u>-1;u--)l(u)})}},onAfterViewportColumnCalculatorOverride:function(e){var t=this,n=e.startColumn;g(0,Math.max(this.columnHeaderLevelCount-1,0),function(r){var o=t.getNestedParent(r,e.startColumn);if(o<e.startColumn){var i=Math.min(n,o);n=i}}),e.startColumn=n},onAfterOnCellMouseDown:function(e,t,n){if(t.row<0){var r=this.getColspan(t.row,t.col),o=t.col+r-1;if(r>1){var i=this.hot.countRows()-1;this.hot.selection.setRangeEnd(new WalkontableCellCoords(i,o))}}},onBeforeOnCellMouseOver:function(e,t,n,r){var o;if(t.row<0&&t.col>=0&&this.hot.view.isMouseDown()){var i=this.hot.getSelectedRange(),s=i.from,a=i.to,l=this.getColspan(t.row,t.col),u=t.col+l-1,d=!1;s.col<=a.col?(t.col<s.col&&u===a.col||t.col<s.col&&u<s.col||t.col<s.col&&u>=s.col&&u<a.col)&&(d=!0):(t.col<a.col&&u>s.col||t.col>s.col||t.col<=a.col&&u>s.col||t.col>a.col&&u>s.col)&&(d=!0),d&&(o=[a.col,s.col],s.col=o[0],a.col=o[1],o),l>1&&(r.column=!0,r.cell=!0,this.hot.selection.setSelectedHeaders(!1,!0),s.col===a.col&&(u<=s.col&&t.col<s.col?(this.hot.selection.setRangeStartOnly(new WalkontableCellCoords(s.row,a.col)),this.hot.selection.setRangeEnd(new WalkontableCellCoords(a.row,t.col))):(this.hot.selection.setRangeStartOnly(new WalkontableCellCoords(s.row,t.col<s.col?t.col:s.col)),this.hot.selection.setRangeEnd(new WalkontableCellCoords(a.row,u>a.col?u:a.col)))),s.col<a.col&&(this.hot.selection.setRangeStartOnly(new WalkontableCellCoords(s.row,t.col<s.col?t.col:s.col)),this.hot.selection.setRangeEnd(new WalkontableCellCoords(a.row,u))),s.col>a.col&&(this.hot.selection.setRangeStartOnly(new WalkontableCellCoords(s.row,s.col)),this.hot.selection.setRangeEnd(new WalkontableCellCoords(a.row,t.col))))}},onAfterInit:function(){this.columnHeaderLevelCount=this.hot.view.wt.getSetting("columnHeaders").length,this.fillTheRemainingColspans(),this.checkForOverlappingHeaders(),this.ghostTable.buildWidthsMapper()},onAfterGetColumnHeaderRenderers:function(e){if(e){e.length=0;for(var t=this.colspanArray.length,n=t-1;n>=0;n--)e.push(this.headerRendererFactory(n));e.reverse()}this.updateHeadersHighlight()},onModifyColWidth:function(e,t){var n=this.ghostTable.widthsCache[t];return e>n?e:n},destroy:function(){this.settings=null,this.columnHeaderLevelCount=null,this.colspanArray=null,$traceurRuntime.superGet(this,M.prototype,"destroy").call(this)}},{},C),y("nestedHeaders",R)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,"utils/ghostTable":215}],215:[function(e,t,n){"use strict";Object.defineProperties(n,{GhostTable:{get:function(){return i}},__esModule:{value:!0}});var r,o=(r=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),r&&r.__esModule&&r||{default:r}).fastInnerHTML,i=function(e){this.nestedHeaders=e,this.container=void 0,this.widthsCache=[]};$traceurRuntime.createClass(i,{buildWidthsMapper:function(){this.container=document.createElement("div"),this.buildGhostTable(this.container),this.nestedHeaders.hot.rootElement.appendChild(this.container);for(var e=this.container.querySelectorAll("tr:last-of-type td"),t=e.length,n=0;n<t;n++)this.widthsCache.push(e[n].offsetWidth);this.container.parentNode.removeChild(this.container),this.container=null,this.nestedHeaders.hot.render()},buildGhostTable:function(e){for(var t=document,n=t.createDocumentFragment(),r=t.createElement("table"),i=!1,s=!!this.nestedHeaders.hot.getSettings().dropdownMenu,a=this.nestedHeaders.colspanArray.length,l=this.nestedHeaders.hot.countCols(),u=a-1,d=0;d<a;d++){var c=t.createElement("tr");i=!1;for(var h=0;h<l;h++){var f=t.createElement("td"),p=this.nestedHeaders.colspanArray[d][h];p&&!p.hidden&&(d===u&&(p.colspan>1&&(i=!0),s&&(p.label+='<button class="changeType"></button>')),o(f,p.label),f.colSpan=p.colspan,c.appendChild(f))}r.appendChild(c)}if(i){for(var m=t.createElement("tr"),g=0;g<l;g++){var v=t.createElement("td");m.appendChild(v)}r.appendChild(m)}n.appendChild(r),e.appendChild(n)},clear:function(){this.container=null,this.widthsCache.length=0}},{})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47}],216:[function(e,t,n){"use strict";Object.defineProperties(n,{DataManager:{get:function(){return u}},__esModule:{value:!0}});var r,o,i,s=(r=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),r&&r.__esModule&&r||{default:r}).rangeEach,a=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),o&&o.__esModule&&o||{default:o}).objectEach,l=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),i&&i.__esModule&&i||{default:i}).arrayEach,u=function(e,t,n){this.hot=t,this.data=n,this.plugin=e,this.parentReference=new WeakMap,this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}};$traceurRuntime.createClass(u,{rewriteCache:function(){var e=this;this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},s(0,this.data.length-1,function(t){e.cacheNode(e.data[t],0,null)})},cacheNode:function(e,t,n){var r=this;this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount++),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:n,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&l(e.__children,function(n,o){r.cacheNode(n,t+1,e)})},getDataObject:function(e){return null==e?null:this.cache.rows[e]},readTreeNodes:function(e,t,n,r){var o=this,i=!1;return isNaN(t)&&t.end?t:(e||(e={__children:this.data},i=!0,t--),null!=n&&t===n?{result:e,end:!0}:null!=r&&e===r?{result:t,end:!0}:(t++,e.__children&&l(e.__children,function(s,a){if(o.parentReference.set(s,i?null:e),t=o.readTreeNodes(s,t,n,r),isNaN(t)&&t.end)return!1}),t))},updateParentReference:function(){this.readTreeNodes({__children:this.data},0,this.hot.countRows())},mockParent:function(){var e=this.mockNode();return e.__children=this.data,e},mockNode:function(){var e={};return a(this.data[0],function(t,n){e[n]=null}),e},getRowIndex:function(e){return null==e?null:this.cache.nodeInfo.get(e).row},getRowIndexWithinParent:function(e){var t=null;t=isNaN(e)?e:this.getDataObject(e);var n=this.getRowParent(e);return null==n?this.data.indexOf(t):n.__children.indexOf(t)},countAllRows:function(){var e={__children:this.data};return this.countChildren(e)},countChildren:function(e){var t=this,n=0;return isNaN(e)||(e=this.getDataObject(e)),e&&e.__children?(l(e.__children,function(e,r){n++,e.__children&&(n+=t.countChildren(e))}),n):0},getRowParent:function(e){var t;return t=isNaN(e)?e:this.getDataObject(e),this.getRowObjectParent(t)},getRowObjectParent:function(e){return"object"!=typeof e?null:this.cache.nodeInfo.get(e).parent},getRowLevel:function(e){var t=null;return t=isNaN(e)?e:this.getDataObject(e),t?this.getRowObjectLevel(t):null},getRowObjectLevel:function(e){return null==e?null:this.cache.nodeInfo.get(e).level},hasChildren:function(e){return isNaN(e)||(e=this.getDataObject(e)),!(!e.__children||!e.__children.length)},isParent:function(e){return isNaN(e)||(e=this.getDataObject(e)),!!e.hasOwnProperty("__children")},addChild:function(e,t){this.hot.runHooks("beforeAddChild",e,t);var n=null;e&&(n=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",n+this.countChildren(e)+1,1);var r=e;e||(r=this.mockParent()),r.__children||(r.__children=[]),t||(t=this.mockNode()),r.__children.push(t),this.rewriteCache();var o=this.getRowIndex(t);this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",e,t)},addChildAtIndex:function(e,t,n,r){this.hot.runHooks("beforeAddChild",e,n,t),this.hot.runHooks("beforeCreateRow",r+1,1);var o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),n||(n=this.mockNode()),o.__children.splice(t,null,n),this.rewriteCache(),this.hot.runHooks("afterCreateRow",r+1,1),this.hot.runHooks("afterAddChild",e,n,t)},addSibling:function(e){var t=void 0!==arguments[1]?arguments[1]:"below",n=this.translateTrimmedRow(e),r=this.getRowParent(n),o=this.getRowIndexWithinParent(n);switch(t){case"below":this.addChildAtIndex(r,o+1,null,e);break;case"above":this.addChildAtIndex(r,o,null,e)}},detachFromParent:function(e){var t=void 0===arguments[1]||arguments[1],n=this,r=null,o=[];Array.isArray(e)?(s(e[0],e[2],function(e){var t=n.translateTrimmedRow(e);o.push(n.getDataObject(t))}),s(0,o.length-2,function(e){n.detachFromParent(o[e],!1)}),r=o[o.length-1]):r=e;var i=this.getRowIndex(r),a=this.getRowIndexWithinParent(r),l=this.getRowParent(r),u=this.getRowParent(l),d=this.getRowIndex(u),c=null;this.hot.runHooks("beforeDetachChild",l,r),null!=a&&(this.hot.runHooks("beforeRemoveRow",i,1,[i],this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",i,1,[i],this.plugin.pluginName),u?(c=d+this.countChildren(u),this.hot.runHooks("beforeCreateRow",c,1,this.plugin.pluginName),u.__children.push(r)):(c=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",c,1,this.plugin.pluginName),this.data.push(r))),this.rewriteCache(),this.hot.runHooks("afterCreateRow",c,1,this.plugin.pluginName),t&&this.hot.render(),this.hot.runHooks("afterDetachChild",l,r)},filterData:function(e,t,n){var r=this,o=[];l(n,function(e,t){o.push(r.getDataObject(e))}),l(o,function(e,t){var n=r.getRowIndexWithinParent(e),o=r.getRowParent(e);null===o?r.data.splice(n,1):o.__children.splice(n,1)}),this.rewriteCache()},spliceData:function(e,t,n){if(e=this.translateTrimmedRow(e),null!=e){var r=this.getDataObject(e-1),o=null,i=null;r&&r.__children&&0===r.__children.length?(o=r,i=0):(o=this.getRowParent(e),i=this.getRowIndexWithinParent(e)),o?n?o.__children.splice(i,t,n):o.__children.splice(i,t):n?this.data.splice(i,t,n):this.data.splice(i,t),this.rewriteCache()}},moveRow:function(e,t){var n=this.isParent(t),r=this.getRowParent(e),o=this.getRowIndexWithinParent(e),i=this.getRowParent(t);null==i&&(i=this.getRowParent(t-1)),null==i&&(i=this.getDataObject(t-1)),i?i.__children||(i.__children=[]):(i=this.getDataObject(t),i.__children=[]);var s=this.getRowParent(t-1),a=n?this.countChildren(s):this.getRowIndexWithinParent(t),l=r.__children.slice(o,o+1);r.__children.splice(o,1),i.__children.splice(a,0,l[0])},translateTrimmedRow:function(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}},{})},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53}],217:[function(e,t,n){"use strict";Object.defineProperties(n,{NestedRows:{get:function(){return _}},__esModule:{value:!0}});var r,o,i,s,a,l,u,d,c=(r=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),r&&r.__esModule&&r||{default:r}).default,h=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),o&&o.__esModule&&o||{default:o}).registerPlugin,f=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),i&&i.__esModule&&i||{default:i}),p=f.rangeEach,m=(f.rangeEachReverse,(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),s&&s.__esModule&&s||{default:s}).arrayEach),g=(a=e("data/dataManager"),a&&a.__esModule&&a||{default:a}).DataManager,v=(l=e("ui/collapsing"),l&&l.__esModule&&l||{default:l}).CollapsingUI,w=(u=e("ui/headers"),u&&u.__esModule&&u||{default:u}).HeadersUI,b=(d=e("ui/contextMenu"),d&&d.__esModule&&d||{default:d}).ContextMenuUI,y=new WeakMap,_=function(e){y.set(this,{changeSelection:!1,movedToFirstChild:!1,movedToCollapsed:!1,skipRender:null}),this.sourceData=null,this.trimRowsPlugin=null,this.bindRowsWithHeadersPlugin=null,this.dataManager=null,this.headersUI=null,$traceurRuntime.superConstructor(C).call(this,e)},C=_;$traceurRuntime.createClass(_,{isEnabled:function(){return!!this.hot.getSettings().nestedRows},enablePlugin:function(){var e=this;this.sourceData=this.hot.getSourceData(),this.trimRowsPlugin=this.hot.getPlugin("trimRows"),this.manualRowMovePlugin=this.hot.getPlugin("manualRowMove"),this.bindRowsWithHeadersPlugin=this.hot.getPlugin("bindRowsWithHeaders"),this.dataManager=new g(this,this.hot,this.sourceData),this.collapsingUI=new v(this,this.hot,this.trimRowsPlugin),this.headersUI=new w(this,this.hot),this.contextMenuUI=new b(this,this.hot),this.dataManager.rewriteCache(),this.addHook("afterInit",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onAfterInit.apply(t,$traceurRuntime.spread(n))}),this.addHook("beforeRender",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onBeforeRender.apply(t,$traceurRuntime.spread(n))}),this.addHook("modifyRowData",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onModifyRowData.apply(t,$traceurRuntime.spread(n))}),this.addHook("modifySourceLength",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onModifySourceLength.apply(t,$traceurRuntime.spread(n))}),this.addHook("beforeDataSplice",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onBeforeDataSplice.apply(t,$traceurRuntime.spread(n))}),this.addHook("beforeDataFilter",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onBeforeDataFilter.apply(t,$traceurRuntime.spread(n))}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onAfterContextMenuDefaultOptions.apply(t,$traceurRuntime.spread(n))}),this.addHook("afterGetRowHeader",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onAfterGetRowHeader.apply(t,$traceurRuntime.spread(n))}),this.addHook("beforeOnCellMouseDown",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onBeforeOnCellMouseDown.apply(t,$traceurRuntime.spread(n))}),this.addHook("afterRemoveRow",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onAfterRemoveRow.apply(t,$traceurRuntime.spread(n))}),this.addHook("modifyRemovedAmount",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onModifyRemovedAmount.apply(t,$traceurRuntime.spread(n))}),this.addHook("beforeAddChild",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onBeforeAddChild.apply(t,$traceurRuntime.spread(n))}),this.addHook("afterAddChild",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onAfterAddChild.apply(t,$traceurRuntime.spread(n))}),this.addHook("beforeDetachChild",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onBeforeDetachChild.apply(t,$traceurRuntime.spread(n))}),this.addHook("afterDetachChild",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onAfterDetachChild.apply(t,$traceurRuntime.spread(n))}),this.addHook("modifyRowHeaderWidth",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onModifyRowHeaderWidth.apply(t,$traceurRuntime.spread(n))}),this.addHook("afterCreateRow",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onAfterCreateRow.apply(t,$traceurRuntime.spread(n))}),this.addHook("beforeRowMove",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onBeforeRowMove.apply(t,$traceurRuntime.spread(n))}),this.addHook("afterRowMove",function(){for(var t,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return(t=e).onAfterRowMove.apply(t,$traceurRuntime.spread(n))}),this.trimRowsPlugin.isEnabled()||(this.trimRowsPlugin.enablePlugin(),this.hot.getSettings().trimRows=!0),$traceurRuntime.superGet(this,C.prototype,"enablePlugin").call(this)},disablePlugin:function(){$traceurRuntime.superGet(this,C.prototype,"disablePlugin").call(this)},updatePlugin:function(){this.disablePlugin(),this.enablePlugin(),$traceurRuntime.superGet(this,C.prototype,"updatePlugin").call(this)},onBeforeRowMove:function(e,t){var n,r,o=y.get(this),i=e.length,s=[],a=this.dataManager.translateTrimmedRow(t),l=!0,u=null,d=null,c=null;for(r=0;r<i;r++)s.push(this.dataManager.translateTrimmedRow(e[r])),this.dataManager.isParent(s[r])&&(l=!1);if(s.indexOf(a)>-1||!l)return!1;if(u=this.dataManager.getRowParent(s[0]),d=this.dataManager.getRowParent(a),null==d&&(d=this.dataManager.getRowParent(a-1)),null==d&&(d=this.dataManager.getDataObject(a-1),o.movedToFirstChild=!0),!d)return!1;for(c=u===d,o.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),c||((n=Math).max.apply(n,$traceurRuntime.spread(s))<=a?this.collapsingUI.collapsedRowsStash.shiftStash(s[0],-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(a,e.length)),o.changeSelection=!0,(s[i-1]<=a&&c||o.movedToFirstChild===!0)&&(e.reverse(),s.reverse(),o.movedToFirstChild!==!0&&a--),r=0;r<i;r++)this.dataManager.moveRow(s[r],a);return(s[i-1]<=a&&c||this.dataManager.isParent(a))&&e.reverse(),this.dataManager.rewriteCache(),!1},onAfterRowMove:function(e,t){var n,r=y.get(this);if(r.changeSelection){var o=e.length,i=0,s=0,a=null,l=null,u=null;if(this.collapsingUI.collapsedRowsStash.applyStash(),a=this.dataManager.translateTrimmedRow(t),r.movedToFirstChild)r.movedToFirstChild=!1,i=t,s=t+o-1,t>=(n=Math).max.apply(n,$traceurRuntime.spread(e))&&(i-=o,s-=o);else if(r.movedToCollapsed){var d=this.dataManager.getRowParent(a-1);null==d&&(d=this.dataManager.getDataObject(a-1));var c=this.dataManager.getRowIndex(d);i=c,s=i}else e[o-1]<t?(s=t-1,i=s-o+1):(i=t,s=i+o-1);l=this.hot.selection,u=this.hot.countCols()-1,l.setRangeStart(new WalkontableCellCoords(i,0)),l.setRangeEnd(new WalkontableCellCoords(s,u),!0),r.changeSelection=!1}},onBeforeOnCellMouseDown:function(e,t,n){this.collapsingUI.toggleState(e,t,n)},onModifyRowData:function(e){return this.dataManager.getDataObject(e)},onModifySourceLength:function(){return this.dataManager.countAllRows()},onBeforeDataSplice:function(e,t,n){return this.dataManager.spliceData(e,t,n),!1},onBeforeDataFilter:function(e,t,n){var r=[],o=this.dataManager.translateTrimmedRow(e),i=y.get(this);return p(o,o+t-1,function(e){r.push(e)}),this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(o,t),this.collapsingUI.collapsedRowsStash.shiftStash(o,-1*t),this.dataManager.filterData(e,t,r),i.skipRender=!0,!1},onAfterContextMenuDefaultOptions:function(e){return this.contextMenuUI.appendOptions(e)},onAfterGetRowHeader:function(e,t){this.headersUI.appendLevelIndicators(e,t)},onModifyRowHeaderWidth:function(e){return this.headersUI.rowHeaderWidthCache||e},onAfterRemoveRow:function(e,t,n,r){var o=this;if(r!==this.pluginName){var i=y.get(this);setTimeout(function(){i.skipRender=null,o.headersUI.updateRowHeaderWidth(),o.collapsingUI.collapsedRowsStash.applyStash()},0)}},onModifyRemovedAmount:function(e,t){var n=this,r=[],o=0;return p(t,t+e-1,function(e){var t=!1,i=n.collapsingUI.translateTrimmedRow(e),s=n.dataManager.getDataObject(i);n.dataManager.hasChildren(s)&&(r.push(s),m(r,function(e){if(e.__children.indexOf(s)>-1)return t=!0,!1}),t||(o+=n.dataManager.countChildren(s))),t=!1,m(r,function(e){if(e.__children.indexOf(s)>-1)return t=!0,!1}),t&&o--}),e+o},onBeforeAddChild:function(e,t){this.collapsingUI.collapsedRowsStash.stash()},onAfterAddChild:function(e,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()},onBeforeDetachChild:function(e,t){this.collapsingUI.collapsedRowsStash.stash()},onAfterDetachChild:function(e,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()},onAfterCreateRow:function(e,t,n){n!==this.pluginName&&this.dataManager.rewriteCache()},onAfterInit:function(){var e;this.bindRowsWithHeadersPlugin.bindStrategy.strategy&&this.bindRowsWithHeadersPlugin.bindStrategy.createMap(this.hot.countSourceRows());var t=(e=Math).max.apply(e,$traceurRuntime.spread(this.dataManager.cache.levels));t>0&&this.headersUI.updateRowHeaderWidth(t)},onBeforeRender:function(e,t){var n=y.get(this);n.skipRender&&(t.skipRender=!0)}},{},c),h("nestedRows",_)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,"data/dataManager":216,"ui/collapsing":219,"ui/contextMenu":220,"ui/headers":221}],218:[function(e,t,n){"use strict";Object.defineProperties(n,{BaseUI:{get:function(){return r}},__esModule:{value:!0}});var r=function(e,t){this.hot=t,this.plugin=e};$traceurRuntime.createClass(r,{},{})},{}],219:[function(e,t,n){"use strict";Object.defineProperties(n,{CollapsingUI:{get:function(){return m}},__esModule:{value:!0}});var r,o,i,s,a,l,u=(r=e("_base"),r&&r.__esModule&&r||{default:r}).BaseUI,d=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event"),o&&o.__esModule&&o||{default:o}).stopImmediatePropagation,c=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),i&&i.__esModule&&i||{default:i}).arrayEach,h=(s=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),s&&s.__esModule&&s||{default:s}).rangeEach,f=(a=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),a&&a.__esModule&&a||{default:a}).hasClass,p=(l=e("headers"),l&&l.__esModule&&l||{default:l}).HeadersUI,m=function(e,t){var n=this;$traceurRuntime.superConstructor(g).call(this,e,t),this.trimRowsPlugin=e.trimRowsPlugin,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){n.lastCollapsedRows=n.collapsedRows.slice(0),n.expandMultipleChildren(n.lastCollapsedRows,!1)},shiftStash:function(e){var t=void 0!==arguments[1]?arguments[1]:1;e=n.translateTrimmedRow(e),c(n.lastCollapsedRows,function(r,o){r>e-1&&(n.lastCollapsedRows[o]=r+t)})},applyStash:function(){n.hot.runHooks("skipLengthCache",100),n.collapseMultipleChildren(n.lastCollapsedRows,!0),n.lastCollapsedRows=void 0},trimStash:function(e,t){h(e,e+t-1,function(e){var t=n.lastCollapsedRows.indexOf(e);t>-1&&n.lastCollapsedRows.splice(t,1)})}}},g=m;$traceurRuntime.createClass(m,{collapseChildren:function(e){var t=void 0===arguments[1]||arguments[1],n=void 0===arguments[2]||arguments[2],r=this,o=[],i=null,s=null,a=null;return isNaN(e)?(i=e,s=this.dataManager.getRowIndex(i)):(i=this.dataManager.getDataObject(e),s=e),this.dataManager.hasChildren(i)&&c(i.__children,function(e,t){o.push(r.dataManager.getRowIndex(e))}),a=this.collapseRows(o,!0,!1),n&&this.trimRowsPlugin.trimRows(a),t&&this.renderAndAdjust(),this.collapsedRows.indexOf(s)===-1&&this.collapsedRows.push(s),a},collapseMultipleChildren:function(e){var t=void 0===arguments[1]||arguments[1],n=void 0===arguments[2]||arguments[2],r=this,o=[];c(e,function(e,t){o=o.concat(r.collapseChildren(e,!1,!1))}),n&&this.trimRowsPlugin.trimRows(o),t&&this.renderAndAdjust()},collapseRow:function(e){var t=void 0===arguments[1]||arguments[1];this.collapseRows([e],t)},collapseRows:function(e){var t=void 0===arguments[1]||arguments[1],n=void 0!==arguments[2]&&arguments[2],r=this,o=[];return c(e,function(e,n){o.push(e),t&&r.collapseChildRows(e,o)}),n&&this.trimRowsPlugin.trimRows(o),o},collapseChildRows:function(e){var t=void 0!==arguments[1]?arguments[1]:[],n=(void 0===arguments[2]||arguments[2],
void 0!==arguments[3]&&arguments[3]),r=this;if(this.dataManager.hasChildren(e)){var o=this.dataManager.getDataObject(e);c(o.__children,function(e,n){var o=r.dataManager.getRowIndex(e);t.push(o),r.collapseChildRows(o,t)})}n&&this.trimRowsPlugin.trimRows(t)},expandRow:function(e){var t=void 0===arguments[1]||arguments[1];this.expandRows([e],t)},expandRows:function(e){var t=void 0===arguments[1]||arguments[1],n=void 0!==arguments[2]&&arguments[2],r=this,o=[];return c(e,function(e,n){o.push(e),t&&r.expandChildRows(e,o)}),n&&this.trimRowsPlugin.untrimRows(o),o},expandChildRows:function(e){var t=void 0!==arguments[1]?arguments[1]:[],n=(void 0===arguments[2]||arguments[2],void 0!==arguments[3]&&arguments[3]),r=this;if(this.dataManager.hasChildren(e)){var o=this.dataManager.getDataObject(e);c(o.__children,function(e,n){if(!r.isAnyParentCollapsed(e)){var o=r.dataManager.getRowIndex(e);t.push(o),r.expandChildRows(o,t)}})}n&&this.trimRowsPlugin.untrimRows(t)},expandChildren:function(e){var t=void 0===arguments[1]||arguments[1],n=void 0===arguments[2]||arguments[2],r=this,o=[],i=null,s=null,a=null;return isNaN(e)?(i=e,s=this.dataManager.getRowIndex(e)):(i=this.dataManager.getDataObject(e),s=e),this.collapsedRows.splice(this.collapsedRows.indexOf(s),1),this.dataManager.hasChildren(i)&&c(i.__children,function(e,t){var n=r.dataManager.getRowIndex(e);o.push(n)}),a=this.expandRows(o,!0,!1),n&&this.trimRowsPlugin.untrimRows(a),t&&this.renderAndAdjust(),a},expandMultipleChildren:function(e){var t=void 0===arguments[1]||arguments[1],n=void 0===arguments[2]||arguments[2],r=this,o=[];c(e,function(e,t){o=o.concat(r.expandChildren(e,!1,!1))}),n&&this.trimRowsPlugin.untrimRows(o),t&&this.renderAndAdjust()},collapseAll:function(){var e=this,t=this.hot.getSourceData(),n=[];c(t,function(t,r){e.dataManager.hasChildren(t)&&n.push(t)}),this.collapseMultipleChildren(n),this.renderAndAdjust()},expandAll:function(){var e=this,t=this.hot.getSourceData(),n=[];c(t,function(t,r){e.dataManager.hasChildren(t)&&n.push(t)}),this.expandMultipleChildren(n),this.renderAndAdjust()},areChildrenCollapsed:function(e){var t=this,n=null,r=!0;return n=isNaN(e)?e:this.dataManager.getDataObject(e),this.dataManager.hasChildren(n)&&c(n.__children,function(e,n){var o=t.dataManager.getRowIndex(e);if(!t.trimRowsPlugin.isTrimmed(o))return r=!1,!1}),r},isAnyParentCollapsed:function(e){for(var t=e;null!==t;){t=this.dataManager.getRowParent(t);var n=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(n)>-1)return!0}return!1},toggleState:function(e,t,n){if(!(t.col>=0)){var r=this.translateTrimmedRow(t.row);f(e.target,p.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),d(e))}},translateTrimmedRow:function(e){return this.trimRowsPlugin.rowsMapper.getValueByIndex(e)},renderAndAdjust:function(){this.hot.render(),this.hot.view.wt.wtOverlays.adjustElementsSize()}},{},u)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/event":48,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,_base:218,headers:221}],220:[function(e,t,n){"use strict";Object.defineProperties(n,{ContextMenuUI:{get:function(){return d}},__esModule:{value:!0}});var r,o,i,s=(r=e("_base"),r&&r.__esModule&&r||{default:r}).BaseUI,a=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),o&&o.__esModule&&o||{default:o}).rangeEach,l=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),i&&i.__esModule&&i||{default:i}).arrayEach,u=new WeakMap,d=function(e,t){var n=this;u.set(this,{row_above:function(e,t){n.dataManager.addSibling(t.start.row,"above")},row_below:function(e,t){n.dataManager.addSibling(t.start.row,"below")}}),$traceurRuntime.superConstructor(c).call(this,e,t),this.dataManager=this.plugin.dataManager},c=d;$traceurRuntime.createClass(d,{appendOptions:function(e){var t=this,n=[{key:"add_child",name:function(){return"Insert child row"},callback:function(){var e=t.dataManager.translateTrimmedRow(t.hot.getSelected()[0]),n=t.dataManager.getDataObject(e);t.dataManager.addChild(n)},disabled:function(){var e=t.hot.getSelected();return!e||e[0]<0||t.hot.selection.selectedHeader.cols||t.hot.countRows()>=t.hot.getSettings().maxRows}},{key:"detach_from_parent",name:function(){return"Detach from parent"},callback:function(){var e=t.dataManager.translateTrimmedRow(t.hot.getSelected()[0]);t.dataManager.getDataObject(e);t.dataManager.detachFromParent(t.hot.getSelected())},disabled:function(){var e=t.hot.getSelected(),n=t.dataManager.translateTrimmedRow(e[0]),r=t.dataManager.getRowParent(n);return!r||!e||e[0]<0||t.hot.selection.selectedHeader.cols||t.hot.countRows()>=t.hot.getSettings().maxRows}},Handsontable.plugins.ContextMenu.SEPARATOR];return a(0,e.items.length-1,function(t){if(0===t)return l(n,function(n,r){e.items.splice(t+r,0,n)}),!1}),e=this.modifyRowInsertingOptions(e)},modifyRowInsertingOptions:function(e){var t=u.get(this);return a(0,e.items.length-1,function(n){null!=t[e.items[n].key]&&(e.items[n].callback=t[e.items[n].key])}),e}},{},s)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,_base:218}],221:[function(e,t,n){"use strict";Object.defineProperties(n,{HeadersUI:{get:function(){return c}},__esModule:{value:!0}});var r,o,i,s,a=(r=e("_base"),r&&r.__esModule&&r||{default:r}).BaseUI,l=(o=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),o&&o.__esModule&&o||{default:o}).arrayEach,u=(i=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),i&&i.__esModule&&i||{default:i}).rangeEach,d=(s=e("../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element"),s&&s.__esModule&&s||{default:s}).addClass,c=function(e,t){$traceurRuntime.superConstructor(h).call(this,e,t),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null,this.trimRowsPlugin=e.trimRowsPlugin},h=c;$traceurRuntime.createClass(c,{appendLevelIndicators:function(e,t){e=this.trimRowsPlugin.rowsMapper.getValueByIndex(e);var n=this.dataManager.getRowLevel(e),r=this.dataManager.getDataObject(e),o=t.getElementsByTagName("DIV")[0],i=o.querySelector("span.rowHeader"),s=o.querySelectorAll('[class^="ht_nesting"]');if(l(s,function(e,t){e&&o.removeChild(e)}),d(t,h.CSS_CLASSES.indicatorContainer),n){var a=i.cloneNode(!0);o.innerHTML="",u(0,n-1,function(e){var t=document.createElement("SPAN");d(t,h.CSS_CLASSES.emptyIndicator),o.appendChild(t)}),o.appendChild(a)}if(this.dataManager.hasChildren(r)){var c=document.createElement("DIV");d(t,h.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(e)?d(c,h.CSS_CLASSES.button+" "+h.CSS_CLASSES.expandButton):d(c,h.CSS_CLASSES.button+" "+h.CSS_CLASSES.collapseButton),o.appendChild(c)}},updateRowHeaderWidth:function(e){e||(e=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*e+25),this.hot.render()}},{get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}},a)},{"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/dom/element":47,"../../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,_base:218}],222:[function(e,t,n){"use strict";Object.defineProperties(n,{RowsMapper:{get:function(){return c}},__esModule:{value:!0}});var r,o,i,s,a=(r=e("../../browser"),r&&r.__esModule&&r||{default:r}).default,l=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper"),o&&o.__esModule&&o||{default:o}).arrayMapper,u=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object"),i&&i.__esModule&&i||{default:i}).mixin,d=(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),s&&s.__esModule&&s||{default:s}).rangeEach,c=function(e){this.trimRows=e};$traceurRuntime.createClass(c,{createMap:function(e){var t=this,n=0,r=void 0===e?this._arrayMap.length:e;this._arrayMap.length=0,d(r-1,function(e){t.trimRows.isTrimmed(e)?n++:t._arrayMap[e-n]=e})},destroy:function(){this._arrayMap=null}},{}),u(c,l),a.utils.TrimRowsRowsMapper=c},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/object":53,"../../../node_modules/hot-builder/node_modules/handsontable/src/mixins/arrayMapper":57,"../../browser":138}],223:[function(e,t,n){"use strict";Object.defineProperties(n,{TrimRows:{get:function(){return f}},__esModule:{value:!0}});var r,o,i,s,a,l=(r=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base"),r&&r.__esModule&&r||{default:r}).default,u=(o=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array"),o&&o.__esModule&&o||{default:o}).arrayEach,d=(i=e("../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number"),i&&i.__esModule&&i||{default:i}).rangeEach,c=(s=e("../../../node_modules/hot-builder/node_modules/handsontable/src/plugins"),s&&s.__esModule&&s||{default:s}).registerPlugin,h=(a=e("rowsMapper"),a&&a.__esModule&&a||{default:a}).RowsMapper,f=function(e){$traceurRuntime.superConstructor(p).call(this,e),this.trimmedRows=[],this.removedRows=[],this.rowsMapper=new h(this)},p=f;$traceurRuntime.createClass(f,{isEnabled:function(){return!!this.hot.getSettings().trimRows},enablePlugin:function(){var e=this;if(!this.enabled){var t=this.hot.getSettings().trimRows;Array.isArray(t)&&(this.trimmedRows=t),this.rowsMapper.createMap(this.hot.countSourceRows()),this.addHook("modifyRow",function(t,n){return e.onModifyRow(t,n)}),this.addHook("unmodifyRow",function(t,n){return e.onUnmodifyRow(t,n)}),this.addHook("afterCreateRow",function(t,n){return e.onAfterCreateRow(t,n)}),this.addHook("beforeRemoveRow",function(t,n){return e.onBeforeRemoveRow(t,n)}),this.addHook("afterRemoveRow",function(t,n){return e.onAfterRemoveRow(t,n)}),this.addHook("afterLoadData",function(t){return e.onAfterLoadData(t)}),$traceurRuntime.superGet(this,p.prototype,"enablePlugin").call(this)}},updatePlugin:function(){this.disablePlugin(),this.enablePlugin(),$traceurRuntime.superGet(this,p.prototype,"updatePlugin").call(this)},disablePlugin:function(){this.trimmedRows=[],this.removedRows.length=0,this.rowsMapper.clearMap(),$traceurRuntime.superGet(this,p.prototype,"disablePlugin").call(this)},trimRows:function(e){var t=this;u(e,function(e){e=parseInt(e,10),t.isTrimmed(e)||t.trimmedRows.push(e)}),this.rowsMapper.createMap(this.hot.countSourceRows()),this.hot.runHooks("afterTrimRow",e)},trimRow:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.trimRows(e)},untrimRows:function(e){var t=this;u(e,function(e){e=parseInt(e,10),t.isTrimmed(e)&&t.trimmedRows.splice(t.trimmedRows.indexOf(e),1)}),this.rowsMapper.createMap(this.hot.countSourceRows()),this.hot.runHooks("afterUntrimRow",e)},untrimRow:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.untrimRows(e)},isTrimmed:function(e){return this.trimmedRows.indexOf(e)>-1},untrimAll:function(){this.untrimRows([].concat(this.trimmedRows))},onModifyRow:function(e,t){return t!==this.pluginName&&(e=this.rowsMapper.getValueByIndex(e)),e},onUnmodifyRow:function(e,t){return t!==this.pluginName&&(e=this.rowsMapper.getIndexByValue(e)),e},onAfterCreateRow:function(e,t){this.rowsMapper.shiftItems(e,t)},onBeforeRemoveRow:function(e,t){var n=this;this.removedRows.length=0,e!==!1&&d(e,e+t-1,function(e){n.removedRows.push(n.hot.runHooks("modifyRow",e,n.pluginName))})},onAfterRemoveRow:function(e,t){this.rowsMapper.unshiftItems(this.removedRows)},onAfterLoadData:function(e){e||this.rowsMapper.createMap(this.hot.countSourceRows())},destroy:function(){this.rowsMapper.destroy(),$traceurRuntime.superGet(this,p.prototype,"destroy").call(this)}},{},l),c("trimRows",f)},{"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/array":43,"../../../node_modules/hot-builder/node_modules/handsontable/src/helpers/number":52,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins":62,"../../../node_modules/hot-builder/node_modules/handsontable/src/plugins/_base":63,rowsMapper:222}],SheetClip:[function(e,t,n){!function(e){"use strict";function t(e){return e.split('"').length-1}var r={parse:function(e){var n,r,o,i,s,a,l,u=[],d=0;for(o=e.split("\n"),o.length>1&&""===o[o.length-1]&&o.pop(),n=0,r=o.length;n<r;n+=1){for(o[n]=o[n].split("\t"),i=0,s=o[n].length;i<s;i+=1)u[d]||(u[d]=[]),a&&0===i?(l=u[d].length-1,u[d][l]=u[d][l]+"\n"+o[n][0],a&&1&t(o[n][0])&&(a=!1,u[d][l]=u[d][l].substring(0,u[d][l].length-1).replace(/""/g,'"'))):i===s-1&&0===o[n][i].indexOf('"')&&1&t(o[n][i])?(u[d].push(o[n][i].substring(1).replace(/""/g,'"')),a=!0):(u[d].push(o[n][i].replace(/""/g,'"')),a=!1);a||(d+=1)}return u},stringify:function(e){var t,n,r,o,i,s="";for(t=0,n=e.length;t<n;t+=1){for(o=e[t].length,r=0;r<o;r+=1)r>0&&(s+="\t"),i=e[t][r],s+="string"==typeof i?i.indexOf("\n")>-1?'"'+i.replace(/"/g,'""')+'"':i:null===i||void 0===i?"":i;s+="\n"}return s}};"undefined"!=typeof n?(n.parse=r.parse,n.stringify=r.stringify):e.SheetClip=r}(window)},{}],autoResize:[function(e,t,n){function r(){function e(e){return e.currentStyle||document.defaultView.getComputedStyle(e)}var t,n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},r=document.body,o=document.createTextNode(""),i=document.createElement("SPAN"),s=function(e,t,n){window.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n,!1)},a=function(e,t,n){window.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,n)},l=function(s){var a,l;s?/^[a-zA-Z \.,\\\/\|0-9]$/.test(s)||(s="."):s="",void 0!==o.textContent?o.textContent=t.value+s:o.data=t.value+s,i.style.fontSize=e(t).fontSize,i.style.fontFamily=e(t).fontFamily,i.style.whiteSpace="pre",r.appendChild(i),a=i.clientWidth+2,r.removeChild(i),t.style.height=n.minHeight+"px",n.minWidth>a?t.style.width=n.minWidth+"px":a>n.maxWidth?t.style.width=n.maxWidth+"px":t.style.width=a+"px",l=t.scrollHeight?t.scrollHeight-1:0,n.minHeight>l?t.style.height=n.minHeight+"px":n.maxHeight<l?(t.style.height=n.maxHeight+"px",t.style.overflowY="visible"):t.style.height=l+"px"},u=function(){window.setTimeout(l,0)},d=function(e){if(e&&e.minHeight)if("inherit"==e.minHeight)n.minHeight=t.clientHeight;else{var r=parseInt(e.minHeight);isNaN(r)||(n.minHeight=r)}if(e&&e.maxHeight)if("inherit"==e.maxHeight)n.maxHeight=t.clientHeight;else{var s=parseInt(e.maxHeight);isNaN(s)||(n.maxHeight=s)}if(e&&e.minWidth)if("inherit"==e.minWidth)n.minWidth=t.clientWidth;else{var a=parseInt(e.minWidth);isNaN(a)||(n.minWidth=a)}if(e&&e.maxWidth)if("inherit"==e.maxWidth)n.maxWidth=t.clientWidth;else{var l=parseInt(e.maxWidth);isNaN(l)||(n.maxWidth=l)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(o))},c=function(e,r,o){t=e,d(r),"TEXTAREA"==t.nodeName&&(t.style.resize="none",t.style.overflowY="",t.style.height=n.minHeight+"px",t.style.minWidth=n.minWidth+"px",t.style.maxWidth=n.maxWidth+"px",t.style.overflowY="hidden"),o&&(s(t,"change",l),s(t,"cut",u),s(t,"paste",u),s(t,"drop",u),s(t,"keydown",u),s(t,"focus",l)),l()};return{init:function(e,t,n){c(e,t,n)},unObserve:function(){a(t,"change",l),a(t,"cut",u),a(t,"paste",u),a(t,"drop",u),a(t,"keydown",u),a(t,"focus",l)},resize:l}}"undefined"!=typeof n&&(t.exports=r)},{}],copyPaste:[function(e,t,n){function r(){return i?i.hasBeenDestroyed()&&i.init():i=new o,i.refCounter++,i}function o(){this.refCounter=0,this.init()}var i;"undefined"!=typeof n&&(t.exports=r),o.prototype.init=function(){var e,t;this.copyCallbacks=[],this.cutCallbacks=[],this.pasteCallbacks=[],t=document.body,document.getElementById("CopyPasteDiv")?(this.elDiv=document.getElementById("CopyPasteDiv"),this.elTextarea=this.elDiv.firstChild):(this.elDiv=document.createElement("div"),this.elDiv.id="CopyPasteDiv",e=this.elDiv.style,e.position="fixed",e.top="-10000px",e.left="-10000px",t.appendChild(this.elDiv),this.elTextarea=document.createElement("textarea"),this.elTextarea.className="copyPaste",this.elTextarea.onpaste=function(e){var t,n;"WebkitAppearance"in document.documentElement.style&&(t=e.clipboardData.getData("Text"),navigator.userAgent.indexOf("Safari")!==-1&&navigator.userAgent.indexOf("Chrome")===-1&&(n=t.split("\n"),""===n[n.length-1]&&n.pop(),t=n.join("\n")),this.value=t,e.preventDefault())},e=this.elTextarea.style,e.width="10000px",e.height="10000px",e.overflow="hidden",this.elDiv.appendChild(this.elTextarea),"undefined"!=typeof e.opacity&&(e.opacity=0)),this.onKeyDownRef=this.onKeyDown.bind(this),document.documentElement.addEventListener("keydown",this.onKeyDownRef,!1)},o.prototype.onKeyDown=function(e){function t(){var e=document.activeElement;return e.shadowRoot&&e.shadowRoot.activeElement&&(e=e.shadowRoot.activeElement),["INPUT","SELECT","TEXTAREA"].indexOf(e.nodeName)>-1||"true"===e.contentEditable}var n=this,r=!1;if(e.metaKey?r=!0:e.ctrlKey&&navigator.userAgent.indexOf("Mac")===-1&&(r=!0),r){if(document.activeElement!==this.elTextarea&&(""!==this.getSelectionText()||t()))return;this.selectNodeText(this.elTextarea),setTimeout(function(){document.activeElement!==n.elTextarea&&n.selectNodeText(n.elTextarea)},0)}e.isImmediatePropagationEnabled===!1||!r||67!==e.keyCode&&86!==e.keyCode&&88!==e.keyCode||(88===e.keyCode?setTimeout(function(){n.triggerCut(e)},0):86===e.keyCode&&setTimeout(function(){n.triggerPaste(e)},0))},o.prototype.selectNodeText=function(e){e&&e.select()},o.prototype.getSelectionText=function(){var e="";return window.getSelection?e=window.getSelection().toString():document.selection&&"Control"!==document.selection.type&&(e=document.selection.createRange().text),e},o.prototype.copyable=function(e){if("string"!=typeof e&&void 0===e.toString)throw new Error("copyable requires string parameter");this.elTextarea.value=e,this.selectNodeText(this.elTextarea)},o.prototype.onCut=function(e){this.cutCallbacks.push(e)},o.prototype.onPaste=function(e){this.pasteCallbacks.push(e)},o.prototype.removeCallback=function(e){var t,n;for(t=0,n=this.copyCallbacks.length;t<n;t++)if(this.copyCallbacks[t]===e)return this.copyCallbacks.splice(t,1),!0;for(t=0,n=this.cutCallbacks.length;t<n;t++)if(this.cutCallbacks[t]===e)return this.cutCallbacks.splice(t,1),!0;for(t=0,n=this.pasteCallbacks.length;t<n;t++)if(this.pasteCallbacks[t]===e)return this.pasteCallbacks.splice(t,1),!0;return!1},o.prototype.triggerCut=function(e){var t=this;t.cutCallbacks&&setTimeout(function(){for(var n=0,r=t.cutCallbacks.length;n<r;n++)t.cutCallbacks[n](e)},50)},o.prototype.triggerPaste=function(e,t){var n=this;n.pasteCallbacks&&setTimeout(function(){for(var r=t||n.elTextarea.value,o=0,i=n.pasteCallbacks.length;o<i;o++)n.pasteCallbacks[o](r,e)},50)},o.prototype.destroy=function(){this.hasBeenDestroyed()||0!==--this.refCounter||(this.elDiv&&this.elDiv.parentNode&&(this.elDiv.parentNode.removeChild(this.elDiv),this.elDiv=null,this.elTextarea=null),document.documentElement.removeEventListener("keydown",this.onKeyDownRef),this.onKeyDownRef=null)},o.prototype.hasBeenDestroyed=function(){return!this.refCounter}},{}],es6collections:[function(e,t,n){/*!
 * Copyright (C) 2011 by Andrea Giammarchi, @WebReflection
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */
!function(e){"use strict";function t(e,t){function r(e){return this&&this.constructor===r?(this._keys=[],this._values=[],this._itp=[],this.objectOnly=t,void(e&&n.call(this,e))):new r(e)}return t||b(e,"size",{get:g}),e.constructor=r,r.prototype=e,r}function n(e){this.add?e.forEach(this.add,this):e.forEach(function(e){this.set(e[0],e[1])},this)}function r(e){return this.has(e)&&(this._keys.splice(w,1),this._values.splice(w,1),this._itp.forEach(function(e){w<e[0]&&e[0]--})),-1<w}function o(e){return this.has(e)?this._values[w]:void 0}function i(e,t){if(this.objectOnly&&t!==Object(t))throw new TypeError("Invalid value used as weak collection key");if(t!=t||0===t)for(w=e.length;w--&&!y(e[w],t););else w=e.indexOf(t);return-1<w}function s(e){return i.call(this,this._values,e)}function a(e){return i.call(this,this._keys,e)}function l(e,t){return this.has(e)?this._values[w]=t:this._values[this._keys.push(e)-1]=t,this}function u(e){return this.has(e)||this._values.push(e),this}function d(){this._values.length=0}function c(){return m(this._itp,this._keys)}function h(){return m(this._itp,this._values)}function f(){return m(this._itp,this._keys,this._values)}function p(){return m(this._itp,this._values,this._values)}function m(e,t,n){var r=[0],o=!1;return e.push(r),{next:function(){var i,s=r[0];return!o&&s<t.length?(i=n?[t[s],n[s]]:t[s],r[0]++):(o=!0,e.splice(e.indexOf(r),1)),{done:o,value:i}}}}function g(){return this._values.length}function v(e,t){for(var n=this.entries();;){var r=n.next();if(r.done)break;e.call(t,r.value[1],r.value[0],this)}}var w,b=Object.defineProperty,y=function(e,t){return isNaN(e)?isNaN(t):e===t};"undefined"==typeof WeakMap&&(e.WeakMap=t({delete:r,clear:d,get:o,has:a,set:l},!0)),"undefined"==typeof Map&&(e.Map=t({delete:r,has:a,get:o,set:l,keys:c,values:h,entries:f,forEach:v,clear:d})),"undefined"==typeof Set&&(e.Set=t({has:s,add:u,delete:r,clear:d,keys:h,values:h,entries:p,forEach:v})),"undefined"==typeof WeakSet&&(e.WeakSet=t({delete:r,add:u,clear:d,has:s},!0))}("undefined"!=typeof n&&"undefined"!=typeof global?global:window)},{}],"hot-formula-parser":[function(_dereq_,module,exports){!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.formulaParser=t():e.formulaParser=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.rowLabelToIndex=t.rowIndexToLabel=t.columnLabelToIndex=t.columnIndexToLabel=t.toLabel=t.extractLabel=t.error=t.Parser=t.ERROR_VALUE=t.ERROR_REF=t.ERROR_NUM=t.ERROR_NULL=t.ERROR_NOT_AVAILABLE=t.ERROR_NAME=t.ERROR_DIV_ZERO=t.ERROR=t.SUPPORTED_FORMULAS=void 0;var o=n(1),i=n(7),s=r(i),a=n(43);t.SUPPORTED_FORMULAS=o.SUPPORTED_FORMULAS,t.ERROR=i.ERROR,t.ERROR_DIV_ZERO=i.ERROR_DIV_ZERO,t.ERROR_NAME=i.ERROR_NAME,t.ERROR_NOT_AVAILABLE=i.ERROR_NOT_AVAILABLE,t.ERROR_NULL=i.ERROR_NULL,t.ERROR_NUM=i.ERROR_NUM,t.ERROR_REF=i.ERROR_REF,t.ERROR_VALUE=i.ERROR_VALUE,t.Parser=o.Parser,t.error=s.default,t.extractLabel=a.extractLabel,t.toLabel=a.toLabel,t.columnIndexToLabel=a.columnIndexToLabel,t.columnLabelToIndex=a.columnLabelToIndex,t.rowIndexToLabel=a.rowIndexToLabel,t.rowLabelToIndex=a.rowLabelToIndex},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),t.Parser=t.SUPPORTED_FORMULAS=void 0;var a=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&a.return&&a.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(2);Object.defineProperty(t,"SUPPORTED_FORMULAS",{enumerable:!0,get:function(){return r(u).default}});var d=n(3),c=r(d),h=n(4),f=r(h),p=n(40),m=n(42),g=n(6),v=n(7),w=r(v),b=n(43),y=function(e){function t(){o(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.parser=new p.Parser,e.parser.yy={toNumber:g.toNumber,trimEdges:m.trimEdges,invertNumber:g.invertNumber,throwError:function(t){return e._throwError(t)},callVariable:function(t){return e._callVariable(t)},evaluateByOperator:f.default,callFunction:f.default,cellValue:function(t){return e._callCellValue(t)},rangeValue:function(t,n){return e._callRangeValue(t,n)}},e.variables=Object.create(null),e.setVariable("TRUE",!0).setVariable("FALSE",!1).setVariable("NULL",null),e}return s(t,e),l(t,[{key:"parse",value:function(e){var t=null,n=null;try{t=""===e?"":this.parser.parse(e)}catch(e){var r=(0,w.default)(e.message);n=r?r:(0,w.default)(v.ERROR)}return t instanceof Error&&(n=(0,w.default)(t.message)||(0,w.default)(v.ERROR),t=null),{error:n,result:t}}},{key:"setVariable",value:function(e,t){return this.variables[e]=t,this}},{key:"getVariable",value:function(e){return this.variables[e]}},{key:"_callVariable",value:function(e){var t=this.getVariable(e);if(this.emit("callVariable",e,function(e){void 0!==e&&(t=e)}),void 0===t)throw Error(v.ERROR_NAME);return t}},{key:"_callCellValue",value:function(e){e=e.toUpperCase();var t=(0,b.extractLabel)(e),n=a(t,2),r=n[0],o=n[1],i=void 0;return this.emit("callCellValue",{label:e,row:r,column:o},function(e){i=e}),i}},{key:"_callRangeValue",value:function(e,t){e=e.toUpperCase(),t=t.toUpperCase();var n=(0,b.extractLabel)(e),r=a(n,2),o=r[0],i=r[1],s=(0,b.extractLabel)(t),l=a(s,2),u=l[0],d=l[1],c={},h={};o.index<=u.index?(c.row=o,h.row=u):(c.row=u,h.row=o),i.index<=d.index?(c.column=i,h.column=d):(c.column=d,h.column=i),c.label=(0,b.toLabel)(c.row,c.column),h.label=(0,b.toLabel)(h.row,h.column);var f=[];return this.emit("callRangeValue",c,h,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];f=e}),f}},{key:"_throwError",value:function(e){if((0,v.isValidStrict)(e))throw Error(e);throw Error(v.ERROR)}}]),t}(c.default);t.Parser=y},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=["ABS","ACCRINT","ACOS","ACOSH","ACOT","ACOTH","ADD","AGGREGATE","AND","ARABIC","ARGS2ARRAY","ASIN","ASINH","ATAN","ATAN2","ATANH","AVEDEV","AVERAGE","AVERAGEA","AVERAGEIF","AVERAGEIFS","BASE","BESSELI","BESSELJ","BESSELK","BESSELY","BETA.DIST","BETA.INV","BETADIST","BETAINV","BIN2DEC","BIN2HEX","BIN2OCT","BINOM.DIST","BINOM.DIST.RANGE","BINOM.INV","BINOMDIST","BITAND","BITLSHIFT","BITOR","BITRSHIFT","BITXOR","CEILING","CEILINGMATH","CEILINGPRECISE","CHAR","CHISQ.DIST","CHISQ.DIST.RT","CHISQ.INV","CHISQ.INV.RT","CHOOSE","CHOOSE","CLEAN","CODE","COLUMN","COLUMNS","COMBIN","COMBINA","COMPLEX","CONCATENATE","CONFIDENCE","CONFIDENCE.NORM","CONFIDENCE.T","CONVERT","CORREL","COS","COSH","COT","COTH","COUNT","COUNTA","COUNTBLANK","COUNTIF","COUNTIFS","COUNTIN","COUNTUNIQUE","COVARIANCE.P","COVARIANCE.S","CSC","CSCH","CUMIPMT","CUMPRINC","DATE","DATEVALUE","DAY","DAYS","DAYS360","DB","DDB","DEC2BIN","DEC2HEX","DEC2OCT","DECIMAL","DEGREES","DELTA","DEVSQ","DIVIDE","DOLLAR","DOLLARDE","DOLLARFR","E","EDATE","EFFECT","EOMONTH","EQ","ERF","ERFC","EVEN","EXACT","EXPON.DIST","EXPONDIST","F.DIST","F.DIST.RT","F.INV","F.INV.RT","FACT","FACTDOUBLE","FALSE","FDIST","FDISTRT","FIND","FINV","FINVRT","FISHER","FISHERINV","FIXED","FLATTEN","FLOOR","FORECAST","FREQUENCY","FV","FVSCHEDULE","GAMMA","GAMMA.DIST","GAMMA.INV","GAMMADIST","GAMMAINV","GAMMALN","GAMMALN.PRECISE","GAUSS","GCD","GEOMEAN","GESTEP","GROWTH","GTE","HARMEAN","HEX2BIN","HEX2DEC","HEX2OCT","HOUR","HTML2TEXT","HYPGEOM.DIST","HYPGEOMDIST","IF","IMABS","IMAGINARY","IMARGUMENT","IMCONJUGATE","IMCOS","IMCOSH","IMCOT","IMCSC","IMCSCH","IMDIV","IMEXP","IMLN","IMLOG10","IMLOG2","IMPOWER","IMPRODUCT","IMREAL","IMSEC","IMSECH","IMSIN","IMSINH","IMSQRT","IMSUB","IMSUM","IMTAN","INT","INTERCEPT","INTERVAL","IPMT","IRR","ISBINARY","ISBLANK","ISEVEN","ISLOGICAL","ISNONTEXT","ISNUMBER","ISODD","ISODD","ISOWEEKNUM","ISPMT","ISTEXT","JOIN","KURT","LARGE","LCM","LEFT","LEN","LINEST","LN","LOG","LOG10","LOGEST","LOGNORM.DIST","LOGNORM.INV","LOGNORMDIST","LOGNORMINV","LOWER","LT","LTE","MATCH","MAX","MAXA","MEDIAN","MID","MIN","MINA","MINUS","MINUTE","MIRR","MOD","MODE.MULT","MODE.SNGL","MODEMULT","MODESNGL","MONTH","MROUND","MULTINOMIAL","MULTIPLY","NE","NEGBINOM.DIST","NEGBINOMDIST","NETWORKDAYS","NOMINAL","NORM.DIST","NORM.INV","NORM.S.DIST","NORM.S.INV","NORMDIST","NORMINV","NORMSDIST","NORMSINV","NOT","NOW","NPER","NPV","NUMBERS","NUMERAL","OCT2BIN","OCT2DEC","OCT2HEX","ODD","OR","PDURATION","PEARSON","PERCENTILEEXC","PERCENTILEINC","PERCENTRANKEXC","PERCENTRANKINC","PERMUT","PERMUTATIONA","PHI","PI","PMT","POISSON.DIST","POISSONDIST","POW","POWER","PPMT","PROB","PRODUCT","PROPER","PV","QUARTILE.EXC","QUARTILE.INC","QUARTILEEXC","QUARTILEINC","QUOTIENT","RADIANS","RAND","RANDBETWEEN","RANK.AVG","RANK.EQ","RANKAVG","RANKEQ","RATE","REFERENCE","REGEXEXTRACT","REGEXMATCH","REGEXREPLACE","REPLACE","REPT","RIGHT","ROMAN","ROUND","ROUNDDOWN","ROUNDUP","ROW","ROWS","RRI","RSQ","SEARCH","SEC","SECH","SECOND","SERIESSUM","SIGN","SIN","SINH","SKEW","SKEW.P","SKEWP","SLN","SLOPE","SMALL","SPLIT","SPLIT","SQRT","SQRTPI","STANDARDIZE","STDEV.P","STDEV.S","STDEVA","STDEVP","STDEVPA","STDEVS","STEYX","SUBSTITUTE","SUBTOTAL","SUM","SUMIF","SUMIFS","SUMPRODUCT","SUMSQ","SUMX2MY2","SUMX2PY2","SUMXMY2","SWITCH","SYD","T","T.DIST","T.DIST.2T","T.DIST.RT","T.INV","T.INV.2T","TAN","TANH","TBILLEQ","TBILLPRICE","TBILLYIELD","TDIST","TDIST2T","TDISTRT","TEXT","TIME","TIMEVALUE","TINV","TINV2T","TODAY","TRANSPOSE","TREND","TRIM","TRIMMEAN","TRUE","TRUNC","UNICHAR","UNICODE","UNIQUE","UPPER","VALUE","VAR.P","VAR.S","VARA","VARP","VARPA","VARS","WEEKDAY","WEEKNUM","WEIBULL.DIST","WEIBULLDIST","WORKDAY","XIRR","XNPV","XOR","YEAR","YEARFRAC"];t.default=n},function(e,t){function n(){}n.prototype={on:function(e,t,n){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){function r(){o.off(e,r),t.apply(n,arguments)}var o=this;return r._=t,this.on(e,r,n)},emit:function(e){var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),r=0,o=n.length;for(r;r<o;r++)n[r].fn.apply(n[r].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),r=n[e],o=[];if(r&&t)for(var i=0,s=r.length;i<s;i++)r[i].fn!==t&&r[i].fn._!==t&&o.push(r[i]);return o.length?n[e]=o:delete n[e],this}},e.exports=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(e=e.toUpperCase(),!D[e])throw Error(I.ERROR_NAME);return D[e].apply(D,o(t))}function s(e,t){Array.isArray(e)||(e=[e.toUpperCase()]),e.forEach(function(e){t.isFactory?D[e]=t(e):D[e]=t})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i,t.registerOperation=s;var a=n(5),l=r(a),u=n(8),d=r(u),c=n(9),h=r(c),f=n(10),p=r(f),m=n(11),g=r(m),v=n(32),w=r(v),b=n(33),y=r(b),_=n(34),C=r(_),R=n(35),M=r(R),E=n(36),S=r(E),O=n(37),T=r(O),A=n(38),N=r(A),x=n(39),k=r(x),I=n(7),D=Object.create(null);s(l.default.SYMBOL,l.default),s(d.default.SYMBOL,d.default),s(h.default.SYMBOL,h.default),s(p.default.SYMBOL,p.default),s(k.default.SYMBOL,k.default),s(g.default.SYMBOL,g.default),s(w.default.SYMBOL,w.default),s(y.default.SYMBOL,y.default),s(C.default.SYMBOL,C.default),s(M.default.SYMBOL,M.default),s(T.default.SYMBOL,T.default),s(N.default.SYMBOL,N.default),s(S.default.SYMBOL,S.default)},function(e,t,n){"use strict";function r(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var s=n.reduce(function(e,t){return e+(0,o.toNumber)(t)},(0,o.toNumber)(e));if(isNaN(s))throw Error(i.ERROR_VALUE);return s}Object.defineProperty(t,"__esModule",{value:!0}),t.SYMBOL=void 0,t.default=r;var o=n(6),i=n(7),s=t.SYMBOL="+";r.SYMBOL=s},function(e,t){"use strict";function n(e){var t=void 0;return"number"==typeof e?t=e:"string"==typeof e&&(t=e.indexOf(".")>-1?parseFloat(e):parseInt(e,10)),t}function r(e){return-1*n(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.toNumber=n,t.invertNumber=r},function(e,t){"use strict";function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e){var t=void 0;return e=(e+"").replace(/#|!|\?/g,""),p[e]&&(t=p[e]),t?t:null}function o(e){var t=!1;for(var n in p)if(p.hasOwnProperty(n)&&p[n]===e){t=!0;break}return t}Object.defineProperty(t,"__esModule",{value:!0});var i;t.default=r,t.isValidStrict=o;var s=t.ERROR="ERROR",a=t.ERROR_DIV_ZERO="DIV/0",l=t.ERROR_NAME="NAME",u=t.ERROR_NOT_AVAILABLE="N/A",d=t.ERROR_NULL="NULL",c=t.ERROR_NUM="NUM",h=t.ERROR_REF="REF",f=t.ERROR_VALUE="VALUE",p=(i={},n(i,s,"#ERROR!"),n(i,a,"#DIV/0!"),n(i,l,"#NAME?"),n(i,u,"#N/A"),n(i,d,"#NULL!"),n(i,c,"#NUM!"),n(i,h,"#REF!"),n(i,f,"#VALUE!"),i)},function(e,t){"use strict";function n(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(function(e,t){return e+t.toString()},"")}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var r=t.SYMBOL="&";n.SYMBOL=r},function(e,t,n){"use strict";function r(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var s=n.reduce(function(e,t){return e/(0,o.toNumber)(t)},(0,o.toNumber)(e));if(s===1/0)throw Error(i.ERROR_DIV_ZERO);if(isNaN(s))throw Error(i.ERROR_VALUE);return s}Object.defineProperty(t,"__esModule",{value:!0}),t.SYMBOL=void 0,t.default=r;var o=n(6),i=n(7),s=t.SYMBOL="/";r.SYMBOL=s},function(e,t){"use strict";function n(e,t){return e===t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var r=t.SYMBOL="=";n.SYMBOL=r},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function i(e){return function(){e=e.toUpperCase();var t=e.split("."),n=!1,r=void 0;if(1===t.length)d[t[0]]&&(n=!0,r=d[t[0]].apply(d,arguments));else{for(var o=t.length,i=0,s=d;i<o;)if(s=s[t[i]],i++,!s){s=null;break}s&&(n=!0,r=s.apply(void 0,arguments))}if(!n)throw Error(l.ERROR_NAME);return r}}Object.defineProperty(t,"__esModule",{value:!0}),t.SYMBOL=void 0,t.default=i;var s=n(2),a=o(s),l=n(7),u=n(12),d=r(u),c=t.SYMBOL=a.default;i.isFactory=!0,i.SYMBOL=c},function(e,t,n){var r=[n(13),n(28),n(25),n(29),n(14),n(18),n(27),n(30),n(24),n(31),n(17),n(23)];for(var o in r){var i=r[o];for(var s in i)t[s]=t[s]||i[s]}},function(e,t,n){function r(e,t){if(t)for(var n in t)e[n]=t[n];return e}var o=n(14),i=n(17),s=n(25),a=n(27);t.BETADIST=i.BETA.DIST,t.BETAINV=i.BETA.INV,t.BINOMDIST=i.BINOM.DIST,t.CEILING=t.ISOCEILING=r(o.CEILING.MATH,o.CEILING),t.CEILINGMATH=o.CEILING.MATH,t.CEILINGPRECISE=o.CEILING.PRECISE,t.CHIDIST=i.CHISQ.DIST,t.CHIDISTRT=i.CHISQ.DIST.RT,t.CHIINV=i.CHISQ.INV,t.CHIINVRT=i.CHISQ.INV.RT,t.CHITEST=i.CHISQ.TEST,t.CONFIDENCE=r(i.CONFIDENCE.NORM,i.CONFIDENCE),t.COVAR=i.COVARIANCE.P,t.COVARIANCEP=i.COVARIANCE.P,t.COVARIANCES=i.COVARIANCE.S,t.CRITBINOM=i.BINOM.INV,t.EXPONDIST=i.EXPON.DIST,t.ERFCPRECISE=s.ERFC.PRECISE,t.ERFPRECISE=s.ERF.PRECISE,t.FDIST=i.F.DIST,t.FDISTRT=i.F.DIST.RT,t.FINVRT=i.F.INV.RT,t.FINV=i.F.INV,t.FLOOR=r(o.FLOOR.MATH,o.FLOOR),t.FLOORMATH=o.FLOOR.MATH,t.FLOORPRECISE=o.FLOOR.PRECISE,t.FTEST=i.F.TEST,t.GAMMADIST=i.GAMMA.DIST,t.GAMMAINV=i.GAMMA.INV,t.GAMMALNPRECISE=i.GAMMALN.PRECISE,t.HYPGEOMDIST=i.HYPGEOM.DIST,t.LOGINV=i.LOGNORM.INV,t.LOGNORMINV=i.LOGNORM.INV,t.LOGNORMDIST=i.LOGNORM.DIST,t.MODE=r(i.MODE.SNGL,i.MODE),t.MODEMULT=i.MODE.MULT,t.MODESNGL=i.MODE.SNGL,t.NEGBINOMDIST=i.NEGBINOM.DIST,t.NETWORKDAYSINTL=a.NETWORKDAYS.INTL,t.NORMDIST=i.NORM.DIST,t.NORMINV=i.NORM.INV,t.NORMSDIST=i.NORM.S.DIST,t.NORMSINV=i.NORM.S.INV,t.PERCENTILE=r(i.PERCENTILE.EXC,i.PERCENTILE),t.PERCENTILEEXC=i.PERCENTILE.EXC,t.PERCENTILEINC=i.PERCENTILE.INC,t.PERCENTRANK=r(i.PERCENTRANK.INC,i.PERCENTRANK),t.PERCENTRANKEXC=i.PERCENTRANK.EXC,t.PERCENTRANKINC=i.PERCENTRANK.INC,t.POISSON=r(i.POISSON.DIST,i.POISSON),t.POISSONDIST=i.POISSON.DIST,t.QUARTILE=r(i.QUARTILE.INC,i.QUARTILE),t.QUARTILEEXC=i.QUARTILE.EXC,t.QUARTILEINC=i.QUARTILE.INC,t.RANK=r(i.RANK.EQ,i.RANK),t.RANKAVG=i.RANK.AVG,t.RANKEQ=i.RANK.EQ,t.SKEWP=i.SKEW.P,t.STDEV=r(i.STDEV.S,i.STDEV),t.STDEVP=i.STDEV.P,t.STDEVS=i.STDEV.S,t.TDIST=i.T.DIST,t.TDISTRT=i.T.DIST.RT,t.TINV=i.T.INV,t.TTEST=i.T.TEST,t.VAR=r(i.VAR.S,i.VAR),t.VARP=i.VAR.P,t.VARS=i.VAR.S,t.WEIBULL=r(i.WEIBULL.DIST,i.WEIBULL),t.WEIBULLDIST=i.WEIBULL.DIST,t.WORKDAYINTL=a.WORKDAY.INTL,t.ZTEST=i.Z.TEST},function(module,exports,__webpack_require__){var utils=__webpack_require__(15),error=__webpack_require__(16),statistical=__webpack_require__(17),information=__webpack_require__(24);exports.ABS=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var t=Math.abs(e);return t},exports.ACOS=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var t=Math.acos(e);return isNaN(t)&&(t=error.num),t},exports.ACOSH=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var t=Math.log(e+Math.sqrt(e*e-1));return isNaN(t)&&(t=error.num),t},exports.ACOT=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var t=Math.atan(1/e);return t},exports.ACOTH=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var t=.5*Math.log((e+1)/(e-1));return isNaN(t)&&(t=error.num),t},exports.AGGREGATE=function(e,t,n,r){if(e=utils.parseNumber(e),t=utils.parseNumber(e),utils.anyIsError(e,t))return error.value;switch(e){case 1:return statistical.AVERAGE(n);case 2:return statistical.COUNT(n);case 3:return statistical.COUNTA(n);case 4:return statistical.MAX(n);case 5:return statistical.MIN(n);case 6:return exports.PRODUCT(n);case 7:return statistical.STDEV.S(n);case 8:return statistical.STDEV.P(n);case 9:return exports.SUM(n);case 10:return statistical.VAR.S(n);case 11:return statistical.VAR.P(n);case 12:return statistical.MEDIAN(n);case 13:return statistical.MODE.SNGL(n);case 14:return statistical.LARGE(n,r);case 15:return statistical.SMALL(n,r);case 16:return statistical.PERCENTILE.INC(n,r);case 17:return statistical.QUARTILE.INC(n,r);case 18:return statistical.PERCENTILE.EXC(n,r);case 19:return statistical.QUARTILE.EXC(n,r)}},exports.ARABIC=function(e){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return error.value;var t=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(e){t+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[e]}),t},exports.ASIN=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var t=Math.asin(e);return isNaN(t)&&(t=error.num),t},exports.ASINH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},exports.ATAN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.atan(e)},exports.ATAN2=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:Math.atan2(e,t)},exports.ATANH=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var t=Math.log((1+e)/(1-e))/2;return isNaN(t)&&(t=error.num),t},exports.BASE=function(e,t,n){if(n=n||0,e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n))return error.value;n=void 0===n?0:n;var r=e.toString(t);return new Array(Math.max(n+1-r.length,0)).join("0")+r},exports.CEILING=function(e,t,n){if(t=void 0===t?1:Math.abs(t),n=n||0,e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n))return error.value;if(0===t)return 0;var r=-Math.floor(Math.log(t)/Math.log(10));return e>=0?exports.ROUND(Math.ceil(e/t)*t,r):0===n?-exports.ROUND(Math.floor(Math.abs(e)/t)*t,r):-exports.ROUND(Math.ceil(Math.abs(e)/t)*t,r)},exports.CEILING.MATH=exports.CEILING,exports.CEILING.PRECISE=exports.CEILING,exports.COMBIN=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:exports.FACT(e)/(exports.FACT(t)*exports.FACT(e-t))},exports.COMBINA=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:0===e&&0===t?1:exports.COMBIN(e+t-1,e-1)},exports.COS=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.cos(e)},exports.COSH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},exports.COT=function(e){return e=utils.parseNumber(e),e instanceof Error?e:1/Math.tan(e)},exports.COTH=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var t=Math.exp(2*e);return(t+1)/(t-1)},exports.CSC=function(e){return e=utils.parseNumber(e),e instanceof Error?e:1/Math.sin(e)},exports.CSCH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:2/(Math.exp(e)-Math.exp(-e))},exports.DECIMAL=function(e,t){return arguments.length<1?error.value:parseInt(e,t)},exports.DEGREES=function(e){return e=utils.parseNumber(e),e instanceof Error?e:180*e/Math.PI},exports.EVEN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:exports.CEILING(e,-2,-1)},exports.EXP=Math.exp;var MEMOIZED_FACT=[];exports.FACT=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var t=Math.floor(e);return 0===t||1===t?1:MEMOIZED_FACT[t]>0?MEMOIZED_FACT[t]:(MEMOIZED_FACT[t]=exports.FACT(t-1)*t,MEMOIZED_FACT[t])},exports.FACTDOUBLE=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var t=Math.floor(e);return t<=0?1:t*exports.FACTDOUBLE(t-2)},exports.FLOOR=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;if(0===t)return 0;if(!(e>0&&t>0||e<0&&t<0))return error.num;t=Math.abs(t);var n=-Math.floor(Math.log(t)/Math.log(10));return e>=0?exports.ROUND(Math.floor(e/t)*t,n):-exports.ROUND(Math.ceil(Math.abs(e)/t),n)},exports.FLOOR.MATH=function(e,t,n){if(t=void 0===t?1:t,n=void 0===n?0:n,e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n))return error.value;if(0===t)return 0;t=t?Math.abs(t):1;var r=-Math.floor(Math.log(t)/Math.log(10));return e>=0?exports.ROUND(Math.floor(e/t)*t,r):0===n||void 0===n?-exports.ROUND(Math.ceil(Math.abs(e)/t)*t,r):-exports.ROUND(Math.floor(Math.abs(e)/t)*t,r)},exports.FLOOR.PRECISE=exports.FLOOR.MATH,exports.GCD=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=e.length,n=e[0],r=n<0?-n:n,o=1;o<t;o++){for(var i=e[o],s=i<0?-i:i;r&&s;)r>s?r%=s:s%=r;r+=s}return r},exports.INT=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.floor(e)},exports.ISO={CEILING:exports.CEILING},exports.LCM=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t,n,r,o,i=1;void 0!==(r=e.pop());)for(;r>1;){if(r%2){for(t=3,n=Math.floor(Math.sqrt(r));t<=n&&r%t;t+=2);o=t<=n?t:r}else o=2;for(r/=o,i*=o,t=e.length;t;e[--t]%o===0&&1===(e[t]/=o)&&e.splice(t,1));}return i},exports.LN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.log(e)},exports.LN10=function(){return Math.log(10)},exports.LN2=function(){return Math.log(2)},exports.LOG10E=function(){return Math.LOG10E},exports.LOG2E=function(){return Math.LOG2E},exports.LOG=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:(t=void 0===t?10:t,Math.log(e)/Math.log(t))},exports.LOG10=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.log(e)/Math.log(10)},exports.MOD=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;if(0===t)return error.div0;var n=Math.abs(e%t);return t>0?n:-n},exports.MROUND=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e*t<0?error.num:Math.round(e/t)*t},exports.MULTINOMIAL=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=0,n=1,r=0;r<e.length;r++)t+=e[r],n*=exports.FACT(e[r]);return exports.FACT(t)/n},exports.ODD=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var t=Math.ceil(Math.abs(e));return t=1&t?t:t+1,e>0?t:-t},exports.PI=function(){return Math.PI},exports.E=function(){return Math.E},exports.POWER=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;var n=Math.pow(e,t);return isNaN(n)?error.num:n},exports.PRODUCT=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=1,n=0;n<e.length;n++)t*=e[n];return t},exports.QUOTIENT=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:parseInt(e/t,10)},exports.RADIANS=function(e){return e=utils.parseNumber(e),e instanceof Error?e:e*Math.PI/180},exports.RAND=function(){return Math.random()},exports.RANDBETWEEN=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e+Math.ceil((t-e+1)*Math.random())-1},exports.ROMAN=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;for(var t=String(e).split(""),n=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"],r="",o=3;o--;)r=(n[+t.pop()+10*o]||"")+r;return new Array(+t.join("")+1).join("M")+r},exports.ROUND=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:Math.round(e*Math.pow(10,t))/Math.pow(10,t)},exports.ROUNDDOWN=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;var n=e>0?1:-1;return n*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},exports.ROUNDUP=function(e,t){if(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;var n=e>0?1:-1;return n*Math.ceil(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)},exports.SEC=function(e){return e=utils.parseNumber(e),e instanceof Error?e:1/Math.cos(e)},exports.SECH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},exports.SERIESSUM=function(e,t,n,r){if(e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),r=utils.parseNumberArray(r),utils.anyIsError(e,t,n,r))return error.value;for(var o=r[0]*Math.pow(e,t),i=1;i<r.length;i++)o+=r[i]*Math.pow(e,t+i*n);return o},exports.SIGN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:e<0?-1:0===e?0:1},exports.SIN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.sin(e)},exports.SINH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},exports.SQRT=function(e){return e=utils.parseNumber(e),e instanceof Error?e:e<0?error.num:Math.sqrt(e)},exports.SQRTPI=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.sqrt(e*Math.PI)},exports.SQRT1_2=function(){return 1/Math.sqrt(2)},exports.SQRT2=function(){return Math.sqrt(2)},exports.SUBTOTAL=function(e,t){if(e=utils.parseNumber(e),e instanceof Error)return e;switch(e){case 1:return statistical.AVERAGE(t);case 2:return statistical.COUNT(t);case 3:return statistical.COUNTA(t);case 4:return statistical.MAX(t);case 5:return statistical.MIN(t);case 6:return exports.PRODUCT(t);case 7:return statistical.STDEV.S(t);case 8:return statistical.STDEV.P(t);case 9:return exports.SUM(t);case 10:return statistical.VAR.S(t);case 11:return statistical.VAR.P(t);case 101:return statistical.AVERAGE(t);case 102:return statistical.COUNT(t);case 103:return statistical.COUNTA(t);case 104:return statistical.MAX(t);case 105:return statistical.MIN(t);case 106:return exports.PRODUCT(t);case 107:return statistical.STDEV.S(t);case 108:return statistical.STDEV.P(t);case 109:return exports.SUM(t);case 110:return statistical.VAR.S(t);case 111:return statistical.VAR.P(t)}},exports.ADD=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e+t)},exports.MINUS=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e-t)},exports.DIVIDE=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:0===t?error.div0:e/t)},exports.MULTIPLY=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:e*t)},exports.GTE=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:e>=t)},exports.LT=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:e<t)},exports.LTE=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:e<=t)},exports.EQ=function(e,t){return 2!==arguments.length?error.na:e===t},exports.NE=function(e,t){return 2!==arguments.length?error.na:e!==t},exports.POW=function(e,t){return 2!==arguments.length?error.na:(e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.error:exports.POWER(e,t))},exports.SUM=function(){var e=0;return utils.arrayEach(utils.argsToArray(arguments),function(t){if("number"==typeof t)e+=t;else if("string"==typeof t){var n=parseFloat(t);!isNaN(n)&&(e+=n)}else Array.isArray(t)&&(e+=exports.SUM.apply(null,t))}),e},exports.SUMIF=function(range,criteria){if(range=utils.parseNumberArray(utils.flatten(range)),range instanceof Error)return range;for(var result=0,i=0;i<range.length;i++)result+=eval(range[i]+criteria)?range[i]:0;return result},exports.SUMIFS=function(){var args=utils.argsToArray(arguments),range=utils.parseNumberArray(utils.flatten(args.shift()));if(range instanceof Error)return range;for(var criteria=args,n_range_elements=range.length,n_criterias=criteria.length,result=0,i=0;i<n_range_elements;i++){for(var el=range[i],condition="",c=0;c<n_criterias;c++)condition+=el+criteria[c],c!==n_criterias-1&&(condition+="&&");eval(condition)&&(result+=el)}return result},exports.SUMPRODUCT=function(){if(!arguments||0===arguments.length)return error.value;for(var e,t,n,r,o=arguments.length+1,i=0,s=0;s<arguments[0].length;s++)if(arguments[0][s]instanceof Array)for(var a=0;a<arguments[0][s].length;a++){for(e=1,t=1;t<o;t++){if(r=utils.parseNumber(arguments[t-1][s][a]),r instanceof Error)return r;e*=r}i+=e}else{for(e=1,t=1;t<o;t++){if(n=utils.parseNumber(arguments[t-1][s]),n instanceof Error)return n;e*=n}i+=e}return i},exports.SUMSQ=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=0,n=e.length,r=0;r<n;r++)t+=information.ISNUMBER(e[r])?e[r]*e[r]:0;return t},exports.SUMX2MY2=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),
utils.anyIsError(e,t))return error.value;for(var n=0,r=0;r<e.length;r++)n+=e[r]*e[r]-t[r]*t[r];return n},exports.SUMX2PY2=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;var n=0;e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t));for(var r=0;r<e.length;r++)n+=e[r]*e[r]+t[r]*t[r];return n},exports.SUMXMY2=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;var n=0;e=utils.flatten(e),t=utils.flatten(t);for(var r=0;r<e.length;r++)n+=Math.pow(e[r]-t[r],2);return n},exports.TAN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.tan(e)},exports.TANH=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var t=Math.exp(2*e);return(t-1)/(t+1)},exports.TRUNC=function(e,t){if(t=void 0===t?0:t,e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;var n=e>0?1:-1;return n*Math.floor(Math.abs(e)*Math.pow(10,t))/Math.pow(10,t)}},function(e,t,n){var r=n(16);t.flattenShallow=function(e){return e&&e.reduce?e.reduce(function(e,t){var n=Array.isArray(e),r=Array.isArray(t);return n&&r?e.concat(t):n?(e.push(t),e):r?[e].concat(t):[e,t]}):e},t.isFlat=function(e){if(!e)return!1;for(var t=0;t<e.length;++t)if(Array.isArray(e[t]))return!1;return!0},t.flatten=function(){for(var e=t.argsToArray.apply(null,arguments);!t.isFlat(e);)e=t.flattenShallow(e);return e},t.argsToArray=function(e){var n=[];return t.arrayEach(e,function(e){n.push(e)}),n},t.numbers=function(){var e=this.flatten.apply(null,arguments);return e.filter(function(e){return"number"==typeof e})},t.cleanFloat=function(e){var t=1e14;return Math.round(e*t)/t},t.parseBool=function(e){if("boolean"==typeof e)return e;if(e instanceof Error)return e;if("number"==typeof e)return 0!==e;if("string"==typeof e){var t=e.toUpperCase();if("TRUE"===t)return!0;if("FALSE"===t)return!1}return e instanceof Date&&!isNaN(e)||r.value},t.parseNumber=function(e){return void 0===e||""===e?r.value:isNaN(e)?r.value:parseFloat(e)},t.parseNumberArray=function(e){var n;if(!e||0===(n=e.length))return r.value;for(var o;n--;){if(o=t.parseNumber(e[n]),o===r.value)return o;e[n]=o}return e},t.parseMatrix=function(e){var n;if(!e||0===(n=e.length))return r.value;for(var o,i=0;i<e.length;i++)if(o=t.parseNumberArray(e[i]),e[i]=o,o instanceof Error)return o;return e};var o=new Date(1900,0,1);t.parseDate=function(e){if(!isNaN(e)){if(e instanceof Date)return new Date(e);var t=parseInt(e,10);return t<0?r.num:t<=60?new Date(o.getTime()+864e5*(t-1)):new Date(o.getTime()+864e5*(t-2))}return"string"!=typeof e||(e=new Date(e),isNaN(e))?r.value:e},t.parseDateArray=function(e){for(var t,n=e.length;n--;){if(t=this.parseDate(e[n]),t===r.value)return t;e[n]=t}return e},t.anyIsError=function(){for(var e=arguments.length;e--;)if(arguments[e]instanceof Error)return!0;return!1},t.arrayValuesToNumbers=function(e){for(var t,n=e.length;n--;)if(t=e[n],"number"!=typeof t)if(t!==!0)if(t!==!1){if("string"==typeof t){var r=this.parseNumber(t);r instanceof Error?e[n]=0:e[n]=r}}else e[n]=0;else e[n]=1;return e},t.rest=function(e,t){return t=t||1,e&&"function"==typeof e.slice?e.slice(t):e},t.initial=function(e,t){return t=t||1,e&&"function"==typeof e.slice?e.slice(0,e.length-t):e},t.arrayEach=function(e,t){for(var n=-1,r=e.length;++n<r&&t(e[n],n,e)!==!1;);return e}},function(e,t){t.nil=new Error("#NULL!"),t.div0=new Error("#DIV/0!"),t.value=new Error("#VALUE!"),t.ref=new Error("#REF!"),t.name=new Error("#NAME?"),t.num=new Error("#NUM!"),t.na=new Error("#N/A"),t.error=new Error("#ERROR!"),t.data=new Error("#GETTING_DATA")},function(module,exports,__webpack_require__){var mathTrig=__webpack_require__(14),text=__webpack_require__(18),jStat=__webpack_require__(22).jStat,utils=__webpack_require__(15),error=__webpack_require__(16),misc=__webpack_require__(23),SQRT2PI=2.5066282746310002;exports.AVEDEV=function(){var e=utils.parseNumberArray(utils.flatten(arguments));return e instanceof Error?e:jStat.sum(jStat(e).subtract(jStat.mean(e)).abs()[0])/e.length},exports.AVERAGE=function(){for(var e,t=utils.numbers(utils.flatten(arguments)),n=t.length,r=0,o=0,i=0;i<n;i++)r+=t[i],o+=1;return e=r/o,isNaN(e)&&(e=error.num),e},exports.AVERAGEA=function(){for(var e,t=utils.flatten(arguments),n=t.length,r=0,o=0,i=0;i<n;i++){var s=t[i];"number"==typeof s&&(r+=s),s===!0&&r++,null!==s&&o++}return e=r/o,isNaN(e)&&(e=error.num),e},exports.AVERAGEIF=function(range,criteria,average_range){if(arguments.length<=1)return error.na;if(average_range=average_range||range,range=utils.flatten(range),average_range=utils.parseNumberArray(utils.flatten(average_range)),average_range instanceof Error)return average_range;for(var average_count=0,result=0,i=0;i<range.length;i++)eval(range[i]+criteria)&&(result+=average_range[i],average_count++);return result/average_count},exports.AVERAGEIFS=function(){for(var args=utils.argsToArray(arguments),criteria=(args.length-1)/2,range=utils.flatten(args[0]),count=0,result=0,i=0;i<range.length;i++){for(var condition="",j=0;j<criteria;j++)condition+=args[2*j+1][i]+args[2*j+2],j!==criteria-1&&(condition+="&&");eval(condition)&&(result+=range[i],count++)}var average=result/count;return isNaN(average)?0:average},exports.BETA={},exports.BETA.DIST=function(e,t,n,r,o,i){return arguments.length<4?error.value:(o=void 0===o?0:o,i=void 0===i?1:i,e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),o=utils.parseNumber(o),i=utils.parseNumber(i),utils.anyIsError(e,t,n,o,i)?error.value:(e=(e-o)/(i-o),r?jStat.beta.cdf(e,t,n):jStat.beta.pdf(e,t,n)))},exports.BETA.INV=function(e,t,n,r,o){return r=void 0===r?0:r,o=void 0===o?1:o,e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),r=utils.parseNumber(r),o=utils.parseNumber(o),utils.anyIsError(e,t,n,r,o)?error.value:jStat.beta.inv(e,t,n)*(o-r)+r},exports.BINOM={},exports.BINOM.DIST=function(e,t,n,r){return e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(e,t,n,r)?error.value:r?jStat.binomial.cdf(e,t,n):jStat.binomial.pdf(e,t,n)},exports.BINOM.DIST.RANGE=function(e,t,n,r){if(r=void 0===r?n:r,e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(e,t,n,r))return error.value;for(var o=0,i=n;i<=r;i++)o+=mathTrig.COMBIN(e,i)*Math.pow(t,i)*Math.pow(1-t,e-i);return o},exports.BINOM.INV=function(e,t,n){if(e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n))return error.value;for(var r=0;r<=e;){if(jStat.binomial.cdf(r,e,t)>=n)return r;r++}},exports.CHISQ={},exports.CHISQ.DIST=function(e,t,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:n?jStat.chisquare.cdf(e,t):jStat.chisquare.pdf(e,t)},exports.CHISQ.DIST.RT=function(e,t){return!e|!t?error.na:e<1||t>Math.pow(10,10)?error.num:"number"!=typeof e||"number"!=typeof t?error.value:1-jStat.chisquare.cdf(e,t)},exports.CHISQ.INV=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:jStat.chisquare.inv(e,t)},exports.CHISQ.INV.RT=function(e,t){return!e|!t?error.na:e<0||e>1||t<1||t>Math.pow(10,10)?error.num:"number"!=typeof e||"number"!=typeof t?error.value:jStat.chisquare.inv(1-e,t)},exports.CHISQ.TEST=function(e,t){function n(e,t){var n=Math.exp(-.5*e);t%2===1&&(n*=Math.sqrt(2*e/d));for(var r=t;r>=2;)n=n*e/r,r-=2;for(var o=n,i=t;o>1e-10*n;)i+=2,o=o*e/i,n+=o;return 1-n}if(2!==arguments.length)return error.na;if(!(e instanceof Array&&t instanceof Array))return error.value;if(e.length!==t.length)return error.value;if(e[0]&&t[0]&&e[0].length!==t[0].length)return error.value;var r,o,i,s=e.length;for(o=0;o<s;o++)e[o]instanceof Array||(r=e[o],e[o]=[],e[o].push(r)),t[o]instanceof Array||(r=t[o],t[o]=[],t[o].push(r));var a=e[0].length,l=1===a?s-1:(s-1)*(a-1),u=0,d=Math.PI;for(o=0;o<s;o++)for(i=0;i<a;i++)u+=Math.pow(e[o][i]-t[o][i],2)/t[o][i];return Math.round(1e6*n(u,l))/1e6},exports.COLUMN=function(e,t){if(2!==arguments.length)return error.na;if(t<0)return error.num;if(!(e instanceof Array)||"number"!=typeof t)return error.value;if(0!==e.length)return jStat.col(e,t)},exports.COLUMNS=function(e){return 1!==arguments.length?error.na:e instanceof Array?0===e.length?0:jStat.cols(e):error.value},exports.CONFIDENCE={},exports.CONFIDENCE.NORM=function(e,t,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n)?error.value:jStat.normalci(1,e,t,n)[1]-1},exports.CONFIDENCE.T=function(e,t,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n)?error.value:jStat.tci(1,e,t,n)[1]-1},exports.CORREL=function(e,t){return e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t)?error.value:jStat.corrcoeff(e,t)},exports.COUNT=function(){return utils.numbers(utils.flatten(arguments)).length},exports.COUNTA=function(){var e=utils.flatten(arguments);return e.length-exports.COUNTBLANK(e)},exports.COUNTIN=function(e,t){var n=0;e=utils.flatten(e);for(var r=0;r<e.length;r++)e[r]===t&&n++;return n},exports.COUNTBLANK=function(){for(var e,t=utils.flatten(arguments),n=0,r=0;r<t.length;r++)e=t[r],null!==e&&""!==e||n++;return n},exports.COUNTIF=function(range,criteria){range=utils.flatten(range),/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');for(var matches=0,i=0;i<range.length;i++)"string"!=typeof range[i]?eval(range[i]+criteria)&&matches++:eval('"'+range[i]+'"'+criteria)&&matches++;return matches},exports.COUNTIFS=function(){for(var args=utils.argsToArray(arguments),results=new Array(utils.flatten(args[0]).length),i=0;i<results.length;i++)results[i]=!0;for(i=0;i<args.length;i+=2){var range=utils.flatten(args[i]),criteria=args[i+1];/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');for(var j=0;j<range.length;j++)"string"!=typeof range[j]?results[j]=results[j]&&eval(range[j]+criteria):results[j]=results[j]&&eval('"'+range[j]+'"'+criteria)}var result=0;for(i=0;i<results.length;i++)results[i]&&result++;return result},exports.COUNTUNIQUE=function(){return misc.UNIQUE.apply(null,utils.flatten(arguments)).length},exports.COVARIANCE={},exports.COVARIANCE.P=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;for(var n=jStat.mean(e),r=jStat.mean(t),o=0,i=e.length,s=0;s<i;s++)o+=(e[s]-n)*(t[s]-r);return o/i},exports.COVARIANCE.S=function(e,t){return e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t)?error.value:jStat.covariance(e,t)},exports.DEVSQ=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=jStat.mean(e),n=0,r=0;r<e.length;r++)n+=Math.pow(e[r]-t,2);return n},exports.EXPON={},exports.EXPON.DIST=function(e,t,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:n?jStat.exponential.cdf(e,t):jStat.exponential.pdf(e,t)},exports.F={},exports.F.DIST=function(e,t,n,r){return e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n)?error.value:r?jStat.centralF.cdf(e,t,n):jStat.centralF.pdf(e,t,n)},exports.F.DIST.RT=function(e,t,n){return 3!==arguments.length?error.na:e<0||t<1||n<1?error.num:"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?error.value:1-jStat.centralF.cdf(e,t,n)},exports.F.INV=function(e,t,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n)?error.value:e<=0||e>1?error.num:jStat.centralF.inv(e,t,n)},exports.F.INV.RT=function(e,t,n){return 3!==arguments.length?error.na:e<0||e>1||t<1||t>Math.pow(10,10)||n<1||n>Math.pow(10,10)?error.num:"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?error.value:jStat.centralF.inv(1-e,t,n)},exports.F.TEST=function(e,t){if(!e||!t)return error.na;if(!(e instanceof Array&&t instanceof Array))return error.na;if(e.length<2||t.length<2)return error.div0;var n=function(e,t){for(var n=0,r=0;r<e.length;r++)n+=Math.pow(e[r]-t,2);return n},r=mathTrig.SUM(e)/e.length,o=mathTrig.SUM(t)/t.length,i=n(e,r)/(e.length-1),s=n(t,o)/(t.length-1);return i/s},exports.FISHER=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.log((1+e)/(1-e))/2},exports.FISHERINV=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var t=Math.exp(2*e);return(t-1)/(t+1)},exports.FORECAST=function(e,t,n){if(e=utils.parseNumber(e),t=utils.parseNumberArray(utils.flatten(t)),n=utils.parseNumberArray(utils.flatten(n)),utils.anyIsError(e,t,n))return error.value;for(var r=jStat.mean(n),o=jStat.mean(t),i=n.length,s=0,a=0,l=0;l<i;l++)s+=(n[l]-r)*(t[l]-o),a+=Math.pow(n[l]-r,2);var u=s/a,d=o-u*r;return d+u*e},exports.FREQUENCY=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;for(var n=e.length,r=t.length,o=[],i=0;i<=r;i++){o[i]=0;for(var s=0;s<n;s++)0===i?e[s]<=t[0]&&(o[0]+=1):i<r?e[s]>t[i-1]&&e[s]<=t[i]&&(o[i]+=1):i===r&&e[s]>t[r-1]&&(o[r]+=1)}return o},exports.GAMMA=function(e){return e=utils.parseNumber(e),e instanceof Error?e:0===e?error.num:parseInt(e,10)===e&&e<0?error.num:jStat.gammafn(e)},exports.GAMMA.DIST=function(e,t,n,r){return 4!==arguments.length?error.na:e<0||t<=0||n<=0?error.value:"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?error.value:r?jStat.gamma.cdf(e,t,n,!0):jStat.gamma.pdf(e,t,n,!1)},exports.GAMMA.INV=function(e,t,n){return 3!==arguments.length?error.na:e<0||e>1||t<=0||n<=0?error.num:"number"!=typeof e||"number"!=typeof t||"number"!=typeof n?error.value:jStat.gamma.inv(e,t,n)},exports.GAMMALN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:jStat.gammaln(e)},exports.GAMMALN.PRECISE=function(e){return 1!==arguments.length?error.na:e<=0?error.num:"number"!=typeof e?error.value:jStat.gammaln(e)},exports.GAUSS=function(e){return e=utils.parseNumber(e),e instanceof Error?e:jStat.normal.cdf(e,0,1)-.5},exports.GEOMEAN=function(){var e=utils.parseNumberArray(utils.flatten(arguments));return e instanceof Error?e:jStat.geomean(e)},exports.GROWTH=function(e,t,n,r){if(e=utils.parseNumberArray(e),e instanceof Error)return e;var o;if(void 0===t)for(t=[],o=1;o<=e.length;o++)t.push(o);if(void 0===n)for(n=[],o=1;o<=e.length;o++)n.push(o);if(t=utils.parseNumberArray(t),n=utils.parseNumberArray(n),utils.anyIsError(t,n))return error.value;void 0===r&&(r=!0);var i=e.length,s=0,a=0,l=0,u=0;for(o=0;o<i;o++){var d=t[o],c=Math.log(e[o]);s+=d,a+=c,l+=d*c,u+=d*d}s/=i,a/=i,l/=i,u/=i;var h,f;r?(h=(l-s*a)/(u-s*s),f=a-h*s):(h=l/u,f=0);var p=[];for(o=0;o<n.length;o++)p.push(Math.exp(f+h*n[o]));return p},exports.HARMEAN=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=e.length,n=0,r=0;r<t;r++)n+=1/e[r];return t/n},exports.HYPGEOM={},exports.HYPGEOM.DIST=function(e,t,n,r,o){function i(e,t,n,r){return mathTrig.COMBIN(n,e)*mathTrig.COMBIN(r-n,t-e)/mathTrig.COMBIN(r,t)}function s(e,t,n,r){for(var o=0,s=0;s<=e;s++)o+=i(s,t,n,r);return o}return e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(e,t,n,r)?error.value:o?s(e,t,n,r):i(e,t,n,r)},exports.INTERCEPT=function(e,t){return e=utils.parseNumberArray(e),t=utils.parseNumberArray(t),utils.anyIsError(e,t)?error.value:e.length!==t.length?error.na:exports.FORECAST(0,e,t)},exports.KURT=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=jStat.mean(e),n=e.length,r=0,o=0;o<n;o++)r+=Math.pow(e[o]-t,4);return r/=Math.pow(jStat.stdev(e,!0),4),n*(n+1)/((n-1)*(n-2)*(n-3))*r-3*(n-1)*(n-1)/((n-2)*(n-3))},exports.LARGE=function(e,t){return e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t)?e:e.sort(function(e,t){return t-e})[t-1]},exports.LINEST=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;for(var n=jStat.mean(e),r=jStat.mean(t),o=t.length,i=0,s=0,a=0;a<o;a++)i+=(t[a]-r)*(e[a]-n),s+=Math.pow(t[a]-r,2);var l=i/s,u=n-l*r;return[l,u]},exports.LOGEST=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;for(var n=0;n<e.length;n++)e[n]=Math.log(e[n]);var r=exports.LINEST(e,t);return r[0]=Math.round(1e6*Math.exp(r[0]))/1e6,r[1]=Math.round(1e6*Math.exp(r[1]))/1e6,r},exports.LOGNORM={},exports.LOGNORM.DIST=function(e,t,n,r){return e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n)?error.value:r?jStat.lognormal.cdf(e,t,n):jStat.lognormal.pdf(e,t,n)},exports.LOGNORM.INV=function(e,t,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n)?error.value:jStat.lognormal.inv(e,t,n)},exports.MAX=function(){var e=utils.numbers(utils.flatten(arguments));return 0===e.length?0:Math.max.apply(Math,e)},exports.MAXA=function(){var e=utils.arrayValuesToNumbers(utils.flatten(arguments));return 0===e.length?0:Math.max.apply(Math,e)},exports.MEDIAN=function(){var e=utils.arrayValuesToNumbers(utils.flatten(arguments)),t=jStat.median(e);return isNaN(t)&&(t=error.num),t},exports.MIN=function(){var e=utils.numbers(utils.flatten(arguments));return 0===e.length?0:Math.min.apply(Math,e)},exports.MINA=function(){var e=utils.arrayValuesToNumbers(utils.flatten(arguments));return 0===e.length?0:Math.min.apply(Math,e)},exports.MODE={},exports.MODE.MULT=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t,n=e.length,r={},o=[],i=0,s=0;s<n;s++)t=e[s],r[t]=r[t]?r[t]+1:1,r[t]>i&&(i=r[t],o=[]),r[t]===i&&(o[o.length]=t);return o},exports.MODE.SNGL=function(){var e=utils.parseNumberArray(utils.flatten(arguments));return e instanceof Error?e:exports.MODE.MULT(e).sort(function(e,t){return e-t})[0]},exports.NEGBINOM={},exports.NEGBINOM.DIST=function(e,t,n,r){return e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n)?error.value:r?jStat.negbin.cdf(e,t,n):jStat.negbin.pdf(e,t,n)},exports.NORM={},exports.NORM.DIST=function(e,t,n,r){return e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n)?error.value:n<=0?error.num:r?jStat.normal.cdf(e,t,n):jStat.normal.pdf(e,t,n)},exports.NORM.INV=function(e,t,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n)?error.value:jStat.normal.inv(e,t,n)},exports.NORM.S={},exports.NORM.S.DIST=function(e,t){return e=utils.parseNumber(e),e instanceof Error?error.value:t?jStat.normal.cdf(e,0,1):jStat.normal.pdf(e,0,1)},exports.NORM.S.INV=function(e){return e=utils.parseNumber(e),e instanceof Error?error.value:jStat.normal.inv(e,0,1)},exports.PEARSON=function(e,t){if(t=utils.parseNumberArray(utils.flatten(t)),e=utils.parseNumberArray(utils.flatten(e)),utils.anyIsError(t,e))return error.value;for(var n=jStat.mean(e),r=jStat.mean(t),o=e.length,i=0,s=0,a=0,l=0;l<o;l++)i+=(e[l]-n)*(t[l]-r),s+=Math.pow(e[l]-n,2),a+=Math.pow(t[l]-r,2);return i/Math.sqrt(s*a)},exports.PERCENTILE={},exports.PERCENTILE.EXC=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;e=e.sort(function(e,t){return e-t});var n=e.length;if(t<1/(n+1)||t>1-1/(n+1))return error.num;var r=t*(n+1)-1,o=Math.floor(r);return utils.cleanFloat(r===o?e[r]:e[o]+(r-o)*(e[o+1]-e[o]))},exports.PERCENTILE.INC=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;e=e.sort(function(e,t){return e-t});var n=e.length,r=t*(n-1),o=Math.floor(r);return utils.cleanFloat(r===o?e[r]:e[o]+(r-o)*(e[o+1]-e[o]))},exports.PERCENTRANK={},exports.PERCENTRANK.EXC=function(e,t,n){if(n=void 0===n?3:n,e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n))return error.value;e=e.sort(function(e,t){return e-t});for(var r=misc.UNIQUE.apply(null,e),o=e.length,i=r.length,s=Math.pow(10,n),a=0,l=!1,u=0;!l&&u<i;)t===r[u]?(a=(e.indexOf(r[u])+1)/(o+1),l=!0):t>=r[u]&&(t<r[u+1]||u===i-1)&&(a=(e.indexOf(r[u])+1+(t-r[u])/(r[u+1]-r[u]))/(o+1),l=!0),u++;return Math.floor(a*s)/s},exports.PERCENTRANK.INC=function(e,t,n){if(n=void 0===n?3:n,e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n))return error.value;e=e.sort(function(e,t){return e-t});for(var r=misc.UNIQUE.apply(null,e),o=e.length,i=r.length,s=Math.pow(10,n),a=0,l=!1,u=0;!l&&u<i;)t===r[u]?(a=e.indexOf(r[u])/(o-1),l=!0):t>=r[u]&&(t<r[u+1]||u===i-1)&&(a=(e.indexOf(r[u])+(t-r[u])/(r[u+1]-r[u]))/(o-1),l=!0),u++;return Math.floor(a*s)/s},exports.PERMUT=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:mathTrig.FACT(e)/mathTrig.FACT(e-t)},exports.PERMUTATIONA=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:Math.pow(e,t)},exports.PHI=function(e){return e=utils.parseNumber(e),e instanceof Error?error.value:Math.exp(-.5*e*e)/SQRT2PI},exports.POISSON={},exports.POISSON.DIST=function(e,t,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:n?jStat.poisson.cdf(e,t):jStat.poisson.pdf(e,t)},exports.PROB=function(e,t,n,r){if(void 0===n)return 0;if(r=void 0===r?n:r,e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),n=utils.parseNumber(n),r=utils.parseNumber(r),utils.anyIsError(e,t,n,r))return error.value;if(n===r)return e.indexOf(n)>=0?t[e.indexOf(n)]:0;for(var o=e.sort(function(e,t){return e-t}),i=o.length,s=0,a=0;a<i;a++)o[a]>=n&&o[a]<=r&&(s+=t[e.indexOf(o[a])]);return s},exports.QUARTILE={},exports.QUARTILE.EXC=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;switch(t){case 1:return exports.PERCENTILE.EXC(e,.25);case 2:return exports.PERCENTILE.EXC(e,.5);case 3:return exports.PERCENTILE.EXC(e,.75);default:return error.num}},exports.QUARTILE.INC=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;switch(t){case 1:return exports.PERCENTILE.INC(e,.25);case 2:return exports.PERCENTILE.INC(e,.5);case 3:return exports.PERCENTILE.INC(e,.75);default:return error.num}},exports.RANK={},exports.RANK.AVG=function(e,t,n){if(e=utils.parseNumber(e),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;t=utils.flatten(t),n=n||!1;var r=n?function(e,t){return e-t}:function(e,t){return t-e};t=t.sort(r);for(var o=t.length,i=0,s=0;s<o;s++)t[s]===e&&i++;return i>1?(2*t.indexOf(e)+i+1)/2:t.indexOf(e)+1},exports.RANK.EQ=function(e,t,n){if(e=utils.parseNumber(e),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;n=n||!1;var r=n?function(e,t){return e-t}:function(e,t){return t-e};return t=t.sort(r),t.indexOf(e)+1},exports.ROW=function(e,t){if(2!==arguments.length)return error.na;if(t<0)return error.num;if(!(e instanceof Array)||"number"!=typeof t)return error.value;if(0!==e.length)return jStat.row(e,t)},exports.ROWS=function(e){return 1!==arguments.length?error.na:e instanceof Array?0===e.length?0:jStat.rows(e):error.value},exports.RSQ=function(e,t){return e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t)?error.value:Math.pow(exports.PEARSON(e,t),2)},exports.SKEW=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=jStat.mean(e),n=e.length,r=0,o=0;o<n;o++)r+=Math.pow(e[o]-t,3);return n*r/((n-1)*(n-2)*Math.pow(jStat.stdev(e,!0),3))},exports.SKEW.P=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var t=jStat.mean(e),n=e.length,r=0,o=0,i=0;i<n;i++)o+=Math.pow(e[i]-t,3),r+=Math.pow(e[i]-t,2);return o/=n,r/=n,o/Math.pow(r,1.5)},exports.SLOPE=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;for(var n=jStat.mean(t),r=jStat.mean(e),o=t.length,i=0,s=0,a=0;a<o;a++)i+=(t[a]-n)*(e[a]-r),s+=Math.pow(t[a]-n,2);return i/s},exports.SMALL=function(e,t){return e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t)?e:e.sort(function(e,t){return e-t})[t-1]},exports.STANDARDIZE=function(e,t,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n)?error.value:(e-t)/n},exports.STDEV={},exports.STDEV.P=function(){var e=exports.VAR.P.apply(this,arguments),t=Math.sqrt(e);return isNaN(t)&&(t=error.num),t},exports.STDEV.S=function(){var e=exports.VAR.S.apply(this,arguments),t=Math.sqrt(e);return t},exports.STDEVA=function(){var e=exports.VARA.apply(this,arguments),t=Math.sqrt(e);return t},exports.STDEVPA=function(){var e=exports.VARPA.apply(this,arguments),t=Math.sqrt(e);return isNaN(t)&&(t=error.num),t},exports.STEYX=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;for(var n=jStat.mean(t),r=jStat.mean(e),o=t.length,i=0,s=0,a=0,l=0;l<o;l++)i+=Math.pow(e[l]-r,2),s+=(t[l]-n)*(e[l]-r),a+=Math.pow(t[l]-n,2);return Math.sqrt((i-s*s/a)/(o-2))},exports.TRANSPOSE=function(e){return e?jStat.transpose(e):error.na},exports.T=text.T,exports.T.DIST=function(e,t,n){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:n?jStat.studentt.cdf(e,t):jStat.studentt.pdf(e,t)},exports.T.DIST["2T"]=function(e,t){return 2!==arguments.length?error.na:e<0||t<1?error.num:"number"!=typeof e||"number"!=typeof t?error.value:2*(1-jStat.studentt.cdf(e,t))},exports.T.DIST.RT=function(e,t){return 2!==arguments.length?error.na:e<0||t<1?error.num:"number"!=typeof e||"number"!=typeof t?error.value:1-jStat.studentt.cdf(e,t)},exports.T.INV=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),utils.anyIsError(e,t)?error.value:jStat.studentt.inv(e,t)},exports.T.INV["2T"]=function(e,t){return e=utils.parseNumber(e),t=utils.parseNumber(t),e<=0||e>1||t<1?error.num:utils.anyIsError(e,t)?error.value:Math.abs(jStat.studentt.inv(e/2,t))},exports.T.TEST=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),utils.anyIsError(e,t))return error.value;var n,r=jStat.mean(e),o=jStat.mean(t),i=0,s=0;for(n=0;n<e.length;n++)i+=Math.pow(e[n]-r,2);for(n=0;n<t.length;n++)s+=Math.pow(t[n]-o,2);i/=e.length-1,s/=t.length-1;var a=Math.abs(r-o)/Math.sqrt(i/e.length+s/t.length);return exports.T.DIST["2T"](a,e.length+t.length-2)},exports.TREND=function(e,t,n){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumberArray(utils.flatten(t)),n=utils.parseNumberArray(utils.flatten(n)),utils.anyIsError(e,t,n))return error.value;var r=exports.LINEST(e,t),o=r[0],i=r[1],s=[];return n.forEach(function(e){s.push(o*e+i)}),s},exports.TRIMMEAN=function(e,t){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;var n=mathTrig.FLOOR(e.length*t,2)/2;return jStat.mean(utils.initial(utils.rest(e.sort(function(e,t){return e-t}),n),n))},exports.VAR={},exports.VAR.P=function(){for(var e,t=utils.numbers(utils.flatten(arguments)),n=t.length,r=0,o=exports.AVERAGE(t),i=0;i<n;i++)r+=Math.pow(t[i]-o,2);return e=r/n,isNaN(e)&&(e=error.num),e},exports.VAR.S=function(){for(var e=utils.numbers(utils.flatten(arguments)),t=e.length,n=0,r=exports.AVERAGE(e),o=0;o<t;o++)n+=Math.pow(e[o]-r,2);return n/(t-1)},exports.VARA=function(){for(var e=utils.flatten(arguments),t=e.length,n=0,r=0,o=exports.AVERAGEA(e),i=0;i<t;i++){var s=e[i];n+="number"==typeof s?Math.pow(s-o,2):s===!0?Math.pow(1-o,2):Math.pow(0-o,2),null!==s&&r++}return n/(r-1)},exports.VARPA=function(){for(var e,t=utils.flatten(arguments),n=t.length,r=0,o=0,i=exports.AVERAGEA(t),s=0;s<n;s++){var a=t[s];r+="number"==typeof a?Math.pow(a-i,2):a===!0?Math.pow(1-i,2):Math.pow(0-i,2),null!==a&&o++}return e=r/o,isNaN(e)&&(e=error.num),e},exports.WEIBULL={},exports.WEIBULL.DIST=function(e,t,n,r){return e=utils.parseNumber(e),t=utils.parseNumber(t),n=utils.parseNumber(n),utils.anyIsError(e,t,n)?error.value:r?1-Math.exp(-Math.pow(e/n,t)):Math.pow(e,t-1)*Math.exp(-Math.pow(e/n,t))*t/Math.pow(n,t)},exports.Z={},exports.Z.TEST=function(e,t,n){if(e=utils.parseNumberArray(utils.flatten(e)),t=utils.parseNumber(t),utils.anyIsError(e,t))return error.value;n=n||exports.STDEV.S(e);var r=e.length;return 1-exports.NORM.S.DIST((exports.AVERAGE(e)-t)/(n/Math.sqrt(r)),!0)}},function(e,t,n){var r=n(15),o=n(16),i=n(19);t.ASC=function(){throw new Error("ASC is not implemented")},t.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},t.CHAR=function(e){return e=r.parseNumber(e),e instanceof Error?e:String.fromCharCode(e)},t.CLEAN=function(e){e=e||"";var t=/[\0-\x1F]/g;return e.replace(t,"")},t.CODE=function(e){e=e||"";var t=e.charCodeAt(0);return isNaN(t)&&(t=o.na),t},t.CONCATENATE=function(){for(var e=r.flatten(arguments),t=0;(t=e.indexOf(!0))>-1;)e[t]="TRUE";for(var n=0;(n=e.indexOf(!1))>-1;)e[n]="FALSE";return e.join("")},t.DBCS=function(){throw new Error("DBCS is not implemented")},t.DOLLAR=function(e,t){if(t=void 0===t?2:t,e=r.parseNumber(e),t=r.parseNumber(t),r.anyIsError(e,t))return o.value;var n="";return t<=0?(e=Math.round(e*Math.pow(10,t))/Math.pow(10,t),n="($0,0)"):t>0&&(n="($0,0."+new Array(t+1).join("0")+")"),i(e).format(n)},t.EXACT=function(e,t){return 2!==arguments.length?o.na:e===t},t.FIND=function(e,t,n){return arguments.length<2?o.na:(n=void 0===n?0:n,t?t.indexOf(e,n-1)+1:null)},t.FIXED=function(e,t,n){if(t=void 0===t?2:t,n=void 0!==n&&n,e=r.parseNumber(e),t=r.parseNumber(t),r.anyIsError(e,t))return o.value;var s=n?"0":"0,0";return t<=0?e=Math.round(e*Math.pow(10,t))/Math.pow(10,t):t>0&&(s+="."+new Array(t+1).join("0")),i(e).format(s)},t.HTML2TEXT=function(e){var t="";return e&&(e instanceof Array?e.forEach(function(e){""!==t&&(t+="\n"),t+=e.replace(/<(?:.|\n)*?>/gm,"")}):t=e.replace(/<(?:.|\n)*?>/gm,"")),t},t.LEFT=function(e,t){return t=void 0===t?1:t,t=r.parseNumber(t),t instanceof Error||"string"!=typeof e?o.value:e?e.substring(0,t):null},t.LEN=function(e){return 0===arguments.length?o.error:"string"==typeof e?e?e.length:0:e.length?e.length:o.value},t.LOWER=function(e){return"string"!=typeof e?o.value:e?e.toLowerCase():e},t.MID=function(e,t,n){if(t=r.parseNumber(t),n=r.parseNumber(n),r.anyIsError(t,n)||"string"!=typeof e)return n;var o=t-1,i=o+n;return e.substring(o,i)},t.NUMBERVALUE=function(e,t,n){return t="undefined"==typeof t?".":t,n="undefined"==typeof n?",":n,Number(e.replace(t,".").replace(n,""))},t.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},t.PROPER=function(e){return void 0===e||0===e.length?o.value:(e===!0&&(e="TRUE"),e===!1&&(e="FALSE"),isNaN(e)&&"number"==typeof e?o.value:("number"==typeof e&&(e=""+e),e.replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})))},t.REGEXEXTRACT=function(e,t){if(arguments.length<2)return o.na;var n=e.match(new RegExp(t));return n?n[n.length>1?n.length-1:0]:null},t.REGEXMATCH=function(e,t,n){if(arguments.length<2)return o.na;var r=e.match(new RegExp(t));return n?r:!!r},t.REGEXREPLACE=function(e,t,n){return arguments.length<3?o.na:e.replace(new RegExp(t),n)},t.REPLACE=function(e,t,n,i){return t=r.parseNumber(t),n=r.parseNumber(n),r.anyIsError(t,n)||"string"!=typeof e||"string"!=typeof i?o.value:e.substr(0,t-1)+i+e.substr(t-1+n)},t.REPT=function(e,t){return t=r.parseNumber(t),t instanceof Error?t:new Array(t+1).join(e)},t.RIGHT=function(e,t){return t=void 0===t?1:t,t=r.parseNumber(t),t instanceof Error?t:e?e.substring(e.length-t):o.na;
},t.SEARCH=function(e,t,n){var r;return"string"!=typeof e||"string"!=typeof t?o.value:(n=void 0===n?0:n,r=t.toLowerCase().indexOf(e.toLowerCase(),n-1)+1,0===r?o.value:r)},t.SPLIT=function(e,t){return e.split(t)},t.SUBSTITUTE=function(e,t,n,r){if(arguments.length<2)return o.na;if(!(e&&t&&n))return e;if(void 0===r)return e.replace(new RegExp(t,"g"),n);for(var i=0,s=0;e.indexOf(t,i)>0;)if(i=e.indexOf(t,i+1),s++,s===r)return e.substring(0,i)+n+e.substring(i+t.length)},t.T=function(e){return"string"==typeof e?e:""},t.TEXT=function(e,t){return e=r.parseNumber(e),r.anyIsError(e)?o.na:i(e).format(t)},t.TRIM=function(e){return"string"!=typeof e?o.value:e.replace(/ +/g," ").trim()},t.UNICHAR=t.CHAR,t.UNICODE=t.CODE,t.UPPER=function(e){return"string"!=typeof e?o.value:e.toUpperCase()},t.VALUE=function(e){if("string"!=typeof e)return o.value;var t=i().unformat(e);return void 0===t?0:t}},function(e,t,n){var r,o;(function(i){/*!
	 * numbro.js
	 * version : 1.9.3
	 * author : Företagsplatsen AB
	 * license : MIT
	 * http://www.foretagsplatsen.se
	 */
(function(){"use strict";function s(e){this._value=e}function a(e){var t,n="";for(t=0;t<e;t++)n+="0";return n}function l(e,t){var n,r,o,i,s,l,u,d;return d=e.toString(),n=d.split("e")[0],i=d.split("e")[1],r=n.split(".")[0],o=n.split(".")[1]||"",+i>0?d=r+o+a(i-o.length):(s=+r<0?"-0":"0",t>0&&(s+="."),u=a(-1*i-1),l=(u+Math.abs(r)+o).substr(0,t),d=s+l),+i>0&&t>0&&(d+="."+a(t)),d}function u(e,t,n,r){var o,i,s=Math.pow(10,t);return e.toString().indexOf("e")>-1?(i=l(e,t),"-"===i.charAt(0)&&+i>=0&&(i=i.substr(1))):i=(n(e+"e+"+t)/s).toFixed(t),r&&(o=new RegExp("0{1,"+r+"}$"),i=i.replace(o,"")),i}function d(e,t,n){var r,o=t.replace(/\{[^\{\}]*\}/g,"");return r=o.indexOf("$")>-1?h(e,N[k].currency.symbol,t,n):o.indexOf("%")>-1?p(e,t,n):o.indexOf(":")>-1?m(e,t):w(e._value,t,n)}function c(e,t){var n,r,o,i,s,a=t,l=!1;if(t.indexOf(":")>-1)e._value=g(t);else if(t===I)e._value=0;else{for("."!==N[k].delimiters.decimal&&(t=t.replace(/\./g,"").replace(N[k].delimiters.decimal,".")),n=new RegExp("[^a-zA-Z]"+N[k].abbreviations.thousand+"(?:\\)|(\\"+N[k].currency.symbol+")?(?:\\))?)?$"),r=new RegExp("[^a-zA-Z]"+N[k].abbreviations.million+"(?:\\)|(\\"+N[k].currency.symbol+")?(?:\\))?)?$"),o=new RegExp("[^a-zA-Z]"+N[k].abbreviations.billion+"(?:\\)|(\\"+N[k].currency.symbol+")?(?:\\))?)?$"),i=new RegExp("[^a-zA-Z]"+N[k].abbreviations.trillion+"(?:\\)|(\\"+N[k].currency.symbol+")?(?:\\))?)?$"),s=1;s<S.length&&!l;++s)t.indexOf(S[s])>-1?l=Math.pow(1024,s):t.indexOf(O[s])>-1&&(l=Math.pow(1e3,s));var u=t.replace(/[^0-9\.]+/g,"");""===u?e._value=NaN:(e._value=(l?l:1)*(a.match(n)?Math.pow(10,3):1)*(a.match(r)?Math.pow(10,6):1)*(a.match(o)?Math.pow(10,9):1)*(a.match(i)?Math.pow(10,12):1)*(t.indexOf("%")>-1?.01:1)*((t.split("-").length+Math.min(t.split("(").length-1,t.split(")").length-1))%2?1:-1)*Number(u),e._value=l?Math.ceil(e._value):e._value)}return e._value}function h(e,t,n,r){var o,i,s=n,a=s.indexOf("$"),l=s.indexOf("("),u=s.indexOf("+"),d=s.indexOf("-"),c="",h="";if(s.indexOf("$")===-1?"infix"===N[k].currency.position?(h=t,N[k].currency.spaceSeparated&&(h=" "+h+" ")):N[k].currency.spaceSeparated&&(c=" "):s.indexOf(" $")>-1?(c=" ",s=s.replace(" $","")):s.indexOf("$ ")>-1?(c=" ",s=s.replace("$ ","")):s=s.replace("$",""),i=w(e._value,s,r,h),n.indexOf("$")===-1)switch(N[k].currency.position){case"postfix":i.indexOf(")")>-1?(i=i.split(""),i.splice(-1,0,c+t),i=i.join("")):i=i+c+t;break;case"infix":break;case"prefix":i.indexOf("(")>-1||i.indexOf("-")>-1?(i=i.split(""),o=Math.max(l,d)+1,i.splice(o,0,t+c),i=i.join("")):i=t+c+i;break;default:throw Error('Currency position should be among ["prefix", "infix", "postfix"]')}else a<=1?i.indexOf("(")>-1||i.indexOf("+")>-1||i.indexOf("-")>-1?(i=i.split(""),o=1,(a<l||a<u||a<d)&&(o=0),i.splice(o,0,t+c),i=i.join("")):i=t+c+i:i.indexOf(")")>-1?(i=i.split(""),i.splice(-1,0,c+t),i=i.join("")):i=i+c+t;return i}function f(e,t,n,r){return h(e,t,n,r)}function p(e,t,n){var r,o="",i=100*e._value;return t.indexOf(" %")>-1?(o=" ",t=t.replace(" %","")):t=t.replace("%",""),r=w(i,t,n),r.indexOf(")")>-1?(r=r.split(""),r.splice(-1,0,o+"%"),r=r.join("")):r=r+o+"%",r}function m(e){var t=Math.floor(e._value/60/60),n=Math.floor((e._value-60*t*60)/60),r=Math.round(e._value-60*t*60-60*n);return t+":"+(n<10?"0"+n:n)+":"+(r<10?"0"+r:r)}function g(e){var t=e.split(":"),n=0;return 3===t.length?(n+=60*Number(t[0])*60,n+=60*Number(t[1]),n+=Number(t[2])):2===t.length&&(n+=60*Number(t[0]),n+=Number(t[1])),Number(n)}function v(e,t,n){var r,o,i,s=t[0],a=Math.abs(e);if(a>=n){for(r=1;r<t.length;++r)if(o=Math.pow(n,r),i=Math.pow(n,r+1),a>=o&&a<i){s=t[r],e/=o;break}s===t[0]&&(e/=Math.pow(n,t.length-1),s=t[t.length-1])}return{value:e,suffix:s}}function w(e,t,n,r){var o,i,s,l,d,c,h,f,p,m,g,w,b,y,_,C,R,M=!1,E=!1,S=!1,O="",T=!1,x=!1,D=!1,P=!1,H=!1,L="",V="",j=Math.abs(e),F="",$=!1,B=!1,W="";if(0===e&&null!==I)return I;if(!isFinite(e))return""+e;if(0===t.indexOf("{")){var U=t.indexOf("}");if(U===-1)throw Error('Format should also contain a "}"');m=t.slice(1,U),t=t.slice(U+1)}else m="";if(t.indexOf("}")===t.length-1){var Y=t.indexOf("{");if(Y===-1)throw Error('Format should also contain a "{"');g=t.slice(Y+1,-1),t=t.slice(0,Y+1)}else g="";var G;for(G=t.indexOf(".")===-1?t.match(/([0-9]+).*/):t.match(/([0-9]+)\..*/),C=null===G?-1:G[1].length,t.indexOf("-")!==-1&&($=!0),t.indexOf("(")>-1?(M=!0,t=t.slice(1,-1)):t.indexOf("+")>-1&&(E=!0,t=t.replace(/\+/g,"")),t.indexOf("a")>-1&&(f=t.split(".")[0].match(/[0-9]+/g)||["0"],f=parseInt(f[0],10),T=t.indexOf("aK")>=0,x=t.indexOf("aM")>=0,D=t.indexOf("aB")>=0,P=t.indexOf("aT")>=0,H=T||x||D||P,t.indexOf(" a")>-1?(O=" ",t=t.replace(" a","")):t=t.replace("a",""),s=Math.floor(Math.log(j)/Math.LN10)+1,d=s%3,d=0===d?3:d,f&&0!==j&&(l=Math.floor(Math.log(j)/Math.LN10)+1-f,c=3*~~((Math.min(f,s)-d)/3),j/=Math.pow(10,c),t.indexOf(".")===-1&&f>3&&(t+="[.]",y=0===l?0:3*~~(l/3)-l,y=y<0?y+3:y,t+=a(y))),Math.floor(Math.log(Math.abs(e))/Math.LN10)+1!==f&&(j>=Math.pow(10,12)&&!H||P?(O+=N[k].abbreviations.trillion,e/=Math.pow(10,12)):j<Math.pow(10,12)&&j>=Math.pow(10,9)&&!H||D?(O+=N[k].abbreviations.billion,e/=Math.pow(10,9)):j<Math.pow(10,9)&&j>=Math.pow(10,6)&&!H||x?(O+=N[k].abbreviations.million,e/=Math.pow(10,6)):(j<Math.pow(10,6)&&j>=Math.pow(10,3)&&!H||T)&&(O+=N[k].abbreviations.thousand,e/=Math.pow(10,3)))),R=0;R<A.length;++R)if(o=A[R],t.indexOf(o.marker)>-1){t.indexOf(" "+o.marker)>-1&&(L=" "),t=t.replace(L+o.marker,""),i=v(e,o.suffixes,o.scale),e=i.value,L+=i.suffix;break}if(t.indexOf("o")>-1&&(t.indexOf(" o")>-1?(V=" ",t=t.replace(" o","")):t=t.replace("o",""),N[k].ordinal&&(V+=N[k].ordinal(e))),t.indexOf("[.]")>-1&&(S=!0,t=t.replace("[.]",".")),h=e.toString().split(".")[0],p=t.split(".")[1],w=t.indexOf(","),p){if(p.indexOf("*")!==-1?F=u(e,e.toString().split(".")[1].length,n):p.indexOf("[")>-1?(p=p.replace("]",""),p=p.split("["),F=u(e,p[0].length+p[1].length,n,p[1].length)):F=u(e,p.length,n),h=F.split(".")[0],F.split(".")[1].length){var z=r?O+r:N[k].delimiters.decimal;F=z+F.split(".")[1]}else F="";S&&0===Number(F.slice(1))&&(F="")}else h=u(e,0,n);return h.indexOf("-")>-1&&(h=h.slice(1),B=!0),h.length<C&&(h=a(C-h.length)+h),w>-1&&(h=h.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+N[k].delimiters.thousands)),0===t.indexOf(".")&&(h=""),b=t.indexOf("("),_=t.indexOf("-"),W=b<_?(M&&B?"(":"")+($&&B||!M&&B?"-":""):($&&B||!M&&B?"-":"")+(M&&B?"(":""),m+W+(!B&&E&&0!==e?"+":"")+h+F+(V?V:"")+(O&&!r?O:"")+(L?L:"")+(M&&B?")":"")+g}function b(e,t){N[e]=t}function y(e){k=e;var t=N[e].defaults;t&&t.format&&M.defaultFormat(t.format),t&&t.currencyFormat&&M.defaultCurrencyFormat(t.currencyFormat)}function _(){return"undefined"!=typeof i&&void 0===i.browser&&i.title&&(0===i.title.indexOf("node")||i.title.indexOf("meteor-tool")>0||"grunt"===i.title||"gulp"===i.title)&&!0}function C(e){var t=e.toString().split(".");return t.length<2?1:Math.pow(10,t[1].length)}function R(){var e=Array.prototype.slice.call(arguments);return e.reduce(function(e,t){var n=C(e),r=C(t);return n>r?n:r},-(1/0))}var M,E="1.9.3",S=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],O=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],T={general:{scale:1024,suffixes:O,marker:"bd"},binary:{scale:1024,suffixes:S,marker:"b"},decimal:{scale:1e3,suffixes:O,marker:"d"}},A=[T.general,T.binary,T.decimal],N={},x=N,k="en-US",I=null,D="0,0",P="0$",H="undefined"!=typeof e&&e.exports,L={delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return 1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$",position:"prefix"},defaults:{currencyFormat:",0000 a"},formats:{fourDigits:"0000 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00"}};M=function(e){return M.isNumbro(e)?e=e.value():0===e||"undefined"==typeof e?e=0:Number(e)||(e=M.fn.unformat(e)),new s(Number(e))},M.version=E,M.isNumbro=function(e){return e instanceof s},M.setLanguage=function(e,t){console.warn("`setLanguage` is deprecated since version 1.6.0. Use `setCulture` instead");var n=e,r=e.split("-")[0],o=null;x[n]||(Object.keys(x).forEach(function(e){o||e.split("-")[0]!==r||(o=e)}),n=o||t||"en-US"),y(n)},M.setCulture=function(e,t){var n=e,r=e.split("-")[1],o=null;N[n]||(r&&Object.keys(N).forEach(function(e){o||e.split("-")[1]!==r||(o=e)}),n=o||t||"en-US"),y(n)},M.language=function(e,t){if(console.warn("`language` is deprecated since version 1.6.0. Use `culture` instead"),!e)return k;if(e&&!t){if(!x[e])throw new Error("Unknown language : "+e);y(e)}return!t&&x[e]||b(e,t),M},M.culture=function(e,t){if(!e)return k;if(e&&!t){if(!N[e])throw new Error("Unknown culture : "+e);y(e)}return!t&&N[e]||b(e,t),M},M.languageData=function(e){if(console.warn("`languageData` is deprecated since version 1.6.0. Use `cultureData` instead"),!e)return x[k];if(!x[e])throw new Error("Unknown language : "+e);return x[e]},M.cultureData=function(e){if(!e)return N[k];if(!N[e])throw new Error("Unknown culture : "+e);return N[e]},M.culture("en-US",L),M.languages=function(){return console.warn("`languages` is deprecated since version 1.6.0. Use `cultures` instead"),x},M.cultures=function(){return N},M.zeroFormat=function(e){I="string"==typeof e?e:null},M.defaultFormat=function(e){D="string"==typeof e?e:"0.0"},M.defaultCurrencyFormat=function(e){P="string"==typeof e?e:"0$"},M.validate=function(e,t){var n,r,o,i,s,a,l,u;if("string"!=typeof e&&(e+="",console.warn&&console.warn("Numbro.js: Value is not string. It has been co-erced to: ",e)),e=e.trim(),e=e.replace(/^[+-]?/,""),e.match(/^\d+$/))return!0;if(""===e)return!1;try{l=M.cultureData(t)}catch(e){l=M.cultureData(M.culture())}return o=l.currency.symbol,s=l.abbreviations,n=l.delimiters.decimal,r="."===l.delimiters.thousands?"\\.":l.delimiters.thousands,u=e.match(/^[^\d\.\,]+/),(null===u||(e=e.substr(1),u[0]===o))&&(u=e.match(/[^\d]+$/),(null===u||(e=e.slice(0,-1),u[0]===s.thousand||u[0]===s.million||u[0]===s.billion||u[0]===s.trillion))&&(a=new RegExp(r+"{2}"),!e.match(/[^\d.,]/g)&&(i=e.split(n),!(i.length>2)&&(i.length<2?!!i[0].match(/^\d+.*\d$/)&&!i[0].match(a):""===i[0]?!i[0].match(a)&&!!i[1].match(/^\d+$/):1===i[0].length?!!i[0].match(/^\d+$/)&&!i[0].match(a)&&!!i[1].match(/^\d+$/):!!i[0].match(/^\d+.*\d$/)&&!i[0].match(a)&&!!i[1].match(/^\d+$/)))))},M.loadLanguagesInNode=function(){console.warn("`loadLanguagesInNode` is deprecated since version 1.6.0. Use `loadCulturesInNode` instead"),M.loadCulturesInNode()},M.loadCulturesInNode=function(){var e=n(21);for(var t in e)t&&M.culture(t,e[t])},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(e,t){if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var n,r,o=this.length>>>0,i=!1;for(1<arguments.length&&(r=t,i=!0),n=0;o>n;++n)this.hasOwnProperty(n)&&(i?r=e(r,this[n],n,this):(r=this[n],i=!0));if(!i)throw new TypeError("Reduce of empty array with no initial value");return r}),M.fn=s.prototype={clone:function(){return M(this)},format:function(e,t){return d(this,e?e:D,void 0!==t?t:Math.round)},formatCurrency:function(e,t){return h(this,N[k].currency.symbol,e?e:P,void 0!==t?t:Math.round)},formatForeignCurrency:function(e,t,n){return f(this,e,t?t:P,void 0!==n?n:Math.round)},unformat:function(e){if("number"==typeof e)return e;if("string"==typeof e){var t=c(this,e);return isNaN(t)?void 0:t}},binaryByteUnits:function(){return v(this._value,T.binary.suffixes,T.binary.scale).suffix},byteUnits:function(){return v(this._value,T.general.suffixes,T.general.scale).suffix},decimalByteUnits:function(){return v(this._value,T.decimal.suffixes,T.decimal.scale).suffix},value:function(){return this._value},valueOf:function(){return this._value},set:function(e){return this._value=Number(e),this},add:function(e){function t(e,t){return e+n*t}var n=R.call(null,this._value,e);return this._value=[this._value,e].reduce(t,0)/n,this},subtract:function(e){function t(e,t){return e-n*t}var n=R.call(null,this._value,e);return this._value=[e].reduce(t,this._value*n)/n,this},multiply:function(e){function t(e,t){var n=R(e,t),r=e*n;return r*=t*n,r/=n*n}return this._value=[this._value,e].reduce(t,1),this},divide:function(e){function t(e,t){var n=R(e,t);return e*n/(t*n)}return this._value=[this._value,e].reduce(t),this},difference:function(e){return Math.abs(M(this._value).subtract(e).value())}},_()&&M.loadCulturesInNode(),H?e.exports=M:("undefined"==typeof ender&&(this.numbro=M),r=[],o=function(){return M}.apply(t,r),!(void 0!==o&&(e.exports=o)))}).call("undefined"==typeof window?this:window)}).call(t,n(20))},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(e){if(d===setTimeout)return setTimeout(e,0);if((d===n||!d)&&setTimeout)return d=setTimeout,setTimeout(e,0);try{return d(e,0)}catch(t){try{return d.call(null,e,0)}catch(t){return d.call(this,e,0)}}}function i(e){if(c===clearTimeout)return clearTimeout(e);if((c===r||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(e);try{return c(e)}catch(t){try{return c.call(null,e)}catch(t){return c.call(this,e)}}}function s(){m&&f&&(m=!1,f.length?p=f.concat(p):g=-1,p.length&&a())}function a(){if(!m){var e=o(s);m=!0;for(var t=p.length;t;){for(f=p,p=[];++g<t;)f&&f[g].run();g=-1,t=p.length}f=null,m=!1,i(e)}}function l(e,t){this.fun=e,this.array=t}function u(){}var d,c,h=e.exports={};!function(){try{d="function"==typeof setTimeout?setTimeout:n}catch(e){d=n}try{c="function"==typeof clearTimeout?clearTimeout:r}catch(e){c=r}}();var f,p=[],m=!1,g=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new l(e,t)),1!==p.length||m||o(a)},l.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=u,h.addListener=u,h.once=u,h.off=u,h.removeListener=u,h.removeAllListeners=u,h.emit=u,h.binding=function(e){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(e){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(e,t){},function(e,t){this.j$=this.jStat=function(e,t){function n(t,n){var r=t>n?t:n;return e.pow(10,17-~~(e.log(r>0?r:-r)*e.LOG10E))}function r(e){return"[object Function]"===f.call(e)}function o(e){return"number"==typeof e&&e===e}function s(e){return c.apply([],e)}function a(){return new a._init(arguments)}function l(){return 0}function u(){return 1}function d(e,t){return e===t?1:0}var c=Array.prototype.concat,h=Array.prototype.slice,f=Object.prototype.toString,p=Array.isArray||function(e){return"[object Array]"===f.call(e)};a.fn=a.prototype,a._init=function(e){var t;if(p(e[0]))if(p(e[0][0])){r(e[1])&&(e[0]=a.map(e[0],e[1]));for(var t=0;t<e[0].length;t++)this[t]=e[0][t];this.length=e[0].length}else this[0]=r(e[1])?a.map(e[0],e[1]):e[0],this.length=1;else if(o(e[0]))this[0]=a.seq.apply(null,e),this.length=1;else{if(e[0]instanceof a)return a(e[0].toArray());this[0]=[],this.length=1}return this},a._init.prototype=a.prototype,a._init.constructor=a,a.utils={calcRdx:n,isArray:p,isFunction:r,isNumber:o,toVector:s},a.extend=function(e){var t,n;if(1===arguments.length){for(n in e)a[n]=e[n];return this}for(var t=1;t<arguments.length;t++)for(n in arguments[t])e[n]=arguments[t][n];return e},a.rows=function(e){return e.length||1},a.cols=function(e){return e[0].length||1},a.dimensions=function(e){return{rows:a.rows(e),cols:a.cols(e)}},a.row=function(e,t){return p(t)?t.map(function(t){return a.row(e,t)}):e[t]},a.rowa=function(e,t){return a.row(e,t)},a.col=function(e,t){if(p(t)){var n=a.arange(e.length).map(function(e){return new Array(t.length)});return t.forEach(function(t,r){a.arange(e.length).forEach(function(o){n[o][r]=e[o][t]})}),n}for(var r=new Array(e.length),o=0;o<e.length;o++)r[o]=[e[o][t]];return r},a.cola=function(e,t){return a.col(e,t).map(function(e){return e[0]})},a.diag=function(e){for(var t=a.rows(e),n=new Array(t),r=0;r<t;r++)n[r]=[e[r][r]];return n},a.antidiag=function(e){for(var t=a.rows(e)-1,n=new Array(t),r=0;t>=0;t--,r++)n[r]=[e[r][t]];return n},a.transpose=function(e){var t,n,r,o,i,s=[];p(e[0])||(e=[e]),n=e.length,r=e[0].length;for(var i=0;i<r;i++){for(t=new Array(n),o=0;o<n;o++)t[o]=e[o][i];s.push(t)}return 1===s.length?s[0]:s},a.map=function(e,t,n){var r,o,i,s,a;for(p(e[0])||(e=[e]),o=e.length,i=e[0].length,s=n?e:new Array(o),r=0;r<o;r++)for(s[r]||(s[r]=new Array(i)),a=0;a<i;a++)s[r][a]=t(e[r][a],r,a);return 1===s.length?s[0]:s},a.cumreduce=function(e,t,n){var r,o,i,s,a;for(p(e[0])||(e=[e]),o=e.length,i=e[0].length,s=n?e:new Array(o),r=0;r<o;r++)for(s[r]||(s[r]=new Array(i)),i>0&&(s[r][0]=e[r][0]),a=1;a<i;a++)s[r][a]=t(s[r][a-1],e[r][a]);return 1===s.length?s[0]:s},a.alter=function(e,t){return a.map(e,t,!0)},a.create=function(e,t,n){var o,i,s=new Array(e);r(t)&&(n=t,t=e);for(var o=0;o<e;o++)for(s[o]=new Array(t),i=0;i<t;i++)s[o][i]=n(o,i);return s},a.zeros=function(e,t){return o(t)||(t=e),a.create(e,t,l)},a.ones=function(e,t){return o(t)||(t=e),a.create(e,t,u)},a.rand=function(t,n){return o(n)||(n=t),a.create(t,n,e.random)},a.identity=function(e,t){return o(t)||(t=e),a.create(e,t,d)},a.symmetric=function(e){var t,n,r=e.length;if(e.length!==e[0].length)return!1;for(t=0;t<r;t++)for(n=0;n<r;n++)if(e[n][t]!==e[t][n])return!1;return!0},a.clear=function(e){return a.alter(e,l)},a.seq=function(e,t,o,i){r(i)||(i=!1);var s,a=[],l=n(e,t),u=(t*l-e*l)/((o-1)*l),d=e;for(s=0;d<=t;s++,d=(e*l+u*l*s)/l)a.push(i?i(d,s):d);return a},a.arange=function(e,n,r){var o=[];if(r=r||1,n===t&&(n=e,e=0),e===n||0===r)return[];if(e<n&&r<0)return[];if(e>n&&r>0)return[];if(r>0)for(i=e;i<n;i+=r)o.push(i);else for(i=e;i>n;i+=r)o.push(i);return o},a.slice=function(){function e(e,n,r,o){var i,s=[],l=e.length;if(n===t&&r===t&&o===t)return a.copy(e);if(n=n||0,r=r||e.length,n=n>=0?n:l+n,r=r>=0?r:l+r,o=o||1,n===r||0===o)return[];if(n<r&&o<0)return[];if(n>r&&o>0)return[];if(o>0)for(i=n;i<r;i+=o)s.push(e[i]);else for(i=n;i>r;i+=o)s.push(e[i]);return s}function n(t,n){if(n=n||{},o(n.row)){if(o(n.col))return t[n.row][n.col];var r=a.rowa(t,n.row),i=n.col||{};return e(r,i.start,i.end,i.step)}if(o(n.col)){var s=a.cola(t,n.col),l=n.row||{};return e(s,l.start,l.end,l.step)}var l=n.row||{},i=n.col||{},u=e(t,l.start,l.end,l.step);return u.map(function(t){return e(t,i.start,i.end,i.step)})}return n}(),a.sliceAssign=function(n,r,i){if(o(r.row)){if(o(r.col))return n[r.row][r.col]=i;r.col=r.col||{},r.col.start=r.col.start||0,r.col.end=r.col.end||n[0].length,r.col.step=r.col.step||1;var s=a.arange(r.col.start,e.min(n.length,r.col.end),r.col.step),l=r.row;return s.forEach(function(e,t){n[l][e]=i[t]}),n}if(o(r.col)){r.row=r.row||{},r.row.start=r.row.start||0,r.row.end=r.row.end||n.length,r.row.step=r.row.step||1;var u=a.arange(r.row.start,e.min(n[0].length,r.row.end),r.row.step),d=r.col;return u.forEach(function(e,t){n[e][d]=i[t]}),n}i[0].length===t&&(i=[i]),r.row.start=r.row.start||0,r.row.end=r.row.end||n.length,r.row.step=r.row.step||1,r.col.start=r.col.start||0,r.col.end=r.col.end||n[0].length,r.col.step=r.col.step||1;var u=a.arange(r.row.start,e.min(n.length,r.row.end),r.row.step),s=a.arange(r.col.start,e.min(n[0].length,r.col.end),r.col.step);return u.forEach(function(e,t){s.forEach(function(r,o){n[e][r]=i[t][o]})}),n},a.diagonal=function(e){var t=a.zeros(e.length,e.length);return e.forEach(function(e,n){t[n][n]=e}),t},a.copy=function(e){return e.map(function(e){return o(e)?e:e.map(function(e){return e})})};var m=a.prototype;return m.length=0,m.push=Array.prototype.push,m.sort=Array.prototype.sort,m.splice=Array.prototype.splice,m.slice=Array.prototype.slice,m.toArray=function(){return this.length>1?h.call(this):h.call(this)[0]},m.map=function(e,t){return a(a.map(this,e,t))},m.cumreduce=function(e,t){return a(a.cumreduce(this,e,t))},m.alter=function(e){return a.alter(this,e),this},function(e){for(var t=0;t<e.length;t++)(function(e){m[e]=function(t){var n,r=this;return t?(setTimeout(function(){t.call(r,m[e].call(r))}),this):(n=a[e](this),p(n)?a(n):n)}})(e[t])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(e){for(var t=0;t<e.length;t++)(function(e){m[e]=function(t,n){var r=this;return n?(setTimeout(function(){n.call(r,m[e].call(r,t))}),this):a(a[e](this,t))}})(e[t])}("row col".split(" ")),function(e){for(var t=0;t<e.length;t++)(function(e){m[e]=new Function("return jStat(jStat."+e+".apply(null, arguments));")})(e[t])}("create zeros ones rand identity".split(" ")),a}(Math),function(e,t){function n(e,t){return e-t}function r(e,n,r){return t.max(n,t.min(e,r))}var o=e.utils.isFunction;e.sum=function e(t){for(var e=0,n=t.length;--n>=0;)e+=t[n];return e},e.sumsqrd=function(e){for(var t=0,n=e.length;--n>=0;)t+=e[n]*e[n];return t},e.sumsqerr=function(t){for(var n,r=e.mean(t),o=0,i=t.length;--i>=0;)n=t[i]-r,o+=n*n;return o},e.sumrow=function(e){for(var t=0,n=e.length;--n>=0;)t+=e[n];return t},e.product=function(e){for(var t=1,n=e.length;--n>=0;)t*=e[n];return t},e.min=function(e){for(var t=e[0],n=0;++n<e.length;)e[n]<t&&(t=e[n]);return t},e.max=function(e){for(var t=e[0],n=0;++n<e.length;)e[n]>t&&(t=e[n]);return t},e.unique=function(e){for(var t={},n=[],r=0;r<e.length;r++)t[e[r]]||(t[e[r]]=!0,n.push(e[r]));return n},e.mean=function(t){return e.sum(t)/t.length},e.meansqerr=function(t){return e.sumsqerr(t)/t.length},e.geomean=function(n){return t.pow(e.product(n),1/n.length)},e.median=function(e){var t=e.length,r=e.slice().sort(n);return 1&t?r[t/2|0]:(r[t/2-1]+r[t/2])/2},e.cumsum=function(t){return e.cumreduce(t,function(e,t){return e+t})},e.cumprod=function(t){return e.cumreduce(t,function(e,t){return e*t})},e.diff=function(e){for(var t,n=[],r=e.length,t=1;t<r;t++)n.push(e[t]-e[t-1]);return n},e.rank=function(e){for(var t=e.length,r=e.slice().sort(n),o=new Array(t),i=0;i<t;i++){var s=r.indexOf(e[i]),a=r.lastIndexOf(e[i]);if(s===a)var l=s;else var l=(s+a)/2;o[i]=l+1}return o},e.mode=function(e){for(var t,r=e.length,o=e.slice().sort(n),i=1,s=0,a=0,l=[],t=0;t<r;t++)o[t]===o[t+1]?i++:(i>s?(l=[o[t]],s=i,a=0):i===s&&(l.push(o[t]),a++),i=1);return 0===a?l[0]:l},e.range=function(t){return e.max(t)-e.min(t)},e.variance=function(t,n){return e.sumsqerr(t)/(t.length-(n?1:0))},e.deviation=function(t){for(var n=e.mean(t),r=t.length,o=new Array(r),i=0;i<r;i++)o[i]=t[i]-n;return o},e.stdev=function(n,r){return t.sqrt(e.variance(n,r))},e.meandev=function(n){for(var r,o=0,i=e.mean(n),r=n.length-1;r>=0;r--)o+=t.abs(n[r]-i);return o/n.length},e.meddev=function(n){for(var r,o=0,i=e.median(n),r=n.length-1;r>=0;r--)o+=t.abs(n[r]-i);return o/n.length},e.coeffvar=function(t){return e.stdev(t)/e.mean(t)},e.quartiles=function(e){var r=e.length,o=e.slice().sort(n);return[o[t.round(r/4)-1],o[t.round(r/2)-1],o[t.round(3*r/4)-1]]},e.quantiles=function(e,o,i,s){var a,l,u,d,c,h,f=e.slice().sort(n),p=[o.length],m=e.length;"undefined"==typeof i&&(i=3/8),"undefined"==typeof s&&(s=3/8);for(var a=0;a<o.length;a++)l=o[a],u=i+l*(1-i-s),d=m*l+u,c=t.floor(r(d,1,m-1)),h=r(d-c,0,1),p[a]=(1-h)*f[c-1]+h*f[c];return p},e.percentile=function(e,t){var r=e.slice().sort(n),o=t*(r.length-1),i=parseInt(o),s=o-i;return i+1<r.length?r[i]*(1-s)+r[i+1]*s:r[i]},e.percentileOfScore=function(e,t,n){var r,o,i=0,s=e.length,a=!1;"strict"===n&&(a=!0);for(var o=0;o<s;o++)r=e[o],(a&&r<t||!a&&r<=t)&&i++;return i/s},e.histogram=function(n,r){for(var o,i=e.min(n),s=r||4,a=(e.max(n)-i)/s,l=n.length,r=[],o=0;o<s;o++)r[o]=0;for(var o=0;o<l;o++)r[t.min(t.floor((n[o]-i)/a),s-1)]+=1;return r},e.covariance=function(t,n){for(var r,o=e.mean(t),i=e.mean(n),s=t.length,a=new Array(s),r=0;r<s;r++)a[r]=(t[r]-o)*(n[r]-i);return e.sum(a)/(s-1)},e.corrcoeff=function(t,n){return e.covariance(t,n)/e.stdev(t,1)/e.stdev(n,1)},e.spearmancoeff=function(n,r){n=e.rank(n),r=e.rank(r);var o=e.deviation(n),i=e.deviation(r);return e.sum(o.map(function(e,t){return e*i[t]}))/t.sqrt(e.sum(o.map(function(e){return t.pow(e,2)}))*e.sum(i.map(function(e){return t.pow(e,2)})))},e.stanMoment=function(n,r){for(var o=e.mean(n),i=e.stdev(n),s=n.length,a=0,l=0;l<s;l++)a+=t.pow((n[l]-o)/i,r);return a/n.length},e.skewness=function(t){return e.stanMoment(t,3)},e.kurtosis=function(t){return e.stanMoment(t,4)-3};var i=e.prototype;!function(t){for(var n=0;n<t.length;n++)(function(t){i[t]=function(n,r){var s=[],a=0,l=this;if(o(n)&&(r=n,n=!1),r)return setTimeout(function(){r.call(l,i[t].call(l,n))}),this;if(this.length>1){for(l=n===!0?this:this.transpose();a<l.length;a++)s[a]=e[t](l[a]);return s}return e[t](this[0],n)}})(t[n])}("cumsum cumprod".split(" ")),function(t){for(var n=0;n<t.length;n++)(function(t){i[t]=function(n,r){var s=[],a=0,l=this;if(o(n)&&(r=n,n=!1),r)return setTimeout(function(){r.call(l,i[t].call(l,n))}),this;if(this.length>1){for("sumrow"!==t&&(l=n===!0?this:this.transpose());a<l.length;a++)s[a]=e[t](l[a]);return n===!0?e[t](e.utils.toVector(s)):s}return e[t](this[0],n)}})(t[n])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(t){for(var n=0;n<t.length;n++)(function(t){i[t]=function(){var n=[],r=0,s=this,a=Array.prototype.slice.call(arguments);if(o(a[a.length-1])){var l=a[a.length-1],u=a.slice(0,a.length-1);return setTimeout(function(){l.call(s,i[t].apply(s,u))}),this}var l=void 0,d=function(n){return e[t].apply(s,[n].concat(a))};if(this.length>1){for(s=s.transpose();r<s.length;r++)n[r]=d(s[r]);return n}return d(this[0])}})(t[n])}("quantiles percentileOfScore".split(" "))}(this.jStat,Math),function(e,t){e.gammaln=function(e){var n,r,o,i=0,s=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],a=1.000000000190015;for(o=(r=n=e)+5.5,o-=(n+.5)*t.log(o);i<6;i++)a+=s[i]/++r;return t.log(2.5066282746310007*a/n)-o},e.gammafn=function(e){var n,r,o,i,s=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],a=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],l=!1,u=0,d=0,c=0,h=e;if(h<=0){if(i=h%1+3.6e-16,!i)return 1/0;l=(1&h?-1:1)*t.PI/t.sin(t.PI*i),h=1-h}o=h,r=h<1?h++:(h-=u=(0|h)-1)-1;for(var n=0;n<8;++n)c=(c+s[n])*r,d=d*r+a[n];if(i=c/d+1,o<h)i/=o;else if(o>h)for(var n=0;n<u;++n)i*=h,h++;return l&&(i=l/i),i},e.gammap=function(t,n){return e.lowRegGamma(t,n)*e.gammafn(t)},e.lowRegGamma=function(n,r){var o,i=e.gammaln(n),s=n,a=1/n,l=a,u=r+1-n,d=1/1e-30,c=1/u,h=c,f=1,p=-~(8.5*t.log(n>=1?n:1/n)+.4*n+17);if(r<0||n<=0)return NaN;if(r<n+1){for(;f<=p;f++)a+=l*=r/++s;return a*t.exp(-r+n*t.log(r)-i)}for(;f<=p;f++)o=-f*(f-n),u+=2,c=o*c+u,d=u+o/d,c=1/c,h*=c*d;return 1-h*t.exp(-r+n*t.log(r)-i)},e.factorialln=function(t){return t<0?NaN:e.gammaln(t+1)},e.factorial=function(t){return t<0?NaN:e.gammafn(t+1)},e.combination=function(n,r){return n>170||r>170?t.exp(e.combinationln(n,r)):e.factorial(n)/e.factorial(r)/e.factorial(n-r)},e.combinationln=function(t,n){return e.factorialln(t)-e.factorialln(n)-e.factorialln(t-n)},e.permutation=function(t,n){return e.factorial(t)/e.factorial(t-n)},e.betafn=function(n,r){if(!(n<=0||r<=0))return n+r>170?t.exp(e.betaln(n,r)):e.gammafn(n)*e.gammafn(r)/e.gammafn(n+r)},e.betaln=function(t,n){return e.gammaln(t)+e.gammaln(n)-e.gammaln(t+n)},e.betacf=function(e,n,r){var o,i,s,a,l=1e-30,u=1,d=n+r,c=n+1,h=n-1,f=1,p=1-d*e/c;for(t.abs(p)<l&&(p=l),p=1/p,a=p;u<=100&&(o=2*u,i=u*(r-u)*e/((h+o)*(n+o)),p=1+i*p,t.abs(p)<l&&(p=l),f=1+i/f,t.abs(f)<l&&(f=l),p=1/p,a*=p*f,i=-(n+u)*(d+u)*e/((n+o)*(c+o)),p=1+i*p,t.abs(p)<l&&(p=l),f=1+i/f,t.abs(f)<l&&(f=l),p=1/p,s=p*f,a*=s,!(t.abs(s-1)<3e-7));u++);return a},e.gammapinv=function(n,r){var o,i,s,a,l,u,d,c=0,h=r-1,f=1e-8,p=e.gammaln(r);if(n>=1)return t.max(100,r+100*t.sqrt(r));if(n<=0)return 0;for(r>1?(u=t.log(h),d=t.exp(h*(u-1)-p),l=n<.5?n:1-n,s=t.sqrt(-2*t.log(l)),o=(2.30753+.27061*s)/(1+s*(.99229+.04481*s))-s,n<.5&&(o=-o),o=t.max(.001,r*t.pow(1-1/(9*r)-o/(3*t.sqrt(r)),3))):(s=1-r*(.253+.12*r),o=n<s?t.pow(n/s,1/r):1-t.log(1-(n-s)/(1-s)));c<12;c++){if(o<=0)return 0;if(i=e.lowRegGamma(r,o)-n,s=r>1?d*t.exp(-(o-h)+h*(t.log(o)-u)):t.exp(-o+h*t.log(o)-p),a=i/s,o-=s=a/(1-.5*t.min(1,a*((r-1)/o-1))),o<=0&&(o=.5*(o+s)),t.abs(s)<f*o)break}return o},e.erf=function(e){var n,r,o,i,s=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,9.6467911e-11,2.394038e-12,-6.886027e-12,8.94487e-13,3.13092e-13,-1.12708e-13,3.81e-16,7.106e-15,-1.523e-15,-9.4e-17,1.21e-16,-2.8e-17],a=s.length-1,l=!1,u=0,d=0;for(e<0&&(e=-e,l=!0),n=2/(2+e),r=4*n-2;a>0;a--)o=u,u=r*u-d+s[a],d=o;return i=n*t.exp(-e*e+.5*(s[0]+r*u)-d),l?i-1:1-i},e.erfc=function(t){return 1-e.erf(t)},e.erfcinv=function(n){var r,o,i,s,a=0;if(n>=2)return-100;if(n<=0)return 100;for(s=n<1?n:2-n,i=t.sqrt(-2*t.log(s/2)),r=-.70711*((2.30753+.27061*i)/(1+i*(.99229+.04481*i))-i);a<2;a++)o=e.erfc(r)-s,r+=o/(1.1283791670955126*t.exp(-r*r)-r*o);return n<1?r:-r},e.ibetainv=function(n,r,o){var i,s,a,l,u,d,c,h,f,p,m,g=1e-8,v=r-1,w=o-1,b=0;if(n<=0)return 0;if(n>=1)return 1;for(r>=1&&o>=1?(a=n<.5?n:1-n,l=t.sqrt(-2*t.log(a)),c=(2.30753+.27061*l)/(1+l*(.99229+.04481*l))-l,n<.5&&(c=-c),h=(c*c-3)/6,f=2/(1/(2*r-1)+1/(2*o-1)),p=c*t.sqrt(h+f)/f-(1/(2*o-1)-1/(2*r-1))*(h+5/6-2/(3*f)),c=r/(r+o*t.exp(2*p))):(i=t.log(r/(r+o)),s=t.log(o/(r+o)),l=t.exp(r*i)/r,u=t.exp(o*s)/o,p=l+u,c=n<l/p?t.pow(r*p*n,1/r):1-t.pow(o*p*(1-n),1/o)),m=-e.gammaln(r)-e.gammaln(o)+e.gammaln(r+o);b<10;b++){if(0===c||1===c)return c;if(d=e.ibeta(c,r,o)-n,l=t.exp(v*t.log(c)+w*t.log(1-c)+m),u=d/l,c-=l=u/(1-.5*t.min(1,u*(v/c-w/(1-c)))),c<=0&&(c=.5*(c+l)),c>=1&&(c=.5*(c+l+1)),t.abs(l)<g*c&&b>0)break}return c},e.ibeta=function(n,r,o){var i=0===n||1===n?0:t.exp(e.gammaln(r+o)-e.gammaln(r)-e.gammaln(o)+r*t.log(n)+o*t.log(1-n));return!(n<0||n>1)&&(n<(r+1)/(r+o+2)?i*e.betacf(n,r,o)/r:1-i*e.betacf(1-n,o,r)/o)},e.randn=function(n,r){var o,i,s,a,l;if(r||(r=n),n)return e.create(n,r,function(){return e.randn()});do o=t.random(),i=1.7156*(t.random()-.5),s=o-.449871,a=t.abs(i)+.386595,l=s*s+a*(.196*a-.25472*s);while(l>.27597&&(l>.27846||i*i>-4*t.log(o)*o*o));return i/o},e.randg=function(n,r,o){var i,s,a,l,u,d,c=n;if(o||(o=r),n||(n=1),r)return d=e.zeros(r,o),d.alter(function(){return e.randg(n)}),d;n<1&&(n+=1),i=n-1/3,s=1/t.sqrt(9*i);do{do u=e.randn(),l=1+s*u;while(l<=0);l*=l*l,a=t.random()}while(a>1-.331*t.pow(u,4)&&t.log(a)>.5*u*u+i*(1-l+t.log(l)));if(n==c)return i*l;do a=t.random();while(0===a);return t.pow(a,1/c)*i*l},function(t){for(var n=0;n<t.length;n++)(function(t){e.fn[t]=function(){return e(e.map(this,function(n){return e[t](n)}))}})(t[n])}("gammaln gammafn factorial factorialln".split(" ")),function(t){for(var n=0;n<t.length;n++)(function(t){e.fn[t]=function(){return e(e[t].apply(null,arguments))}})(t[n])}("randn".split(" "))}(this.jStat,Math),function(e,t){function n(e){return e/t.abs(e)}!function(t){for(var n=0;n<t.length;n++)(function(t){e[t]=function(e,t,n){return this instanceof arguments.callee?(this._a=e,this._b=t,this._c=n,this):new arguments.callee(e,t,n)},e.fn[t]=function(n,r,o){var i=e[t](n,r,o);return i.data=this,i},e[t].prototype.sample=function(n){var r=this._a,o=this._b,i=this._c;return n?e.alter(n,function(){return e[t].sample(r,o,i)}):e[t].sample(r,o,i)},function(n){for(var r=0;r<n.length;r++)(function(n){e[t].prototype[n]=function(r){var o=this._a,i=this._b,s=this._c;return r||0===r||(r=this.data),"number"!=typeof r?e.fn.map.call(r,function(r){return e[t][n](r,o,i,s)}):e[t][n](r,o,i,s)}})(n[r])}("pdf cdf inv".split(" ")),function(n){for(var r=0;r<n.length;r++)(function(n){
e[t].prototype[n]=function(){return e[t][n](this._a,this._b,this._c)}})(n[r])}("mean median mode variance".split(" "))})(t[n])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular".split(" ")),e.extend(e.beta,{pdf:function(n,r,o){return n>1||n<0?0:1==r&&1==o?1:r<512&&o<512?t.pow(n,r-1)*t.pow(1-n,o-1)/e.betafn(r,o):t.exp((r-1)*t.log(n)+(o-1)*t.log(1-n)-e.betaln(r,o))},cdf:function(t,n,r){return t>1||t<0?1*(t>1):e.ibeta(t,n,r)},inv:function(t,n,r){return e.ibetainv(t,n,r)},mean:function(e,t){return e/(e+t)},median:function(t,n){return e.ibetainv(.5,t,n)},mode:function(e,t){return(e-1)/(e+t-2)},sample:function(t,n){var r=e.randg(t);return r/(r+e.randg(n))},variance:function(e,n){return e*n/(t.pow(e+n,2)*(e+n+1))}}),e.extend(e.centralF,{pdf:function(n,r,o){var i,s,a;return n<0?0:r<=2?0===n&&r<2?1/0:0===n&&2===r?1:t.sqrt(t.pow(r*n,r)*t.pow(o,o)/t.pow(r*n+o,r+o))/(n*e.betafn(r/2,o/2)):(i=r*n/(o+n*r),s=o/(o+n*r),a=r*s/2,a*e.binomial.pdf((r-2)/2,(r+o-2)/2,i))},cdf:function(t,n,r){return t<0?0:e.ibeta(n*t/(n*t+r),n/2,r/2)},inv:function(t,n,r){return r/(n*(1/e.ibetainv(t,n/2,r/2)-1))},mean:function(e,t){return t>2?t/(t-2):void 0},mode:function(e,t){return e>2?t*(e-2)/(e*(t+2)):void 0},sample:function(t,n){var r=2*e.randg(t/2),o=2*e.randg(n/2);return r/t/(o/n)},variance:function(e,t){if(!(t<=4))return 2*t*t*(e+t-2)/(e*(t-2)*(t-2)*(t-4))}}),e.extend(e.cauchy,{pdf:function(e,n,r){return r<0?0:r/(t.pow(e-n,2)+t.pow(r,2))/t.PI},cdf:function(e,n,r){return t.atan((e-n)/r)/t.PI+.5},inv:function(e,n,r){return n+r*t.tan(t.PI*(e-.5))},median:function(e,t){return e},mode:function(e,t){return e},sample:function(n,r){return e.randn()*t.sqrt(1/(2*e.randg(.5)))*r+n}}),e.extend(e.chisquare,{pdf:function(n,r){return n<0?0:0===n&&2===r?.5:t.exp((r/2-1)*t.log(n)-n/2-r/2*t.log(2)-e.gammaln(r/2))},cdf:function(t,n){return t<0?0:e.lowRegGamma(n/2,t/2)},inv:function(t,n){return 2*e.gammapinv(t,.5*n)},mean:function(e){return e},median:function(e){return e*t.pow(1-2/(9*e),3)},mode:function(e){return e-2>0?e-2:0},sample:function(t){return 2*e.randg(t/2)},variance:function(e){return 2*e}}),e.extend(e.exponential,{pdf:function(e,n){return e<0?0:n*t.exp(-n*e)},cdf:function(e,n){return e<0?0:1-t.exp(-n*e)},inv:function(e,n){return-t.log(1-e)/n},mean:function(e){return 1/e},median:function(e){return 1/e*t.log(2)},mode:function(e){return 0},sample:function(e){return-1/e*t.log(t.random())},variance:function(e){return t.pow(e,-2)}}),e.extend(e.gamma,{pdf:function(n,r,o){return n<0?0:0===n&&1===r?1/o:t.exp((r-1)*t.log(n)-n/o-e.gammaln(r)-r*t.log(o))},cdf:function(t,n,r){return t<0?0:e.lowRegGamma(n,t/r)},inv:function(t,n,r){return e.gammapinv(t,n)*r},mean:function(e,t){return e*t},mode:function(e,t){if(e>1)return(e-1)*t},sample:function(t,n){return e.randg(t)*n},variance:function(e,t){return e*t*t}}),e.extend(e.invgamma,{pdf:function(n,r,o){return n<=0?0:t.exp(-(r+1)*t.log(n)-o/n-e.gammaln(r)+r*t.log(o))},cdf:function(t,n,r){return t<=0?0:1-e.lowRegGamma(n,r/t)},inv:function(t,n,r){return r/e.gammapinv(1-t,n)},mean:function(e,t){return e>1?t/(e-1):void 0},mode:function(e,t){return t/(e+1)},sample:function(t,n){return n/e.randg(t)},variance:function(e,t){if(!(e<=2))return t*t/((e-1)*(e-1)*(e-2))}}),e.extend(e.kumaraswamy,{pdf:function(e,n,r){return 0===e&&1===n?r:1===e&&1===r?n:t.exp(t.log(n)+t.log(r)+(n-1)*t.log(e)+(r-1)*t.log(1-t.pow(e,n)))},cdf:function(e,n,r){return e<0?0:e>1?1:1-t.pow(1-t.pow(e,n),r)},inv:function(e,n,r){return t.pow(1-t.pow(1-e,1/r),1/n)},mean:function(t,n){return n*e.gammafn(1+1/t)*e.gammafn(n)/e.gammafn(1+1/t+n)},median:function(e,n){return t.pow(1-t.pow(2,-1/n),1/e)},mode:function(e,n){if(e>=1&&n>=1&&1!==e&&1!==n)return t.pow((e-1)/(e*n-1),1/e)},variance:function(e,t){throw new Error("variance not yet implemented")}}),e.extend(e.lognormal,{pdf:function(e,n,r){return e<=0?0:t.exp(-t.log(e)-.5*t.log(2*t.PI)-t.log(r)-t.pow(t.log(e)-n,2)/(2*r*r))},cdf:function(n,r,o){return n<0?0:.5+.5*e.erf((t.log(n)-r)/t.sqrt(2*o*o))},inv:function(n,r,o){return t.exp(-1.4142135623730951*o*e.erfcinv(2*n)+r)},mean:function(e,n){return t.exp(e+n*n/2)},median:function(e,n){return t.exp(e)},mode:function(e,n){return t.exp(e-n*n)},sample:function(n,r){return t.exp(e.randn()*r+n)},variance:function(e,n){return(t.exp(n*n)-1)*t.exp(2*e+n*n)}}),e.extend(e.noncentralt,{pdf:function(n,r,o){var i=1e-14;return t.abs(o)<i?e.studentt.pdf(n,r):t.abs(n)<i?t.exp(e.gammaln((r+1)/2)-o*o/2-.5*t.log(t.PI*r)-e.gammaln(r/2)):r/n*(e.noncentralt.cdf(n*t.sqrt(1+2/r),r+2,o)-e.noncentralt.cdf(n,r,o))},cdf:function(n,r,o){var i=1e-14,s=200;if(t.abs(o)<i)return e.studentt.cdf(n,r);var a=!1;n<0&&(a=!0,o=-o);for(var l=e.normal.cdf(-o,0,1),u=i+1,d=u,c=n*n/(n*n+r),h=0,f=t.exp(-o*o/2),p=t.exp(-o*o/2-.5*t.log(2)-e.gammaln(1.5))*o;h<s||d>i||u>i;)d=u,h>0&&(f*=o*o/(2*h),p*=o*o/(2*(h+.5))),u=f*e.beta.cdf(c,h+.5,r/2)+p*e.beta.cdf(c,h+1,r/2),l+=.5*u,h++;return a?1-l:l}}),e.extend(e.normal,{pdf:function(e,n,r){return t.exp(-.5*t.log(2*t.PI)-t.log(r)-t.pow(e-n,2)/(2*r*r))},cdf:function(n,r,o){return.5*(1+e.erf((n-r)/t.sqrt(2*o*o)))},inv:function(t,n,r){return-1.4142135623730951*r*e.erfcinv(2*t)+n},mean:function(e,t){return e},median:function(e,t){return e},mode:function(e,t){return e},sample:function(t,n){return e.randn()*n+t},variance:function(e,t){return t*t}}),e.extend(e.pareto,{pdf:function(e,n,r){return e<n?0:r*t.pow(n,r)/t.pow(e,r+1)},cdf:function(e,n,r){return e<n?0:1-t.pow(n/e,r)},inv:function(e,n,r){return n/t.pow(1-e,1/r)},mean:function(e,n){if(!(n<=1))return n*t.pow(e,n)/(n-1)},median:function(e,n){return e*(n*t.SQRT2)},mode:function(e,t){return e},variance:function(e,n){if(!(n<=2))return e*e*n/(t.pow(n-1,2)*(n-2))}}),e.extend(e.studentt,{pdf:function(n,r){return r=r>1e100?1e100:r,1/(t.sqrt(r)*e.betafn(.5,r/2))*t.pow(1+n*n/r,-((r+1)/2))},cdf:function(n,r){var o=r/2;return e.ibeta((n+t.sqrt(n*n+r))/(2*t.sqrt(n*n+r)),o,o)},inv:function(n,r){var o=e.ibetainv(2*t.min(n,1-n),.5*r,.5);return o=t.sqrt(r*(1-o)/o),n>.5?o:-o},mean:function(e){return e>1?0:void 0},median:function(e){return 0},mode:function(e){return 0},sample:function(n){return e.randn()*t.sqrt(n/(2*e.randg(n/2)))},variance:function(e){return e>2?e/(e-2):e>1?1/0:void 0}}),e.extend(e.weibull,{pdf:function(e,n,r){return e<0||n<0||r<0?0:r/n*t.pow(e/n,r-1)*t.exp(-t.pow(e/n,r))},cdf:function(e,n,r){return e<0?0:1-t.exp(-t.pow(e/n,r))},inv:function(e,n,r){return n*t.pow(-t.log(1-e),1/r)},mean:function(t,n){return t*e.gammafn(1+1/n)},median:function(e,n){return e*t.pow(t.log(2),1/n)},mode:function(e,n){return n<=1?0:e*t.pow((n-1)/n,1/n)},sample:function(e,n){return e*t.pow(-t.log(t.random()),1/n)},variance:function(n,r){return n*n*e.gammafn(1+2/r)-t.pow(e.weibull.mean(n,r),2)}}),e.extend(e.uniform,{pdf:function(e,t,n){return e<t||e>n?0:1/(n-t)},cdf:function(e,t,n){return e<t?0:e<n?(e-t)/(n-t):1},inv:function(e,t,n){return t+e*(n-t)},mean:function(e,t){return.5*(e+t)},median:function(t,n){return e.mean(t,n)},mode:function(e,t){throw new Error("mode is not yet implemented")},sample:function(e,n){return e/2+n/2+(n/2-e/2)*(2*t.random()-1)},variance:function(e,n){return t.pow(n-e,2)/12}}),e.extend(e.binomial,{pdf:function(n,r,o){return 0===o||1===o?r*o===n?1:0:e.combination(r,n)*t.pow(o,n)*t.pow(1-o,r-n)},cdf:function(t,n,r){var o=[],i=0;if(t<0)return 0;if(t<n){for(;i<=t;i++)o[i]=e.binomial.pdf(i,n,r);return e.sum(o)}return 1}}),e.extend(e.negbin,{pdf:function(n,r,o){return n===n>>>0&&(n<0?0:e.combination(n+r-1,r-1)*t.pow(1-o,n)*t.pow(o,r))},cdf:function(t,n,r){var o=0,i=0;if(t<0)return 0;for(;i<=t;i++)o+=e.negbin.pdf(i,n,r);return o}}),e.extend(e.hypgeom,{pdf:function(n,r,o,i){if(n!==n|0)return!1;if(n<0||n<o-(r-i))return 0;if(n>i||n>o)return 0;if(2*o>r)return 2*i>r?e.hypgeom.pdf(r-o-i+n,r,r-o,r-i):e.hypgeom.pdf(i-n,r,r-o,i);if(2*i>r)return e.hypgeom.pdf(o-n,r,o,r-i);if(o<i)return e.hypgeom.pdf(n,r,i,o);for(var s=1,a=0,l=0;l<n;l++){for(;s>1&&a<i;)s*=1-o/(r-a),a++;s*=(i-l)*(o-l)/((l+1)*(r-o-i+l+1))}for(;a<i;a++)s*=1-o/(r-a);return t.min(1,t.max(0,s))},cdf:function(n,r,o,i){if(n<0||n<o-(r-i))return 0;if(n>=i||n>=o)return 1;if(2*o>r)return 2*i>r?e.hypgeom.cdf(r-o-i+n,r,r-o,r-i):1-e.hypgeom.cdf(i-n-1,r,r-o,i);if(2*i>r)return 1-e.hypgeom.cdf(o-n-1,r,o,r-i);if(o<i)return e.hypgeom.cdf(n,r,i,o);for(var s=1,a=1,l=0,u=0;u<n;u++){for(;s>1&&l<i;){var d=1-o/(r-l);a*=d,s*=d,l++}a*=(i-u)*(o-u)/((u+1)*(r-o-i+u+1)),s+=a}for(;l<i;l++)s*=1-o/(r-l);return t.min(1,t.max(0,s))}}),e.extend(e.poisson,{pdf:function(n,r){return r<0||n%1!==0||n<0?0:t.pow(r,n)*t.exp(-r)/e.factorial(n)},cdf:function(t,n){var r=[],o=0;if(t<0)return 0;for(;o<=t;o++)r.push(e.poisson.pdf(o,n));return e.sum(r)},mean:function(e){return e},variance:function(e){return e},sample:function(e){var n=1,r=0,o=t.exp(-e);do r++,n*=t.random();while(n>o);return r-1}}),e.extend(e.triangular,{pdf:function(e,t,n,r){return n<=t||r<t||r>n?NaN:e<t||e>n?0:e<r?2*(e-t)/((n-t)*(r-t)):e===r?2/(n-t):2*(n-e)/((n-t)*(n-r))},cdf:function(e,n,r,o){return r<=n||o<n||o>r?NaN:e<=n?0:e>=r?1:e<=o?t.pow(e-n,2)/((r-n)*(o-n)):1-t.pow(r-e,2)/((r-n)*(r-o))},inv:function(e,n,r,o){return r<=n||o<n||o>r?NaN:e<=(o-n)/(r-n)?n+(r-n)*t.sqrt(e*((o-n)/(r-n))):n+(r-n)*(1-t.sqrt((1-e)*(1-(o-n)/(r-n))))},mean:function(e,t,n){return(e+t+n)/3},median:function(e,n,r){return r<=(e+n)/2?n-t.sqrt((n-e)*(n-r))/t.sqrt(2):r>(e+n)/2?e+t.sqrt((n-e)*(r-e))/t.sqrt(2):void 0},mode:function(e,t,n){return n},sample:function(e,n,r){var o=t.random();return o<(r-e)/(n-e)?e+t.sqrt(o*(n-e)*(r-e)):n-t.sqrt((1-o)*(n-e)*(n-r))},variance:function(e,t,n){return(e*e+t*t+n*n-e*t-e*n-t*n)/18}}),e.extend(e.laplace,{pdf:function(e,n,r){return r<=0?0:t.exp(-t.abs(e-n)/r)/(2*r)},cdf:function(e,n,r){return r<=0?0:e<n?.5*t.exp((e-n)/r):1-.5*t.exp(-(e-n)/r)},mean:function(e,t){return e},median:function(e,t){return e},mode:function(e,t){return e},variance:function(e,t){return 2*t*t},sample:function(e,r){var o=t.random()-.5;return e-r*n(o)*t.log(1-2*t.abs(o))}})}(this.jStat,Math),function(e,t){function n(t){return o(t)||t instanceof e}var r=Array.prototype.push,o=e.utils.isArray;e.extend({add:function(t,r){return n(r)?(n(r[0])||(r=[r]),e.map(t,function(e,t,n){return e+r[t][n]})):e.map(t,function(e){return e+r})},subtract:function(t,r){return n(r)?(n(r[0])||(r=[r]),e.map(t,function(e,t,n){return e-r[t][n]||0})):e.map(t,function(e){return e-r})},divide:function(t,r){return n(r)?(n(r[0])||(r=[r]),e.multiply(t,e.inv(r))):e.map(t,function(e){return e/r})},multiply:function(t,r){var o,i,s,a,l,u,d,c;if(void 0===t.length&&void 0===r.length)return t*r;if(l=t.length,u=t[0].length,d=e.zeros(l,s=n(r)?r[0].length:u),c=0,n(r)){for(;c<s;c++)for(o=0;o<l;o++){for(a=0,i=0;i<u;i++)a+=t[o][i]*r[i][c];d[o][c]=a}return 1===l&&1===c?d[0][0]:d}return e.map(t,function(e){return e*r})},outer:function(t,n){return e.multiply(t.map(function(e){return[e]}),[n])},dot:function(t,r){n(t[0])||(t=[t]),n(r[0])||(r=[r]);for(var o,i,s=1===t[0].length&&1!==t.length?e.transpose(t):t,a=1===r[0].length&&1!==r.length?e.transpose(r):r,l=[],u=0,d=s.length,c=s[0].length;u<d;u++){for(l[u]=[],o=0,i=0;i<c;i++)o+=s[u][i]*a[u][i];l[u]=o}return 1===l.length?l[0]:l},pow:function(n,r){return e.map(n,function(e){return t.pow(e,r)})},exp:function(n){return e.map(n,function(e){return t.exp(e)})},log:function(n){return e.map(n,function(e){return t.log(e)})},abs:function(n){return e.map(n,function(e){return t.abs(e)})},norm:function(e,r){var o=0,i=0;for(isNaN(r)&&(r=2),n(e[0])&&(e=e[0]);i<e.length;i++)o+=t.pow(t.abs(e[i]),r);return t.pow(o,1/r)},angle:function(n,r){return t.acos(e.dot(n,r)/(e.norm(n)*e.norm(r)))},aug:function(e,t){for(var n=[],o=0;o<e.length;o++)n.push(e[o].slice());for(var o=0;o<n.length;o++)r.apply(n[o],t[o]);return n},inv:function(t){for(var n,r=t.length,o=t[0].length,i=e.identity(r,o),s=e.gauss_jordan(t,i),a=[],l=0;l<r;l++)for(a[l]=[],n=o;n<s[0].length;n++)a[l][n-o]=s[l][n];return a},det:function(e){var t,n=e.length,r=2*n,o=new Array(r),i=n-1,s=r-1,a=i-n+1,l=s,u=0,d=0;if(2===n)return e[0][0]*e[1][1]-e[0][1]*e[1][0];for(;u<r;u++)o[u]=1;for(var u=0;u<n;u++){for(t=0;t<n;t++)o[a<0?a+n:a]*=e[u][t],o[l<n?l+n:l]*=e[u][t],a++,l--;a=--i-n+1,l=--s}for(var u=0;u<n;u++)d+=o[u];for(;u<r;u++)d-=o[u];return d},gauss_elimination:function(n,r){var o,i,s,a,l=0,u=0,d=n.length,c=n[0].length,h=1,f=0,p=[];n=e.aug(n,r),o=n[0].length;for(var l=0;l<d;l++){for(i=n[l][l],u=l,a=l+1;a<c;a++)i<t.abs(n[a][l])&&(i=n[a][l],u=a);if(u!=l)for(a=0;a<o;a++)s=n[l][a],n[l][a]=n[u][a],n[u][a]=s;for(u=l+1;u<d;u++)for(h=n[u][l]/n[l][l],a=l;a<o;a++)n[u][a]=n[u][a]-h*n[l][a]}for(var l=d-1;l>=0;l--){for(f=0,u=l+1;u<=d-1;u++)f+=p[u]*n[l][u];p[l]=(n[l][o-1]-f)/n[l][l]}return p},gauss_jordan:function(n,r){for(var o=e.aug(n,r),i=o.length,s=o[0].length,a=0;a<i;a++){for(var l=a,u=a+1;u<i;u++)t.abs(o[u][a])>t.abs(o[l][a])&&(l=u);var d=o[a];o[a]=o[l],o[l]=d;for(var u=a+1;u<i;u++){c=o[u][a]/o[a][a];for(var h=a;h<s;h++)o[u][h]-=o[a][h]*c}}for(var a=i-1;a>=0;a--){c=o[a][a];for(var u=0;u<a;u++)for(var h=s-1;h>a-1;h--)o[u][h]-=o[a][h]*o[u][a]/c;o[a][a]/=c;for(var h=i;h<s;h++)o[a][h]/=c}return o},triaUpSolve:function(t,n){var r,o=t[0].length,i=e.zeros(1,o)[0],s=!1;return void 0!=n[0].length&&(n=n.map(function(e){return e[0]}),s=!0),e.arange(o-1,-1,-1).forEach(function(s){r=e.arange(s+1,o).map(function(e){return i[e]*t[s][e]}),i[s]=(n[s]-e.sum(r))/t[s][s]}),s?i.map(function(e){return[e]}):i},triaLowSolve:function(t,n){var r,o=t[0].length,i=e.zeros(1,o)[0],s=!1;return void 0!=n[0].length&&(n=n.map(function(e){return e[0]}),s=!0),e.arange(o).forEach(function(o){r=e.arange(o).map(function(e){return t[o][e]*i[e]}),i[o]=(n[o]-e.sum(r))/t[o][o]}),s?i.map(function(e){return[e]}):i},lu:function(t){var n,r=t.length,o=e.identity(r),s=e.zeros(t.length,t[0].length);return e.arange(r).forEach(function(e){s[0][e]=t[0][e]}),e.arange(1,r).forEach(function(a){e.arange(a).forEach(function(r){n=e.arange(r).map(function(e){return o[a][e]*s[e][r]}),o[a][r]=(t[a][r]-e.sum(n))/s[r][r]}),e.arange(a,r).forEach(function(r){n=e.arange(a).map(function(e){return o[a][e]*s[e][r]}),s[a][r]=t[i][r]-e.sum(n)})}),[o,s]},cholesky:function(n){var r,o=n.length,i=e.zeros(n.length,n[0].length);return e.arange(o).forEach(function(s){r=e.arange(s).map(function(e){return t.pow(i[s][e],2)}),i[s][s]=t.sqrt(n[s][s]-e.sum(r)),e.arange(s+1,o).forEach(function(t){r=e.arange(s).map(function(e){return i[s][e]*i[t][e]}),i[t][s]=(n[s][t]-e.sum(r))/i[s][s]})}),i},gauss_jacobi:function(n,r,o,i){for(var s,a,l,u,d=0,c=0,h=n.length,f=[],p=[],m=[];d<h;d++)for(f[d]=[],p[d]=[],m[d]=[],c=0;c<h;c++)d>c?(f[d][c]=n[d][c],p[d][c]=m[d][c]=0):d<c?(p[d][c]=n[d][c],f[d][c]=m[d][c]=0):(m[d][c]=n[d][c],f[d][c]=p[d][c]=0);for(l=e.multiply(e.multiply(e.inv(m),e.add(f,p)),-1),a=e.multiply(e.inv(m),r),s=o,u=e.add(e.multiply(l,o),a),d=2;t.abs(e.norm(e.subtract(u,s)))>i;)s=u,u=e.add(e.multiply(l,s),a),d++;return u},gauss_seidel:function(n,r,o,i){for(var s,a,l,u,d,c=0,h=n.length,f=[],p=[],m=[];c<h;c++)for(f[c]=[],p[c]=[],m[c]=[],s=0;s<h;s++)c>s?(f[c][s]=n[c][s],p[c][s]=m[c][s]=0):c<s?(p[c][s]=n[c][s],f[c][s]=m[c][s]=0):(m[c][s]=n[c][s],f[c][s]=p[c][s]=0);for(u=e.multiply(e.multiply(e.inv(e.add(m,f)),p),-1),l=e.multiply(e.inv(e.add(m,f)),r),a=o,d=e.add(e.multiply(u,o),l),c=2;t.abs(e.norm(e.subtract(d,a)))>i;)a=d,d=e.add(e.multiply(u,a),l),c+=1;return d},SOR:function(n,r,o,i,s){for(var a,l,u,d,c,h=0,f=n.length,p=[],m=[],g=[];h<f;h++)for(p[h]=[],m[h]=[],g[h]=[],a=0;a<f;a++)h>a?(p[h][a]=n[h][a],m[h][a]=g[h][a]=0):h<a?(m[h][a]=n[h][a],p[h][a]=g[h][a]=0):(g[h][a]=n[h][a],p[h][a]=m[h][a]=0);for(d=e.multiply(e.inv(e.add(g,e.multiply(p,s))),e.subtract(e.multiply(g,1-s),e.multiply(m,s))),u=e.multiply(e.multiply(e.inv(e.add(g,e.multiply(p,s))),r),s),l=o,c=e.add(e.multiply(d,o),u),h=2;t.abs(e.norm(e.subtract(c,l)))>i;)l=c,c=e.add(e.multiply(d,l),u),h++;return c},householder:function(n){for(var r,o,i,s,a,l=n.length,u=n[0].length,d=0,c=[],h=[];d<l-1;d++){for(r=0,s=d+1;s<u;s++)r+=n[s][d]*n[s][d];for(a=n[d+1][d]>0?-1:1,r=a*t.sqrt(r),o=t.sqrt((r*r-n[d+1][d]*r)/2),c=e.zeros(l,1),c[d+1][0]=(n[d+1][d]-r)/(2*o),i=d+2;i<l;i++)c[i][0]=n[i][d]/(2*o);h=e.subtract(e.identity(l,u),e.multiply(e.multiply(c,e.transpose(c)),2)),n=e.multiply(h,e.multiply(n,h))}return n},QR:function(){function t(t){var n=t.length,r=e.norm(t,2),o=e.zeros(1,n)[0];o[0]=1;var i=e.add(e.multiply(e.multiply(o,r),-1),t),s=e.norm(i,2),a=e.divide(i,s),l=e.subtract(e.identity(n),e.multiply(e.outer(a,a),2));return l}function n(n){var r=n[0].length,o=[];e.arange(r).forEach(function(r){var i=e.slice(n,{row:{start:r},col:r}),s=t(i),a=e.identity(n.length);a=e.sliceAssign(a,{row:{start:r},col:{start:r}},s),n=e.multiply(a,n),o.push(a)});var i=o.reduce(function(t,n){return e.multiply(t,n)}),s=n;return[i,s]}return n}(),lstsq:function(t,n){function r(t){t=e.copy(t);var n=t.length,r=e.identity(n);return e.arange(n-1,-1,-1).forEach(function(n){e.sliceAssign(r,{row:n},e.divide(e.slice(r,{row:n}),t[n][n])),e.sliceAssign(t,{row:n},e.divide(e.slice(t,{row:n}),t[n][n])),e.arange(n).forEach(function(o){var i=e.multiply(t[o][n],-1),s=e.slice(t,{row:o}),a=e.multiply(e.slice(t,{row:n}),i);e.sliceAssign(t,{row:o},e.add(s,a));var l=e.slice(r,{row:o}),u=e.multiply(e.slice(r,{row:n}),i);e.sliceAssign(r,{row:o},e.add(l,u))})}),r}function o(t,n){var o=!1;void 0===n[0].length&&(n=n.map(function(e){return[e]}),o=!0);var i=e.QR(t),s=i[0],a=i[1],l=t[0].length,u=e.slice(s,{col:{end:l}}),d=e.slice(a,{row:{end:l}}),c=r(d),h=e.multiply(e.multiply(c,e.transpose(u)),n);return o?h.map(function(e){return e[0]}):h}return o}(),jacobi:function(n){for(var r,o,i,s,a,l,u,d,c=1,h=0,f=n.length,p=e.identity(f,f),m=[];1===c;){h++,l=n[0][1],s=0,a=1;for(var o=0;o<f;o++)for(i=0;i<f;i++)o!=i&&l<t.abs(n[o][i])&&(l=t.abs(n[o][i]),s=o,a=i);u=n[s][s]===n[a][a]?n[s][a]>0?t.PI/4:-t.PI/4:t.atan(2*n[s][a]/(n[s][s]-n[a][a]))/2,d=e.identity(f,f),d[s][s]=t.cos(u),d[s][a]=-t.sin(u),d[a][s]=t.sin(u),d[a][a]=t.cos(u),p=e.multiply(p,d),r=e.multiply(e.multiply(e.inv(d),n),d),n=r,c=0;for(var o=1;o<f;o++)for(i=1;i<f;i++)o!=i&&t.abs(n[o][i])>.001&&(c=1)}for(var o=0;o<f;o++)m.push(n[o][o]);return[p,m]},rungekutta:function(e,t,n,r,o,i){var s,a,l,u,d;if(2===i)for(;r<=n;)s=t*e(r,o),a=t*e(r+t,o+s),l=o+(s+a)/2,o=l,r+=t;if(4===i)for(;r<=n;)s=t*e(r,o),a=t*e(r+t/2,o+s/2),u=t*e(r+t/2,o+a/2),d=t*e(r+t,o+u),l=o+(s+2*a+2*u+d)/6,o=l,r+=t;return o},romberg:function(e,n,r,o){for(var i,s,a,l,u,d=0,c=(r-n)/2,h=[],f=[],p=[];d<o/2;){for(u=e(n),a=n,l=0;a<=r;a+=c,l++)h[l]=a;for(i=h.length,a=1;a<i-1;a++)u+=(a%2!==0?4:2)*e(h[a]);u=c/3*(u+e(r)),p[d]=u,c/=2,d++}for(s=p.length,i=1;1!==s;){for(a=0;a<s-1;a++)f[a]=(t.pow(4,i)*p[a+1]-p[a])/(t.pow(4,i)-1);s=f.length,p=f,f=[],i++}return p},richardson:function(e,n,r,o){function i(e,t){for(var n,r=0,o=e.length;r<o;r++)e[r]===t&&(n=r);return n}for(var s,a,l,u,d,c=(e.length,t.abs(r-e[i(e,r)+1])),h=0,f=[],p=[];o>=c;)s=i(e,r+o),a=i(e,r),f[h]=(n[s]-2*n[a]+n[2*a-s])/(o*o),o/=2,h++;for(u=f.length,l=1;1!=u;){for(d=0;d<u-1;d++)p[d]=(t.pow(4,l)*f[d+1]-f[d])/(t.pow(4,l)-1);u=p.length,f=p,p=[],l++}return f},simpson:function(e,t,n,r){for(var o,i=(n-t)/r,s=e(t),a=[],l=t,u=0,d=1;l<=n;l+=i,u++)a[u]=l;for(o=a.length;d<o-1;d++)s+=(d%2!==0?4:2)*e(a[d]);return i/3*(s+e(n))},hermite:function(e,t,n,r){for(var o,i=e.length,s=0,a=0,l=[],u=[],d=[],c=[];a<i;a++){for(l[a]=1,o=0;o<i;o++)a!=o&&(l[a]*=(r-e[o])/(e[a]-e[o]));for(u[a]=0,o=0;o<i;o++)a!=o&&(u[a]+=1/(e[a]-e[o]));d[a]=(1-2*(r-e[a])*u[a])*(l[a]*l[a]),c[a]=(r-e[a])*(l[a]*l[a]),s+=d[a]*t[a]+c[a]*n[a]}return s},lagrange:function(e,t,n){for(var r,o,i=0,s=0,a=e.length;s<a;s++){for(o=t[s],r=0;r<a;r++)s!=r&&(o*=(n-e[r])/(e[s]-e[r]));i+=o}return i},cubic_spline:function(t,n,r){for(var o,i=t.length,s=0,a=[],l=[],u=[],d=[],c=[],h=[],f=[];s<i-1;s++)c[s]=t[s+1]-t[s];u[0]=0;for(var s=1;s<i-1;s++)u[s]=3/c[s]*(n[s+1]-n[s])-3/c[s-1]*(n[s]-n[s-1]);for(var s=1;s<i-1;s++)a[s]=[],l[s]=[],a[s][s-1]=c[s-1],a[s][s]=2*(c[s-1]+c[s]),a[s][s+1]=c[s],l[s][0]=u[s];for(d=e.multiply(e.inv(a),l),o=0;o<i-1;o++)h[o]=(n[o+1]-n[o])/c[o]-c[o]*(d[o+1][0]+2*d[o][0])/3,f[o]=(d[o+1][0]-d[o][0])/(3*c[o]);for(o=0;o<i&&!(t[o]>r);o++);return o-=1,n[o]+(r-t[o])*h[o]+e.sq(r-t[o])*d[o]+(r-t[o])*e.sq(r-t[o])*f[o]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(t){for(var n,r,o=t.length,i=t[0].length,s=0,a=[],l=[],u=[],d=[],c=[],h=[],f=[],p=[],m=[],g=[],s=0;s<o;s++)a[s]=e.sum(t[s])/i;for(var s=0;s<i;s++)for(f[s]=[],n=0;n<o;n++)f[s][n]=t[n][s]-a[n];f=e.transpose(f);for(var s=0;s<o;s++)for(p[s]=[],n=0;n<o;n++)p[s][n]=e.dot([f[s]],[f[n]])/(i-1);u=e.jacobi(p),m=u[0],l=u[1],g=e.transpose(m);for(var s=0;s<l.length;s++)for(n=s;n<l.length;n++)l[s]<l[n]&&(r=l[s],l[s]=l[n],l[n]=r,d=g[s],g[s]=g[n],g[n]=d);h=e.transpose(f);for(var s=0;s<o;s++)for(c[s]=[],n=0;n<h.length;n++)c[s][n]=e.dot([g[s]],[h[n]]);return[t,l,g,c]}}),function(t){for(var n=0;n<t.length;n++)(function(t){e.fn[t]=function(n,r){var o=this;return r?(setTimeout(function(){r.call(o,e.fn[t].call(o,n))},15),this):"number"==typeof e[t](this,n)?e[t](this,n):e(e[t](this,n))}})(t[n])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(this.jStat,Math),function(e,t){function n(e,n,r,o){if(e>1||r>1||e<=0||r<=0)throw new Error("Proportions should be greater than 0 and less than 1");var i=(e*n+r*o)/(n+o),s=t.sqrt(i*(1-i)*(1/n+1/o));return(e-r)/s}var r=[].slice,o=e.utils.isNumber,i=e.utils.isArray;e.extend({zscore:function(){var t=r.call(arguments);return o(t[1])?(t[0]-t[1])/t[2]:(t[0]-e.mean(t[1]))/e.stdev(t[1],t[2])},ztest:function(){var n,o=r.call(arguments);return i(o[1])?(n=e.zscore(o[0],o[1],o[3]),1===o[2]?e.normal.cdf(-t.abs(n),0,1):2*e.normal.cdf(-t.abs(n),0,1)):o.length>2?(n=e.zscore(o[0],o[1],o[2]),1===o[3]?e.normal.cdf(-t.abs(n),0,1):2*e.normal.cdf(-t.abs(n),0,1)):(n=o[0],1===o[1]?e.normal.cdf(-t.abs(n),0,1):2*e.normal.cdf(-t.abs(n),0,1))}}),e.extend(e.fn,{zscore:function(e,t){return(e-this.mean())/this.stdev(t)},ztest:function(n,r,o){var i=t.abs(this.zscore(n,o));return 1===r?e.normal.cdf(-i,0,1):2*e.normal.cdf(-i,0,1)}}),e.extend({tscore:function(){var n=r.call(arguments);return 4===n.length?(n[0]-n[1])/(n[2]/t.sqrt(n[3])):(n[0]-e.mean(n[1]))/(e.stdev(n[1],!0)/t.sqrt(n[1].length))},ttest:function(){var n,i=r.call(arguments);return 5===i.length?(n=t.abs(e.tscore(i[0],i[1],i[2],i[3])),1===i[4]?e.studentt.cdf(-n,i[3]-1):2*e.studentt.cdf(-n,i[3]-1)):o(i[1])?(n=t.abs(i[0]),1==i[2]?e.studentt.cdf(-n,i[1]-1):2*e.studentt.cdf(-n,i[1]-1)):(n=t.abs(e.tscore(i[0],i[1])),1==i[2]?e.studentt.cdf(-n,i[1].length-1):2*e.studentt.cdf(-n,i[1].length-1))}}),e.extend(e.fn,{tscore:function(e){return(e-this.mean())/(this.stdev(!0)/t.sqrt(this.cols()))},ttest:function(n,r){return 1===r?1-e.studentt.cdf(t.abs(this.tscore(n)),this.cols()-1):2*e.studentt.cdf(-t.abs(this.tscore(n)),this.cols()-1)}}),e.extend({anovafscore:function(){var n,o,i,s,a,l,u,d,c=r.call(arguments);if(1===c.length){a=new Array(c[0].length);for(var u=0;u<c[0].length;u++)a[u]=c[0][u];c=a}if(2===c.length)return e.variance(c[0])/e.variance(c[1]);o=new Array;for(var u=0;u<c.length;u++)o=o.concat(c[u]);i=e.mean(o),n=0;for(var u=0;u<c.length;u++)n+=c[u].length*t.pow(e.mean(c[u])-i,2);n/=c.length-1,l=0;for(var u=0;u<c.length;u++)for(s=e.mean(c[u]),d=0;d<c[u].length;d++)l+=t.pow(c[u][d]-s,2);return l/=o.length-c.length,n/l},anovaftest:function(){var t,n,i,s,a=r.call(arguments);if(o(a[0]))return 1-e.centralF.cdf(a[0],a[1],a[2]);anovafscore=e.anovafscore(a),t=a.length-1,i=0;for(var s=0;s<a.length;s++)i+=a[s].length;return n=i-t-1,1-e.centralF.cdf(anovafscore,t,n)},ftest:function(t,n,r){return 1-e.centralF.cdf(t,n,r)}}),e.extend(e.fn,{anovafscore:function(){return e.anovafscore(this.toArray())},anovaftes:function(){for(var t,n=0,t=0;t<this.length;t++)n+=this[t].length;return e.ftest(this.anovafscore(),this.length-1,n-this.length)}}),e.extend({normalci:function(){var n,o=r.call(arguments),i=new Array(2);return n=4===o.length?t.abs(e.normal.inv(o[1]/2,0,1)*o[2]/t.sqrt(o[3])):t.abs(e.normal.inv(o[1]/2,0,1)*e.stdev(o[2])/t.sqrt(o[2].length)),i[0]=o[0]-n,i[1]=o[0]+n,i},tci:function(){var n,o=r.call(arguments),i=new Array(2);return n=4===o.length?t.abs(e.studentt.inv(o[1]/2,o[3]-1)*o[2]/t.sqrt(o[3])):t.abs(e.studentt.inv(o[1]/2,o[2].length-1)*e.stdev(o[2],!0)/t.sqrt(o[2].length)),i[0]=o[0]-n,i[1]=o[0]+n,i},significant:function(e,t){return e<t}}),e.extend(e.fn,{normalci:function(t,n){return e.normalci(t,n,this.toArray())},tci:function(t,n){return e.tci(t,n,this.toArray())}}),e.extend(e.fn,{oneSidedDifferenceOfProportions:function(t,r,o,i){var s=n(t,r,o,i);return e.ztest(s,1)},twoSidedDifferenceOfProportions:function(t,r,o,i){var s=n(t,r,o,i);return e.ztest(s,2)}})}(this.jStat,Math),this.jStat.models=function(){function e(e,n){return t(e,n)}function e(e){var n=e[0].length,r=jStat.arange(n).map(function(r){var o=jStat.arange(n).filter(function(e){return e!==r});return t(jStat.col(e,r).map(function(e){return e[0]}),jStat.col(e,o))});return r}function t(e,t){var n=e.length,r=t[0].length-1,o=n-r-1,i=jStat.lstsq(t,e),s=jStat.multiply(t,i.map(function(e){return[e]})).map(function(e){return e[0]}),a=jStat.subtract(e,s),l=jStat.mean(e),u=jStat.sum(s.map(function(e){return Math.pow(e-l,2)})),d=jStat.sum(e.map(function(e,t){return Math.pow(e-s[t],2)})),c=u+d,h=u/c;return{exog:t,endog:e,nobs:n,df_model:r,df_resid:o,coef:i,predict:s,resid:a,ybar:l,SST:c,SSE:u,SSR:d,R2:h}}function n(t){var n=e(t.exog),r=Math.sqrt(t.SSR/t.df_resid),o=n.map(function(e){var t=e.SST,n=e.R2;return r/Math.sqrt(t*(1-n))}),i=t.coef.map(function(e,t){return(e-0)/o[t]}),s=i.map(function(e){var n=jStat.studentt.cdf(e,t.df_resid);return 2*(n>.5?1-n:n)}),a=jStat.studentt.inv(.975,t.df_resid),l=t.coef.map(function(e,t){var n=a*o[t];return[e-n,e+n]});return{se:o,t:i,p:s,sigmaHat:r,interval95:l}}function r(e){var t=e.R2/e.df_model/((1-e.R2)/e.df_resid),n=function(e,t,n){return jStat.beta.cdf(e/(n/t+e),t/2,n/2)},r=1-n(t,e.df_model,e.df_resid);return{F_statistic:t,pvalue:r}}function o(e,o){var i=t(e,o),s=n(i),a=r(i),l=1-(1-i.rsquared)*((i.nobs-1)/i.df_resid);return i.t=s,i.f=a,i.adjust_R2=l,i}return{ols:o}}()},function(e,t,n){var r=n(15),o=n(19),i=n(16);t.UNIQUE=function(){for(var e=[],t=0;t<arguments.length;++t){for(var n=!1,r=arguments[t],o=0;o<e.length&&!(n=e[o]===r);++o);n||e.push(r)}return e},t.FLATTEN=r.flatten,t.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)},t.REFERENCE=function(e,t){if(!arguments.length)return i.error;try{for(var n=t.split("."),r=e,o=0;o<n.length;++o){var s=n[o];if("]"===s[s.length-1]){var a=s.indexOf("["),l=s.substring(a+1,s.length-1);r=r[s.substring(0,a)][l]}else r=r[s]}return r}catch(e){}},t.JOIN=function(e,t){return e.join(t)},t.NUMBERS=function(){var e=r.flatten(arguments);return e.filter(function(e){return"number"==typeof e})},t.NUMERAL=function(e,t){return o(e).format(t)}},function(e,t,n){var r=n(16);t.CELL=function(){throw new Error("CELL is not implemented")},t.ERROR={},t.ERROR.TYPE=function(e){switch(e){case r.nil:return 1;case r.div0:return 2;case r.value:return 3;case r.ref:return 4;case r.name:return 5;case r.num:return 6;case r.na:return 7;case r.data:return 8}return r.na},t.INFO=function(){throw new Error("INFO is not implemented")},t.ISBLANK=function(e){return null===e},t.ISBINARY=function(e){return/^[01]{1,10}$/.test(e)},t.ISERR=function(e){return[r.value,r.ref,r.div0,r.num,r.name,r.nil].indexOf(e)>=0||"number"==typeof e&&(isNaN(e)||!isFinite(e))},t.ISERROR=function(e){return t.ISERR(e)||e===r.na},t.ISEVEN=function(e){return!(1&Math.floor(Math.abs(e)))},t.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},t.ISLOGICAL=function(e){return e===!0||e===!1},t.ISNA=function(e){return e===r.na},t.ISNONTEXT=function(e){return"string"!=typeof e},t.ISNUMBER=function(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)},t.ISODD=function(e){return!!(1&Math.floor(Math.abs(e)))},t.ISREF=function(){throw new Error("ISREF is not implemented")},t.ISTEXT=function(e){return"string"==typeof e},t.N=function(e){return this.ISNUMBER(e)?e:e instanceof Date?e.getTime():e===!0?1:e===!1?0:this.ISERROR(e)?e:0},t.NA=function(){return r.na},t.SHEET=function(){throw new Error("SHEET is not implemented")},t.SHEETS=function(){throw new Error("SHEETS is not implemented")},t.TYPE=function(e){return this.ISNUMBER(e)?1:this.ISTEXT(e)?2:this.ISLOGICAL(e)?4:this.ISERROR(e)?16:Array.isArray(e)?64:void 0}},function(e,t,n){function r(e){return/^[01]{1,10}$/.test(e)}var o=n(16),i=n(22).jStat,s=n(18),a=n(15),l=n(26);t.BESSELI=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?o.value:l.besseli(e,t)},t.BESSELJ=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?o.value:l.besselj(e,t)},t.BESSELK=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?o.value:l.besselk(e,t)},t.BESSELY=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?o.value:l.bessely(e,t)},t.BIN2DEC=function(e){if(!r(e))return o.num;var t=parseInt(e,2),n=e.toString();return 10===n.length&&"1"===n.substring(0,1)?parseInt(n.substring(1),2)-512:t},t.BIN2HEX=function(e,t){if(!r(e))return o.num;var n=e.toString();if(10===n.length&&"1"===n.substring(0,1))return(0xfffffffe00+parseInt(n.substring(1),2)).toString(16);var i=parseInt(e,2).toString(16);return void 0===t?i:isNaN(t)?o.value:t<0?o.num:(t=Math.floor(t),t>=i.length?s.REPT("0",t-i.length)+i:o.num)},t.BIN2OCT=function(e,t){if(!r(e))return o.num;var n=e.toString();if(10===n.length&&"1"===n.substring(0,1))return(1073741312+parseInt(n.substring(1),2)).toString(8);var i=parseInt(e,2).toString(8);return void 0===t?i:isNaN(t)?o.value:t<0?o.num:(t=Math.floor(t),t>=i.length?s.REPT("0",t-i.length)+i:o.num)},t.BITAND=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?o.value:e<0||t<0?o.num:Math.floor(e)!==e||Math.floor(t)!==t?o.num:e>0xffffffffffff||t>0xffffffffffff?o.num:e&t},t.BITLSHIFT=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?o.value:e<0?o.num:Math.floor(e)!==e?o.num:e>0xffffffffffff?o.num:Math.abs(t)>53?o.num:t>=0?e<<t:e>>-t},t.BITOR=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?o.value:e<0||t<0?o.num:Math.floor(e)!==e||Math.floor(t)!==t?o.num:e>0xffffffffffff||t>0xffffffffffff?o.num:e|t},t.BITRSHIFT=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?o.value:e<0?o.num:Math.floor(e)!==e?o.num:e>0xffffffffffff?o.num:Math.abs(t)>53?o.num:t>=0?e>>t:e<<-t},t.BITXOR=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?o.value:e<0||t<0?o.num:Math.floor(e)!==e||Math.floor(t)!==t?o.num:e>0xffffffffffff||t>0xffffffffffff?o.num:e^t},t.COMPLEX=function(e,t,n){if(e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t))return e;if(n=void 0===n?"i":n,"i"!==n&&"j"!==n)return o.value;if(0===e&&0===t)return 0;if(0===e)return 1===t?n:t.toString()+n;if(0===t)return e.toString();var r=t>0?"+":"";return e.toString()+r+(1===t?n:t.toString()+n)},t.CONVERT=function(e,t,n){if(e=a.parseNumber(e),e instanceof Error)return e;for(var r,i=[["a.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["a.u. of charge","e",null,"electric_charge",!1,!1,1.60217653141414e-19],["a.u. of energy","Eh",null,"energy",!1,!1,4.35974417757576e-18],["a.u. of length","a?",null,"length",!1,!1,5.29177210818182e-11],["a.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["a.u. of time","?/Eh",null,"time",!1,!1,2.41888432650516e-17],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,1.49597870691667e-11],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,8.46786664623715e-47],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,1.66053886282828e-27],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,1.05457168181818e-34],["n.u. of mass","m?",null,"mass",!1,!1,9.10938261616162e-31],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,1.28808866778687e-21],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,8.95054210748189e31],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],s={
Yi:["yobi",80,1.2089258196146292e24,"Yi","yotta"],Zi:["zebi",70,0x400000000000000000,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},l={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},u=null,d=null,c=t,h=n,f=1,p=1,m=0;m<i.length;m++)r=null===i[m][2]?[]:i[m][2],(i[m][1]===c||r.indexOf(c)>=0)&&(u=i[m]),(i[m][1]===h||r.indexOf(h)>=0)&&(d=i[m]);if(null===u){var g=s[t.substring(0,2)],v=l[t.substring(0,1)];"da"===t.substring(0,2)&&(v=["dekao",10,"da"]),g?(f=g[2],c=t.substring(2)):v&&(f=v[1],c=t.substring(v[2].length));for(var w=0;w<i.length;w++)r=null===i[w][2]?[]:i[w][2],(i[w][1]===c||r.indexOf(c)>=0)&&(u=i[w])}if(null===d){var b=s[n.substring(0,2)],y=l[n.substring(0,1)];"da"===n.substring(0,2)&&(y=["dekao",10,"da"]),b?(p=b[2],h=n.substring(2)):y&&(p=y[1],h=n.substring(y[2].length));for(var _=0;_<i.length;_++)r=null===i[_][2]?[]:i[_][2],(i[_][1]===h||r.indexOf(h)>=0)&&(d=i[_])}return null===u||null===d?o.na:u[3]!==d[3]?o.na:e*u[6]*f/(d[6]*p)},t.DEC2BIN=function(e,t){if(e=a.parseNumber(e),e instanceof Error)return e;if(!/^-?[0-9]{1,3}$/.test(e)||e<-512||e>511)return o.num;if(e<0)return"1"+s.REPT("0",9-(512+e).toString(2).length)+(512+e).toString(2);var n=parseInt(e,10).toString(2);return"undefined"==typeof t?n:isNaN(t)?o.value:t<0?o.num:(t=Math.floor(t),t>=n.length?s.REPT("0",t-n.length)+n:o.num)},t.DEC2HEX=function(e,t){if(e=a.parseNumber(e),e instanceof Error)return e;if(!/^-?[0-9]{1,12}$/.test(e)||e<-549755813888||e>549755813887)return o.num;if(e<0)return(1099511627776+e).toString(16);var n=parseInt(e,10).toString(16);return"undefined"==typeof t?n:isNaN(t)?o.value:t<0?o.num:(t=Math.floor(t),t>=n.length?s.REPT("0",t-n.length)+n:o.num)},t.DEC2OCT=function(e,t){if(e=a.parseNumber(e),e instanceof Error)return e;if(!/^-?[0-9]{1,9}$/.test(e)||e<-536870912||e>536870911)return o.num;if(e<0)return(1073741824+e).toString(8);var n=parseInt(e,10).toString(8);return"undefined"==typeof t?n:isNaN(t)?o.value:t<0?o.num:(t=Math.floor(t),t>=n.length?s.REPT("0",t-n.length)+n:o.num)},t.DELTA=function(e,t){return t=void 0===t?0:t,e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?o.value:e===t?1:0},t.ERF=function(e,t){return t=void 0===t?0:t,e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?o.value:i.erf(e)},t.ERF.PRECISE=function(){throw new Error("ERF.PRECISE is not implemented")},t.ERFC=function(e){return isNaN(e)?o.value:i.erfc(e)},t.ERFC.PRECISE=function(){throw new Error("ERFC.PRECISE is not implemented")},t.GESTEP=function(e,t){return t=t||0,e=a.parseNumber(e),a.anyIsError(t,e)?e:e>=t?1:0},t.HEX2BIN=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return o.num;var n=10===e.length&&"f"===e.substring(0,1).toLowerCase(),r=n?parseInt(e,16)-1099511627776:parseInt(e,16);if(r<-512||r>511)return o.num;if(n)return"1"+s.REPT("0",9-(512+r).toString(2).length)+(512+r).toString(2);var i=r.toString(2);return void 0===t?i:isNaN(t)?o.value:t<0?o.num:(t=Math.floor(t),t>=i.length?s.REPT("0",t-i.length)+i:o.num)},t.HEX2DEC=function(e){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return o.num;var t=parseInt(e,16);return t>=549755813888?t-1099511627776:t},t.HEX2OCT=function(e,t){if(!/^[0-9A-Fa-f]{1,10}$/.test(e))return o.num;var n=parseInt(e,16);if(n>536870911&&n<0xffe0000000)return o.num;if(n>=0xffe0000000)return(n-0xffc0000000).toString(8);var r=n.toString(8);return void 0===t?r:isNaN(t)?o.value:t<0?o.num:(t=Math.floor(t),t>=r.length?s.REPT("0",t-r.length)+r:o.num)},t.IMABS=function(e){var n=t.IMREAL(e),r=t.IMAGINARY(e);return a.anyIsError(n,r)?o.value:Math.sqrt(Math.pow(n,2)+Math.pow(r,2))},t.IMAGINARY=function(e){if(void 0===e||e===!0||e===!1)return o.value;if(0===e||"0"===e)return 0;if(["i","j"].indexOf(e)>=0)return 1;e=e.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var t=e.indexOf("+"),n=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===n&&(n=e.indexOf("-",1));var r=e.substring(e.length-1,e.length),i="i"===r||"j"===r;return t>=0||n>=0?i?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?o.num:Number(e.substring(t+1,e.length-1)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?o.num:-Number(e.substring(n+1,e.length-1)):o.num:i?isNaN(e.substring(0,e.length-1))?o.num:e.substring(0,e.length-1):isNaN(e)?o.num:0},t.IMARGUMENT=function(e){var n=t.IMREAL(e),r=t.IMAGINARY(e);return a.anyIsError(n,r)?o.value:0===n&&0===r?o.div0:0===n&&r>0?Math.PI/2:0===n&&r<0?-Math.PI/2:0===r&&n>0?0:0===r&&n<0?-Math.PI:n>0?Math.atan(r/n):n<0&&r>=0?Math.atan(r/n)+Math.PI:Math.atan(r/n)-Math.PI},t.IMCONJUGATE=function(e){var n=t.IMREAL(e),r=t.IMAGINARY(e);if(a.anyIsError(n,r))return o.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",0!==r?t.COMPLEX(n,-r,i):e},t.IMCOS=function(e){var n=t.IMREAL(e),r=t.IMAGINARY(e);if(a.anyIsError(n,r))return o.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",t.COMPLEX(Math.cos(n)*(Math.exp(r)+Math.exp(-r))/2,-Math.sin(n)*(Math.exp(r)-Math.exp(-r))/2,i)},t.IMCOSH=function(e){var n=t.IMREAL(e),r=t.IMAGINARY(e);if(a.anyIsError(n,r))return o.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",t.COMPLEX(Math.cos(r)*(Math.exp(n)+Math.exp(-n))/2,Math.sin(r)*(Math.exp(n)-Math.exp(-n))/2,i)},t.IMCOT=function(e){var n=t.IMREAL(e),r=t.IMAGINARY(e);return a.anyIsError(n,r)?o.value:t.IMDIV(t.IMCOS(e),t.IMSIN(e))},t.IMDIV=function(e,n){var r=t.IMREAL(e),i=t.IMAGINARY(e),s=t.IMREAL(n),l=t.IMAGINARY(n);if(a.anyIsError(r,i,s,l))return o.value;var u=e.substring(e.length-1),d=n.substring(n.length-1),c="i";if("j"===u?c="j":"j"===d&&(c="j"),0===s&&0===l)return o.num;var h=s*s+l*l;return t.COMPLEX((r*s+i*l)/h,(i*s-r*l)/h,c)},t.IMEXP=function(e){var n=t.IMREAL(e),r=t.IMAGINARY(e);if(a.anyIsError(n,r))return o.value;var i=e.substring(e.length-1);i="i"===i||"j"===i?i:"i";var s=Math.exp(n);return t.COMPLEX(s*Math.cos(r),s*Math.sin(r),i)},t.IMLN=function(e){var n=t.IMREAL(e),r=t.IMAGINARY(e);if(a.anyIsError(n,r))return o.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",t.COMPLEX(Math.log(Math.sqrt(n*n+r*r)),Math.atan(r/n),i)},t.IMLOG10=function(e){var n=t.IMREAL(e),r=t.IMAGINARY(e);if(a.anyIsError(n,r))return o.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",t.COMPLEX(Math.log(Math.sqrt(n*n+r*r))/Math.log(10),Math.atan(r/n)/Math.log(10),i)},t.IMLOG2=function(e){var n=t.IMREAL(e),r=t.IMAGINARY(e);if(a.anyIsError(n,r))return o.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",t.COMPLEX(Math.log(Math.sqrt(n*n+r*r))/Math.log(2),Math.atan(r/n)/Math.log(2),i)},t.IMPOWER=function(e,n){n=a.parseNumber(n);var r=t.IMREAL(e),i=t.IMAGINARY(e);if(a.anyIsError(n,r,i))return o.value;var s=e.substring(e.length-1);s="i"===s||"j"===s?s:"i";var l=Math.pow(t.IMABS(e),n),u=t.IMARGUMENT(e);return t.COMPLEX(l*Math.cos(n*u),l*Math.sin(n*u),s)},t.IMPRODUCT=function(){var e=arguments[0];if(!arguments.length)return o.value;for(var n=1;n<arguments.length;n++){var r=t.IMREAL(e),i=t.IMAGINARY(e),s=t.IMREAL(arguments[n]),l=t.IMAGINARY(arguments[n]);if(a.anyIsError(r,i,s,l))return o.value;e=t.COMPLEX(r*s-i*l,r*l+i*s)}return e},t.IMREAL=function(e){if(void 0===e||e===!0||e===!1)return o.value;if(0===e||"0"===e)return 0;if(["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(e)>=0)return 0;var t=e.indexOf("+"),n=e.indexOf("-");0===t&&(t=e.indexOf("+",1)),0===n&&(n=e.indexOf("-",1));var r=e.substring(e.length-1,e.length),i="i"===r||"j"===r;return t>=0||n>=0?i?t>=0?isNaN(e.substring(0,t))||isNaN(e.substring(t+1,e.length-1))?o.num:Number(e.substring(0,t)):isNaN(e.substring(0,n))||isNaN(e.substring(n+1,e.length-1))?o.num:Number(e.substring(0,n)):o.num:i?isNaN(e.substring(0,e.length-1))?o.num:0:isNaN(e)?o.num:e},t.IMSEC=function(e){if(e===!0||e===!1)return o.value;var n=t.IMREAL(e),r=t.IMAGINARY(e);return a.anyIsError(n,r)?o.value:t.IMDIV("1",t.IMCOS(e))},t.IMSECH=function(e){var n=t.IMREAL(e),r=t.IMAGINARY(e);return a.anyIsError(n,r)?o.value:t.IMDIV("1",t.IMCOSH(e))},t.IMSIN=function(e){var n=t.IMREAL(e),r=t.IMAGINARY(e);if(a.anyIsError(n,r))return o.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",t.COMPLEX(Math.sin(n)*(Math.exp(r)+Math.exp(-r))/2,Math.cos(n)*(Math.exp(r)-Math.exp(-r))/2,i)},t.IMSINH=function(e){var n=t.IMREAL(e),r=t.IMAGINARY(e);if(a.anyIsError(n,r))return o.value;var i=e.substring(e.length-1);return i="i"===i||"j"===i?i:"i",t.COMPLEX(Math.cos(r)*(Math.exp(n)-Math.exp(-n))/2,Math.sin(r)*(Math.exp(n)+Math.exp(-n))/2,i)},t.IMSQRT=function(e){var n=t.IMREAL(e),r=t.IMAGINARY(e);if(a.anyIsError(n,r))return o.value;var i=e.substring(e.length-1);i="i"===i||"j"===i?i:"i";var s=Math.sqrt(t.IMABS(e)),l=t.IMARGUMENT(e);return t.COMPLEX(s*Math.cos(l/2),s*Math.sin(l/2),i)},t.IMCSC=function(e){if(e===!0||e===!1)return o.value;var n=t.IMREAL(e),r=t.IMAGINARY(e);return a.anyIsError(n,r)?o.num:t.IMDIV("1",t.IMSIN(e))},t.IMCSCH=function(e){if(e===!0||e===!1)return o.value;var n=t.IMREAL(e),r=t.IMAGINARY(e);return a.anyIsError(n,r)?o.num:t.IMDIV("1",t.IMSINH(e))},t.IMSUB=function(e,t){var n=this.IMREAL(e),r=this.IMAGINARY(e),i=this.IMREAL(t),s=this.IMAGINARY(t);if(a.anyIsError(n,r,i,s))return o.value;var l=e.substring(e.length-1),u=t.substring(t.length-1),d="i";return"j"===l?d="j":"j"===u&&(d="j"),this.COMPLEX(n-i,r-s,d)},t.IMSUM=function(){if(!arguments.length)return o.value;for(var e=a.flatten(arguments),t=e[0],n=1;n<e.length;n++){var r=this.IMREAL(t),i=this.IMAGINARY(t),s=this.IMREAL(e[n]),l=this.IMAGINARY(e[n]);if(a.anyIsError(r,i,s,l))return o.value;t=this.COMPLEX(r+s,i+l)}return t},t.IMTAN=function(e){if(e===!0||e===!1)return o.value;var n=t.IMREAL(e),r=t.IMAGINARY(e);return a.anyIsError(n,r)?o.value:this.IMDIV(this.IMSIN(e),this.IMCOS(e))},t.OCT2BIN=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return o.num;var n=10===e.length&&"7"===e.substring(0,1),r=n?parseInt(e,8)-1073741824:parseInt(e,8);if(r<-512||r>511)return o.num;if(n)return"1"+s.REPT("0",9-(512+r).toString(2).length)+(512+r).toString(2);var i=r.toString(2);return"undefined"==typeof t?i:isNaN(t)?o.value:t<0?o.num:(t=Math.floor(t),t>=i.length?s.REPT("0",t-i.length)+i:o.num)},t.OCT2DEC=function(e){if(!/^[0-7]{1,10}$/.test(e))return o.num;var t=parseInt(e,8);return t>=536870912?t-1073741824:t},t.OCT2HEX=function(e,t){if(!/^[0-7]{1,10}$/.test(e))return o.num;var n=parseInt(e,8);if(n>=536870912)return"ff"+(n+3221225472).toString(16);var r=n.toString(16);return void 0===t?r:isNaN(t)?o.value:t<0?o.num:(t=Math.floor(t),t>=r.length?s.REPT("0",t-r.length)+r:o.num)}},function(e,t,n){function r(e,t){return e.reduce(function(e,n){return t*e+n},0)}function o(e,t,n,r,o){o||(o=-1);var i,s=2/e;if(0===t)return n;if(1===t)return r;for(var a=1;a!=t;++a)i=r*a*s+o*n,n=r,r=i;return r}function i(e,t,n,r,i){return function(s,a){if(0===a)return e(s);if(1===a)return t(s);if(a<0)throw n+": Order ("+a+") must be nonnegative";if(1==r&&0===s)throw n+": Undefined when x == 0";if(2==r&&s<=0)throw n+": Undefined when x <= 0";var l=e(s),u=t(s);return o(s,a,l,u,i)}}var s=Math,a=function(){function e(e){var t,o,d,c=e*e,h=s.abs(e)-.785398164;return s.abs(e)<8?(o=r(n,c),d=r(i,c),t=o/d):(c=64/c,o=r(a,c),d=r(l,c),t=s.sqrt(u/s.abs(e))*(s.cos(h)*o-s.sin(h)*d*8/s.abs(e))),t}function t(e){var t,n,o,i=e*e,a=s.abs(e)-2.356194491;return Math.abs(e)<8?(n=e*r(d,i),o=r(c,i),t=n/o):(i=64/i,n=r(h,i),o=r(f,i),t=s.sqrt(u/s.abs(e))*(s.cos(a)*n-s.sin(a)*o*8/s.abs(e)),e<0&&(t=-t)),t}var n=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),i=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),a=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),l=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse(),u=.636619772,d=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),c=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),h=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),f=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();return function(n,r){if(r=Math.round(r),0===r)return e(s.abs(n));if(1===r)return t(s.abs(n));if(r<0)throw"BESSELJ: Order ("+r+") must be nonnegative";if(0===s.abs(n))return 0;var i,a,l,u,d,c,h,f,p=2/s.abs(n);if(s.abs(n)>r)i=o(n,r,e(s.abs(n)),t(s.abs(n)),-1);else{for(l=2*s.floor((r+s.floor(s.sqrt(40*r)))/2),u=0,c=i=d=0,h=1,a=l;a>0;a--)f=a*p*h-c,c=h,h=f,s.abs(h)>1e10&&(h*=1e-10,c*=1e-10,i*=1e-10,d*=1e-10),u&&(d+=h),u=!u,a==r&&(i=c);d=2*d-h,i/=d}return n<0&&r%2?-i:i}}(),l=function(){function e(e){var t,i,c,h=e*e,f=e-.785398164;return e<8?(i=r(n,h),c=r(o,h),t=i/c+d*a(e,0)*s.log(e)):(h=64/h,i=r(l,h),c=r(u,h),t=s.sqrt(d/e)*(s.sin(f)*i+s.cos(f)*c*8/e)),t}function t(e){var t,n,o,i=e*e,l=e-2.356194491;return e<8?(n=e*r(c,i),o=r(h,i),t=n/o+d*(a(e,1)*s.log(e)-1/e)):(i=64/i,n=r(f,i),o=r(p,i),t=s.sqrt(d/e)*(s.sin(l)*n+s.cos(l)*o*8/e)),t}var n=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),o=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),l=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),u=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),d=.636619772,c=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),h=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),f=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),p=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();return i(e,t,"BESSELY",1,-1)}(),u=function(){function e(e){return e<=3.75?r(n,e*e/14.0625):s.exp(s.abs(e))/s.sqrt(s.abs(e))*r(o,3.75/s.abs(e))}function t(e){return e<3.75?e*r(i,e*e/14.0625):(e<0?-1:1)*s.exp(s.abs(e))/s.sqrt(s.abs(e))*r(a,3.75/s.abs(e))}var n=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),o=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),i=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),a=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse();return function n(r,o){if(o=Math.round(o),0===o)return e(r);if(1==o)return t(r);if(o<0)throw"BESSELI Order ("+o+") must be nonnegative";if(0===s.abs(r))return 0;var i,a,l,u,d,c,h=2/s.abs(r);for(l=2*s.round((o+s.round(s.sqrt(40*o)))/2),u=i=0,d=1,a=l;a>0;a--)c=a*h*d+u,u=d,d=c,s.abs(d)>1e10&&(d*=1e-10,u*=1e-10,i*=1e-10),a==o&&(i=u);return i*=n(r,0)/d,r<0&&o%2?-i:i}}(),d=function(){function e(e){return e<=2?-s.log(e/2)*u(e,0)+r(n,e*e/4):s.exp(-e)/s.sqrt(e)*r(o,2/e)}function t(e){return e<=2?s.log(e/2)*u(e,1)+1/e*r(a,e*e/4):s.exp(-e)/s.sqrt(e)*r(l,2/e)}var n=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),o=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),a=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),l=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return i(e,t,"BESSELK",2,1)}();t.besselj=a,t.bessely=l,t.besseli=u,t.besselk=d},function(e,t,n){function r(e){return 1===new Date(e,1,29).getMonth()}function o(e,t){return Math.ceil((t-e)/1e3/60/60/24)}function i(e){var t=e>-22038912e5?2:1;return(e-l)/864e5+t}var s=n(16),a=n(15),l=new Date(1900,0,1),u=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],d=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],c=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];t.DATE=function(e,t,n){var r;return e=a.parseNumber(e),t=a.parseNumber(t),n=a.parseNumber(n),r=a.anyIsError(e,t,n)?s.value:e<0||t<0||n<0?s.num:new Date(e,t-1,n)},t.DATEVALUE=function(e){if("string"!=typeof e)return s.value;var t=Date.parse(e);return isNaN(t)?s.value:t<=-22038912e5?(t-l)/864e5+1:(t-l)/864e5+2},t.DAY=function(e){var t=a.parseDate(e);return t instanceof Error?t:t.getDate()},t.DAYS=function(e,t){return e=a.parseDate(e),t=a.parseDate(t),e instanceof Error?e:t instanceof Error?t:i(e)-i(t)},t.DAYS360=function(e,t,n){if(n=a.parseBool(n),e=a.parseDate(e),t=a.parseDate(t),e instanceof Error)return e;if(t instanceof Error)return t;if(n instanceof Error)return n;var r,o,i=e.getMonth(),s=t.getMonth();if(n)r=31===e.getDate()?30:e.getDate(),o=31===t.getDate()?30:t.getDate();else{var l=new Date(e.getFullYear(),i+1,0).getDate(),u=new Date(t.getFullYear(),s+1,0).getDate();r=e.getDate()===l?30:e.getDate(),t.getDate()===u?r<30?(s++,o=1):o=30:o=t.getDate()}return 360*(t.getFullYear()-e.getFullYear())+30*(s-i)+(o-r)},t.EDATE=function(e,t){return e=a.parseDate(e),e instanceof Error?e:isNaN(t)?s.value:(t=parseInt(t,10),e.setMonth(e.getMonth()+t),i(e))},t.EOMONTH=function(e,t){return e=a.parseDate(e),e instanceof Error?e:isNaN(t)?s.value:(t=parseInt(t,10),i(new Date(e.getFullYear(),e.getMonth()+t+1,0)))},t.HOUR=function(e){return e=a.parseDate(e),e instanceof Error?e:e.getHours()},t.INTERVAL=function(e){if("number"!=typeof e&&"string"!=typeof e)return s.value;e=parseInt(e,10);var t=Math.floor(e/94608e4);e%=94608e4;var n=Math.floor(e/2592e3);e%=2592e3;var r=Math.floor(e/86400);e%=86400;var o=Math.floor(e/3600);e%=3600;var i=Math.floor(e/60);e%=60;var a=e;return t=t>0?t+"Y":"",n=n>0?n+"M":"",r=r>0?r+"D":"",o=o>0?o+"H":"",i=i>0?i+"M":"",a=a>0?a+"S":"","P"+t+n+r+"T"+o+i+a},t.ISOWEEKNUM=function(e){if(e=a.parseDate(e),e instanceof Error)return e;e.setHours(0,0,0),e.setDate(e.getDate()+4-(e.getDay()||7));var t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+1)/7)},t.MINUTE=function(e){return e=a.parseDate(e),e instanceof Error?e:e.getMinutes()},t.MONTH=function(e){return e=a.parseDate(e),e instanceof Error?e:e.getMonth()+1},t.NETWORKDAYS=function(e,t,n){return this.NETWORKDAYS.INTL(e,t,1,n)},t.NETWORKDAYS.INTL=function(e,t,n,r){if(e=a.parseDate(e),e instanceof Error)return e;if(t=a.parseDate(t),t instanceof Error)return t;if(n=void 0===n?c[1]:c[n],!(n instanceof Array))return s.value;void 0===r?r=[]:r instanceof Array||(r=[r]);for(var o=0;o<r.length;o++){var i=a.parseDate(r[o]);if(i instanceof Error)return i;r[o]=i}var l=(t-e)/864e5+1,u=l,d=e;for(o=0;o<l;o++){var h=(new Date).getTimezoneOffset()>0?d.getUTCDay():d.getDay(),f=!1;h!==n[0]&&h!==n[1]||(f=!0);for(var p=0;p<r.length;p++){var m=r[p];if(m.getDate()===d.getDate()&&m.getMonth()===d.getMonth()&&m.getFullYear()===d.getFullYear()){f=!0;break}}f&&u--,d.setDate(d.getDate()+1)}return u},t.NOW=function(){return new Date},t.SECOND=function(e){return e=a.parseDate(e),e instanceof Error?e:e.getSeconds()},t.TIME=function(e,t,n){return e=a.parseNumber(e),t=a.parseNumber(t),n=a.parseNumber(n),a.anyIsError(e,t,n)?s.value:e<0||t<0||n<0?s.num:(3600*e+60*t+n)/86400},t.TIMEVALUE=function(e){return e=a.parseDate(e),e instanceof Error?e:(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())/86400},t.TODAY=function(){return new Date},t.WEEKDAY=function(e,t){if(e=a.parseDate(e),e instanceof Error)return e;void 0===t&&(t=1);var n=e.getDay();return d[t][n]},t.WEEKNUM=function(e,t){if(e=a.parseDate(e),e instanceof Error)return e;if(void 0===t&&(t=1),21===t)return this.ISOWEEKNUM(e);var n=u[t],r=new Date(e.getFullYear(),0,1),o=r.getDay()<n?1:0;return r-=24*Math.abs(r.getDay()-n)*60*60*1e3,Math.floor((e-r)/864e5/7+1)+o},t.WORKDAY=function(e,t,n){return this.WORKDAY.INTL(e,t,1,n)},t.WORKDAY.INTL=function(e,t,n,r){if(e=a.parseDate(e),e instanceof Error)return e;if(t=a.parseNumber(t),t instanceof Error)return t;if(t<0)return s.num;if(n=void 0===n?c[1]:c[n],!(n instanceof Array))return s.value;void 0===r?r=[]:r instanceof Array||(r=[r]);for(var o=0;o<r.length;o++){var i=a.parseDate(r[o]);if(i instanceof Error)return i;r[o]=i}for(var l=0;l<t;){e.setDate(e.getDate()+1);var u=e.getDay();if(u!==n[0]&&u!==n[1]){for(var d=0;d<r.length;d++){var h=r[d];if(h.getDate()===e.getDate()&&h.getMonth()===e.getMonth()&&h.getFullYear()===e.getFullYear()){l--;break}}l++}}return e},t.YEAR=function(e){return e=a.parseDate(e),e instanceof Error?e:e.getFullYear()},t.YEARFRAC=function(e,t,n){if(e=a.parseDate(e),e instanceof Error)return e;if(t=a.parseDate(t),t instanceof Error)return t;n=n||0;var i=e.getDate(),s=e.getMonth()+1,l=e.getFullYear(),u=t.getDate(),d=t.getMonth()+1,c=t.getFullYear();switch(n){case 0:return 31===i&&31===u?(i=30,u=30):31===i?i=30:30===i&&31===u&&(u=30),(u+30*d+360*c-(i+30*s+360*l))/360;case 1:var h=function(e,t){var n=e.getFullYear(),o=new Date(n,2,1);if(r(n)&&e<o&&t>=o)return!0;var i=t.getFullYear(),s=new Date(i,2,1);return r(i)&&t>=s&&e<s},f=365;if(l===c||l+1===c&&(s>d||s===d&&i>=u))return(l===c&&r(l)||h(e,t)||1===d&&29===u)&&(f=366),o(e,t)/f;var p=c-l+1,m=(new Date(c+1,0,1)-new Date(l,0,1))/1e3/60/60/24,g=m/p;return o(e,t)/g;case 2:return o(e,t)/360;case 3:return o(e,t)/365;case 4:return(u+30*d+360*c-(i+30*s+360*l))/360}}},function(module,exports,__webpack_require__){function compact(e){var t=[];return utils.arrayEach(e,function(e){e&&t.push(e)}),t}function findResultIndex(database,criterias){for(var matches={},i=1;i<database[0].length;++i)matches[i]=!0;var maxCriteriaLength=criterias[0].length;for(i=1;i<criterias.length;++i)criterias[i].length>maxCriteriaLength&&(maxCriteriaLength=criterias[i].length);for(var k=1;k<database.length;++k)for(var l=1;l<database[k].length;++l){for(var currentCriteriaResult=!1,hasMatchingCriteria=!1,j=0;j<criterias.length;++j){var criteria=criterias[j];if(!(criteria.length<maxCriteriaLength)){var criteriaField=criteria[0];if(database[k][0]===criteriaField){hasMatchingCriteria=!0;for(var p=1;p<criteria.length;++p)currentCriteriaResult=currentCriteriaResult||eval(database[k][l]+criteria[p])}}}hasMatchingCriteria&&(matches[l]=matches[l]&&currentCriteriaResult)}for(var result=[],n=0;n<database[0].length;++n)matches[n]&&result.push(n-1);return result}var error=__webpack_require__(16),stats=__webpack_require__(17),maths=__webpack_require__(14),utils=__webpack_require__(15);exports.FINDFIELD=function(e,t){var n=null;return utils.arrayEach(e,function(e,r){if(e[0]===t)return n=r,!1}),null==n?error.value:n},exports.DAVERAGE=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return error.value;var r=findResultIndex(e,n),o=[];if("string"==typeof t){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else o=utils.rest(e[t]);var s=0;return utils.arrayEach(r,function(e){s+=o[e]}),0===r.length?error.div0:s/r.length},exports.DCOUNT=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return error.value;var r=findResultIndex(e,n),o=[];if("string"==typeof t){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else o=utils.rest(e[t]);var s=[];return utils.arrayEach(r,function(e){s.push(o[e])}),stats.COUNT(s)},exports.DCOUNTA=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return error.value;var r=findResultIndex(e,n),o=[];if("string"==typeof t){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else o=utils.rest(e[t]);var s=[];return utils.arrayEach(r,function(e){s.push(o[e])}),stats.COUNTA(s)},exports.DGET=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return error.value;var r=findResultIndex(e,n),o=[];if("string"==typeof t){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else o=utils.rest(e[t]);return 0===r.length?error.value:r.length>1?error.num:o[r[0]]},exports.DMAX=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return error.value;var r=findResultIndex(e,n),o=[];if("string"==typeof t){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else o=utils.rest(e[t]);var s=o[r[0]];return utils.arrayEach(r,function(e){s<o[e]&&(s=o[e])}),s},exports.DMIN=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return error.value;var r=findResultIndex(e,n),o=[];if("string"==typeof t){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else o=utils.rest(e[t]);var s=o[r[0]];return utils.arrayEach(r,function(e){s>o[e]&&(s=o[e])}),s},exports.DPRODUCT=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return error.value;var r=findResultIndex(e,n),o=[];if("string"==typeof t){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else o=utils.rest(e[t]);var s=[];utils.arrayEach(r,function(e){s.push(o[e])}),s=compact(s);var a=1;return utils.arrayEach(s,function(e){a*=e}),a},exports.DSTDEV=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return error.value;var r=findResultIndex(e,n),o=[];if("string"==typeof t){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else o=utils.rest(e[t]);var s=[];return utils.arrayEach(r,function(e){s.push(o[e])}),s=compact(s),stats.STDEV.S(s)},exports.DSTDEVP=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return error.value;var r=findResultIndex(e,n),o=[];if("string"==typeof t){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else o=utils.rest(e[t]);var s=[];return utils.arrayEach(r,function(e){s.push(o[e])}),s=compact(s),stats.STDEV.P(s)},exports.DSUM=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return error.value;var r=findResultIndex(e,n),o=[];if("string"==typeof t){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else o=utils.rest(e[t]);var s=[];return utils.arrayEach(r,function(e){s.push(o[e])}),maths.SUM(s)},exports.DVAR=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return error.value;var r=findResultIndex(e,n),o=[];if("string"==typeof t){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else o=utils.rest(e[t]);var s=[];return utils.arrayEach(r,function(e){s.push(o[e])}),stats.VAR.S(s)},exports.DVARP=function(e,t,n){if(isNaN(t)&&"string"!=typeof t)return error.value;var r=findResultIndex(e,n),o=[];if("string"==typeof t){var i=exports.FINDFIELD(e,t);o=utils.rest(e[i])}else o=utils.rest(e[t]);var s=[];return utils.arrayEach(r,function(e){s.push(o[e])}),stats.VAR.P(s)}},function(e,t,n){var r=n(16),o=n(15),i=n(24);t.AND=function(){for(var e=o.flatten(arguments),t=!0,n=0;n<e.length;n++)e[n]||(t=!1);return t},t.CHOOSE=function(){if(arguments.length<2)return r.na;var e=arguments[0];return e<1||e>254?r.value:arguments.length<e+1?r.value:arguments[e]},t.FALSE=function(){return!1},t.IF=function(e,t,n){return e?t:n},t.IFERROR=function(e,t){return i.ISERROR(e)?t:e},t.IFNA=function(e,t){return e===r.na?t:e},t.NOT=function(e){return!e},t.OR=function(){for(var e=o.flatten(arguments),t=!1,n=0;n<e.length;n++)e[n]&&(t=!0);return t},t.TRUE=function(){return!0},t.XOR=function(){for(var e=o.flatten(arguments),t=0,n=0;n<e.length;n++)e[n]&&t++;return!!(1&Math.floor(Math.abs(t)))},t.SWITCH=function(){var e;if(arguments.length>0){var t=arguments[0],n=arguments.length-1,o=Math.floor(n/2),i=!1,s=n%2!==0,a=n%2===0?null:arguments[arguments.length-1];if(o)for(var l=0;l<o;l++)if(t===arguments[2*l+1]){e=arguments[2*l+2],i=!0;break}i||(e=s?a:r.na)}else e=r.value;return e}},function(e,t,n){function r(e){return e&&e.getTime&&!isNaN(e.getTime())}function o(e){return e instanceof Date?e:new Date(e)}var i=n(16),s=n(27),a=n(15);t.ACCRINT=function(e,t,n,a,l,u,d){return e=o(e),t=o(t),n=o(n),r(e)&&r(t)&&r(n)?a<=0||l<=0?i.num:[1,2,4].indexOf(u)===-1?i.num:[0,1,2,3,4].indexOf(d)===-1?i.num:n<=e?i.num:(l=l||0,d=d||0,l*a*s.YEARFRAC(e,n,d)):i.value},t.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},t.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},t.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},t.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},t.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},t.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},t.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},t.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},t.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},t.CUMIPMT=function(e,n,r,o,s,l){if(e=a.parseNumber(e),n=a.parseNumber(n),r=a.parseNumber(r),a.anyIsError(e,n,r))return i.value;if(e<=0||n<=0||r<=0)return i.num;if(o<1||s<1||o>s)return i.num;if(0!==l&&1!==l)return i.num;var u=t.PMT(e,n,r,0,l),d=0;1===o&&0===l&&(d=-r,o++);for(var c=o;c<=s;c++)d+=1===l?t.FV(e,c-2,u,r,1)-u:t.FV(e,c-1,u,r,0);return d*=e},t.CUMPRINC=function(e,n,r,o,s,l){if(e=a.parseNumber(e),n=a.parseNumber(n),r=a.parseNumber(r),a.anyIsError(e,n,r))return i.value;if(e<=0||n<=0||r<=0)return i.num;if(o<1||s<1||o>s)return i.num;if(0!==l&&1!==l)return i.num;var u=t.PMT(e,n,r,0,l),d=0;1===o&&(d=0===l?u+r*e:u,o++);for(var c=o;c<=s;c++)d+=l>0?u-(t.FV(e,c-2,u,r,1)-u)*e:u-t.FV(e,c-1,u,r,0)*e;return d},t.DB=function(e,t,n,r,o){if(o=void 0===o?12:o,e=a.parseNumber(e),t=a.parseNumber(t),n=a.parseNumber(n),r=a.parseNumber(r),o=a.parseNumber(o),a.anyIsError(e,t,n,r,o))return i.value;if(e<0||t<0||n<0||r<0)return i.num;if([1,2,3,4,5,6,7,8,9,10,11,12].indexOf(o)===-1)return i.num;if(r>n)return i.num;if(t>=e)return 0;for(var s=(1-Math.pow(t/e,1/n)).toFixed(3),l=e*s*o/12,u=l,d=0,c=r===n?n-1:r,h=2;h<=c;h++)d=(e-u)*s,u+=d;return 1===r?l:r===n?(e-u)*s:d},t.DDB=function(e,t,n,r,o){if(o=void 0===o?2:o,e=a.parseNumber(e),t=a.parseNumber(t),n=a.parseNumber(n),r=a.parseNumber(r),o=a.parseNumber(o),a.anyIsError(e,t,n,r,o))return i.value;if(e<0||t<0||n<0||r<0||o<=0)return i.num;if(r>n)return i.num;if(t>=e)return 0;for(var s=0,l=0,u=1;u<=r;u++)l=Math.min((e-s)*(o/n),e-t-s),s+=l;return l},t.DISC=function(){throw new Error("DISC is not implemented")},t.DOLLARDE=function(e,t){if(e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t))return i.value;if(t<0)return i.num;if(t>=0&&t<1)return i.div0;t=parseInt(t,10);var n=parseInt(e,10);n+=e%1*Math.pow(10,Math.ceil(Math.log(t)/Math.LN10))/t;var r=Math.pow(10,Math.ceil(Math.log(t)/Math.LN2)+1);return n=Math.round(n*r)/r},t.DOLLARFR=function(e,t){if(e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t))return i.value;if(t<0)return i.num;if(t>=0&&t<1)return i.div0;t=parseInt(t,10);var n=parseInt(e,10);return n+=e%1*Math.pow(10,-Math.ceil(Math.log(t)/Math.LN10))*t},t.DURATION=function(){throw new Error("DURATION is not implemented")},t.EFFECT=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?i.value:e<=0||t<1?i.num:(t=parseInt(t,10),Math.pow(1+e/t,t)-1)},t.FV=function(e,t,n,r,o){if(r=r||0,o=o||0,e=a.parseNumber(e),t=a.parseNumber(t),n=a.parseNumber(n),r=a.parseNumber(r),o=a.parseNumber(o),a.anyIsError(e,t,n,r,o))return i.value;var s;if(0===e)s=r+n*t;else{var l=Math.pow(1+e,t);s=1===o?r*l+n*(1+e)*(l-1)/e:r*l+n*(l-1)/e}return-s},t.FVSCHEDULE=function(e,t){if(e=a.parseNumber(e),t=a.parseNumberArray(a.flatten(t)),a.anyIsError(e,t))return i.value;for(var n=t.length,r=e,o=0;o<n;o++)r*=1+t[o];return r},t.INTRATE=function(){throw new Error("INTRATE is not implemented")},t.IPMT=function(e,n,r,o,s,l){if(s=s||0,l=l||0,e=a.parseNumber(e),n=a.parseNumber(n),r=a.parseNumber(r),o=a.parseNumber(o),s=a.parseNumber(s),l=a.parseNumber(l),a.anyIsError(e,n,r,o,s,l))return i.value;var u,d=t.PMT(e,r,o,s,l);return u=1===n?1===l?0:-o:1===l?t.FV(e,n-2,d,o,1)-d:t.FV(e,n-1,d,o,0),u*e},t.IRR=function(e,t){if(t=t||0,e=a.parseNumberArray(a.flatten(e)),t=a.parseNumber(t),a.anyIsError(e,t))return i.value;for(var n=function(e,t,n){for(var r=n+1,o=e[0],i=1;i<e.length;i++)o+=e[i]/Math.pow(r,(t[i]-t[0])/365);return o},r=function(e,t,n){for(var r=n+1,o=0,i=1;i<e.length;i++){var s=(t[i]-t[0])/365;o-=s*e[i]/Math.pow(r,s+1)}return o},o=[],s=!1,l=!1,u=0;u<e.length;u++)o[u]=0===u?0:o[u-1]+365,e[u]>0&&(s=!0),e[u]<0&&(l=!0);if(!s||!l)return i.num;t=void 0===t?.1:t;var d,c,h,f=t,p=1e-10,m=!0;do h=n(e,o,f),d=f-h/r(e,o,f),c=Math.abs(d-f),f=d,m=c>p&&Math.abs(h)>p;while(m);return f},t.ISPMT=function(e,t,n,r){return e=a.parseNumber(e),
t=a.parseNumber(t),n=a.parseNumber(n),r=a.parseNumber(r),a.anyIsError(e,t,n,r)?i.value:r*e*(t/n-1)},t.MDURATION=function(){throw new Error("MDURATION is not implemented")},t.MIRR=function(e,n,r){if(e=a.parseNumberArray(a.flatten(e)),n=a.parseNumber(n),r=a.parseNumber(r),a.anyIsError(e,n,r))return i.value;for(var o=e.length,s=[],l=[],u=0;u<o;u++)e[u]<0?s.push(e[u]):l.push(e[u]);var d=-t.NPV(r,l)*Math.pow(1+r,o-1),c=t.NPV(n,s)*(1+n);return Math.pow(d/c,1/(o-1))-1},t.NOMINAL=function(e,t){return e=a.parseNumber(e),t=a.parseNumber(t),a.anyIsError(e,t)?i.value:e<=0||t<1?i.num:(t=parseInt(t,10),(Math.pow(e+1,1/t)-1)*t)},t.NPER=function(e,t,n,r,o){if(o=void 0===o?0:o,r=void 0===r?0:r,e=a.parseNumber(e),t=a.parseNumber(t),n=a.parseNumber(n),r=a.parseNumber(r),o=a.parseNumber(o),a.anyIsError(e,t,n,r,o))return i.value;var s=t*(1+e*o)-r*e,l=n*e+t*(1+e*o);return Math.log(s/l)/Math.log(1+e)},t.NPV=function(){var e=a.parseNumberArray(a.flatten(arguments));if(e instanceof Error)return e;for(var t=e[0],n=0,r=1;r<e.length;r++)n+=e[r]/Math.pow(1+t,r);return n},t.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},t.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},t.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},t.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},t.PDURATION=function(e,t,n){return e=a.parseNumber(e),t=a.parseNumber(t),n=a.parseNumber(n),a.anyIsError(e,t,n)?i.value:e<=0?i.num:(Math.log(n)-Math.log(t))/Math.log(1+e)},t.PMT=function(e,t,n,r,o){if(r=r||0,o=o||0,e=a.parseNumber(e),t=a.parseNumber(t),n=a.parseNumber(n),r=a.parseNumber(r),o=a.parseNumber(o),a.anyIsError(e,t,n,r,o))return i.value;var s;if(0===e)s=(n+r)/t;else{var l=Math.pow(1+e,t);s=1===o?(r*e/(l-1)+n*e/(1-1/l))/(1+e):r*e/(l-1)+n*e/(1-1/l)}return-s},t.PPMT=function(e,n,r,o,s,l){return s=s||0,l=l||0,e=a.parseNumber(e),r=a.parseNumber(r),o=a.parseNumber(o),s=a.parseNumber(s),l=a.parseNumber(l),a.anyIsError(e,r,o,s,l)?i.value:t.PMT(e,r,o,s,l)-t.IPMT(e,n,r,o,s,l)},t.PRICE=function(){throw new Error("PRICE is not implemented")},t.PRICEDISC=function(){throw new Error("PRICEDISC is not implemented")},t.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},t.PV=function(e,t,n,r,o){return r=r||0,o=o||0,e=a.parseNumber(e),t=a.parseNumber(t),n=a.parseNumber(n),r=a.parseNumber(r),o=a.parseNumber(o),a.anyIsError(e,t,n,r,o)?i.value:0===e?-n*t-r:((1-Math.pow(1+e,t))/e*n*(1+e*o)-r)/Math.pow(1+e,t)},t.RATE=function(e,t,n,r,o,s){if(s=void 0===s?.01:s,r=void 0===r?0:r,o=void 0===o?0:o,e=a.parseNumber(e),t=a.parseNumber(t),n=a.parseNumber(n),r=a.parseNumber(r),o=a.parseNumber(o),s=a.parseNumber(s),a.anyIsError(e,t,n,r,o,s))return i.value;var l,u,d,c,h=1e-10,f=50,p=0,m=0,g=0,v=s;for(Math.abs(v)<h?l=n*(1+e*v)+t*(1+v*o)*e+r:(m=Math.exp(e*Math.log(1+v)),l=n*m+t*(1/v+o)*(m-1)+r),u=n+t*e+r,d=n*m+t*(1/v+o)*(m-1)+r,g=c=0,p=v;Math.abs(u-d)>h&&g<f;)v=(d*c-u*p)/(d-u),c=p,p=v,Math.abs(v)<h?l=n*(1+e*v)+t*(1+v*o)*e+r:(m=Math.exp(e*Math.log(1+v)),l=n*m+t*(1/v+o)*(m-1)+r),u=d,d=l,++g;return v},t.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},t.RRI=function(e,t,n){return e=a.parseNumber(e),t=a.parseNumber(t),n=a.parseNumber(n),a.anyIsError(e,t,n)?i.value:0===e||0===t?i.num:Math.pow(n/t,1/e)-1},t.SLN=function(e,t,n){return e=a.parseNumber(e),t=a.parseNumber(t),n=a.parseNumber(n),a.anyIsError(e,t,n)?i.value:0===n?i.num:(e-t)/n},t.SYD=function(e,t,n,r){return e=a.parseNumber(e),t=a.parseNumber(t),n=a.parseNumber(n),r=a.parseNumber(r),a.anyIsError(e,t,n,r)?i.value:0===n?i.num:r<1||r>n?i.num:(r=parseInt(r,10),(e-t)*(n-r+1)*2/(n*(n+1)))},t.TBILLEQ=function(e,t,n){return e=a.parseDate(e),t=a.parseDate(t),n=a.parseNumber(n),a.anyIsError(e,t,n)?i.value:n<=0?i.num:e>t?i.num:t-e>31536e6?i.num:365*n/(360-n*s.DAYS360(e,t,!1))},t.TBILLPRICE=function(e,t,n){return e=a.parseDate(e),t=a.parseDate(t),n=a.parseNumber(n),a.anyIsError(e,t,n)?i.value:n<=0?i.num:e>t?i.num:t-e>31536e6?i.num:100*(1-n*s.DAYS360(e,t,!1)/360)},t.TBILLYIELD=function(e,t,n){return e=a.parseDate(e),t=a.parseDate(t),n=a.parseNumber(n),a.anyIsError(e,t,n)?i.value:n<=0?i.num:e>t?i.num:t-e>31536e6?i.num:360*(100-n)/(n*s.DAYS360(e,t,!1))},t.VDB=function(){throw new Error("VDB is not implemented")},t.XNPV=function(e,t,n){if(e=a.parseNumber(e),t=a.parseNumberArray(a.flatten(t)),n=a.parseDateArray(a.flatten(n)),a.anyIsError(e,t,n))return i.value;for(var r=0,o=0;o<t.length;o++)r+=t[o]/Math.pow(1+e,s.DAYS(n[o],n[0])/365);return r},t.YIELD=function(){throw new Error("YIELD is not implemented")},t.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},t.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")}},function(e,t,n){var r=n(16);t.MATCH=function(e,t,n){if(!e&&!t)return r.na;if(2===arguments.length&&(n=1),!(t instanceof Array))return r.na;if(n!==-1&&0!==n&&1!==n)return r.na;for(var o,i,s=0;s<t.length;s++)if(1===n){if(t[s]===e)return s+1;t[s]<e&&(i?t[s]>i&&(o=s+1,i=t[s]):(o=s+1,i=t[s]))}else if(0===n){if("string"==typeof e){if(e=e.replace(/\?/g,"."),t[s].toLowerCase().match(e.toLowerCase()))return s+1}else if(t[s]===e)return s+1}else if(n===-1){if(t[s]===e)return s+1;t[s]>e&&(i?t[s]<i&&(o=s+1,i=t[s]):(o=s+1,i=t[s]))}return o?o:r.na}},function(e,t){"use strict";function n(e,t){return e>t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var r=t.SYMBOL=">";n.SYMBOL=r},function(e,t){"use strict";function n(e,t){return e>=t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var r=t.SYMBOL=">=";n.SYMBOL=r},function(e,t){"use strict";function n(e,t){return e<t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var r=t.SYMBOL="<";n.SYMBOL=r},function(e,t){"use strict";function n(e,t){return e<=t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var r=t.SYMBOL="<=";n.SYMBOL=r},function(e,t,n){"use strict";function r(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var s=n.reduce(function(e,t){return e-(0,o.toNumber)(t)},(0,o.toNumber)(e));if(isNaN(s))throw Error(i.ERROR_VALUE);return s}Object.defineProperty(t,"__esModule",{value:!0}),t.SYMBOL=void 0,t.default=r;var o=n(6),i=n(7),s=t.SYMBOL="-";r.SYMBOL=s},function(e,t,n){"use strict";function r(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var s=n.reduce(function(e,t){return e*(0,o.toNumber)(t)},(0,o.toNumber)(e));if(isNaN(s))throw Error(i.ERROR_VALUE);return s}Object.defineProperty(t,"__esModule",{value:!0}),t.SYMBOL=void 0,t.default=r;var o=n(6),i=n(7),s=t.SYMBOL="*";r.SYMBOL=s},function(e,t){"use strict";function n(e,t){return e!==t}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;var r=t.SYMBOL="<>";n.SYMBOL=r},function(e,t,n){"use strict";function r(e,t){var n=Math.pow((0,o.toNumber)(e),(0,o.toNumber)(t));if(isNaN(n))throw Error(i.ERROR_VALUE);return n}Object.defineProperty(t,"__esModule",{value:!0}),t.SYMBOL=void 0,t.default=r;var o=n(6),i=n(7),s=t.SYMBOL="^";r.SYMBOL=s},function(module,exports,__webpack_require__){(function(module,process){"use strict";var parser=function(){function Parser(){this.yy={}}var o=function(e,t,n,r){for(n=n||{},r=e.length;r--;n[e[r]]=t);return n},$V0=[1,5],$V1=[1,8],$V2=[1,6],$V3=[1,7],$V4=[1,9],$V5=[1,14],$V6=[1,15],$V7=[1,16],$V8=[1,12],$V9=[1,13],$Va=[1,17],$Vb=[1,19],$Vc=[1,20],$Vd=[1,21],$Ve=[1,22],$Vf=[1,23],$Vg=[1,24],$Vh=[1,25],$Vi=[1,26],$Vj=[1,27],$Vk=[1,28],$Vl=[5,9,10,11,13,14,15,16,17,18,19,20,29,30],$Vm=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,32],$Vn=[5,9,10,11,13,14,15,16,17,18,19,20,29,30,34],$Vo=[5,10,11,13,14,15,16,17,29,30],$Vp=[5,10,13,14,15,16,29,30],$Vq=[5,10,11,13,14,15,16,17,18,19,29,30],$Vr=[13,29,30],parser={trace:function(){},yy:{},symbols_:{error:2,expressions:3,expression:4,EOF:5,variableSequence:6,number:7,STRING:8,"&":9,"=":10,"+":11,"(":12,")":13,"<":14,">":15,NOT:16,"-":17,"*":18,"/":19,"^":20,FUNCTION:21,expseq:22,cell:23,ABSOLUTE_CELL:24,RELATIVE_CELL:25,MIXED_CELL:26,":":27,ARRAY:28,";":29,",":30,VARIABLE:31,DECIMAL:32,NUMBER:33,"%":34,ERROR:35,$accept:0,$end:1},terminals_:{5:"EOF",8:"STRING",9:"&",10:"=",11:"+",12:"(",13:")",14:"<",15:">",16:"NOT",17:"-",18:"*",19:"/",20:"^",21:"FUNCTION",24:"ABSOLUTE_CELL",25:"RELATIVE_CELL",26:"MIXED_CELL",27:":",28:"ARRAY",29:";",30:",",31:"VARIABLE",32:"DECIMAL",33:"NUMBER",34:"%",35:"ERROR"},productions_:[0,[3,2],[4,1],[4,1],[4,1],[4,3],[4,3],[4,3],[4,3],[4,4],[4,4],[4,4],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,2],[4,2],[4,3],[4,4],[4,1],[4,1],[4,2],[23,1],[23,1],[23,1],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[23,3],[22,1],[22,1],[22,3],[22,3],[6,1],[6,3],[7,1],[7,3],[7,2],[2,1]],performAction:function anonymous(yytext,yyleng,yylineno,yy,yystate,$$,_$){var $0=$$.length-1;switch(yystate){case 1:return $$[$0-1];case 2:this.$=yy.callVariable($$[$0][0]);break;case 3:this.$=yy.toNumber($$[$0]);break;case 4:this.$=yy.trimEdges($$[$0]);break;case 5:this.$=yy.evaluateByOperator("&",[$$[$0-2],$$[$0]]);break;case 6:this.$=yy.evaluateByOperator("=",[$$[$0-2],$$[$0]]);break;case 7:this.$=yy.evaluateByOperator("+",[$$[$0-2],$$[$0]]);break;case 8:this.$=$$[$0-1];break;case 9:this.$=yy.evaluateByOperator("<=",[$$[$0-3],$$[$0]]);break;case 10:this.$=yy.evaluateByOperator(">=",[$$[$0-3],$$[$0]]);break;case 11:this.$=yy.evaluateByOperator("<>",[$$[$0-3],$$[$0]]);break;case 12:this.$=yy.evaluateByOperator("NOT",[$$[$0-2],$$[$0]]);break;case 13:this.$=yy.evaluateByOperator(">",[$$[$0-2],$$[$0]]);break;case 14:this.$=yy.evaluateByOperator("<",[$$[$0-2],$$[$0]]);break;case 15:this.$=yy.evaluateByOperator("-",[$$[$0-2],$$[$0]]);break;case 16:this.$=yy.evaluateByOperator("*",[$$[$0-2],$$[$0]]);break;case 17:this.$=yy.evaluateByOperator("/",[$$[$0-2],$$[$0]]);break;case 18:this.$=yy.evaluateByOperator("^",[$$[$0-2],$$[$0]]);break;case 19:var n1=yy.invertNumber($$[$0]);this.$=n1,isNaN(this.$)&&(this.$=0);break;case 20:var n1=yy.toNumber($$[$0]);this.$=n1,isNaN(this.$)&&(this.$=0);break;case 21:this.$=yy.callFunction($$[$0-2]);break;case 22:this.$=yy.callFunction($$[$0-3],$$[$0-1]);break;case 26:case 27:case 28:this.$=yy.cellValue($$[$0]);break;case 29:case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:this.$=yy.rangeValue($$[$0-2],$$[$0]);break;case 38:case 42:this.$=[$$[$0]];break;case 39:var result=[],arr=eval("["+yytext+"]");arr.forEach(function(e){result.push(e)}),this.$=result;break;case 40:case 41:$$[$0-2].push($$[$0]),this.$=$$[$0-2];break;case 43:this.$=Array.isArray($$[$0-2])?$$[$0-2]:[$$[$0-2]],this.$.push($$[$0]);break;case 44:this.$=$$[$0];break;case 45:this.$=1*($$[$0-2]+"."+$$[$0]);break;case 46:this.$=.01*$$[$0-1];break;case 47:this.$=yy.throwError($$[$0])}},table:[{2:11,3:1,4:2,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{1:[3]},{5:[1,18],9:$Vb,10:$Vc,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk},o($Vl,[2,2],{32:[1,29]}),o($Vl,[2,3],{34:[1,30]}),o($Vl,[2,4]),{2:11,4:31,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:32,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:33,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{12:[1,34]},o($Vl,[2,23]),o($Vl,[2,24],{2:35,35:$Va}),o($Vm,[2,42]),o($Vn,[2,44],{32:[1,36]}),o($Vl,[2,26],{27:[1,37]}),o($Vl,[2,27],{27:[1,38]}),o($Vl,[2,28],{27:[1,39]}),o([5,9,10,11,13,14,15,16,17,18,19,20,29,30,35],[2,47]),{1:[2,1]},{2:11,4:40,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:41,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:42,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:45,6:3,7:4,8:$V0,10:[1,43],11:$V1,12:$V2,15:[1,44],17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:47,6:3,7:4,8:$V0,10:[1,46],11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:48,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:49,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:50,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:51,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:52,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{31:[1,53]},o($Vn,[2,46]),{9:$Vb,10:$Vc,11:$Vd,13:[1,54],14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk},o($Vo,[2,19],{9:$Vb,18:$Vi,19:$Vj,20:$Vk}),o($Vo,[2,20],{9:$Vb,18:$Vi,19:$Vj,20:$Vk}),{2:11,4:57,6:3,7:4,8:$V0,11:$V1,12:$V2,13:[1,55],17:$V3,21:$V4,22:56,23:10,24:$V5,25:$V6,26:$V7,28:[1,58],31:$V8,33:$V9,35:$Va},o($Vl,[2,25]),{33:[1,59]},{24:[1,60],25:[1,61],26:[1,62]},{24:[1,63],25:[1,64],26:[1,65]},{24:[1,66],25:[1,67],26:[1,68]},o($Vl,[2,5]),o([5,10,13,29,30],[2,6],{9:$Vb,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vo,[2,7],{9:$Vb,18:$Vi,19:$Vj,20:$Vk}),{2:11,4:69,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:70,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},o($Vp,[2,14],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),{2:11,4:71,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},o($Vp,[2,13],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o([5,10,13,16,29,30],[2,12],{9:$Vb,11:$Vd,14:$Ve,15:$Vf,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vo,[2,15],{9:$Vb,18:$Vi,19:$Vj,20:$Vk}),o($Vq,[2,16],{9:$Vb,20:$Vk}),o($Vq,[2,17],{9:$Vb,20:$Vk}),o([5,10,11,13,14,15,16,17,18,19,20,29,30],[2,18],{9:$Vb}),o($Vm,[2,43]),o($Vl,[2,8]),o($Vl,[2,21]),{13:[1,72],29:[1,73],30:[1,74]},o($Vr,[2,38],{9:$Vb,10:$Vc,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vr,[2,39]),o($Vn,[2,45]),o($Vl,[2,29]),o($Vl,[2,30]),o($Vl,[2,31]),o($Vl,[2,32]),o($Vl,[2,33]),o($Vl,[2,34]),o($Vl,[2,35]),o($Vl,[2,36]),o($Vl,[2,37]),o($Vp,[2,9],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vp,[2,11],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vp,[2,10],{9:$Vb,11:$Vd,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vl,[2,22]),{2:11,4:75,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},{2:11,4:76,6:3,7:4,8:$V0,11:$V1,12:$V2,17:$V3,21:$V4,23:10,24:$V5,25:$V6,26:$V7,31:$V8,33:$V9,35:$Va},o($Vr,[2,40],{9:$Vb,10:$Vc,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk}),o($Vr,[2,41],{9:$Vb,10:$Vc,11:$Vd,14:$Ve,15:$Vf,16:$Vg,17:$Vh,18:$Vi,19:$Vj,20:$Vk})],defaultActions:{18:[2,1]},parseError:function(e,t){if(!t.recoverable){var n=function(e,t){this.message=e,this.hash=t};throw n.prototype=Error,new n(e,t)}this.trace(e)},parse:function(e){function t(e){r.length=r.length-2*e,o.length=o.length-e,i.length=i.length-e}var n=this,r=[0],o=[null],i=[],s=this.table,a="",l=0,u=0,d=0,c=2,h=1,f=i.slice.call(arguments,1),p=Object.create(this.lexer),m={yy:{}};for(var g in this.yy)Object.prototype.hasOwnProperty.call(this.yy,g)&&(m.yy[g]=this.yy[g]);p.setInput(e,m.yy),m.yy.lexer=p,m.yy.parser=this,"undefined"==typeof p.yylloc&&(p.yylloc={});var v=p.yylloc;i.push(v);var w=p.options&&p.options.ranges;"function"==typeof m.yy.parseError?this.parseError=m.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var b,y,_,C,R,M,E,S,O,T=function(){var e;return e=p.lex()||h,"number"!=typeof e&&(e=n.symbols_[e]||e),e},A={};;){if(_=r[r.length-1],this.defaultActions[_]?C=this.defaultActions[_]:(null!==b&&"undefined"!=typeof b||(b=T()),C=s[_]&&s[_][b]),"undefined"==typeof C||!C.length||!C[0]){var N,x=function(e){for(var t=r.length-1,n=0;;){if(c.toString()in s[e])return n;if(0===e||t<2)return!1;t-=2,e=r[t],++n}},k="";if(d)y!==h&&(N=x(_));else{N=x(_),O=[];for(M in s[_])this.terminals_[M]&&M>c&&O.push("'"+this.terminals_[M]+"'");k=p.showPosition?"Parse error on line "+(l+1)+":\n"+p.showPosition()+"\nExpecting "+O.join(", ")+", got '"+(this.terminals_[b]||b)+"'":"Parse error on line "+(l+1)+": Unexpected "+(b==h?"end of input":"'"+(this.terminals_[b]||b)+"'"),this.parseError(k,{text:p.match,token:this.terminals_[b]||b,line:p.yylineno,loc:v,expected:O,recoverable:N!==!1})}if(3==d){if(b===h||y===h)throw new Error(k||"Parsing halted while starting to recover from another error.");u=p.yyleng,a=p.yytext,l=p.yylineno,v=p.yylloc,b=T()}if(N===!1)throw new Error(k||"Parsing halted. No suitable error recovery rule available.");t(N),y=b==c?null:b,b=c,_=r[r.length-1],C=s[_]&&s[_][c],d=3}if(C[0]instanceof Array&&C.length>1)throw new Error("Parse Error: multiple actions possible at state: "+_+", token: "+b);switch(C[0]){case 1:r.push(b),o.push(p.yytext),i.push(p.yylloc),r.push(C[1]),b=null,y?(b=y,y=null):(u=p.yyleng,a=p.yytext,l=p.yylineno,v=p.yylloc,d>0&&d--);break;case 2:if(E=this.productions_[C[1]][1],A.$=o[o.length-E],A._$={first_line:i[i.length-(E||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(E||1)].first_column,last_column:i[i.length-1].last_column},w&&(A._$.range=[i[i.length-(E||1)].range[0],i[i.length-1].range[1]]),R=this.performAction.apply(A,[a,u,l,m.yy,C[1],o,i].concat(f)),"undefined"!=typeof R)return R;E&&(r=r.slice(0,-1*E*2),o=o.slice(0,-1*E),i=i.slice(0,-1*E)),r.push(this.productions_[C[1]][0]),o.push(A.$),i.push(A._$),S=s[r[r.length-2]][r[r.length-1]],r.push(S);break;case 3:return!0}}return!0}},lexer=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e,t){return this.yy=t||this.yy||{},this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);return t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t),this.offset-=t;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var o=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[o[0],o[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var n,r,o;if(this.options.backtrack_lexer&&(o={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(o.yylloc.range=this.yylloc.range.slice(0))),r=e[0].match(/(?:\r\n?|\n).*/g),r&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],n=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var i in o)this[i]=o[i];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,n,r;this._more||(this.yytext="",this.match="");for(var o=this._currentRules(),i=0;i<o.length;i++)if(n=this._input.match(this.rules[o[i]]),n&&(!t||n[0].length>t[0].length)){if(t=n,r=i,this.options.backtrack_lexer){if(e=this.test_match(n,o[i]),e!==!1)return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?(e=this.test_match(t,o[r]),e!==!1&&e):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){var e=this.conditionStack.length-1;return e>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return e=this.conditionStack.length-1-Math.abs(e||0),e>=0?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(e,t,n,r){switch(n){case 0:break;case 1:return 8;case 2:return 8;case 3:return 21;case 4:return 35;case 5:return 24;case 6:return 26;case 7:return 26;case 8:return 25;case 9:return 21;case 10:return 31;case 11:return 31;case 12:return 33;case 13:return 28;case 14:return 9;case 15:return" ";case 16:return 32;case 17:return 27;case 18:return 29;case 19:return 30;case 20:return 18;case 21:return 19;case 22:return 17;case 23:return 11;case 24:return 20;case 25:return 12;case 26:return 13;case 27:return 15;case 28:return 14;case 29:return 16;case 30:return'"';case 31:return"'";case 32:return"!";case 33:return 10;case 34:return 34;case 35:return"#";case 36:return 5}},rules:[/^(?:\s+)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9\.]+(?=[(]))/,/^(?:#[A-Z0-9\/]+(!|\?)?)/,/^(?:\$[A-Za-z]+\$[0-9]+)/,/^(?:\$[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z]+\$[0-9]+)/,/^(?:[A-Za-z]+[0-9]+)/,/^(?:[A-Za-z\.]+(?=[(]))/,/^(?:[A-Za-z]{1,}[A-Za-z_0-9]+)/,/^(?:[A-Za-z_]+)/,/^(?:[0-9]+)/,/^(?:\[(.*)?\])/,/^(?:&)/,/^(?: )/,/^(?:[.])/,/^(?::)/,/^(?:;)/,/^(?:,)/,/^(?:\*)/,/^(?:\/)/,/^(?:-)/,/^(?:\+)/,/^(?:\^)/,/^(?:\()/,/^(?:\))/,/^(?:>)/,/^(?:<)/,/^(?:NOT\b)/,/^(?:")/,/^(?:')/,/^(?:!)/,/^(?:=)/,/^(?:%)/,/^(?:[#])/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36],inclusive:!0}}};return e}();return parser.lexer=lexer,Parser.prototype=parser,parser.Parser=Parser,new Parser}();exports.parser=parser,exports.Parser=parser.Parser,exports.parse=function(){return parser.parse.apply(parser,arguments)},"undefined"!=typeof module&&__webpack_require__.c[0]===module&&exports.main(process.argv.slice(1))}).call(exports,__webpack_require__(41)(module),__webpack_require__(20))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){"use strict";function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e=e.substring(t,e.length-t)}Object.defineProperty(t,"__esModule",{value:!0}),t.trimEdges=n},function(e,t){"use strict";function n(e){if("string"!=typeof e||!u.test(e))return[];var t=e.toUpperCase().match(u),n=l(t,5),r=n[1],i=n[2],a=n[3],d=n[4];return[{index:s(d),label:d,isAbsolute:"$"===a},{index:o(i),label:i,isAbsolute:"$"===r}]}function r(e,t){var n=(e.isAbsolute?"$":"")+a(e.index),r=(t.isAbsolute?"$":"")+i(t.index);return r+n}function o(e){var t=0;if("string"==typeof e){e=e.toUpperCase();for(var n=0,r=e.length-1;n<e.length;n+=1,r-=1)t+=Math.pow(c,r)*(d.indexOf(e[n])+1)}return--t,t}function i(e){for(var t="";e>=0;)t=String.fromCharCode(e%c+97)+t,e=Math.floor(e/c)-1;return t.toUpperCase()}function s(e){var t=parseInt(e,10);return t=isNaN(t)?-1:Math.max(t-1,-1)}function a(e){var t="";return e>=0&&(t=""+(e+1)),t}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&a.return&&a.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.extractLabel=n,t.toLabel=r,t.columnLabelToIndex=o,t.columnIndexToLabel=i,t.rowLabelToIndex=s,t.rowIndexToLabel=a;var u=/^([$])?([A-Za-z]+)([$])?([0-9]+)$/,d="ABCDEFGHIJKLMNOPQRSTUVWXYZ",c=d.length}])})},{}],jsonpatch:[function(e,t,n){/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * json-patch-duplex.js version: 0.5.7
 * (c) 2013 Joachim Wester
 * MIT license
 */
var r,o=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},i=Error;!function(e){function t(e,n){switch(typeof e){case"undefined":case"boolean":case"string":case"number":return e===n;case"object":if(null===e)return null===n;if(S(e)){if(!S(n)||e.length!==n.length)return!1;for(var r=0,o=e.length;r<o;r++)if(!t(e[r],n[r]))return!1;return!0}var i=b(n),s=i.length;if(b(e).length!==s)return!1;for(var r=0;r<s;r++)if(!t(e[r],n[r]))return!1;return!0;default:return!1}}function n(e){return e.indexOf("/")===-1&&e.indexOf("~")===-1?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function r(e){for(var t=0,n=R.length;t<n;t++)if(R[t].obj===e)return R[t]}function s(e,t){for(var n=0,r=e.observers.length;n<r;n++)if(e.observers[n].callback===t)return e.observers[n].observer}function a(e,t){for(var n=0,r=e.observers.length;n<r;n++)if(e.observers[n].observer===t)return void e.observers.splice(n,1)}function l(e,t){t.unobserve()}function u(e){return"object"==typeof e?JSON.parse(JSON.stringify(e)):e}function d(e,t){var n,o=[],l=r(e);if(l?n=s(l,t):(l=new M(e),R.push(l)),n)return n;if(n={},l.value=u(e),t){n.callback=t,n.next=null;var d=this.intervals||[100,1e3,1e4,6e4];if(void 0===d.push)throw new i("jsonpatch.intervals must be an array");var h=0,f=function(){c(n)},p=function(){clearTimeout(n.next),n.next=setTimeout(function(){f(),h=0,n.next=setTimeout(m,d[h++])},0)},m=function(){f(),h==d.length&&(h=d.length-1),n.next=setTimeout(m,d[h++])};"undefined"!=typeof window&&(window.addEventListener?(window.addEventListener("mousedown",p),window.addEventListener("mouseup",p),window.addEventListener("keydown",p)):(document.documentElement.attachEvent("onmousedown",p),document.documentElement.attachEvent("onmouseup",p),document.documentElement.attachEvent("onkeydown",p))),n.next=setTimeout(m,d[h++])}return n.patches=o,n.object=e,n.unobserve=function(){c(n),clearTimeout(n.next),a(l,n),"undefined"!=typeof window&&(window.removeEventListener?(window.removeEventListener("mousedown",p),window.removeEventListener("mouseup",p),window.removeEventListener("keydown",p)):(document.documentElement.detachEvent("onmousedown",p),document.documentElement.detachEvent("onmouseup",p),document.documentElement.detachEvent("onkeydown",p)))},l.observers.push(new E(t,n)),n}function c(e){for(var t,n=0,r=R.length;n<r;n++)if(R[n].obj===e.object){t=R[n];break}h(t.value,e.object,e.patches,""),e.patches.length&&p(t.value,e.patches);var o=e.patches;return o.length>0&&(e.patches=[],e.callback&&e.callback(o)),o}function h(e,t,r,o){for(var i=b(t),s=b(e),a=!1,l=!1,d=s.length-1;d>=0;d--){var c=s[d],f=e[c];if(t.hasOwnProperty(c)){var p=t[c];"object"==typeof f&&null!=f&&"object"==typeof p&&null!=p?h(f,p,r,o+"/"+n(c)):f!=p&&(a=!0,r.push({op:"replace",path:o+"/"+n(c),value:u(p)}))}else r.push({op:"remove",path:o+"/"+n(c)}),l=!0}if(l||i.length!=s.length)for(var d=0;d<i.length;d++){var c=i[d];e.hasOwnProperty(c)||r.push({op:"add",path:o+"/"+n(c),value:u(t[c])})}}function f(e){for(var t,n=0,r=e.length;n<r;){t=e.charCodeAt(n);{if(!(t>=48&&t<=57))return!1;n++}}return!0}function p(e,t,n){for(var r,o,i=!1,s=0,a=t.length;s<a;){r=t[s],s++;for(var l=r.path||"",u=l.split("/"),d=e,c=1,h=u.length,p=void 0;;){if(o=u[c],n&&void 0===p&&(void 0===d[o]?p=u.slice(0,c).join("/"):c==h-1&&(p=r.path),void 0!==p&&this.validator(r,s-1,e,p)),c++,void 0===o&&c>=h){i=C[r.op].call(r,d,o,e);break}if(S(d)){if("-"===o)o=d.length;else{if(n&&!f(o))throw new O("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s-1,r.path,r);o=parseInt(o,10)}if(c>=h){if(n&&"add"===r.op&&o>d.length)throw new O("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s-1,r.path,r);i=_[r.op].call(r,d,o,e);break}}else if(o&&o.indexOf("~")!=-1&&(o=o.replace(/~1/g,"/").replace(/~0/g,"~")),c>=h){i=y[r.op].call(r,d,o,e);break}d=d[o]}}return i}function m(e,t){var n=[];return h(e,t,n,""),n}function g(e){if(void 0===e)return!0;if("array"==typeof e||"object"==typeof e)for(var t in e)if(g(e[t]))return!0;return!1}function v(t,n,r,o){if("object"!=typeof t||null===t||S(t))throw new O("Operation is not an object","OPERATION_NOT_AN_OBJECT",n,t,r);if(!y[t.op])throw new O("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",n,t,r);if("string"!=typeof t.path)throw new O("Operation `path` property is not a string","OPERATION_PATH_INVALID",n,t,r);if(("move"===t.op||"copy"===t.op)&&"string"!=typeof t.from)throw new O("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",n,t,r);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&void 0===t.value)throw new O("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",n,t,r);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&g(t.value))throw new O("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",n,t,r);if(r)if("add"==t.op){var i=t.path.split("/").length,s=o.split("/").length;if(i!==s+1&&i!==s)throw new O("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",n,t,r)}else if("replace"===t.op||"remove"===t.op||"_get"===t.op){if(t.path!==o)throw new O("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",n,t,r)}else if("move"===t.op||"copy"===t.op){var a={op:"_get",path:t.from,value:void 0},l=e.validate([a],r);if(l&&"OPERATION_PATH_UNRESOLVABLE"===l.name)throw new O("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",n,t,r)}}function w(e,t){try{if(!S(e))throw new O("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)t=JSON.parse(JSON.stringify(t)),p.call(this,t,e,!0);else for(var n=0;n<e.length;n++)this.validator(e[n],n)}catch(e){if(e instanceof O)return e;throw e}}var b=function(e){if(S(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t},y={add:function(e,t){return e[t]=this.value,!0},remove:function(e,t){return delete e[t],!0},replace:function(e,t){return e[t]=this.value,!0},move:function(e,t,n){var r={op:"_get",path:this.from};return p(n,[r]),p(n,[{op:"remove",path:this.from}]),p(n,[{op:"add",path:this.path,value:r.value}]),!0},copy:function(e,t,n){var r={op:"_get",path:this.from};return p(n,[r]),p(n,[{op:"add",path:this.path,value:r.value}]),!0},test:function(e,n){return t(e[n],this.value)},_get:function(e,t){this.value=e[t]}},_={add:function(e,t){return e.splice(t,0,this.value),!0},remove:function(e,t){return e.splice(t,1),!0},replace:function(e,t){return e[t]=this.value,!0},move:y.move,copy:y.copy,test:y.test,_get:y._get},C={add:function(e){C.remove.call(this,e);for(var t in this.value)this.value.hasOwnProperty(t)&&(e[t]=this.value[t]);return!0},remove:function(e){for(var t in e)e.hasOwnProperty(t)&&y.remove.call(this,e,t);return!0},replace:function(e){return p(e,[{op:"remove",path:this.path}]),p(e,[{op:"add",path:this.path,value:this.value}]),!0},move:y.move,copy:y.copy,test:function(e){return JSON.stringify(e)===JSON.stringify(this.value)},_get:function(e){this.value=e}},R=[],M=function(){function e(e){this.observers=[],this.obj=e}return e}(),E=function(){function e(e,t){this.callback=e,this.observer=t}return e}();e.unobserve=l,e.observe=d,e.generate=c;var S;S=Array.isArray?Array.isArray:function(e){return e.push&&"number"==typeof e.length},e.apply=p,e.compare=m;var O=function(e){function t(t,n,r,o,i){e.call(this,t),this.message=t,this.name=n,this.index=r,this.operation=o,this.tree=i}return o(t,e),t}(i);e.JsonPatchError=O,e.Error=O,e.validator=v,e.validate=w}(r||(r={})),"undefined"!=typeof n&&(n.apply=r.apply,n.observe=r.observe,n.unobserve=r.unobserve,n.generate=r.generate,n.compare=r.compare,n.validate=r.validate,n.validator=r.validator,n.JsonPatchError=r.JsonPatchError,n.Error=r.Error)},{}],moment:[function(e,t,n){!function(e,r){"object"==typeof n&&"undefined"!=typeof t?t.exports=r():"function"==typeof define&&define.amd?define(r):e.moment=r()}(this,function(){"use strict";function n(){return vr.apply(null,arguments)}function r(e){vr=e}function o(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function i(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function s(e){var t;for(t in e)return!1;return!0}function a(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function l(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function u(e,t){var n,r=[];for(n=0;n<e.length;++n)r.push(t(e[n],n));return r}function d(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function c(e,t){for(var n in t)d(t,n)&&(e[n]=t[n]);return d(t,"toString")&&(e.toString=t.toString),d(t,"valueOf")&&(e.valueOf=t.valueOf),e}function h(e,t,n,r){return bt(e,t,n,r,!0).utc()}function f(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null}}function p(e){return null==e._pf&&(e._pf=f()),e._pf}function m(e){if(null==e._isValid){var t=p(e),n=br.call(t.parsedDateParts,function(e){return null!=e}),r=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n);if(e._strict&&(r=r&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return r;e._isValid=r}return e._isValid}function g(e){var t=h(NaN);return null!=e?c(p(t),e):p(t).userInvalidated=!0,t}function v(e){return void 0===e}function w(e,t){var n,r,o;if(v(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),v(t._i)||(e._i=t._i),v(t._f)||(e._f=t._f),v(t._l)||(e._l=t._l),v(t._strict)||(e._strict=t._strict),v(t._tzm)||(e._tzm=t._tzm),v(t._isUTC)||(e._isUTC=t._isUTC),v(t._offset)||(e._offset=t._offset),v(t._pf)||(e._pf=p(t)),v(t._locale)||(e._locale=t._locale),yr.length>0)for(n in yr)r=yr[n],o=t[r],v(o)||(e[r]=o);return e}function b(e){w(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),_r===!1&&(_r=!0,n.updateOffset(this),_r=!1)}function y(e){return e instanceof b||null!=e&&null!=e._isAMomentObject}function _(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function C(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=_(t)),n}function R(e,t,n){var r,o=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),s=0;for(r=0;r<o;r++)(n&&e[r]!==t[r]||!n&&C(e[r])!==C(t[r]))&&s++;return s+i}function M(e){n.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function E(e,t){var r=!0;return c(function(){if(null!=n.deprecationHandler&&n.deprecationHandler(null,e),r){for(var o,i=[],s=0;s<arguments.length;s++){if(o="","object"==typeof arguments[s]){o+="\n["+s+"] ";for(var a in arguments[0])o+=a+": "+arguments[0][a]+", ";o=o.slice(0,-2)}else o=arguments[s];i.push(o)}M(e+"\nArguments: "+Array.prototype.slice.call(i).join("")+"\n"+(new Error).stack),r=!1}return t.apply(this,arguments)},t)}function S(e,t){null!=n.deprecationHandler&&n.deprecationHandler(e,t),Cr[e]||(M(t),Cr[e]=!0)}function O(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function T(e){var t,n;for(n in e)t=e[n],O(t)?this[n]=t:this["_"+n]=t;this._config=e,this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function A(e,t){var n,r=c({},e);for(n in t)d(t,n)&&(i(e[n])&&i(t[n])?(r[n]={},c(r[n],e[n]),c(r[n],t[n])):null!=t[n]?r[n]=t[n]:delete r[n]);for(n in e)d(e,n)&&!d(t,n)&&i(e[n])&&(r[n]=c({},r[n]));return r}function N(e){null!=e&&this.set(e)}function x(e,t,n){var r=this._calendar[e]||this._calendar.sameElse;return O(r)?r.call(t,n):r}function k(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])}function I(){return this._invalidDate}function D(e){return this._ordinal.replace("%d",e)}function P(e,t,n,r){var o=this._relativeTime[n];return O(o)?o(e,t,n,r):o.replace(/%d/i,e)}function H(e,t){var n=this._relativeTime[e>0?"future":"past"];return O(n)?n(t):n.replace(/%s/i,t)}function L(e,t){var n=e.toLowerCase();kr[n]=kr[n+"s"]=kr[t]=e}function V(e){return"string"==typeof e?kr[e]||kr[e.toLowerCase()]:void 0}function j(e){var t,n,r={};for(n in e)d(e,n)&&(t=V(n),t&&(r[t]=e[n]));return r}function F(e,t){Ir[e]=t}function $(e){var t=[];for(var n in e)t.push({unit:n,priority:Ir[n]});return t.sort(function(e,t){return e.priority-t.priority}),t}function B(e,t){return function(r){return null!=r?(U(this,e,r),n.updateOffset(this,t),this):W(this,e)}}function W(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function U(e,t,n){e.isValid()&&e._d["set"+(e._isUTC?"UTC":"")+t](n)}function Y(e){return e=V(e),O(this[e])?this[e]():this}function G(e,t){if("object"==typeof e){e=j(e);for(var n=$(e),r=0;r<n.length;r++)this[n[r].unit](e[n[r].unit])}else if(e=V(e),O(this[e]))return this[e](t);return this}function z(e,t,n){var r=""+Math.abs(e),o=t-r.length,i=e>=0;return(i?n?"+":"":"-")+Math.pow(10,Math.max(0,o)).toString().substr(1)+r}function X(e,t,n,r){var o=r;"string"==typeof r&&(o=function(){return this[r]()}),e&&(Lr[e]=o),t&&(Lr[t[0]]=function(){return z(o.apply(this,arguments),t[1],t[2])}),n&&(Lr[n]=function(){return this.localeData().ordinal(o.apply(this,arguments),e)})}function q(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function K(e){var t,n,r=e.match(Dr);for(t=0,n=r.length;t<n;t++)Lr[r[t]]?r[t]=Lr[r[t]]:r[t]=q(r[t]);return function(t){var o,i="";for(o=0;o<n;o++)i+=r[o]instanceof Function?r[o].call(t,e):r[o];return i}}function Q(e,t){return e.isValid()?(t=Z(t,e.localeData()),Hr[t]=Hr[t]||K(t),Hr[t](e)):e.localeData().invalidDate()}function Z(e,t){function n(e){return t.longDateFormat(e)||e}var r=5;for(Pr.lastIndex=0;r>=0&&Pr.test(e);)e=e.replace(Pr,n),Pr.lastIndex=0,r-=1;return e}function J(e,t,n){to[e]=O(t)?t:function(e,r){return e&&n?n:t}}function ee(e,t){return d(to,e)?to[e](t._strict,t._locale):new RegExp(te(e))}function te(e){return ne(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,r,o){return t||n||r||o}))}function ne(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function re(e,t){var n,r=t;for("string"==typeof e&&(e=[e]),a(t)&&(r=function(e,n){n[t]=C(e)}),n=0;n<e.length;n++)no[e[n]]=r}function oe(e,t){re(e,function(e,n,r,o){r._w=r._w||{},t(e,r._w,r,o)})}function ie(e,t,n){null!=t&&d(no,e)&&no[e](t,n._a,n,e)}function se(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function ae(e,t){return e?o(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||po).test(t)?"format":"standalone"][e.month()]:this._months}function le(e,t){return e?o(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[po.test(t)?"format":"standalone"][e.month()]:this._monthsShort}function ue(e,t,n){var r,o,i,s=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)i=h([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(i,"").toLocaleLowerCase();return n?"MMM"===t?(o=fo.call(this._shortMonthsParse,s),o!==-1?o:null):(o=fo.call(this._longMonthsParse,s),o!==-1?o:null):"MMM"===t?(o=fo.call(this._shortMonthsParse,s),o!==-1?o:(o=fo.call(this._longMonthsParse,s),o!==-1?o:null)):(o=fo.call(this._longMonthsParse,s),o!==-1?o:(o=fo.call(this._shortMonthsParse,s),o!==-1?o:null))}function de(e,t,n){var r,o,i;if(this._monthsParseExact)return ue.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(o=h([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(o,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(o,"").replace(".","")+"$","i")),n||this._monthsParse[r]||(i="^"+this.months(o,"")+"|^"+this.monthsShort(o,""),this._monthsParse[r]=new RegExp(i.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[r].test(e))return r;if(n&&"MMM"===t&&this._shortMonthsParse[r].test(e))return r;if(!n&&this._monthsParse[r].test(e))return r}}function ce(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=C(t);else if(t=e.localeData().monthsParse(t),!a(t))return e;return n=Math.min(e.date(),se(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function he(e){return null!=e?(ce(this,e),n.updateOffset(this,!0),this):W(this,"Month")}function fe(){return se(this.year(),this.month())}function pe(e){return this._monthsParseExact?(d(this,"_monthsRegex")||ge.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(d(this,"_monthsShortRegex")||(this._monthsShortRegex=vo),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function me(e){return this._monthsParseExact?(d(this,"_monthsRegex")||ge.call(this),e?this._monthsStrictRegex:this._monthsRegex):(d(this,"_monthsRegex")||(this._monthsRegex=wo),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function ge(){function e(e,t){return t.length-e.length}var t,n,r=[],o=[],i=[];for(t=0;t<12;t++)n=h([2e3,t]),r.push(this.monthsShort(n,"")),o.push(this.months(n,"")),i.push(this.months(n,"")),i.push(this.monthsShort(n,""));for(r.sort(e),o.sort(e),i.sort(e),t=0;t<12;t++)r[t]=ne(r[t]),o[t]=ne(o[t]);for(t=0;t<24;t++)i[t]=ne(i[t]);this._monthsRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+r.join("|")+")","i")}function ve(e){return we(e)?366:365}function we(e){return e%4===0&&e%100!==0||e%400===0}function be(){return we(this.year())}function ye(e,t,n,r,o,i,s){var a=new Date(e,t,n,r,o,i,s);return e<100&&e>=0&&isFinite(a.getFullYear())&&a.setFullYear(e),a}function _e(e){var t=new Date(Date.UTC.apply(null,arguments));return e<100&&e>=0&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e),t}function Ce(e,t,n){var r=7+t-n,o=(7+_e(e,0,r).getUTCDay()-t)%7;return-o+r-1}function Re(e,t,n,r,o){var i,s,a=(7+n-r)%7,l=Ce(e,r,o),u=1+7*(t-1)+a+l;return u<=0?(i=e-1,s=ve(i)+u):u>ve(e)?(i=e+1,s=u-ve(e)):(i=e,s=u),{year:i,dayOfYear:s}}function Me(e,t,n){var r,o,i=Ce(e.year(),t,n),s=Math.floor((e.dayOfYear()-i-1)/7)+1;return s<1?(o=e.year()-1,r=s+Ee(o,t,n)):s>Ee(e.year(),t,n)?(r=s-Ee(e.year(),t,n),o=e.year()+1):(o=e.year(),r=s),{week:r,year:o}}function Ee(e,t,n){var r=Ce(e,t,n),o=Ce(e+1,t,n);return(ve(e)-r+o)/7}function Se(e){return Me(e,this._week.dow,this._week.doy).week}function Oe(){return this._week.dow}function Te(){return this._week.doy}function Ae(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function Ne(e){var t=Me(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function xe(e,t){return"string"!=typeof e?e:isNaN(e)?(e=t.weekdaysParse(e),"number"==typeof e?e:null):parseInt(e,10)}function ke(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function Ie(e,t){return e?o(this._weekdays)?this._weekdays[e.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][e.day()]:this._weekdays}function De(e){return e?this._weekdaysShort[e.day()]:this._weekdaysShort}function Pe(e){return e?this._weekdaysMin[e.day()]:this._weekdaysMin}function He(e,t,n){var r,o,i,s=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)i=h([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(i,"").toLocaleLowerCase();return n?"dddd"===t?(o=fo.call(this._weekdaysParse,s),o!==-1?o:null):"ddd"===t?(o=fo.call(this._shortWeekdaysParse,s),o!==-1?o:null):(o=fo.call(this._minWeekdaysParse,s),o!==-1?o:null):"dddd"===t?(o=fo.call(this._weekdaysParse,s),o!==-1?o:(o=fo.call(this._shortWeekdaysParse,s),o!==-1?o:(o=fo.call(this._minWeekdaysParse,s),o!==-1?o:null))):"ddd"===t?(o=fo.call(this._shortWeekdaysParse,s),o!==-1?o:(o=fo.call(this._weekdaysParse,s),o!==-1?o:(o=fo.call(this._minWeekdaysParse,s),o!==-1?o:null))):(o=fo.call(this._minWeekdaysParse,s),o!==-1?o:(o=fo.call(this._weekdaysParse,s),o!==-1?o:(o=fo.call(this._shortWeekdaysParse,s),o!==-1?o:null)))}function Le(e,t,n){var r,o,i;if(this._weekdaysParseExact)return He.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(o=h([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(o,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(o,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(o,"").replace(".",".?")+"$","i")),this._weekdaysParse[r]||(i="^"+this.weekdays(o,"")+"|^"+this.weekdaysShort(o,"")+"|^"+this.weekdaysMin(o,""),this._weekdaysParse[r]=new RegExp(i.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[r].test(e))return r;if(n&&"ddd"===t&&this._shortWeekdaysParse[r].test(e))return r;if(n&&"dd"===t&&this._minWeekdaysParse[r].test(e))return r;if(!n&&this._weekdaysParse[r].test(e))return r}}function Ve(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=xe(e,this.localeData()),this.add(e-t,"d")):t}function je(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function Fe(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=ke(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7}function $e(e){return this._weekdaysParseExact?(d(this,"_weekdaysRegex")||Ue.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(d(this,"_weekdaysRegex")||(this._weekdaysRegex=Mo),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function Be(e){return this._weekdaysParseExact?(d(this,"_weekdaysRegex")||Ue.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(d(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Eo),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function We(e){return this._weekdaysParseExact?(d(this,"_weekdaysRegex")||Ue.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(d(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=So),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Ue(){function e(e,t){return t.length-e.length}var t,n,r,o,i,s=[],a=[],l=[],u=[];for(t=0;t<7;t++)n=h([2e3,1]).day(t),r=this.weekdaysMin(n,""),o=this.weekdaysShort(n,""),i=this.weekdays(n,""),s.push(r),a.push(o),l.push(i),u.push(r),u.push(o),u.push(i);for(s.sort(e),a.sort(e),l.sort(e),u.sort(e),t=0;t<7;t++)a[t]=ne(a[t]),l[t]=ne(l[t]),u[t]=ne(u[t]);this._weekdaysRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+s.join("|")+")","i")}function Ye(){return this.hours()%12||12}function Ge(){return this.hours()||24}function ze(e,t){X(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function Xe(e,t){return t._meridiemParse}function qe(e){return"p"===(e+"").toLowerCase().charAt(0)}function Ke(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"}function Qe(e){return e?e.toLowerCase().replace("_","-"):e}function Ze(e){for(var t,n,r,o,i=0;i<e.length;){for(o=Qe(e[i]).split("-"),t=o.length,n=Qe(e[i+1]),n=n?n.split("-"):null;t>0;){if(r=Je(o.slice(0,t).join("-")))return r;if(n&&n.length>=t&&R(o,n,!0)>=t-1)break;t--}i++}return null}function Je(n){var r=null;if(!xo[n]&&"undefined"!=typeof t&&t&&t.exports)try{r=Oo._abbr,e("./locale/"+n),et(r)}catch(e){}return xo[n]}function et(e,t){var n;return e&&(n=v(t)?rt(e):tt(e,t),n&&(Oo=n)),Oo._abbr}function tt(e,t){if(null!==t){var n=No;if(t.abbr=e,null!=xo[e])S("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=xo[e]._config;else if(null!=t.parentLocale){if(null==xo[t.parentLocale])return ko[t.parentLocale]||(ko[t.parentLocale]=[]),ko[t.parentLocale].push({name:e,config:t}),null;n=xo[t.parentLocale]._config}return xo[e]=new N(A(n,t)),ko[e]&&ko[e].forEach(function(e){tt(e.name,e.config)}),et(e),xo[e]}return delete xo[e],null}function nt(e,t){if(null!=t){var n,r=No;null!=xo[e]&&(r=xo[e]._config),t=A(r,t),n=new N(t),n.parentLocale=xo[e],xo[e]=n,et(e)}else null!=xo[e]&&(null!=xo[e].parentLocale?xo[e]=xo[e].parentLocale:null!=xo[e]&&delete xo[e]);return xo[e]}function rt(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Oo;if(!o(e)){if(t=Je(e))return t;e=[e]}return Ze(e)}function ot(){return Er(xo)}function it(e){var t,n=e._a;return n&&p(e).overflow===-2&&(t=n[oo]<0||n[oo]>11?oo:n[io]<1||n[io]>se(n[ro],n[oo])?io:n[so]<0||n[so]>24||24===n[so]&&(0!==n[ao]||0!==n[lo]||0!==n[uo])?so:n[ao]<0||n[ao]>59?ao:n[lo]<0||n[lo]>59?lo:n[uo]<0||n[uo]>999?uo:-1,p(e)._overflowDayOfYear&&(t<ro||t>io)&&(t=io),p(e)._overflowWeeks&&t===-1&&(t=co),p(e)._overflowWeekday&&t===-1&&(t=ho),p(e).overflow=t),e}function st(e){var t,n,r,o,i,s,a=e._i,l=Io.exec(a)||Do.exec(a);if(l){for(p(e).iso=!0,t=0,n=Ho.length;t<n;t++)if(Ho[t][1].exec(l[1])){o=Ho[t][0],r=Ho[t][2]!==!1;break}if(null==o)return void(e._isValid=!1);if(l[3]){for(t=0,n=Lo.length;t<n;t++)if(Lo[t][1].exec(l[3])){i=(l[2]||" ")+Lo[t][0];break}if(null==i)return void(e._isValid=!1)}if(!r&&null!=i)return void(e._isValid=!1);if(l[4]){if(!Po.exec(l[4]))return void(e._isValid=!1);s="Z"}e._f=o+(i||"")+(s||""),ht(e)}else e._isValid=!1}function at(e){var t=Vo.exec(e._i);return null!==t?void(e._d=new Date(+t[1])):(st(e),void(e._isValid===!1&&(delete e._isValid,n.createFromInputFallback(e))))}function lt(e,t,n){return null!=e?e:null!=t?t:n}function ut(e){var t=new Date(n.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function dt(e){var t,n,r,o,i=[];if(!e._d){for(r=ut(e),e._w&&null==e._a[io]&&null==e._a[oo]&&ct(e),e._dayOfYear&&(o=lt(e._a[ro],r[ro]),e._dayOfYear>ve(o)&&(p(e)._overflowDayOfYear=!0),n=_e(o,0,e._dayOfYear),e._a[oo]=n.getUTCMonth(),e._a[io]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=i[t]=r[t];for(;t<7;t++)e._a[t]=i[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[so]&&0===e._a[ao]&&0===e._a[lo]&&0===e._a[uo]&&(e._nextDay=!0,e._a[so]=0),e._d=(e._useUTC?_e:ye).apply(null,i),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[so]=24)}}function ct(e){var t,n,r,o,i,s,a,l;if(t=e._w,null!=t.GG||null!=t.W||null!=t.E)i=1,s=4,n=lt(t.GG,e._a[ro],Me(yt(),1,4).year),r=lt(t.W,1),o=lt(t.E,1),(o<1||o>7)&&(l=!0);else{i=e._locale._week.dow,s=e._locale._week.doy;var u=Me(yt(),i,s);n=lt(t.gg,e._a[ro],u.year),r=lt(t.w,u.week),null!=t.d?(o=t.d,(o<0||o>6)&&(l=!0)):null!=t.e?(o=t.e+i,(t.e<0||t.e>6)&&(l=!0)):o=i}r<1||r>Ee(n,i,s)?p(e)._overflowWeeks=!0:null!=l?p(e)._overflowWeekday=!0:(a=Re(n,r,o,i,s),e._a[ro]=a.year,e._dayOfYear=a.dayOfYear)}function ht(e){if(e._f===n.ISO_8601)return void st(e);e._a=[],p(e).empty=!0;var t,r,o,i,s,a=""+e._i,l=a.length,u=0;for(o=Z(e._f,e._locale).match(Dr)||[],t=0;t<o.length;t++)i=o[t],r=(a.match(ee(i,e))||[])[0],r&&(s=a.substr(0,a.indexOf(r)),s.length>0&&p(e).unusedInput.push(s),a=a.slice(a.indexOf(r)+r.length),u+=r.length),Lr[i]?(r?p(e).empty=!1:p(e).unusedTokens.push(i),ie(i,r,e)):e._strict&&!r&&p(e).unusedTokens.push(i);p(e).charsLeftOver=l-u,a.length>0&&p(e).unusedInput.push(a),e._a[so]<=12&&p(e).bigHour===!0&&e._a[so]>0&&(p(e).bigHour=void 0),p(e).parsedDateParts=e._a.slice(0),p(e).meridiem=e._meridiem,e._a[so]=ft(e._locale,e._a[so],e._meridiem),dt(e),it(e)}function ft(e,t,n){var r;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?(r=e.isPM(n),r&&t<12&&(t+=12),r||12!==t||(t=0),t):t}function pt(e){var t,n,r,o,i;if(0===e._f.length)return p(e).invalidFormat=!0,void(e._d=new Date(NaN));for(o=0;o<e._f.length;o++)i=0,t=w({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[o],ht(t),m(t)&&(i+=p(t).charsLeftOver,i+=10*p(t).unusedTokens.length,p(t).score=i,(null==r||i<r)&&(r=i,n=t));c(e,n||t)}function mt(e){if(!e._d){var t=j(e._i);e._a=u([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),dt(e)}}function gt(e){var t=new b(it(vt(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function vt(e){var t=e._i,n=e._f;return e._locale=e._locale||rt(e._l),null===t||void 0===n&&""===t?g({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),y(t)?new b(it(t)):(l(t)?e._d=t:o(n)?pt(e):n?ht(e):wt(e),m(e)||(e._d=null),e))}function wt(e){var t=e._i;void 0===t?e._d=new Date(n.now()):l(t)?e._d=new Date(t.valueOf()):"string"==typeof t?at(e):o(t)?(e._a=u(t.slice(0),function(e){return parseInt(e,10)}),dt(e)):"object"==typeof t?mt(e):a(t)?e._d=new Date(t):n.createFromInputFallback(e)}function bt(e,t,n,r,a){var l={};return n!==!0&&n!==!1||(r=n,n=void 0),(i(e)&&s(e)||o(e)&&0===e.length)&&(e=void 0),l._isAMomentObject=!0,l._useUTC=l._isUTC=a,l._l=n,l._i=e,l._f=t,l._strict=r,gt(l)}function yt(e,t,n,r){return bt(e,t,n,r,!1)}function _t(e,t){var n,r;if(1===t.length&&o(t[0])&&(t=t[0]),!t.length)return yt();for(n=t[0],r=1;r<t.length;++r)t[r].isValid()&&!t[r][e](n)||(n=t[r]);return n}function Ct(){var e=[].slice.call(arguments,0);return _t("isBefore",e)}function Rt(){var e=[].slice.call(arguments,0);return _t("isAfter",e)}function Mt(e){var t=j(e),n=t.year||0,r=t.quarter||0,o=t.month||0,i=t.week||0,s=t.day||0,a=t.hour||0,l=t.minute||0,u=t.second||0,d=t.millisecond||0;this._milliseconds=+d+1e3*u+6e4*l+1e3*a*60*60,this._days=+s+7*i,this._months=+o+3*r+12*n,this._data={},this._locale=rt(),this._bubble()}function Et(e){return e instanceof Mt}function St(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function Ot(e,t){X(e,0,0,function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+z(~~(e/60),2)+t+z(~~e%60,2)})}function Tt(e,t){var n=(t||"").match(e);if(null===n)return null;var r=n[n.length-1]||[],o=(r+"").match(Bo)||["-",0,0],i=+(60*o[1])+C(o[2]);return 0===i?0:"+"===o[0]?i:-i}function At(e,t){var r,o;return t._isUTC?(r=t.clone(),o=(y(e)||l(e)?e.valueOf():yt(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+o),n.updateOffset(r,!1),r):yt(e).local()}function Nt(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function xt(e,t){var r,o=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(e=Tt(Zr,e),null===e)return this}else Math.abs(e)<16&&(e*=60);return!this._isUTC&&t&&(r=Nt(this)),this._offset=e,this._isUTC=!0,null!=r&&this.add(r,"m"),o!==e&&(!t||this._changeInProgress?zt(this,Bt(e-o,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,n.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?o:Nt(this)}function kt(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),
this):-this.utcOffset()}function It(e){return this.utcOffset(0,e)}function Dt(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Nt(this),"m")),this}function Pt(){if(null!=this._tzm)this.utcOffset(this._tzm);else if("string"==typeof this._i){var e=Tt(Qr,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this}function Ht(e){return!!this.isValid()&&(e=e?yt(e).utcOffset():0,(this.utcOffset()-e)%60===0)}function Lt(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Vt(){if(!v(this._isDSTShifted))return this._isDSTShifted;var e={};if(w(e,this),e=vt(e),e._a){var t=e._isUTC?h(e._a):yt(e._a);this._isDSTShifted=this.isValid()&&R(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function jt(){return!!this.isValid()&&!this._isUTC}function Ft(){return!!this.isValid()&&this._isUTC}function $t(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}function Bt(e,t){var n,r,o,i=e,s=null;return Et(e)?i={ms:e._milliseconds,d:e._days,M:e._months}:a(e)?(i={},t?i[t]=e:i.milliseconds=e):(s=Wo.exec(e))?(n="-"===s[1]?-1:1,i={y:0,d:C(s[io])*n,h:C(s[so])*n,m:C(s[ao])*n,s:C(s[lo])*n,ms:C(St(1e3*s[uo]))*n}):(s=Uo.exec(e))?(n="-"===s[1]?-1:1,i={y:Wt(s[2],n),M:Wt(s[3],n),w:Wt(s[4],n),d:Wt(s[5],n),h:Wt(s[6],n),m:Wt(s[7],n),s:Wt(s[8],n)}):null==i?i={}:"object"==typeof i&&("from"in i||"to"in i)&&(o=Yt(yt(i.from),yt(i.to)),i={},i.ms=o.milliseconds,i.M=o.months),r=new Mt(i),Et(e)&&d(e,"_locale")&&(r._locale=e._locale),r}function Wt(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Ut(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function Yt(e,t){var n;return e.isValid()&&t.isValid()?(t=At(t,e),e.isBefore(t)?n=Ut(e,t):(n=Ut(t,e),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function Gt(e,t){return function(n,r){var o,i;return null===r||isNaN(+r)||(S(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=n,n=r,r=i),n="string"==typeof n?+n:n,o=Bt(n,r),zt(this,o,e),this}}function zt(e,t,r,o){var i=t._milliseconds,s=St(t._days),a=St(t._months);e.isValid()&&(o=null==o||o,i&&e._d.setTime(e._d.valueOf()+i*r),s&&U(e,"Date",W(e,"Date")+s*r),a&&ce(e,W(e,"Month")+a*r),o&&n.updateOffset(e,s||a))}function Xt(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function qt(e,t){var r=e||yt(),o=At(r,this).startOf("day"),i=n.calendarFormat(this,o)||"sameElse",s=t&&(O(t[i])?t[i].call(this,r):t[i]);return this.format(s||this.localeData().calendar(i,this,yt(r)))}function Kt(){return new b(this)}function Qt(e,t){var n=y(e)?e:yt(e);return!(!this.isValid()||!n.isValid())&&(t=V(v(t)?"millisecond":t),"millisecond"===t?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())}function Zt(e,t){var n=y(e)?e:yt(e);return!(!this.isValid()||!n.isValid())&&(t=V(v(t)?"millisecond":t),"millisecond"===t?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())}function Jt(e,t,n,r){return r=r||"()",("("===r[0]?this.isAfter(e,n):!this.isBefore(e,n))&&(")"===r[1]?this.isBefore(t,n):!this.isAfter(t,n))}function en(e,t){var n,r=y(e)?e:yt(e);return!(!this.isValid()||!r.isValid())&&(t=V(t||"millisecond"),"millisecond"===t?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))}function tn(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function nn(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function rn(e,t,n){var r,o,i,s;return this.isValid()?(r=At(e,this),r.isValid()?(o=6e4*(r.utcOffset()-this.utcOffset()),t=V(t),"year"===t||"month"===t||"quarter"===t?(s=on(this,r),"quarter"===t?s/=3:"year"===t&&(s/=12)):(i=this-r,s="second"===t?i/1e3:"minute"===t?i/6e4:"hour"===t?i/36e5:"day"===t?(i-o)/864e5:"week"===t?(i-o)/6048e5:i),n?s:_(s)):NaN):NaN}function on(e,t){var n,r,o=12*(t.year()-e.year())+(t.month()-e.month()),i=e.clone().add(o,"months");return t-i<0?(n=e.clone().add(o-1,"months"),r=(t-i)/(i-n)):(n=e.clone().add(o+1,"months"),r=(t-i)/(n-i)),-(o+r)||0}function sn(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function an(){var e=this.clone().utc();return 0<e.year()&&e.year()<=9999?O(Date.prototype.toISOString)?this.toDate().toISOString():Q(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):Q(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function ln(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="";this.isLocal()||(e=0===this.utcOffset()?"moment.utc":"moment.parseZone",t="Z");var n="["+e+'("]',r=0<this.year()&&this.year()<=9999?"YYYY":"YYYYYY",o="-MM-DD[T]HH:mm:ss.SSS",i=t+'[")]';return this.format(n+r+o+i)}function un(e){e||(e=this.isUtc()?n.defaultFormatUtc:n.defaultFormat);var t=Q(this,e);return this.localeData().postformat(t)}function dn(e,t){return this.isValid()&&(y(e)&&e.isValid()||yt(e).isValid())?Bt({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function cn(e){return this.from(yt(),e)}function hn(e,t){return this.isValid()&&(y(e)&&e.isValid()||yt(e).isValid())?Bt({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function fn(e){return this.to(yt(),e)}function pn(e){var t;return void 0===e?this._locale._abbr:(t=rt(e),null!=t&&(this._locale=t),this)}function mn(){return this._locale}function gn(e){switch(e=V(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this}function vn(e){return e=V(e),void 0===e||"millisecond"===e?this:("date"===e&&(e="day"),this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms"))}function wn(){return this._d.valueOf()-6e4*(this._offset||0)}function bn(){return Math.floor(this.valueOf()/1e3)}function yn(){return new Date(this.valueOf())}function _n(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Cn(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function Rn(){return this.isValid()?this.toISOString():null}function Mn(){return m(this)}function En(){return c({},p(this))}function Sn(){return p(this).overflow}function On(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function Tn(e,t){X(0,[e,e.length],0,t)}function An(e){return In.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Nn(e){return In.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function xn(){return Ee(this.year(),1,4)}function kn(){var e=this.localeData()._week;return Ee(this.year(),e.dow,e.doy)}function In(e,t,n,r,o){var i;return null==e?Me(this,r,o).year:(i=Ee(e,r,o),t>i&&(t=i),Dn.call(this,e,t,n,r,o))}function Dn(e,t,n,r,o){var i=Re(e,t,n,r,o),s=_e(i.year,0,i.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}function Pn(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}function Hn(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}function Ln(e,t){t[uo]=C(1e3*("0."+e))}function Vn(){return this._isUTC?"UTC":""}function jn(){return this._isUTC?"Coordinated Universal Time":""}function Fn(e){return yt(1e3*e)}function $n(){return yt.apply(null,arguments).parseZone()}function Bn(e){return e}function Wn(e,t,n,r){var o=rt(),i=h().set(r,t);return o[n](i,e)}function Un(e,t,n){if(a(e)&&(t=e,e=void 0),e=e||"",null!=t)return Wn(e,t,n,"month");var r,o=[];for(r=0;r<12;r++)o[r]=Wn(e,r,n,"month");return o}function Yn(e,t,n,r){"boolean"==typeof e?(a(t)&&(n=t,t=void 0),t=t||""):(t=e,n=t,e=!1,a(t)&&(n=t,t=void 0),t=t||"");var o=rt(),i=e?o._week.dow:0;if(null!=n)return Wn(t,(n+i)%7,r,"day");var s,l=[];for(s=0;s<7;s++)l[s]=Wn(t,(s+i)%7,r,"day");return l}function Gn(e,t){return Un(e,t,"months")}function zn(e,t){return Un(e,t,"monthsShort")}function Xn(e,t,n){return Yn(e,t,n,"weekdays")}function qn(e,t,n){return Yn(e,t,n,"weekdaysShort")}function Kn(e,t,n){return Yn(e,t,n,"weekdaysMin")}function Qn(){var e=this._data;return this._milliseconds=ti(this._milliseconds),this._days=ti(this._days),this._months=ti(this._months),e.milliseconds=ti(e.milliseconds),e.seconds=ti(e.seconds),e.minutes=ti(e.minutes),e.hours=ti(e.hours),e.months=ti(e.months),e.years=ti(e.years),this}function Zn(e,t,n,r){var o=Bt(t,n);return e._milliseconds+=r*o._milliseconds,e._days+=r*o._days,e._months+=r*o._months,e._bubble()}function Jn(e,t){return Zn(this,e,t,1)}function er(e,t){return Zn(this,e,t,-1)}function tr(e){return e<0?Math.floor(e):Math.ceil(e)}function nr(){var e,t,n,r,o,i=this._milliseconds,s=this._days,a=this._months,l=this._data;return i>=0&&s>=0&&a>=0||i<=0&&s<=0&&a<=0||(i+=864e5*tr(or(a)+s),s=0,a=0),l.milliseconds=i%1e3,e=_(i/1e3),l.seconds=e%60,t=_(e/60),l.minutes=t%60,n=_(t/60),l.hours=n%24,s+=_(n/24),o=_(rr(s)),a+=o,s-=tr(or(o)),r=_(a/12),a%=12,l.days=s,l.months=a,l.years=r,this}function rr(e){return 4800*e/146097}function or(e){return 146097*e/4800}function ir(e){var t,n,r=this._milliseconds;if(e=V(e),"month"===e||"year"===e)return t=this._days+r/864e5,n=this._months+rr(t),"month"===e?n:n/12;switch(t=this._days+Math.round(or(this._months)),e){case"week":return t/7+r/6048e5;case"day":return t+r/864e5;case"hour":return 24*t+r/36e5;case"minute":return 1440*t+r/6e4;case"second":return 86400*t+r/1e3;case"millisecond":return Math.floor(864e5*t)+r;default:throw new Error("Unknown unit "+e)}}function sr(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*C(this._months/12)}function ar(e){return function(){return this.as(e)}}function lr(e){return e=V(e),this[e+"s"]()}function ur(e){return function(){return this._data[e]}}function dr(){return _(this.days()/7)}function cr(e,t,n,r,o){return o.relativeTime(t||1,!!n,e,r)}function hr(e,t,n){var r=Bt(e).abs(),o=vi(r.as("s")),i=vi(r.as("m")),s=vi(r.as("h")),a=vi(r.as("d")),l=vi(r.as("M")),u=vi(r.as("y")),d=o<wi.s&&["s",o]||i<=1&&["m"]||i<wi.m&&["mm",i]||s<=1&&["h"]||s<wi.h&&["hh",s]||a<=1&&["d"]||a<wi.d&&["dd",a]||l<=1&&["M"]||l<wi.M&&["MM",l]||u<=1&&["y"]||["yy",u];return d[2]=t,d[3]=+e>0,d[4]=n,cr.apply(null,d)}function fr(e){return void 0===e?vi:"function"==typeof e&&(vi=e,!0)}function pr(e,t){return void 0!==wi[e]&&(void 0===t?wi[e]:(wi[e]=t,!0))}function mr(e){var t=this.localeData(),n=hr(this,!e,t);return e&&(n=t.pastFuture(+this,n)),t.postformat(n)}function gr(){var e,t,n,r=bi(this._milliseconds)/1e3,o=bi(this._days),i=bi(this._months);e=_(r/60),t=_(e/60),r%=60,e%=60,n=_(i/12),i%=12;var s=n,a=i,l=o,u=t,d=e,c=r,h=this.asSeconds();return h?(h<0?"-":"")+"P"+(s?s+"Y":"")+(a?a+"M":"")+(l?l+"D":"")+(u||d||c?"T":"")+(u?u+"H":"")+(d?d+"M":"")+(c?c+"S":""):"P0D"}var vr,wr;wr=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),n=t.length>>>0,r=0;r<n;r++)if(r in t&&e.call(this,t[r],r,t))return!0;return!1};var br=wr,yr=n.momentProperties=[],_r=!1,Cr={};n.suppressDeprecationWarnings=!1,n.deprecationHandler=null;var Rr;Rr=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)d(e,t)&&n.push(t);return n};var Mr,Er=Rr,Sr={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},Or={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},Tr="Invalid date",Ar="%d",Nr=/\d{1,2}/,xr={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},kr={},Ir={},Dr=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Pr=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Hr={},Lr={},Vr=/\d/,jr=/\d\d/,Fr=/\d{3}/,$r=/\d{4}/,Br=/[+-]?\d{6}/,Wr=/\d\d?/,Ur=/\d\d\d\d?/,Yr=/\d\d\d\d\d\d?/,Gr=/\d{1,3}/,zr=/\d{1,4}/,Xr=/[+-]?\d{1,6}/,qr=/\d+/,Kr=/[+-]?\d+/,Qr=/Z|[+-]\d\d:?\d\d/gi,Zr=/Z|[+-]\d\d(?::?\d\d)?/gi,Jr=/[+-]?\d+(\.\d{1,3})?/,eo=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,to={},no={},ro=0,oo=1,io=2,so=3,ao=4,lo=5,uo=6,co=7,ho=8;Mr=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};var fo=Mr;X("M",["MM",2],"Mo",function(){return this.month()+1}),X("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),X("MMMM",0,0,function(e){return this.localeData().months(this,e)}),L("month","M"),F("month",8),J("M",Wr),J("MM",Wr,jr),J("MMM",function(e,t){return t.monthsShortRegex(e)}),J("MMMM",function(e,t){return t.monthsRegex(e)}),re(["M","MM"],function(e,t){t[oo]=C(e)-1}),re(["MMM","MMMM"],function(e,t,n,r){var o=n._locale.monthsParse(e,r,n._strict);null!=o?t[oo]=o:p(n).invalidMonth=e});var po=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,mo="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),go="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),vo=eo,wo=eo;X("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e}),X(0,["YY",2],0,function(){return this.year()%100}),X(0,["YYYY",4],0,"year"),X(0,["YYYYY",5],0,"year"),X(0,["YYYYYY",6,!0],0,"year"),L("year","y"),F("year",1),J("Y",Kr),J("YY",Wr,jr),J("YYYY",zr,$r),J("YYYYY",Xr,Br),J("YYYYYY",Xr,Br),re(["YYYYY","YYYYYY"],ro),re("YYYY",function(e,t){t[ro]=2===e.length?n.parseTwoDigitYear(e):C(e)}),re("YY",function(e,t){t[ro]=n.parseTwoDigitYear(e)}),re("Y",function(e,t){t[ro]=parseInt(e,10)}),n.parseTwoDigitYear=function(e){return C(e)+(C(e)>68?1900:2e3)};var bo=B("FullYear",!0);X("w",["ww",2],"wo","week"),X("W",["WW",2],"Wo","isoWeek"),L("week","w"),L("isoWeek","W"),F("week",5),F("isoWeek",5),J("w",Wr),J("ww",Wr,jr),J("W",Wr),J("WW",Wr,jr),oe(["w","ww","W","WW"],function(e,t,n,r){t[r.substr(0,1)]=C(e)});var yo={dow:0,doy:6};X("d",0,"do","day"),X("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),X("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),X("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),X("e",0,0,"weekday"),X("E",0,0,"isoWeekday"),L("day","d"),L("weekday","e"),L("isoWeekday","E"),F("day",11),F("weekday",11),F("isoWeekday",11),J("d",Wr),J("e",Wr),J("E",Wr),J("dd",function(e,t){return t.weekdaysMinRegex(e)}),J("ddd",function(e,t){return t.weekdaysShortRegex(e)}),J("dddd",function(e,t){return t.weekdaysRegex(e)}),oe(["dd","ddd","dddd"],function(e,t,n,r){var o=n._locale.weekdaysParse(e,r,n._strict);null!=o?t.d=o:p(n).invalidWeekday=e}),oe(["d","e","E"],function(e,t,n,r){t[r]=C(e)});var _o="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Co="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Ro="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Mo=eo,Eo=eo,So=eo;X("H",["HH",2],0,"hour"),X("h",["hh",2],0,Ye),X("k",["kk",2],0,Ge),X("hmm",0,0,function(){return""+Ye.apply(this)+z(this.minutes(),2)}),X("hmmss",0,0,function(){return""+Ye.apply(this)+z(this.minutes(),2)+z(this.seconds(),2)}),X("Hmm",0,0,function(){return""+this.hours()+z(this.minutes(),2)}),X("Hmmss",0,0,function(){return""+this.hours()+z(this.minutes(),2)+z(this.seconds(),2)}),ze("a",!0),ze("A",!1),L("hour","h"),F("hour",13),J("a",Xe),J("A",Xe),J("H",Wr),J("h",Wr),J("HH",Wr,jr),J("hh",Wr,jr),J("hmm",Ur),J("hmmss",Yr),J("Hmm",Ur),J("Hmmss",Yr),re(["H","HH"],so),re(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),re(["h","hh"],function(e,t,n){t[so]=C(e),p(n).bigHour=!0}),re("hmm",function(e,t,n){var r=e.length-2;t[so]=C(e.substr(0,r)),t[ao]=C(e.substr(r)),p(n).bigHour=!0}),re("hmmss",function(e,t,n){var r=e.length-4,o=e.length-2;t[so]=C(e.substr(0,r)),t[ao]=C(e.substr(r,2)),t[lo]=C(e.substr(o)),p(n).bigHour=!0}),re("Hmm",function(e,t,n){var r=e.length-2;t[so]=C(e.substr(0,r)),t[ao]=C(e.substr(r))}),re("Hmmss",function(e,t,n){var r=e.length-4,o=e.length-2;t[so]=C(e.substr(0,r)),t[ao]=C(e.substr(r,2)),t[lo]=C(e.substr(o))});var Oo,To=/[ap]\.?m?\.?/i,Ao=B("Hours",!0),No={calendar:Sr,longDateFormat:Or,invalidDate:Tr,ordinal:Ar,ordinalParse:Nr,relativeTime:xr,months:mo,monthsShort:go,week:yo,weekdays:_o,weekdaysMin:Ro,weekdaysShort:Co,meridiemParse:To},xo={},ko={},Io=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Do=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Po=/Z|[+-]\d\d(?::?\d\d)?/,Ho=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],Lo=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Vo=/^\/?Date\((\-?\d+)/i;n.createFromInputFallback=E("value provided is not in a recognized ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),n.ISO_8601=function(){};var jo=E("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=yt.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:g()}),Fo=E("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=yt.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:g()}),$o=function(){return Date.now?Date.now():+new Date};Ot("Z",":"),Ot("ZZ",""),J("Z",Zr),J("ZZ",Zr),re(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=Tt(Zr,e)});var Bo=/([\+\-]|\d\d)/gi;n.updateOffset=function(){};var Wo=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,Uo=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;Bt.fn=Mt.prototype;var Yo=Gt(1,"add"),Go=Gt(-1,"subtract");n.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",n.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var zo=E("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});X(0,["gg",2],0,function(){return this.weekYear()%100}),X(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Tn("gggg","weekYear"),Tn("ggggg","weekYear"),Tn("GGGG","isoWeekYear"),Tn("GGGGG","isoWeekYear"),L("weekYear","gg"),L("isoWeekYear","GG"),F("weekYear",1),F("isoWeekYear",1),J("G",Kr),J("g",Kr),J("GG",Wr,jr),J("gg",Wr,jr),J("GGGG",zr,$r),J("gggg",zr,$r),J("GGGGG",Xr,Br),J("ggggg",Xr,Br),oe(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,r){t[r.substr(0,2)]=C(e)}),oe(["gg","GG"],function(e,t,r,o){t[o]=n.parseTwoDigitYear(e)}),X("Q",0,"Qo","quarter"),L("quarter","Q"),F("quarter",7),J("Q",Vr),re("Q",function(e,t){t[oo]=3*(C(e)-1)}),X("D",["DD",2],"Do","date"),L("date","D"),F("date",9),J("D",Wr),J("DD",Wr,jr),J("Do",function(e,t){return e?t._ordinalParse:t._ordinalParseLenient}),re(["D","DD"],io),re("Do",function(e,t){t[io]=C(e.match(Wr)[0],10)});var Xo=B("Date",!0);X("DDD",["DDDD",3],"DDDo","dayOfYear"),L("dayOfYear","DDD"),F("dayOfYear",4),J("DDD",Gr),J("DDDD",Fr),re(["DDD","DDDD"],function(e,t,n){n._dayOfYear=C(e)}),X("m",["mm",2],0,"minute"),L("minute","m"),F("minute",14),J("m",Wr),J("mm",Wr,jr),re(["m","mm"],ao);var qo=B("Minutes",!1);X("s",["ss",2],0,"second"),L("second","s"),F("second",15),J("s",Wr),J("ss",Wr,jr),re(["s","ss"],lo);var Ko=B("Seconds",!1);X("S",0,0,function(){return~~(this.millisecond()/100)}),X(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),X(0,["SSS",3],0,"millisecond"),X(0,["SSSS",4],0,function(){return 10*this.millisecond()}),X(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),X(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),X(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),X(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),X(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),L("millisecond","ms"),F("millisecond",16),J("S",Gr,Vr),J("SS",Gr,jr),J("SSS",Gr,Fr);var Qo;for(Qo="SSSS";Qo.length<=9;Qo+="S")J(Qo,qr);for(Qo="S";Qo.length<=9;Qo+="S")re(Qo,Ln);var Zo=B("Milliseconds",!1);X("z",0,0,"zoneAbbr"),X("zz",0,0,"zoneName");var Jo=b.prototype;Jo.add=Yo,Jo.calendar=qt,Jo.clone=Kt,Jo.diff=rn,Jo.endOf=vn,Jo.format=un,Jo.from=dn,Jo.fromNow=cn,Jo.to=hn,Jo.toNow=fn,Jo.get=Y,Jo.invalidAt=Sn,Jo.isAfter=Qt,Jo.isBefore=Zt,Jo.isBetween=Jt,Jo.isSame=en,Jo.isSameOrAfter=tn,Jo.isSameOrBefore=nn,Jo.isValid=Mn,Jo.lang=zo,Jo.locale=pn,Jo.localeData=mn,Jo.max=Fo,Jo.min=jo,Jo.parsingFlags=En,Jo.set=G,Jo.startOf=gn,Jo.subtract=Go,Jo.toArray=_n,Jo.toObject=Cn,Jo.toDate=yn,Jo.toISOString=an,Jo.inspect=ln,Jo.toJSON=Rn,Jo.toString=sn,Jo.unix=bn,Jo.valueOf=wn,Jo.creationData=On,Jo.year=bo,Jo.isLeapYear=be,Jo.weekYear=An,Jo.isoWeekYear=Nn,Jo.quarter=Jo.quarters=Pn,Jo.month=he,Jo.daysInMonth=fe,Jo.week=Jo.weeks=Ae,Jo.isoWeek=Jo.isoWeeks=Ne,Jo.weeksInYear=kn,Jo.isoWeeksInYear=xn,Jo.date=Xo,Jo.day=Jo.days=Ve,Jo.weekday=je,Jo.isoWeekday=Fe,Jo.dayOfYear=Hn,Jo.hour=Jo.hours=Ao,Jo.minute=Jo.minutes=qo,Jo.second=Jo.seconds=Ko,Jo.millisecond=Jo.milliseconds=Zo,Jo.utcOffset=xt,Jo.utc=It,Jo.local=Dt,Jo.parseZone=Pt,Jo.hasAlignedHourOffset=Ht,Jo.isDST=Lt,Jo.isLocal=jt,Jo.isUtcOffset=Ft,Jo.isUtc=$t,Jo.isUTC=$t,Jo.zoneAbbr=Vn,Jo.zoneName=jn,Jo.dates=E("dates accessor is deprecated. Use date instead.",Xo),Jo.months=E("months accessor is deprecated. Use month instead",he),Jo.years=E("years accessor is deprecated. Use year instead",bo),Jo.zone=E("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",kt),Jo.isDSTShifted=E("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Vt);var ei=N.prototype;ei.calendar=x,ei.longDateFormat=k,ei.invalidDate=I,ei.ordinal=D,ei.preparse=Bn,ei.postformat=Bn,ei.relativeTime=P,ei.pastFuture=H,ei.set=T,ei.months=ae,ei.monthsShort=le,ei.monthsParse=de,ei.monthsRegex=me,ei.monthsShortRegex=pe,ei.week=Se,ei.firstDayOfYear=Te,ei.firstDayOfWeek=Oe,ei.weekdays=Ie,ei.weekdaysMin=Pe,ei.weekdaysShort=De,ei.weekdaysParse=Le,ei.weekdaysRegex=$e,ei.weekdaysShortRegex=Be,ei.weekdaysMinRegex=We,ei.isPM=qe,ei.meridiem=Ke,et("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,n=1===C(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+n}}),n.lang=E("moment.lang is deprecated. Use moment.locale instead.",et),n.langData=E("moment.langData is deprecated. Use moment.localeData instead.",rt);var ti=Math.abs,ni=ar("ms"),ri=ar("s"),oi=ar("m"),ii=ar("h"),si=ar("d"),ai=ar("w"),li=ar("M"),ui=ar("y"),di=ur("milliseconds"),ci=ur("seconds"),hi=ur("minutes"),fi=ur("hours"),pi=ur("days"),mi=ur("months"),gi=ur("years"),vi=Math.round,wi={s:45,m:45,h:22,d:26,M:11},bi=Math.abs,yi=Mt.prototype;return yi.abs=Qn,yi.add=Jn,yi.subtract=er,yi.as=ir,yi.asMilliseconds=ni,yi.asSeconds=ri,yi.asMinutes=oi,yi.asHours=ii,yi.asDays=si,yi.asWeeks=ai,yi.asMonths=li,yi.asYears=ui,yi.valueOf=sr,yi._bubble=nr,yi.get=lr,yi.milliseconds=di,yi.seconds=ci,yi.minutes=hi,yi.hours=fi,yi.days=pi,yi.weeks=dr,yi.months=mi,yi.years=gi,yi.humanize=mr,yi.toISOString=gr,yi.toString=gr,yi.toJSON=gr,yi.locale=pn,yi.localeData=mn,yi.toIsoString=E("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",gr),yi.lang=zo,X("X",0,0,"unix"),X("x",0,0,"valueOf"),J("x",Kr),J("X",Jr),re("X",function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))}),re("x",function(e,t,n){n._d=new Date(C(e))}),n.version="2.17.1",r(yt),n.fn=Jo,n.min=Ct,n.max=Rt,n.now=$o,n.utc=h,n.unix=Fn,n.months=Gn,n.isDate=l,n.locale=et,n.invalid=g,n.duration=Bt,n.isMoment=y,n.weekdays=Xn,n.parseZone=$n,n.localeData=rt,n.isDuration=Et,n.monthsShort=zn,n.weekdaysMin=Kn,n.defineLocale=tt,n.updateLocale=nt,n.locales=ot,n.weekdaysShort=qn,n.normalizeUnits=V,n.relativeTimeRounding=fr,n.relativeTimeThreshold=pr,n.calendarFormat=Xt,n.prototype=Jo,n})},{}],numbro:[function(e,t,n){/*!
 * numbro.js
 * version : 1.9.3
 * author : Företagsplatsen AB
 * license : MIT
 * http://www.foretagsplatsen.se
 */
(function(){"use strict";function n(e){this._value=e}function r(e){var t,n="";for(t=0;t<e;t++)n+="0";return n}function o(e,t){var n,o,i,s,a,l,u,d;return d=e.toString(),n=d.split("e")[0],s=d.split("e")[1],o=n.split(".")[0],i=n.split(".")[1]||"",+s>0?d=o+i+r(s-i.length):(a=+o<0?"-0":"0",t>0&&(a+="."),u=r(-1*s-1),l=(u+Math.abs(o)+i).substr(0,t),d=a+l),+s>0&&t>0&&(d+="."+r(t)),d}function i(e,t,n,r){var i,s,a=Math.pow(10,t);return e.toString().indexOf("e")>-1?(s=o(e,t),"-"===s.charAt(0)&&+s>=0&&(s=s.substr(1))):s=(n(e+"e+"+t)/a).toFixed(t),r&&(i=new RegExp("0{1,"+r+"}$"),s=s.replace(i,"")),s}function s(e,t,n){var r,o=t.replace(/\{[^\{\}]*\}/g,"");return r=o.indexOf("$")>-1?l(e,S[T].currency.symbol,t,n):o.indexOf("%")>-1?d(e,t,n):o.indexOf(":")>-1?c(e,t):p(e._value,t,n)}function a(e,t){var n,r,o,i,s,a=t,l=!1;if(t.indexOf(":")>-1)e._value=h(t);else if(t===A)e._value=0;else{for("."!==S[T].delimiters.decimal&&(t=t.replace(/\./g,"").replace(S[T].delimiters.decimal,".")),n=new RegExp("[^a-zA-Z]"+S[T].abbreviations.thousand+"(?:\\)|(\\"+S[T].currency.symbol+")?(?:\\))?)?$"),r=new RegExp("[^a-zA-Z]"+S[T].abbreviations.million+"(?:\\)|(\\"+S[T].currency.symbol+")?(?:\\))?)?$"),o=new RegExp("[^a-zA-Z]"+S[T].abbreviations.billion+"(?:\\)|(\\"+S[T].currency.symbol+")?(?:\\))?)?$"),i=new RegExp("[^a-zA-Z]"+S[T].abbreviations.trillion+"(?:\\)|(\\"+S[T].currency.symbol+")?(?:\\))?)?$"),s=1;s<C.length&&!l;++s)t.indexOf(C[s])>-1?l=Math.pow(1024,s):t.indexOf(R[s])>-1&&(l=Math.pow(1e3,s));var u=t.replace(/[^0-9\.]+/g,"");""===u?e._value=NaN:(e._value=(l?l:1)*(a.match(n)?Math.pow(10,3):1)*(a.match(r)?Math.pow(10,6):1)*(a.match(o)?Math.pow(10,9):1)*(a.match(i)?Math.pow(10,12):1)*(t.indexOf("%")>-1?.01:1)*((t.split("-").length+Math.min(t.split("(").length-1,t.split(")").length-1))%2?1:-1)*Number(u),e._value=l?Math.ceil(e._value):e._value)}return e._value}function l(e,t,n,r){var o,i,s=n,a=s.indexOf("$"),l=s.indexOf("("),u=s.indexOf("+"),d=s.indexOf("-"),c="",h="";if(s.indexOf("$")===-1?"infix"===S[T].currency.position?(h=t,S[T].currency.spaceSeparated&&(h=" "+h+" ")):S[T].currency.spaceSeparated&&(c=" "):s.indexOf(" $")>-1?(c=" ",s=s.replace(" $","")):s.indexOf("$ ")>-1?(c=" ",s=s.replace("$ ","")):s=s.replace("$",""),i=p(e._value,s,r,h),n.indexOf("$")===-1)switch(S[T].currency.position){case"postfix":i.indexOf(")")>-1?(i=i.split(""),i.splice(-1,0,c+t),i=i.join("")):i=i+c+t;break;case"infix":break;case"prefix":i.indexOf("(")>-1||i.indexOf("-")>-1?(i=i.split(""),o=Math.max(l,d)+1,i.splice(o,0,t+c),i=i.join("")):i=t+c+i;break;default:throw Error('Currency position should be among ["prefix", "infix", "postfix"]')}else a<=1?i.indexOf("(")>-1||i.indexOf("+")>-1||i.indexOf("-")>-1?(i=i.split(""),o=1,(a<l||a<u||a<d)&&(o=0),i.splice(o,0,t+c),i=i.join("")):i=t+c+i:i.indexOf(")")>-1?(i=i.split(""),i.splice(-1,0,c+t),i=i.join("")):i=i+c+t;return i}function u(e,t,n,r){return l(e,t,n,r)}function d(e,t,n){var r,o="",i=100*e._value;return t.indexOf(" %")>-1?(o=" ",t=t.replace(" %","")):t=t.replace("%",""),r=p(i,t,n),r.indexOf(")")>-1?(r=r.split(""),r.splice(-1,0,o+"%"),r=r.join("")):r=r+o+"%",r}function c(e){var t=Math.floor(e._value/60/60),n=Math.floor((e._value-60*t*60)/60),r=Math.round(e._value-60*t*60-60*n);return t+":"+(n<10?"0"+n:n)+":"+(r<10?"0"+r:r)}function h(e){var t=e.split(":"),n=0;return 3===t.length?(n+=60*Number(t[0])*60,n+=60*Number(t[1]),n+=Number(t[2])):2===t.length&&(n+=60*Number(t[0]),n+=Number(t[1])),Number(n)}function f(e,t,n){var r,o,i,s=t[0],a=Math.abs(e);if(a>=n){for(r=1;r<t.length;++r)if(o=Math.pow(n,r),i=Math.pow(n,r+1),a>=o&&a<i){s=t[r],e/=o;break}s===t[0]&&(e/=Math.pow(n,t.length-1),s=t[t.length-1])}return{value:e,suffix:s}}function p(e,t,n,o){var s,a,l,u,d,c,h,p,m,g,v,w,b,y,_,C,R,M=!1,O=!1,N=!1,x="",k=!1,I=!1,D=!1,P=!1,H=!1,L="",V="",j=Math.abs(e),F="",$=!1,B=!1,W="";if(0===e&&null!==A)return A;if(!isFinite(e))return""+e;if(0===t.indexOf("{")){var U=t.indexOf("}");if(U===-1)throw Error('Format should also contain a "}"');g=t.slice(1,U),t=t.slice(U+1)}else g="";if(t.indexOf("}")===t.length-1){var Y=t.indexOf("{");if(Y===-1)throw Error('Format should also contain a "{"');v=t.slice(Y+1,-1),t=t.slice(0,Y+1)}else v="";var G;for(G=t.indexOf(".")===-1?t.match(/([0-9]+).*/):t.match(/([0-9]+)\..*/),C=null===G?-1:G[1].length,t.indexOf("-")!==-1&&($=!0),t.indexOf("(")>-1?(M=!0,t=t.slice(1,-1)):t.indexOf("+")>-1&&(O=!0,t=t.replace(/\+/g,"")),t.indexOf("a")>-1&&(p=t.split(".")[0].match(/[0-9]+/g)||["0"],p=parseInt(p[0],10),k=t.indexOf("aK")>=0,I=t.indexOf("aM")>=0,D=t.indexOf("aB")>=0,P=t.indexOf("aT")>=0,H=k||I||D||P,t.indexOf(" a")>-1?(x=" ",t=t.replace(" a","")):t=t.replace("a",""),l=Math.floor(Math.log(j)/Math.LN10)+1,d=l%3,d=0===d?3:d,p&&0!==j&&(u=Math.floor(Math.log(j)/Math.LN10)+1-p,c=3*~~((Math.min(p,l)-d)/3),j/=Math.pow(10,c),t.indexOf(".")===-1&&p>3&&(t+="[.]",y=0===u?0:3*~~(u/3)-u,y=y<0?y+3:y,t+=r(y))),Math.floor(Math.log(Math.abs(e))/Math.LN10)+1!==p&&(j>=Math.pow(10,12)&&!H||P?(x+=S[T].abbreviations.trillion,e/=Math.pow(10,12)):j<Math.pow(10,12)&&j>=Math.pow(10,9)&&!H||D?(x+=S[T].abbreviations.billion,e/=Math.pow(10,9)):j<Math.pow(10,9)&&j>=Math.pow(10,6)&&!H||I?(x+=S[T].abbreviations.million,e/=Math.pow(10,6)):(j<Math.pow(10,6)&&j>=Math.pow(10,3)&&!H||k)&&(x+=S[T].abbreviations.thousand,e/=Math.pow(10,3)))),R=0;R<E.length;++R)if(s=E[R],t.indexOf(s.marker)>-1){t.indexOf(" "+s.marker)>-1&&(L=" "),t=t.replace(L+s.marker,""),a=f(e,s.suffixes,s.scale),e=a.value,L+=a.suffix;break}if(t.indexOf("o")>-1&&(t.indexOf(" o")>-1?(V=" ",t=t.replace(" o","")):t=t.replace("o",""),S[T].ordinal&&(V+=S[T].ordinal(e))),t.indexOf("[.]")>-1&&(N=!0,t=t.replace("[.]",".")),h=e.toString().split(".")[0],m=t.split(".")[1],w=t.indexOf(","),m){if(m.indexOf("*")!==-1?F=i(e,e.toString().split(".")[1].length,n):m.indexOf("[")>-1?(m=m.replace("]",""),m=m.split("["),F=i(e,m[0].length+m[1].length,n,m[1].length)):F=i(e,m.length,n),h=F.split(".")[0],F.split(".")[1].length){var z=o?x+o:S[T].delimiters.decimal;F=z+F.split(".")[1]}else F="";N&&0===Number(F.slice(1))&&(F="")}else h=i(e,0,n);return h.indexOf("-")>-1&&(h=h.slice(1),B=!0),h.length<C&&(h=r(C-h.length)+h),w>-1&&(h=h.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+S[T].delimiters.thousands)),0===t.indexOf(".")&&(h=""),b=t.indexOf("("),_=t.indexOf("-"),W=b<_?(M&&B?"(":"")+($&&B||!M&&B?"-":""):($&&B||!M&&B?"-":"")+(M&&B?"(":""),g+W+(!B&&O&&0!==e?"+":"")+h+F+(V?V:"")+(x&&!o?x:"")+(L?L:"")+(M&&B?")":"")+v}function m(e,t){S[e]=t}function g(e){T=e;var t=S[e].defaults;t&&t.format&&y.defaultFormat(t.format),t&&t.currencyFormat&&y.defaultCurrencyFormat(t.currencyFormat)}function v(){return"undefined"!=typeof process&&void 0===process.browser&&process.title&&(0===process.title.indexOf("node")||process.title.indexOf("meteor-tool")>0||"grunt"===process.title||"gulp"===process.title)&&"undefined"!=typeof e}function w(e){var t=e.toString().split(".");return t.length<2?1:Math.pow(10,t[1].length)}function b(){var e=Array.prototype.slice.call(arguments);return e.reduce(function(e,t){var n=w(e),r=w(t);return n>r?n:r},-(1/0))}var y,_="1.9.3",C=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],R=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],M={general:{scale:1024,suffixes:R,marker:"bd"},binary:{scale:1024,suffixes:C,marker:"b"},decimal:{scale:1e3,suffixes:R,marker:"d"}},E=[M.general,M.binary,M.decimal],S={},O=S,T="en-US",A=null,N="0,0",x="0$",k="undefined"!=typeof t&&t.exports,I={delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return 1===~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$",position:"prefix"},defaults:{currencyFormat:",0000 a"},formats:{fourDigits:"0000 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00"}};y=function(e){return y.isNumbro(e)?e=e.value():0===e||"undefined"==typeof e?e=0:Number(e)||(e=y.fn.unformat(e)),new n(Number(e))},y.version=_,y.isNumbro=function(e){return e instanceof n},y.setLanguage=function(e,t){console.warn("`setLanguage` is deprecated since version 1.6.0. Use `setCulture` instead");var n=e,r=e.split("-")[0],o=null;O[n]||(Object.keys(O).forEach(function(e){o||e.split("-")[0]!==r||(o=e)}),n=o||t||"en-US"),g(n)},y.setCulture=function(e,t){var n=e,r=e.split("-")[1],o=null;S[n]||(r&&Object.keys(S).forEach(function(e){o||e.split("-")[1]!==r||(o=e)}),n=o||t||"en-US"),g(n)},y.language=function(e,t){if(console.warn("`language` is deprecated since version 1.6.0. Use `culture` instead"),!e)return T;if(e&&!t){if(!O[e])throw new Error("Unknown language : "+e);g(e)}return!t&&O[e]||m(e,t),y},y.culture=function(e,t){if(!e)return T;if(e&&!t){if(!S[e])throw new Error("Unknown culture : "+e);g(e)}return!t&&S[e]||m(e,t),y},y.languageData=function(e){if(console.warn("`languageData` is deprecated since version 1.6.0. Use `cultureData` instead"),!e)return O[T];if(!O[e])throw new Error("Unknown language : "+e);return O[e]},y.cultureData=function(e){if(!e)return S[T];if(!S[e])throw new Error("Unknown culture : "+e);return S[e]},y.culture("en-US",I),y.languages=function(){return console.warn("`languages` is deprecated since version 1.6.0. Use `cultures` instead"),O},y.cultures=function(){return S},y.zeroFormat=function(e){A="string"==typeof e?e:null},y.defaultFormat=function(e){N="string"==typeof e?e:"0.0"},y.defaultCurrencyFormat=function(e){x="string"==typeof e?e:"0$"},y.validate=function(e,t){var n,r,o,i,s,a,l,u;if("string"!=typeof e&&(e+="",console.warn&&console.warn("Numbro.js: Value is not string. It has been co-erced to: ",e)),e=e.trim(),e=e.replace(/^[+-]?/,""),e.match(/^\d+$/))return!0;if(""===e)return!1;try{l=y.cultureData(t)}catch(e){l=y.cultureData(y.culture())}return o=l.currency.symbol,s=l.abbreviations,n=l.delimiters.decimal,r="."===l.delimiters.thousands?"\\.":l.delimiters.thousands,u=e.match(/^[^\d\.\,]+/),(null===u||(e=e.substr(1),u[0]===o))&&(u=e.match(/[^\d]+$/),(null===u||(e=e.slice(0,-1),u[0]===s.thousand||u[0]===s.million||u[0]===s.billion||u[0]===s.trillion))&&(a=new RegExp(r+"{2}"),!e.match(/[^\d.,]/g)&&(i=e.split(n),!(i.length>2)&&(i.length<2?!!i[0].match(/^\d+.*\d$/)&&!i[0].match(a):""===i[0]?!i[0].match(a)&&!!i[1].match(/^\d+$/):1===i[0].length?!!i[0].match(/^\d+$/)&&!i[0].match(a)&&!!i[1].match(/^\d+$/):!!i[0].match(/^\d+.*\d$/)&&!i[0].match(a)&&!!i[1].match(/^\d+$/)))))},y.loadLanguagesInNode=function(){console.warn("`loadLanguagesInNode` is deprecated since version 1.6.0. Use `loadCulturesInNode` instead"),y.loadCulturesInNode()},y.loadCulturesInNode=function(){var t=e("./languages");for(var n in t)n&&y.culture(n,t[n])},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(e,t){if(null===this||"undefined"==typeof this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var n,r,o=this.length>>>0,i=!1;for(1<arguments.length&&(r=t,i=!0),n=0;o>n;++n)this.hasOwnProperty(n)&&(i?r=e(r,this[n],n,this):(r=this[n],i=!0));if(!i)throw new TypeError("Reduce of empty array with no initial value");return r}),y.fn=n.prototype={clone:function(){return y(this)},format:function(e,t){return s(this,e?e:N,void 0!==t?t:Math.round)},formatCurrency:function(e,t){return l(this,S[T].currency.symbol,e?e:x,void 0!==t?t:Math.round)},formatForeignCurrency:function(e,t,n){return u(this,e,t?t:x,void 0!==n?n:Math.round)},unformat:function(e){if("number"==typeof e)return e;if("string"==typeof e){var t=a(this,e);return isNaN(t)?void 0:t}},binaryByteUnits:function(){return f(this._value,M.binary.suffixes,M.binary.scale).suffix},byteUnits:function(){return f(this._value,M.general.suffixes,M.general.scale).suffix},decimalByteUnits:function(){return f(this._value,M.decimal.suffixes,M.decimal.scale).suffix},value:function(){return this._value},valueOf:function(){return this._value},set:function(e){return this._value=Number(e),this},add:function(e){function t(e,t){return e+n*t}var n=b.call(null,this._value,e);return this._value=[this._value,e].reduce(t,0)/n,this},subtract:function(e){function t(e,t){return e-n*t}var n=b.call(null,this._value,e);return this._value=[e].reduce(t,this._value*n)/n,this},multiply:function(e){function t(e,t){var n=b(e,t),r=e*n;return r*=t*n,r/=n*n}return this._value=[this._value,e].reduce(t,1),this},divide:function(e){function t(e,t){var n=b(e,t);return e*n/(t*n)}return this._value=[this._value,e].reduce(t),this},difference:function(e){return Math.abs(y(this._value).subtract(e).value())}},v()&&y.loadCulturesInNode(),k?t.exports=y:("undefined"==typeof ender&&(this.numbro=y),"function"==typeof define&&define.amd&&define([],function(){return y}))}).call("undefined"==typeof window?this:window)},{languages:1}],pikaday:[function(e,t,n){/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/dbushell/Pikaday
 */
!function(r,o){"use strict";var i;if("object"==typeof n){try{i=e("moment")}catch(e){}t.exports=o(i)}else"function"==typeof define&&define.amd?define(function(e){var t="moment";try{i=e(t)}catch(e){}return o(i)}):r.Pikaday=o(r.moment)}(this,function(e){"use strict";var t="function"==typeof e,n=!!window.addEventListener,r=window.document,o=window.setTimeout,i=function(e,t,r,o){n?e.addEventListener(t,r,!!o):e.attachEvent("on"+t,r)},s=function(e,t,r,o){n?e.removeEventListener(t,r,!!o):e.detachEvent("on"+t,r)},a=function(e,t,n){var o;r.createEvent?(o=r.createEvent("HTMLEvents"),o.initEvent(t,!0,!1),o=b(o,n),e.dispatchEvent(o)):r.createEventObject&&(o=r.createEventObject(),o=b(o,n),e.fireEvent("on"+t,o))},l=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},u=function(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")!==-1},d=function(e,t){u(e,t)||(e.className=""===e.className?t:e.className+" "+t)},c=function(e,t){e.className=l((" "+e.className+" ").replace(" "+t+" "," "))},h=function(e){return/Array/.test(Object.prototype.toString.call(e))},f=function(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())},p=function(e){var t=e.getDay();return 0===t||6===t},m=function(e){return e%4===0&&e%100!==0||e%400===0},g=function(e,t){return[31,m(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},v=function(e){f(e)&&e.setHours(0,0,0,0)},w=function(e,t){return e.getTime()===t.getTime()},b=function(e,t,n){var r,o;for(r in t)o=void 0!==e[r],o&&"object"==typeof t[r]&&null!==t[r]&&void 0===t[r].nodeName?f(t[r])?n&&(e[r]=new Date(t[r].getTime())):h(t[r])?n&&(e[r]=t[r].slice(0)):e[r]=b({},t[r],n):!n&&o||(e[r]=t[r]);return e},y=function(e){return e.month<0&&(e.year-=Math.ceil(Math.abs(e.month)/12),e.month+=12),e.month>11&&(e.year+=Math.floor(Math.abs(e.month)/12),e.month-=12),e},_={field:null,bound:void 0,position:"bottom left",reposition:!0,format:"YYYY-MM-DD",defaultDate:null,setDefaultDate:!1,firstDay:0,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,onSelect:null,onOpen:null,onClose:null,onDraw:null},C=function(e,t,n){for(t+=e.firstDay;t>=7;)t-=7;return n?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]},R=function(e){var t=[],n="false";if(e.isEmpty){if(!e.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';t.push("is-outside-current-month")}return e.isDisabled&&t.push("is-disabled"),e.isToday&&t.push("is-today"),e.isSelected&&(t.push("is-selected"),n="true"),e.isInRange&&t.push("is-inrange"),e.isStartRange&&t.push("is-startrange"),e.isEndRange&&t.push("is-endrange"),'<td data-day="'+e.day+'" class="'+t.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+e.year+'" data-pika-month="'+e.month+'" data-pika-day="'+e.day+'">'+e.day+"</button></td>"},M=function(e,t,n){var r=new Date(n,0,1),o=Math.ceil(((new Date(n,t,e)-r)/864e5+r.getDay()+1)/7);return'<td class="pika-week">'+o+"</td>"},E=function(e,t){return"<tr>"+(t?e.reverse():e).join("")+"</tr>"},S=function(e){return"<tbody>"+e.join("")+"</tbody>"},O=function(e){var t,n=[];for(e.showWeekNumber&&n.push("<th></th>"),t=0;t<7;t++)n.push('<th scope="col"><abbr title="'+C(e,t)+'">'+C(e,t,!0)+"</abbr></th>");return"<thead><tr>"+(e.isRTL?n.reverse():n).join("")+"</tr></thead>"},T=function(e,t,n,r,o,i){var s,a,l,u,d,c=e._o,f=n===c.minYear,p=n===c.maxYear,m='<div id="'+i+'" class="pika-title" role="heading" aria-live="assertive">',g=!0,v=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===o?s-t:12+s-t)+'"'+(s===r?' selected="selected"':"")+(f&&s<c.minMonth||p&&s>c.maxMonth?'disabled="disabled"':"")+">"+c.i18n.months[s]+"</option>");for(u='<div class="pika-label">'+c.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",h(c.yearRange)?(s=c.yearRange[0],a=c.yearRange[1]+1):(s=n-c.yearRange,a=1+n+c.yearRange),l=[];s<a&&s<=c.maxYear;s++)s>=c.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return d='<div class="pika-label">'+n+c.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",m+=c.showMonthAfterYear?d+u:u+d,f&&(0===r||c.minMonth>=r)&&(g=!1),p&&(11===r||c.maxMonth<=r)&&(v=!1),0===t&&(m+='<button class="pika-prev'+(g?"":" is-disabled")+'" type="button">'+c.i18n.previousMonth+"</button>"),t===e._o.numberOfMonths-1&&(m+='<button class="pika-next'+(v?"":" is-disabled")+'" type="button">'+c.i18n.nextMonth+"</button>"),m+="</div>"},A=function(e,t,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+O(e)+S(t)+"</table>"},N=function(s){var a=this,l=a.config(s);a._onMouseDown=function(e){if(a._v){e=e||window.event;var t=e.target||e.srcElement;if(t)if(u(t,"is-disabled")||(!u(t,"pika-button")||u(t,"is-empty")||u(t.parentNode,"is-disabled")?u(t,"pika-prev")?a.prevMonth():u(t,"pika-next")&&a.nextMonth():(a.setDate(new Date(t.getAttribute("data-pika-year"),t.getAttribute("data-pika-month"),t.getAttribute("data-pika-day"))),l.bound&&o(function(){a.hide(),l.field&&l.field.blur()},100))),u(t,"pika-select"))a._c=!0;else{if(!e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()}}},a._onChange=function(e){e=e||window.event;var t=e.target||e.srcElement;t&&(u(t,"pika-select-month")?a.gotoMonth(t.value):u(t,"pika-select-year")&&a.gotoYear(t.value))},a._onKeyChange=function(e){if(e=e||window.event,a.isVisible())switch(e.keyCode){case 13:case 27:l.field.blur();break;case 37:e.preventDefault(),a.adjustDate("subtract",1);break;case 38:a.adjustDate("subtract",7);break;case 39:a.adjustDate("add",1);break;case 40:a.adjustDate("add",7)}},a._onInputChange=function(n){var r;n.firedBy!==a&&(t?(r=e(l.field.value,l.format,l.formatStrict),r=r&&r.isValid()?r.toDate():null):r=new Date(Date.parse(l.field.value)),f(r)&&a.setDate(r),a._v||a.show())},a._onInputFocus=function(){a.show()},a._onInputClick=function(){a.show()},a._onInputBlur=function(){var e=r.activeElement;do if(u(e,"pika-single"))return;while(e=e.parentNode);a._c||(a._b=o(function(){a.hide()},50)),a._c=!1},a._onClick=function(e){e=e||window.event;var t=e.target||e.srcElement,r=t;if(t){!n&&u(t,"pika-select")&&(t.onchange||(t.setAttribute("onchange","return;"),i(t,"change",a._onChange)));do if(u(r,"pika-single")||r===l.trigger)return;while(r=r.parentNode);a._v&&t!==l.trigger&&r!==l.trigger&&a.hide()}},a.el=r.createElement("div"),a.el.className="pika-single"+(l.isRTL?" is-rtl":"")+(l.theme?" "+l.theme:""),i(a.el,"mousedown",a._onMouseDown,!0),i(a.el,"touchend",a._onMouseDown,!0),i(a.el,"change",a._onChange),i(r,"keydown",a._onKeyChange),l.field&&(l.container?l.container.appendChild(a.el):l.bound?r.body.appendChild(a.el):l.field.parentNode.insertBefore(a.el,l.field.nextSibling),i(l.field,"change",a._onInputChange),l.defaultDate||(t&&l.field.value?l.defaultDate=e(l.field.value,l.format).toDate():l.defaultDate=new Date(Date.parse(l.field.value)),l.setDefaultDate=!0));var d=l.defaultDate;f(d)?l.setDefaultDate?a.setDate(d,!0):a.gotoDate(d):a.gotoDate(new Date),l.bound?(this.hide(),a.el.className+=" is-bound",i(l.trigger,"click",a._onInputClick),i(l.trigger,"focus",a._onInputFocus),i(l.trigger,"blur",a._onInputBlur)):this.show()};return N.prototype={config:function(e){this._o||(this._o=b({},_,!0));var t=b(this._o,e,!0);t.isRTL=!!t.isRTL,t.field=t.field&&t.field.nodeName?t.field:null,t.theme="string"==typeof t.theme&&t.theme?t.theme:null,t.bound=!!(void 0!==t.bound?t.field&&t.bound:t.field),t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field,t.disableWeekends=!!t.disableWeekends,t.disableDayFn="function"==typeof t.disableDayFn?t.disableDayFn:null;var n=parseInt(t.numberOfMonths,10)||1;if(t.numberOfMonths=n>4?4:n,f(t.minDate)||(t.minDate=!1),f(t.maxDate)||(t.maxDate=!1),t.minDate&&t.maxDate&&t.maxDate<t.minDate&&(t.maxDate=t.minDate=!1),t.minDate&&this.setMinDate(t.minDate),t.maxDate&&this.setMaxDate(t.maxDate),h(t.yearRange)){var r=(new Date).getFullYear()-10;t.yearRange[0]=parseInt(t.yearRange[0],10)||r,t.yearRange[1]=parseInt(t.yearRange[1],10)||r}else t.yearRange=Math.abs(parseInt(t.yearRange,10))||_.yearRange,t.yearRange>100&&(t.yearRange=100);return t},toString:function(n){return f(this._d)?t?e(this._d).format(n||this._o.format):this._d.toDateString():""},getMoment:function(){return t?e(this._d):null},setMoment:function(n,r){t&&e.isMoment(n)&&this.setDate(n.toDate(),r)},getDate:function(){return f(this._d)?new Date(this._d.getTime()):new Date},setDate:function(e,t){if(!e)return this._d=null,this._o.field&&(this._o.field.value="",a(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof e&&(e=new Date(Date.parse(e))),f(e)){var n=this._o.minDate,r=this._o.maxDate;f(n)&&e<n?e=n:f(r)&&e>r&&(e=r),this._d=new Date(e.getTime()),v(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),a(this._o.field,"change",{firedBy:this})),t||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())}},gotoDate:function(e){var t=!0;if(f(e)){if(this.calendars){var n=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),o=e.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),t=o<n.getTime()||r.getTime()<o}t&&(this.calendars=[{month:e.getMonth(),year:e.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(n,r){var o,i=this.getDate(),s=24*parseInt(r)*60*60*1e3;"add"===n?o=new Date(i.valueOf()+s):"subtract"===n&&(o=new Date(i.valueOf()-s)),t&&("add"===n?o=e(i).add(r,"days").toDate():"subtract"===n&&(o=e(i).subtract(r,"days").toDate())),this.setDate(o)},adjustCalendars:function(){this.calendars[0]=y(this.calendars[0]);for(var e=1;e<this._o.numberOfMonths;e++)this.calendars[e]=y({month:this.calendars[0].month+e,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){isNaN(e)||(this.calendars[0].month=parseInt(e,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(e){isNaN(e)||(this.calendars[0].year=parseInt(e,10),this.adjustCalendars())},setMinDate:function(e){e instanceof Date?(v(e),this._o.minDate=e,this._o.minYear=e.getFullYear(),this._o.minMonth=e.getMonth()):(this._o.minDate=_.minDate,this._o.minYear=_.minYear,this._o.minMonth=_.minMonth,this._o.startRange=_.startRange),this.draw()},setMaxDate:function(e){e instanceof Date?(v(e),this._o.maxDate=e,this._o.maxYear=e.getFullYear(),this._o.maxMonth=e.getMonth()):(this._o.maxDate=_.maxDate,this._o.maxYear=_.maxYear,this._o.maxMonth=_.maxMonth,this._o.endRange=_.endRange),this.draw()},setStartRange:function(e){this._o.startRange=e},setEndRange:function(e){this._o.endRange=e},draw:function(e){if(this._v||e){var t,n=this._o,r=n.minYear,i=n.maxYear,s=n.minMonth,a=n.maxMonth,l="";this._y<=r&&(this._y=r,!isNaN(s)&&this._m<s&&(this._m=s)),this._y>=i&&(this._y=i,!isNaN(a)&&this._m>a&&(this._m=a)),t="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2);for(var u=0;u<n.numberOfMonths;u++)l+='<div class="pika-lendar">'+T(this,u,this.calendars[u].year,this.calendars[u].month,this.calendars[0].year,t)+this.render(this.calendars[u].year,this.calendars[u].month,t)+"</div>";this.el.innerHTML=l,n.bound&&"hidden"!==n.field.type&&o(function(){n.trigger.focus()},1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),n.bound&&n.field.setAttribute("aria-label","Use the arrow keys to pick a date")}},adjustPosition:function(){var e,t,n,o,i,s,a,l,u,d;if(!this._o.container){if(this.el.style.position="absolute",e=this._o.trigger,t=e,n=this.el.offsetWidth,o=this.el.offsetHeight,i=window.innerWidth||r.documentElement.clientWidth,s=window.innerHeight||r.documentElement.clientHeight,a=window.pageYOffset||r.body.scrollTop||r.documentElement.scrollTop,"function"==typeof e.getBoundingClientRect)d=e.getBoundingClientRect(),l=d.left+window.pageXOffset,u=d.bottom+window.pageYOffset;else for(l=t.offsetLeft,u=t.offsetTop+t.offsetHeight;t=t.offsetParent;)l+=t.offsetLeft,u+=t.offsetTop;(this._o.reposition&&l+n>i||this._o.position.indexOf("right")>-1&&l-n+e.offsetWidth>0)&&(l=l-n+e.offsetWidth),(this._o.reposition&&u+o>s+a||this._o.position.indexOf("top")>-1&&u-o-e.offsetHeight>0)&&(u=u-o-e.offsetHeight),this.el.style.left=l+"px",this.el.style.top=u+"px"}},render:function(e,t,n){var r=this._o,o=new Date,i=g(e,t),s=new Date(e,t,1).getDay(),a=[],l=[];v(o),r.firstDay>0&&(s-=r.firstDay,s<0&&(s+=7));for(var u=0===t?11:t-1,d=11===t?0:t+1,c=0===t?e-1:e,h=11===t?e+1:e,m=g(c,u),b=i+s,y=b;y>7;)y-=7;b+=7-y;for(var _=0,C=0;_<b;_++){var S=new Date(e,t,1+(_-s)),O=!!f(this._d)&&w(S,this._d),T=w(S,o),N=_<s||_>=i+s,x=1+(_-s),k=t,I=e,D=r.startRange&&w(r.startRange,S),P=r.endRange&&w(r.endRange,S),H=r.startRange&&r.endRange&&r.startRange<S&&S<r.endRange,L=r.minDate&&S<r.minDate||r.maxDate&&S>r.maxDate||r.disableWeekends&&p(S)||r.disableDayFn&&r.disableDayFn(S);N&&(_<s?(x=m+x,k=u,I=c):(x-=i,k=d,I=h));var V={day:x,month:k,year:I,isSelected:O,isToday:T,isDisabled:L,isEmpty:N,isStartRange:D,isEndRange:P,isInRange:H,showDaysInNextAndPreviousMonths:r.showDaysInNextAndPreviousMonths};l.push(R(V)),7===++C&&(r.showWeekNumber&&l.unshift(M(_-s,t,e)),a.push(E(l,r.isRTL)),l=[],C=0)}return A(r,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(c(this.el,"is-hidden"),this._v=!0,this.draw(),this._o.bound&&(i(r,"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var e=this._v;e!==!1&&(this._o.bound&&s(r,"click",this._onClick),this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto",d(this.el,"is-hidden"),this._v=!1,void 0!==e&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){this.hide(),s(this.el,"mousedown",this._onMouseDown,!0),s(this.el,"touchend",this._onMouseDown,!0),s(this.el,"change",this._onChange),this._o.field&&(s(this._o.field,"change",this._onInputChange),this._o.bound&&(s(this._o.trigger,"click",this._onInputClick),s(this._o.trigger,"focus",this._onInputFocus),s(this._o.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},N})},{moment:"moment"}],zeroclipboard:[function(e,t,n){/*!
 * ZeroClipboard
 * The ZeroClipboard library provides an easy way to copy text to the clipboard using an invisible Adobe Flash movie and a JavaScript interface
 * Copyright (c) 2009-2016 Jon Rohan, James M. Greene
 * Licensed MIT
 * http://zeroclipboard.org/
 * v2.3.0
 */
!function(e,n){"use strict";var r,o,i,s=e,a=s.document,l=s.navigator,u=s.setTimeout,d=s.clearTimeout,c=s.setInterval,h=s.clearInterval,f=s.getComputedStyle,p=s.encodeURIComponent,m=s.ActiveXObject,g=s.Error,v=s.Number.parseInt||s.parseInt,w=s.Number.parseFloat||s.parseFloat,b=s.Number.isNaN||s.isNaN,y=s.Date.now,_=s.Object.keys,C=s.Object.prototype.hasOwnProperty,R=s.Array.prototype.slice,M=function(){var e=function(e){return e};if("function"==typeof s.wrap&&"function"==typeof s.unwrap)try{var t=a.createElement("div"),n=s.unwrap(t);1===t.nodeType&&n&&1===n.nodeType&&(e=s.unwrap)}catch(e){}return e}(),E=function(e){return R.call(e,0)},S=function(){var e,t,r,o,i,s,a=E(arguments),l=a[0]||{};for(e=1,t=a.length;e<t;e++)if(null!=(r=a[e]))for(o in r)C.call(r,o)&&(i=l[o],s=r[o],l!==s&&s!==n&&(l[o]=s));return l},O=function(e){var t,n,r,o;if("object"!=typeof e||null==e||"number"==typeof e.nodeType)t=e;else if("number"==typeof e.length)for(t=[],n=0,r=e.length;n<r;n++)C.call(e,n)&&(t[n]=O(e[n]));else{t={};for(o in e)C.call(e,o)&&(t[o]=O(e[o]))}return t},T=function(e,t){for(var n={},r=0,o=t.length;r<o;r++)t[r]in e&&(n[t[r]]=e[t[r]]);return n},A=function(e,t){var n={};for(var r in e)t.indexOf(r)===-1&&(n[r]=e[r]);return n},N=function(e){if(e)for(var t in e)C.call(e,t)&&delete e[t];return e},x=function(e,t){if(e&&1===e.nodeType&&e.ownerDocument&&t&&(1===t.nodeType&&t.ownerDocument&&t.ownerDocument===e.ownerDocument||9===t.nodeType&&!t.ownerDocument&&t===e.ownerDocument))do{if(e===t)return!0;e=e.parentNode}while(e);return!1},k=function(e){var t;return"string"==typeof e&&e&&(t=e.split("#")[0].split("?")[0],t=e.slice(0,e.lastIndexOf("/")+1)),t},I=function(e){var t,n;return"string"==typeof e&&e&&(n=e.match(/^(?:|[^:@]*@|.+\)@(?=http[s]?|file)|.+?\s+(?: at |@)(?:[^:\(]+ )*[\(]?)((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/),n&&n[1]?t=n[1]:(n=e.match(/\)@((?:http[s]?|file):\/\/[\/]?.+?\/[^:\)]*?)(?::\d+)(?::\d+)?/),n&&n[1]&&(t=n[1]))),t},D=function(){var e,t;try{throw new g}catch(e){t=e}return t&&(e=t.sourceURL||t.fileName||I(t.stack)),e},P=function(){var e,t,r;if(a.currentScript&&(e=a.currentScript.src))return e;if(t=a.getElementsByTagName("script"),1===t.length)return t[0].src||n;if("readyState"in(t[0]||document.createElement("script")))for(r=t.length;r--;)if("interactive"===t[r].readyState&&(e=t[r].src))return e;return"loading"===a.readyState&&(e=t[t.length-1].src)?e:(e=D())?e:n},H=function(){var e,t,r,o=a.getElementsByTagName("script");for(e=o.length;e--;){if(!(r=o[e].src)){t=null;break}if(r=k(r),null==t)t=r;else if(t!==r){t=null;break}}return t||n},L=function(){var e=k(P())||H()||"";return e+"ZeroClipboard.swf"},V=function(){var e=/win(dows|[\s]?(nt|me|ce|xp|vista|[\d]+))/i;return!!l&&(e.test(l.appVersion||"")||e.test(l.platform||"")||(l.userAgent||"").indexOf("Windows")!==-1)},j=function(){return null==s.opener&&(!!s.top&&s!=s.top||!!s.parent&&s!=s.parent)}(),F="html"===a.documentElement.nodeName,$={bridge:null,version:"0.0.0",pluginType:"unknown",sandboxed:null,disabled:null,outdated:null,insecure:null,unavailable:null,degraded:null,deactivated:null,overdue:null,ready:null},B="11.0.0",W={},U={},Y=null,G=0,z=0,X={ready:"Flash communication is established",error:{"flash-sandboxed":"Attempting to run Flash in a sandboxed iframe, which is impossible","flash-disabled":"Flash is disabled or not installed. May also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-outdated":"Flash is too outdated to support ZeroClipboard","flash-insecure":"Flash will be unable to communicate due to a protocol mismatch between your `swfPath` configuration and the page","flash-unavailable":"Flash is unable to communicate bidirectionally with JavaScript","flash-degraded":"Flash is unable to preserve data fidelity when communicating with JavaScript","flash-deactivated":"Flash is too outdated for your browser and/or is configured as click-to-activate.\nThis may also mean that the ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity.\nMay also be attempting to run Flash in a sandboxed iframe, which is impossible.","flash-overdue":"Flash communication was established but NOT within the acceptable time limit","version-mismatch":"ZeroClipboard JS version number does not match ZeroClipboard SWF version number","clipboard-error":"At least one error was thrown while ZeroClipboard was attempting to inject your data into the clipboard","config-mismatch":"ZeroClipboard configuration does not match Flash's reality","swf-not-found":"The ZeroClipboard SWF object could not be loaded, so please check your `swfPath` configuration and/or network connectivity","browser-unsupported":"The browser does not support the required HTML DOM and JavaScript features"}},q=["flash-unavailable","flash-degraded","flash-overdue","version-mismatch","config-mismatch","clipboard-error"],K=["flash-sandboxed","flash-disabled","flash-outdated","flash-insecure","flash-unavailable","flash-degraded","flash-deactivated","flash-overdue"],Q=new RegExp("^flash-("+K.map(function(e){return e.replace(/^flash-/,"")}).join("|")+")$"),Z=new RegExp("^flash-("+K.filter(function(e){return"flash-disabled"!==e}).map(function(e){return e.replace(/^flash-/,"")}).join("|")+")$"),J={swfPath:L(),trustedDomains:s.location.host?[s.location.host]:[],cacheBust:!0,forceEnhancedClipboard:!1,flashLoadTimeout:3e4,autoActivate:!0,bubbleEvents:!0,fixLineEndings:!0,containerId:"global-zeroclipboard-html-bridge",containerClass:"global-zeroclipboard-container",swfObjectId:"global-zeroclipboard-flash-bridge",hoverClass:"zeroclipboard-is-hover",activeClass:"zeroclipboard-is-active",forceHandCursor:!1,title:null,zIndex:999999999},ee=function(e){"object"!=typeof e||!e||"length"in e||_(e).forEach(function(t){if(/^(?:forceHandCursor|title|zIndex|bubbleEvents|fixLineEndings)$/.test(t))J[t]=e[t];else if(null==$.bridge)if("containerId"===t||"swfObjectId"===t){if(!ve(e[t]))throw new Error("The specified `"+t+"` value is not valid as an HTML4 Element ID");J[t]=e[t]}else J[t]=e[t]});{if("string"!=typeof e||!e)return O(J);if(C.call(J,e))return J[e]}},te=function(){return Qe(),{browser:S(T(l,["userAgent","platform","appName","appVersion"]),{isSupported:ne()}),flash:A($,["bridge"]),zeroclipboard:{version:Je.version,config:Je.config()}}},ne=function(){return!!(a.addEventListener&&s.Object.keys&&s.Array.prototype.map)},re=function(){return!!($.sandboxed||$.disabled||$.outdated||$.unavailable||$.degraded||$.deactivated)},oe=function(e,t){var o,i,s,a={};if("string"==typeof e&&e?s=e.toLowerCase().split(/\s+/):"object"!=typeof e||!e||"length"in e||"undefined"!=typeof t||_(e).forEach(function(t){var n=e[t];"function"==typeof n&&Je.on(t,n)}),s&&s.length&&t){for(o=0,i=s.length;o<i;o++)e=s[o].replace(/^on/,""),a[e]=!0,W[e]||(W[e]=[]),W[e].push(t);if(a.ready&&$.ready&&Je.emit({type:"ready"}),a.error){for(ne()||Je.emit({type:"error",name:"browser-unsupported"}),o=0,i=K.length;o<i;o++)if($[K[o].replace(/^flash-/,"")]===!0){Je.emit({type:"error",name:K[o]});break}r!==n&&Je.version!==r&&Je.emit({type:"error",name:"version-mismatch",jsVersion:Je.version,swfVersion:r})}}return Je},ie=function(e,t){var n,r,o,i,s;if(0===arguments.length?i=_(W):"string"==typeof e&&e?i=e.toLowerCase().split(/\s+/):"object"!=typeof e||!e||"length"in e||"undefined"!=typeof t||_(e).forEach(function(t){var n=e[t];"function"==typeof n&&Je.off(t,n)}),i&&i.length)for(n=0,r=i.length;n<r;n++)if(e=i[n].replace(/^on/,""),s=W[e],s&&s.length)if(t)for(o=s.indexOf(t);o!==-1;)s.splice(o,1),o=s.indexOf(t,o);else s.length=0;return Je},se=function(e){var t;return t="string"==typeof e&&e?O(W[e])||null:O(W)},ae=function(e){var t,n,r;if(e=we(e),e&&!Ee(e))return"ready"===e.type&&$.overdue===!0?Je.emit({type:"error",name:"flash-overdue"}):(t=S({},e),Re.call(this,t),"copy"===e.type&&(r=De(U),n=r.data,Y=r.formatMap),n)},le=function(){var e=J.swfPath||"",t=e.slice(0,2),n=e.slice(0,e.indexOf("://")+1);return"\\\\"===t?"file:":"//"===t||""===n?s.location.protocol:n},ue=function(){var e,t,n=$.sandboxed;return ne()?(Qe(),"boolean"!=typeof $.ready&&($.ready=!1),void($.sandboxed!==n&&$.sandboxed===!0?($.ready=!1,Je.emit({type:"error",name:"flash-sandboxed"})):Je.isFlashUnusable()||null!==$.bridge||(t=le(),t&&t!==s.location.protocol?Je.emit({type:"error",name:"flash-insecure"}):(e=J.flashLoadTimeout,"number"==typeof e&&e>=0&&(G=u(function(){"boolean"!=typeof $.deactivated&&($.deactivated=!0),$.deactivated===!0&&Je.emit({type:"error",name:"flash-deactivated"})},e)),$.overdue=!1,ke())))):($.ready=!1,void Je.emit({type:"error",name:"browser-unsupported"}))},de=function(){Je.clearData(),Je.blur(),Je.emit("destroy"),Ie(),Je.off()},ce=function(e,t){var n;if("object"==typeof e&&e&&"undefined"==typeof t)n=e,Je.clearData();else{if("string"!=typeof e||!e)return;n={},n[e]=t}for(var r in n)"string"==typeof r&&r&&C.call(n,r)&&"string"==typeof n[r]&&n[r]&&(U[r]=Ke(n[r]))},he=function(e){"undefined"==typeof e?(N(U),Y=null):"string"==typeof e&&C.call(U,e)&&delete U[e]},fe=function(e){return"undefined"==typeof e?O(U):"string"==typeof e&&C.call(U,e)?U[e]:void 0},pe=function(e){if(e&&1===e.nodeType){o&&(Be(o,J.activeClass),o!==e&&Be(o,J.hoverClass)),o=e,$e(e,J.hoverClass);var t=e.getAttribute("title")||J.title;if("string"==typeof t&&t){var n=Ne($.bridge);n&&n.setAttribute("title",t)}var r=J.forceHandCursor===!0||"pointer"===We(e,"cursor");Xe(r),ze()}},me=function(){var e=Ne($.bridge);e&&(e.removeAttribute("title"),e.style.left="0px",e.style.top="-9999px",e.style.width="1px",e.style.height="1px"),o&&(Be(o,J.hoverClass),Be(o,J.activeClass),o=null)},ge=function(){return o||null},ve=function(e){return"string"==typeof e&&e&&/^[A-Za-z][A-Za-z0-9_:\-\.]*$/.test(e)},we=function(e){var t;if("string"==typeof e&&e?(t=e,e={}):"object"==typeof e&&e&&"string"==typeof e.type&&e.type&&(t=e.type),t){t=t.toLowerCase(),!e.target&&(/^(copy|aftercopy|_click)$/.test(t)||"error"===t&&"clipboard-error"===e.name)&&(e.target=i),S(e,{type:t,target:e.target||o||null,relatedTarget:e.relatedTarget||null,currentTarget:$&&$.bridge||null,timeStamp:e.timeStamp||y()||null});var n=X[e.type];return"error"===e.type&&e.name&&n&&(n=n[e.name]),n&&(e.message=n),"ready"===e.type&&S(e,{target:null,version:$.version}),"error"===e.type&&(Q.test(e.name)&&S(e,{target:null,minimumVersion:B}),Z.test(e.name)&&S(e,{version:$.version}),"flash-insecure"===e.name&&S(e,{pageProtocol:s.location.protocol,swfProtocol:le()})),"copy"===e.type&&(e.clipboardData={setData:Je.setData,clearData:Je.clearData}),"aftercopy"===e.type&&(e=Pe(e,Y)),e.target&&!e.relatedTarget&&(e.relatedTarget=be(e.target)),ye(e)}},be=function(e){var t=e&&e.getAttribute&&e.getAttribute("data-clipboard-target");return t?a.getElementById(t):null},ye=function(e){if(e&&/^_(?:click|mouse(?:over|out|down|up|move))$/.test(e.type)){var t=e.target,r="_mouseover"===e.type&&e.relatedTarget?e.relatedTarget:n,o="_mouseout"===e.type&&e.relatedTarget?e.relatedTarget:n,i=Ue(t),l=s.screenLeft||s.screenX||0,u=s.screenTop||s.screenY||0,d=a.body.scrollLeft+a.documentElement.scrollLeft,c=a.body.scrollTop+a.documentElement.scrollTop,h=i.left+("number"==typeof e._stageX?e._stageX:0),f=i.top+("number"==typeof e._stageY?e._stageY:0),p=h-d,m=f-c,g=l+p,v=u+m,w="number"==typeof e.movementX?e.movementX:0,b="number"==typeof e.movementY?e.movementY:0;delete e._stageX,delete e._stageY,S(e,{srcElement:t,fromElement:r,toElement:o,screenX:g,screenY:v,pageX:h,pageY:f,clientX:p,clientY:m,x:p,y:m,movementX:w,movementY:b,offsetX:0,offsetY:0,layerX:0,layerY:0})}return e},_e=function(e){var t=e&&"string"==typeof e.type&&e.type||"";return!/^(?:(?:before)?copy|destroy)$/.test(t)},Ce=function(e,t,n,r){r?u(function(){e.apply(t,n)},0):e.apply(t,n)},Re=function(e){if("object"==typeof e&&e&&e.type){var t=_e(e),n=W["*"]||[],r=W[e.type]||[],o=n.concat(r);if(o&&o.length){var i,a,l,u,d,c=this;for(i=0,a=o.length;i<a;i++)l=o[i],u=c,"string"==typeof l&&"function"==typeof s[l]&&(l=s[l]),"object"==typeof l&&l&&"function"==typeof l.handleEvent&&(u=l,l=l.handleEvent),"function"==typeof l&&(d=S({},e),Ce(l,u,[d],t))}return this}},Me=function(e){var t=null;return(j===!1||e&&"error"===e.type&&e.name&&q.indexOf(e.name)!==-1)&&(t=!1),t},Ee=function(e){var t=e.target||o||null,n="swf"===e._source;switch(delete e._source,e.type){case"error":var s="flash-sandboxed"===e.name||Me(e);"boolean"==typeof s&&($.sandboxed=s),"browser-unsupported"===e.name?S($,{disabled:!1,outdated:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:!1,ready:!1}):K.indexOf(e.name)!==-1?S($,{disabled:"flash-disabled"===e.name,outdated:"flash-outdated"===e.name,insecure:"flash-insecure"===e.name,unavailable:"flash-unavailable"===e.name,degraded:"flash-degraded"===e.name,deactivated:"flash-deactivated"===e.name,overdue:"flash-overdue"===e.name,ready:!1}):"version-mismatch"===e.name&&(r=e.swfVersion,S($,{disabled:!1,outdated:!1,insecure:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:!1,ready:!1})),Ge();break;case"ready":r=e.swfVersion;var a=$.deactivated===!0;S($,{sandboxed:!1,disabled:!1,outdated:!1,insecure:!1,unavailable:!1,degraded:!1,deactivated:!1,overdue:a,ready:!a}),Ge();break;case"beforecopy":i=t;break;case"copy":var l,u,d=e.relatedTarget;!U["text/html"]&&!U["text/plain"]&&d&&(u=d.value||d.outerHTML||d.innerHTML)&&(l=d.value||d.textContent||d.innerText)?(e.clipboardData.clearData(),e.clipboardData.setData("text/plain",l),u!==l&&e.clipboardData.setData("text/html",u)):!U["text/plain"]&&e.target&&(l=e.target.getAttribute("data-clipboard-text"))&&(e.clipboardData.clearData(),e.clipboardData.setData("text/plain",l));break;case"aftercopy":Se(e),Je.clearData(),t&&t!==Fe()&&t.focus&&t.focus();break;case"_mouseover":Je.focus(t),J.bubbleEvents===!0&&n&&(t&&t!==e.relatedTarget&&!x(e.relatedTarget,t)&&Oe(S({},e,{type:"mouseenter",bubbles:!1,cancelable:!1})),Oe(S({},e,{type:"mouseover"})));break;case"_mouseout":Je.blur(),J.bubbleEvents===!0&&n&&(t&&t!==e.relatedTarget&&!x(e.relatedTarget,t)&&Oe(S({},e,{type:"mouseleave",bubbles:!1,cancelable:!1})),Oe(S({},e,{type:"mouseout"})));break;case"_mousedown":$e(t,J.activeClass),J.bubbleEvents===!0&&n&&Oe(S({},e,{type:e.type.slice(1)}));break;case"_mouseup":Be(t,J.activeClass),J.bubbleEvents===!0&&n&&Oe(S({},e,{type:e.type.slice(1)}));break;case"_click":i=null,J.bubbleEvents===!0&&n&&Oe(S({},e,{type:e.type.slice(1)}));break;case"_mousemove":J.bubbleEvents===!0&&n&&Oe(S({},e,{type:e.type.slice(1)}))}if(/^_(?:click|mouse(?:over|out|down|up|move))$/.test(e.type))return!0},Se=function(e){if(e.errors&&e.errors.length>0){var t=O(e);S(t,{type:"error",name:"clipboard-error"}),delete t.success,u(function(){Je.emit(t)},0)}},Oe=function(e){if(e&&"string"==typeof e.type&&e){var t,n=e.target||null,r=n&&n.ownerDocument||a,o={view:r.defaultView||s,canBubble:!0,cancelable:!0,detail:"click"===e.type?1:0,button:"number"==typeof e.which?e.which-1:"number"==typeof e.button?e.button:r.createEvent?0:1},i=S(o,e);n&&r.createEvent&&n.dispatchEvent&&(i=[i.type,i.canBubble,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget],t=r.createEvent("MouseEvents"),t.initMouseEvent&&(t.initMouseEvent.apply(t,i),t._source="js",n.dispatchEvent(t)))}},Te=function(){var e=J.flashLoadTimeout;if("number"==typeof e&&e>=0){var t=Math.min(1e3,e/10),n=J.swfObjectId+"_fallbackContent";z=c(function(){var e=a.getElementById(n);Ye(e)&&(Ge(),$.deactivated=null,Je.emit({type:"error",name:"swf-not-found"}))},t)}},Ae=function(){var e=a.createElement("div");return e.id=J.containerId,e.className=J.containerClass,e.style.position="absolute",e.style.left="0px",e.style.top="-9999px",e.style.width="1px",e.style.height="1px",e.style.zIndex=""+qe(J.zIndex),e},Ne=function(e){for(var t=e&&e.parentNode;t&&"OBJECT"===t.nodeName&&t.parentNode;)t=t.parentNode;return t||null},xe=function(e){return"string"==typeof e&&e?e.replace(/["&'<>]/g,function(e){switch(e){case'"':return"&quot;";case"&":return"&amp;";case"'":return"&apos;";case"<":return"&lt;";case">":return"&gt;";default:return e}}):e},ke=function(){var e,t=$.bridge,n=Ne(t);if(!t){var r=je(s.location.host,J),o="never"===r?"none":"all",i=Le(S({jsVersion:Je.version},J)),l=J.swfPath+He(J.swfPath,J);F&&(l=xe(l)),n=Ae();var u=a.createElement("div");n.appendChild(u),a.body.appendChild(n);var d=a.createElement("div"),c="activex"===$.pluginType;d.innerHTML='<object id="'+J.swfObjectId+'" name="'+J.swfObjectId+'" width="100%" height="100%" '+(c?'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"':'type="application/x-shockwave-flash" data="'+l+'"')+">"+(c?'<param name="movie" value="'+l+'"/>':"")+'<param name="allowScriptAccess" value="'+r+'"/><param name="allowNetworking" value="'+o+'"/><param name="menu" value="false"/><param name="wmode" value="transparent"/><param name="flashvars" value="'+i+'"/><div id="'+J.swfObjectId+'_fallbackContent">&nbsp;</div></object>',t=d.firstChild,d=null,M(t).ZeroClipboard=Je,n.replaceChild(t,u),Te()}return t||(t=a[J.swfObjectId],t&&(e=t.length)&&(t=t[e-1]),!t&&n&&(t=n.firstChild)),$.bridge=t||null,t},Ie=function(){var e=$.bridge;if(e){var t=Ne(e);t&&("activex"===$.pluginType&&"readyState"in e?(e.style.display="none",function n(){if(4===e.readyState){for(var r in e)"function"==typeof e[r]&&(e[r]=null);e.parentNode&&e.parentNode.removeChild(e),t.parentNode&&t.parentNode.removeChild(t)}else u(n,10)}()):(e.parentNode&&e.parentNode.removeChild(e),t.parentNode&&t.parentNode.removeChild(t))),Ge(),$.ready=null,$.bridge=null,$.deactivated=null,$.insecure=null,r=n}},De=function(e){var t={},n={};if("object"==typeof e&&e){for(var r in e)if(r&&C.call(e,r)&&"string"==typeof e[r]&&e[r])switch(r.toLowerCase()){case"text/plain":case"text":case"air:text":case"flash:text":t.text=e[r],n.text=r;break;case"text/html":case"html":case"air:html":case"flash:html":t.html=e[r],n.html=r;break;case"application/rtf":case"text/rtf":case"rtf":case"richtext":case"air:rtf":case"flash:rtf":t.rtf=e[r],n.rtf=r}return{data:t,formatMap:n}}},Pe=function(e,t){if("object"!=typeof e||!e||"object"!=typeof t||!t)return e;var n={};for(var r in e)if(C.call(e,r))if("errors"===r){n[r]=e[r]?e[r].slice():[];for(var o=0,i=n[r].length;o<i;o++)n[r][o].format=t[n[r][o].format]}else if("success"!==r&&"data"!==r)n[r]=e[r];else{n[r]={};var s=e[r];for(var a in s)a&&C.call(s,a)&&C.call(t,a)&&(n[r][t[a]]=s[a])}return n},He=function(e,t){var n=null==t||t&&t.cacheBust===!0;return n?(e.indexOf("?")===-1?"?":"&")+"noCache="+y():""},Le=function(e){var t,n,r,o,i="",a=[];if(e.trustedDomains&&("string"==typeof e.trustedDomains?o=[e.trustedDomains]:"object"==typeof e.trustedDomains&&"length"in e.trustedDomains&&(o=e.trustedDomains)),o&&o.length)for(t=0,n=o.length;t<n;t++)if(C.call(o,t)&&o[t]&&"string"==typeof o[t]){if(r=Ve(o[t]),!r)continue;if("*"===r){a.length=0,a.push(r);break}a.push.apply(a,[r,"//"+r,s.location.protocol+"//"+r])}return a.length&&(i+="trustedOrigins="+p(a.join(","))),e.forceEnhancedClipboard===!0&&(i+=(i?"&":"")+"forceEnhancedClipboard=true"),"string"==typeof e.swfObjectId&&e.swfObjectId&&(i+=(i?"&":"")+"swfObjectId="+p(e.swfObjectId)),"string"==typeof e.jsVersion&&e.jsVersion&&(i+=(i?"&":"")+"jsVersion="+p(e.jsVersion)),i},Ve=function(e){if(null==e||""===e)return null;if(e=e.replace(/^\s+|\s+$/g,""),""===e)return null;var t=e.indexOf("//");e=t===-1?e:e.slice(t+2);var n=e.indexOf("/");return e=n===-1?e:t===-1||0===n?null:e.slice(0,n),e&&".swf"===e.slice(-4).toLowerCase()?null:e||null},je=function(){var e=function(e){var t,n,r,o=[];if("string"==typeof e&&(e=[e]),"object"!=typeof e||!e||"number"!=typeof e.length)return o;for(t=0,n=e.length;t<n;t++)if(C.call(e,t)&&(r=Ve(e[t]))){if("*"===r){o.length=0,o.push("*");break}o.indexOf(r)===-1&&o.push(r)}return o};return function(t,n){var r=Ve(n.swfPath);null===r&&(r=t);var o=e(n.trustedDomains),i=o.length;if(i>0){if(1===i&&"*"===o[0])return"always";if(o.indexOf(t)!==-1)return 1===i&&t===r?"sameDomain":"always"}return"never"}}(),Fe=function(){try{return a.activeElement}catch(e){return null}},$e=function(e,t){var n,r,o,i=[];if("string"==typeof t&&t&&(i=t.split(/\s+/)),e&&1===e.nodeType&&i.length>0){for(o=(" "+(e.className||"")+" ").replace(/[\t\r\n\f]/g," "),n=0,r=i.length;n<r;n++)o.indexOf(" "+i[n]+" ")===-1&&(o+=i[n]+" ");o=o.replace(/^\s+|\s+$/g,""),o!==e.className&&(e.className=o)}return e},Be=function(e,t){var n,r,o,i=[];if("string"==typeof t&&t&&(i=t.split(/\s+/)),e&&1===e.nodeType&&i.length>0&&e.className){for(o=(" "+e.className+" ").replace(/[\t\r\n\f]/g," "),n=0,r=i.length;n<r;n++)o=o.replace(" "+i[n]+" "," ");o=o.replace(/^\s+|\s+$/g,""),o!==e.className&&(e.className=o)}return e},We=function(e,t){var n=f(e,null).getPropertyValue(t);return"cursor"!==t||n&&"auto"!==n||"A"!==e.nodeName?n:"pointer"},Ue=function(e){var t={left:0,top:0,width:0,height:0};if(e.getBoundingClientRect){var n=e.getBoundingClientRect(),r=s.pageXOffset,o=s.pageYOffset,i=a.documentElement.clientLeft||0,l=a.documentElement.clientTop||0,u=0,d=0;if("relative"===We(a.body,"position")){var c=a.body.getBoundingClientRect(),h=a.documentElement.getBoundingClientRect();u=c.left-h.left||0,d=c.top-h.top||0}t.left=n.left+r-i-u,t.top=n.top+o-l-d,t.width="width"in n?n.width:n.right-n.left,t.height="height"in n?n.height:n.bottom-n.top}return t},Ye=function(e){if(!e)return!1;var t=f(e,null);if(!t)return!1;var n=w(t.height)>0,r=w(t.width)>0,o=w(t.top)>=0,i=w(t.left)>=0,s=n&&r&&o&&i,a=s?null:Ue(e),l="none"!==t.display&&"collapse"!==t.visibility&&(s||!!a&&(n||a.height>0)&&(r||a.width>0)&&(o||a.top>=0)&&(i||a.left>=0));return l},Ge=function(){d(G),G=0,h(z),z=0},ze=function(){var e;if(o&&(e=Ne($.bridge))){var t=Ue(o);S(e.style,{width:t.width+"px",height:t.height+"px",top:t.top+"px",left:t.left+"px",zIndex:""+qe(J.zIndex)})}},Xe=function(e){$.ready===!0&&($.bridge&&"function"==typeof $.bridge.setHandCursor?$.bridge.setHandCursor(e):$.ready=!1)},qe=function(e){if(/^(?:auto|inherit)$/.test(e))return e;var t;return"number"!=typeof e||b(e)?"string"==typeof e&&(t=qe(v(e,10))):t=e,"number"==typeof t?t:"auto"},Ke=function(e){var t=/(\r\n|\r|\n)/g;return"string"==typeof e&&J.fixLineEndings===!0&&(V()?/((^|[^\r])\n|\r([^\n]|$))/.test(e)&&(e=e.replace(t,"\r\n")):/\r/.test(e)&&(e=e.replace(t,"\n"))),e},Qe=function(t){var n,r,o,i=$.sandboxed,s=null;if(t=t===!0,j===!1)s=!1;else{try{r=e.frameElement||null}catch(e){o={name:e.name,message:e.message}}if(r&&1===r.nodeType&&"IFRAME"===r.nodeName)try{s=r.hasAttribute("sandbox")}catch(e){s=null}else{try{n=document.domain||null}catch(e){n=null}(null===n||o&&"SecurityError"===o.name&&/(^|[\s\(\[@])sandbox(es|ed|ing|[\s\.,!\)\]@]|$)/.test(o.message.toLowerCase()))&&(s=!0)}}return $.sandboxed=s,i===s||t||Ze(m),s},Ze=function(e){function t(e){var t=e.match(/[\d]+/g);return t.length=3,t.join(".")}function n(e){return!!e&&(e=e.toLowerCase())&&(/^(pepflashplayer\.dll|libpepflashplayer\.so|pepperflashplayer\.plugin)$/.test(e)||"chrome.plugin"===e.slice(-13))}function r(e){e&&(a=!0,e.version&&(c=t(e.version)),!c&&e.description&&(c=t(e.description)),e.filename&&(d=n(e.filename)))}var o,i,s,a=!1,u=!1,d=!1,c="";if(l.plugins&&l.plugins.length)o=l.plugins["Shockwave Flash"],r(o),l.plugins["Shockwave Flash 2.0"]&&(a=!0,c="2.0.0.11");else if(l.mimeTypes&&l.mimeTypes.length)s=l.mimeTypes["application/x-shockwave-flash"],o=s&&s.enabledPlugin,r(o);else if("undefined"!=typeof e){u=!0;try{i=new e("ShockwaveFlash.ShockwaveFlash.7"),a=!0,c=t(i.GetVariable("$version"))}catch(n){try{i=new e("ShockwaveFlash.ShockwaveFlash.6"),a=!0,c="6.0.21"}catch(n){try{i=new e("ShockwaveFlash.ShockwaveFlash"),a=!0,c=t(i.GetVariable("$version"))}catch(e){u=!1}}}}$.disabled=a!==!0,$.outdated=c&&w(c)<w(B),$.version=c||"0.0.0",$.pluginType=d?"pepper":u?"activex":a?"netscape":"unknown"};Ze(m),Qe(!0);var Je=function(){return this instanceof Je?void("function"==typeof Je._createClient&&Je._createClient.apply(this,E(arguments))):new Je};Je.version="2.3.0",Je.config=function(){return ee.apply(this,E(arguments))},Je.state=function(){return te.apply(this,E(arguments))},Je.isFlashUnusable=function(){return re.apply(this,E(arguments))},Je.on=function(){return oe.apply(this,E(arguments))},Je.off=function(){return ie.apply(this,E(arguments))},Je.handlers=function(){return se.apply(this,E(arguments))},Je.emit=function(){return ae.apply(this,E(arguments))},Je.create=function(){return ue.apply(this,E(arguments))},Je.destroy=function(){return de.apply(this,E(arguments))},Je.setData=function(){return ce.apply(this,E(arguments))},Je.clearData=function(){return he.apply(this,E(arguments))},Je.getData=function(){return fe.apply(this,E(arguments))},Je.focus=Je.activate=function(){return pe.apply(this,E(arguments))},Je.blur=Je.deactivate=function(){return me.apply(this,E(arguments))},Je.activeElement=function(){return ge.apply(this,E(arguments))};var et=0,tt={},nt=0,rt={},ot={};S(J,{autoActivate:!0});var it=function(e){var t,n=this;n.id=""+et++,t={instance:n,elements:[],handlers:{},coreWildcardHandler:function(e){return n.emit(e)}},tt[n.id]=t,e&&n.clip(e),Je.on("*",t.coreWildcardHandler),Je.on("destroy",function(){n.destroy()}),Je.create()},st=function(e,t){var o,i,s,a={},l=this,u=tt[l.id],d=u&&u.handlers;if(!u)throw new Error("Attempted to add new listener(s) to a destroyed ZeroClipboard client instance");if("string"==typeof e&&e?s=e.toLowerCase().split(/\s+/):"object"!=typeof e||!e||"length"in e||"undefined"!=typeof t||_(e).forEach(function(t){var n=e[t];"function"==typeof n&&l.on(t,n)}),s&&s.length&&t){for(o=0,i=s.length;o<i;o++)e=s[o].replace(/^on/,""),a[e]=!0,d[e]||(d[e]=[]),d[e].push(t);if(a.ready&&$.ready&&this.emit({type:"ready",client:this}),a.error){for(o=0,i=K.length;o<i;o++)if($[K[o].replace(/^flash-/,"")]){this.emit({type:"error",name:K[o],client:this});break}r!==n&&Je.version!==r&&this.emit({type:"error",name:"version-mismatch",jsVersion:Je.version,swfVersion:r})}}return l},at=function(e,t){var n,r,o,i,s,a=this,l=tt[a.id],u=l&&l.handlers;if(!u)return a;if(0===arguments.length?i=_(u):"string"==typeof e&&e?i=e.split(/\s+/):"object"!=typeof e||!e||"length"in e||"undefined"!=typeof t||_(e).forEach(function(t){var n=e[t];"function"==typeof n&&a.off(t,n)}),i&&i.length)for(n=0,r=i.length;n<r;n++)if(e=i[n].toLowerCase().replace(/^on/,""),s=u[e],s&&s.length)if(t)for(o=s.indexOf(t);o!==-1;)s.splice(o,1),o=s.indexOf(t,o);else s.length=0;return a},lt=function(e){var t=null,n=tt[this.id]&&tt[this.id].handlers;return n&&(t="string"==typeof e&&e?n[e]?n[e].slice(0):[]:O(n)),t},ut=function(e){var t,n=this;return pt.call(n,e)&&("object"==typeof e&&e&&"string"==typeof e.type&&e.type&&(e=S({},e)),t=S({},we(e),{client:n}),mt.call(n,t)),n},dt=function(e){if(!tt[this.id])throw new Error("Attempted to clip element(s) to a destroyed ZeroClipboard client instance");e=gt(e);for(var t=0;t<e.length;t++)if(C.call(e,t)&&e[t]&&1===e[t].nodeType){e[t].zcClippingId?rt[e[t].zcClippingId].indexOf(this.id)===-1&&rt[e[t].zcClippingId].push(this.id):(e[t].zcClippingId="zcClippingId_"+nt++,rt[e[t].zcClippingId]=[this.id],J.autoActivate===!0&&vt(e[t]));var n=tt[this.id]&&tt[this.id].elements;n.indexOf(e[t])===-1&&n.push(e[t])}return this},ct=function(e){var t=tt[this.id];if(!t)return this;var n,r=t.elements;e="undefined"==typeof e?r.slice(0):gt(e);for(var o=e.length;o--;)if(C.call(e,o)&&e[o]&&1===e[o].nodeType){for(n=0;(n=r.indexOf(e[o],n))!==-1;)r.splice(n,1);var i=rt[e[o].zcClippingId];if(i){for(n=0;(n=i.indexOf(this.id,n))!==-1;)i.splice(n,1);0===i.length&&(J.autoActivate===!0&&wt(e[o]),delete e[o].zcClippingId)}}return this},ht=function(){var e=tt[this.id];return e&&e.elements?e.elements.slice(0):[]},ft=function(){var e=tt[this.id];e&&(this.unclip(),this.off(),Je.off("*",e.coreWildcardHandler),delete tt[this.id])},pt=function(e){if(!e||!e.type)return!1;if(e.client&&e.client!==this)return!1;var t=tt[this.id],n=t&&t.elements,r=!!n&&n.length>0,o=!e.target||r&&n.indexOf(e.target)!==-1,i=e.relatedTarget&&r&&n.indexOf(e.relatedTarget)!==-1,s=e.client&&e.client===this;return!(!t||!(o||i||s))},mt=function(e){var t=tt[this.id];if("object"==typeof e&&e&&e.type&&t){var n=_e(e),r=t&&t.handlers["*"]||[],o=t&&t.handlers[e.type]||[],i=r.concat(o);if(i&&i.length){var a,l,u,d,c,h=this;for(a=0,l=i.length;a<l;a++)u=i[a],d=h,"string"==typeof u&&"function"==typeof s[u]&&(u=s[u]),"object"==typeof u&&u&&"function"==typeof u.handleEvent&&(d=u,u=u.handleEvent),"function"==typeof u&&(c=S({},e),Ce(u,d,[c],n))}}},gt=function(e){return"string"==typeof e&&(e=[]),"number"!=typeof e.length?[e]:e},vt=function(e){if(e&&1===e.nodeType){var t=function(e){(e||(e=s.event))&&("js"!==e._source&&(e.stopImmediatePropagation(),e.preventDefault()),delete e._source)},n=function(n){(n||(n=s.event))&&(t(n),Je.focus(e))};e.addEventListener("mouseover",n,!1),e.addEventListener("mouseout",t,!1),e.addEventListener("mouseenter",t,!1),e.addEventListener("mouseleave",t,!1),e.addEventListener("mousemove",t,!1),ot[e.zcClippingId]={mouseover:n,mouseout:t,mouseenter:t,mouseleave:t,mousemove:t}}},wt=function(e){if(e&&1===e.nodeType){var t=ot[e.zcClippingId];if("object"==typeof t&&t){for(var n,r,o=["move","leave","enter","out","over"],i=0,s=o.length;i<s;i++)n="mouse"+o[i],r=t[n],"function"==typeof r&&e.removeEventListener(n,r,!1);delete ot[e.zcClippingId]}}};Je._createClient=function(){it.apply(this,E(arguments))},Je.prototype.on=function(){return st.apply(this,E(arguments))},Je.prototype.off=function(){return at.apply(this,E(arguments))},Je.prototype.handlers=function(){return lt.apply(this,E(arguments))},Je.prototype.emit=function(){return ut.apply(this,E(arguments))},Je.prototype.clip=function(){return dt.apply(this,E(arguments))},Je.prototype.unclip=function(){return ct.apply(this,E(arguments))},Je.prototype.elements=function(){return ht.apply(this,E(arguments))},Je.prototype.destroy=function(){return ft.apply(this,E(arguments))},Je.prototype.setText=function(e){if(!tt[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Je.setData("text/plain",e),this},Je.prototype.setHtml=function(e){if(!tt[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Je.setData("text/html",e),this},Je.prototype.setRichText=function(e){if(!tt[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Je.setData("application/rtf",e),this},Je.prototype.setData=function(){if(!tt[this.id])throw new Error("Attempted to set pending clipboard data from a destroyed ZeroClipboard client instance");return Je.setData.apply(this,E(arguments)),this},Je.prototype.clearData=function(){if(!tt[this.id])throw new Error("Attempted to clear pending clipboard data from a destroyed ZeroClipboard client instance");return Je.clearData.apply(this,E(arguments)),this},Je.prototype.getData=function(){if(!tt[this.id])throw new Error("Attempted to get pending clipboard data from a destroyed ZeroClipboard client instance");return Je.getData.apply(this,E(arguments))},"function"==typeof define&&define.amd?define(function(){return Je}):"object"==typeof t&&t&&"object"==typeof t.exports&&t.exports?t.exports=Je:e.ZeroClipboard=Je}(function(){return this||window}())},{}]},{},[138,64,66,65,67,110,111,112,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,99,100,101,102,103,105,106,107,108,109,113,114,115,116,132,133,134,135,119,120,121,122,123,124,32,36,33,34,41,35,37,38,39,40,139,140,141,142,143,214,215,208,209,210,144,145,146,147,148,149,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,184,185,186,187,188,189,190,191,192,193,195,196,197,198,199,200,201,202,203,204,205,206,207,211,212,213,216,217,219,220,221,222,223])(138)});