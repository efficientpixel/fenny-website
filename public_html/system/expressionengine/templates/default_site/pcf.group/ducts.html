<pre>{exp:replace_plus find="CID[2047]" replace="CID=[2047]" multiple="yes"}{exp:stringy:removeemptyline}{exp:pcf:parse url="/data/pcf/collamer/VOC-3-LVL-2.PCF" parse="inward"}
{exp:switchee variable="{descmod findreplace="Full Strap Hanger=SUPPORT|Half Strap Hanger=SUPPORT|Double Unistrut=SUPPORT|End Cap=CAP|90 Elbow=ELBOW90"}{type}{/descmod}"}
{case value="CAP|MISC_COMPONENTx"}{/case}
{case value="SUPPORT"}
SUPPORT
    CO-ORDS {endpoint1:z} {endpoint1:x} {endpoint1:y} {endpoint1:size} PL
    SKEY 01V2
    {itemcode}
    {itemdesc}
    ADDITIONAL-ITEM
    {fabitem}
    {revision}
    {project-identifier}
    {area}
    {piping-spec}
    {date-dmy}
    {spoolidentifier}
    {itemattribute0}
    ITEM-ATTRIBUTE1 !!! UNDEFINED-COMPONENT !!!
{/case}
{case value="ELBOW90x"}
{if '{endpoint1:y}' == '{endpoint2:y}'}
    {if '{endpoint1:z}' > '{endpoint2:Z}' AND '{endpoint1:x}' < '{endpoint2:x}'}
ELBOW
    {endpoint1}
    {endpoint2}
    CENTRE-POINT  {endpoint2:z}  {endpoint1:x}  {endpoint1:y}
    {if:else}
ELBOW
    {endpoint1}
    {endpoint2}
    CENTRE-POINT  {endpoint1:z}  {endpoint2:x}  {endpoint1:y}
    {/if}
{if:else}
PIPE
    {endpoint1}
    {endpoint2}
{/if}
    {descmod findreplace="Elbow=ELPL"}{skey}{/descmod}
    {itemcode}
    {itemdesc}
    {fabitem}
    {revision}
    {project-identifier}
    {area}
    {piping-spec}
    {date-dmy}
    {spoolidentifier}
    {itemattribute0}
{/case}
{case default="Yes"}{descmod findreplace="PSP Cut to Length=PIPE|Blastgate=PIPE|Damper=PIPE|PSP 8 to 48=PIPE|PSP 4 to 48=PIPE|Spiral Pipe=PIPE|PSP 50  to 100=PIPE|PSP Offset=PIPE|Lateral Tap=PIPE|Canvas=PIPE|Nailor Heavy Duty Balance Damper=PIPE|Conical Tee=PIPE|Elbow=PIPE|PSP Reducer=REDUCER-CONCENTRIC|Tap=REDUCER-CONCENTRICX|Reducer-Concentric=REDUCER-CONCENTRIC|PSP Reducer Eccentric=REDUCER-ECCENTRIC|Reducer-Eccentric=REDUCER-ECCENTRIC"}{type}{/descmod}
    {endpoint1}
    {endpoint2}
    {centrepoint}
    {branch1point}
    {descmod findreplace="blind flange=FLBL|weld neck=FLWN|WN Flange=FLWN|Elbow=ELPL"}{skey}{/descmod}
    {itemcode}
    {itemdesc}
    {fabitem}
    {revision}
    {project-identifier}
    {area}
    {piping-spec}
    {date-dmy}
    {spoolidentifier}
    {itemattribute0}
{/case}{/exp:switchee}{/exp:pcf:parse}{/exp:stringy:removeemptyline}{/exp:replace_plus}
</pre>